{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/images/sort_asc_disabled.png","path":"images/sort_asc_disabled.png","modified":1,"renderable":0},{"_id":"source/images/sort_asc.png","path":"images/sort_asc.png","modified":1,"renderable":0},{"_id":"source/images/sort_both.png","path":"images/sort_both.png","modified":1,"renderable":0},{"_id":"source/images/sort_desc_disabled.png","path":"images/sort_desc_disabled.png","modified":1,"renderable":0},{"_id":"source/images/sort_desc.png","path":"images/sort_desc.png","modified":1,"renderable":0},{"_id":"source/images/2012/oracle-01-1.jpg","path":"images/2012/oracle-01-1.jpg","modified":1,"renderable":0},{"_id":"source/images/2012/oracle-04-1.jpg","path":"images/2012/oracle-04-1.jpg","modified":1,"renderable":0},{"_id":"source/images/2013/2013-01-16-import-spring-source-code-into-myeclipse.png","path":"images/2013/2013-01-16-import-spring-source-code-into-myeclipse.png","modified":1,"renderable":0},{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":1,"renderable":1},{"_id":"themes/next/source/images/algolia_logo.svg","path":"images/algolia_logo.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/avatar.gif","path":"images/avatar.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/loading.gif","path":"images/loading.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/placeholder.gif","path":"images/placeholder.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/searchicon.png","path":"images/searchicon.png","modified":1,"renderable":1},{"_id":"source/images/2013/07/gradle02.png","path":"images/2013/07/gradle02.png","modified":1,"renderable":0},{"_id":"source/images/2013/04/pptp-xp.jpg","path":"images/2013/04/pptp-xp.jpg","modified":1,"renderable":0},{"_id":"source/images/2013/install-centos/1-15.JPG","path":"images/2013/install-centos/1-15.JPG","modified":1,"renderable":0},{"_id":"source/images/2013/install-centos/1_1.JPG","path":"images/2013/install-centos/1_1.JPG","modified":1,"renderable":0},{"_id":"source/images/2013/install-centos/1_12.JPG","path":"images/2013/install-centos/1_12.JPG","modified":1,"renderable":0},{"_id":"source/images/2013/install-centos/1_14.JPG","path":"images/2013/install-centos/1_14.JPG","modified":1,"renderable":0},{"_id":"source/images/2013/install-centos/1_14_0.JPG","path":"images/2013/install-centos/1_14_0.JPG","modified":1,"renderable":0},{"_id":"source/images/2013/install-centos/1_15.JPG","path":"images/2013/install-centos/1_15.JPG","modified":1,"renderable":0},{"_id":"source/images/2013/install-centos/1_16.JPG","path":"images/2013/install-centos/1_16.JPG","modified":1,"renderable":0},{"_id":"source/images/2013/install-centos/1_17.JPG","path":"images/2013/install-centos/1_17.JPG","modified":1,"renderable":0},{"_id":"source/images/2013/install-centos/1_18.JPG","path":"images/2013/install-centos/1_18.JPG","modified":1,"renderable":0},{"_id":"source/images/2013/install-centos/1_19.JPG","path":"images/2013/install-centos/1_19.JPG","modified":1,"renderable":0},{"_id":"source/images/2013/install-centos/1_22.JPG","path":"images/2013/install-centos/1_22.JPG","modified":1,"renderable":0},{"_id":"source/images/2013/install-centos/1_7.JPG","path":"images/2013/install-centos/1_7.JPG","modified":1,"renderable":0},{"_id":"source/images/2013/install-centos/1_8.JPG","path":"images/2013/install-centos/1_8.JPG","modified":1,"renderable":0},{"_id":"source/images/2013/install-centos/1_8_1.JPG","path":"images/2013/install-centos/1_8_1.JPG","modified":1,"renderable":0},{"_id":"source/images/2013/install-centos/1_8_2.JPG","path":"images/2013/install-centos/1_8_2.JPG","modified":1,"renderable":0},{"_id":"source/images/2013/install-centos/1_8_3.JPG","path":"images/2013/install-centos/1_8_3.JPG","modified":1,"renderable":0},{"_id":"source/images/2013/install-centos/1_8_4.JPG","path":"images/2013/install-centos/1_8_4.JPG","modified":1,"renderable":0},{"_id":"source/images/2013/install-centos/2_1_0.JPG","path":"images/2013/install-centos/2_1_0.JPG","modified":1,"renderable":0},{"_id":"source/images/2013/install-centos/2_1_1.JPG","path":"images/2013/install-centos/2_1_1.JPG","modified":1,"renderable":0},{"_id":"source/images/2013/pxe-dhcp-nfs-kickstart/01.jpg","path":"images/2013/pxe-dhcp-nfs-kickstart/01.jpg","modified":1,"renderable":0},{"_id":"source/images/2015/0409/01.png","path":"images/2015/0409/01.png","modified":1,"renderable":0},{"_id":"source/images/2015/0409/05.png","path":"images/2015/0409/05.png","modified":1,"renderable":0},{"_id":"source/images/2015/0409/03.png","path":"images/2015/0409/03.png","modified":1,"renderable":0},{"_id":"source/images/2015/0409/41.png","path":"images/2015/0409/41.png","modified":1,"renderable":0},{"_id":"source/images/2015/0409/43.png","path":"images/2015/0409/43.png","modified":1,"renderable":0},{"_id":"source/images/2015/0409/42.png","path":"images/2015/0409/42.png","modified":1,"renderable":0},{"_id":"source/images/2015/0409/46.png","path":"images/2015/0409/46.png","modified":1,"renderable":0},{"_id":"source/images/2015/0409/49.png","path":"images/2015/0409/49.png","modified":1,"renderable":0},{"_id":"source/images/2015/0409/54.png","path":"images/2015/0409/54.png","modified":1,"renderable":0},{"_id":"themes/next/source/js/src/algolia-search.js","path":"js/src/algolia-search.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/affix.js","path":"js/src/affix.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/bootstrap.js","path":"js/src/bootstrap.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/hook-duoshuo.js","path":"js/src/hook-duoshuo.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/motion.js","path":"js/src/motion.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/post-details.js","path":"js/src/post-details.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/scrollspy.js","path":"js/src/scrollspy.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/utils.js","path":"js/src/utils.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.css","path":"lib/algolia-instant-search/instantsearch.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","path":"lib/canvas-nest/canvas-nest.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/LICENSE","path":"lib/fastclick/LICENSE","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/README.md","path":"lib/fastclick/README.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/bower.json","path":"lib/fastclick/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","path":"lib/font-awesome/HELP-US-OUT.txt","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/bower.json","path":"lib/font-awesome/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/CONTRIBUTING.md","path":"lib/jquery_lazyload/CONTRIBUTING.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/README.md","path":"lib/jquery_lazyload/README.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.scrollstop.js","path":"lib/jquery_lazyload/jquery.scrollstop.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/bower.json","path":"lib/jquery_lazyload/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.lazyload.js","path":"lib/jquery_lazyload/jquery.lazyload.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/bower.json","path":"lib/velocity/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.min.js","path":"lib/velocity/velocity.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","path":"lib/velocity/velocity.ui.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","path":"lib/velocity/velocity.ui.min.js","modified":1,"renderable":1},{"_id":"source/images/2013/03/android2.png","path":"images/2013/03/android2.png","modified":1,"renderable":0},{"_id":"source/images/2013/install-centos/1_2.JPG","path":"images/2013/install-centos/1_2.JPG","modified":1,"renderable":0},{"_id":"source/images/2013/newer-should-be-known-in-mac/01.png","path":"images/2013/newer-should-be-known-in-mac/01.png","modified":1,"renderable":0},{"_id":"source/images/2013/newer-should-be-known-in-mac/02.png","path":"images/2013/newer-should-be-known-in-mac/02.png","modified":1,"renderable":0},{"_id":"source/images/2013/pxe-dhcp-nfs-kickstart/02.png","path":"images/2013/pxe-dhcp-nfs-kickstart/02.png","modified":1,"renderable":0},{"_id":"source/images/2013/pxe-dhcp-nfs-kickstart/03.png","path":"images/2013/pxe-dhcp-nfs-kickstart/03.png","modified":1,"renderable":0},{"_id":"source/images/2015/0409/02.png","path":"images/2015/0409/02.png","modified":1,"renderable":0},{"_id":"source/images/2015/0409/04.png","path":"images/2015/0409/04.png","modified":1,"renderable":0},{"_id":"source/images/2015/0409/44.png","path":"images/2015/0409/44.png","modified":1,"renderable":0},{"_id":"source/images/2015/0409/45.png","path":"images/2015/0409/45.png","modified":1,"renderable":0},{"_id":"source/images/2015/0409/47.png","path":"images/2015/0409/47.png","modified":1,"renderable":0},{"_id":"source/images/2015/0409/48.png","path":"images/2015/0409/48.png","modified":1,"renderable":0},{"_id":"source/images/2015/0409/50.png","path":"images/2015/0409/50.png","modified":1,"renderable":0},{"_id":"source/images/2015/0409/51.png","path":"images/2015/0409/51.png","modified":1,"renderable":0},{"_id":"source/images/2015/0409/53.png","path":"images/2015/0409/53.png","modified":1,"renderable":0},{"_id":"source/images/2015/0409/55.png","path":"images/2015/0409/55.png","modified":1,"renderable":0},{"_id":"themes/next/source/lib/jquery/index.js","path":"lib/jquery/index.js","modified":1,"renderable":1},{"_id":"source/images/2013/03/android.jpeg","path":"images/2013/03/android.jpeg","modified":1,"renderable":0},{"_id":"source/images/2013/03/android1.png","path":"images/2013/03/android1.png","modified":1,"renderable":0},{"_id":"source/images/2013/04/pptp-mac-01.png","path":"images/2013/04/pptp-mac-01.png","modified":1,"renderable":0},{"_id":"source/images/2013/04/pptp-mac-02.png","path":"images/2013/04/pptp-mac-02.png","modified":1,"renderable":0},{"_id":"themes/next/source/js/src/schemes/pisces.js","path":"js/src/schemes/pisces.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading.gif","path":"lib/fancybox/source/fancybox_loading.gif","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/blank.gif","path":"lib/fancybox/source/blank.gif","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading@2x.gif","path":"lib/fancybox/source/fancybox_loading@2x.gif","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_overlay.png","path":"lib/fancybox/source/fancybox_overlay.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite.png","path":"lib/fancybox/source/fancybox_sprite.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite@2x.png","path":"lib/fancybox/source/fancybox_sprite@2x.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","path":"lib/fancybox/source/jquery.fancybox.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","path":"lib/fancybox/source/jquery.fancybox.pack.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","path":"lib/fancybox/source/jquery.fancybox.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.js","path":"lib/fastclick/lib/fastclick.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.min.js","path":"lib/fastclick/lib/fastclick.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","path":"lib/font-awesome/css/font-awesome.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","path":"lib/font-awesome/css/font-awesome.css.map","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","path":"lib/font-awesome/css/font-awesome.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","path":"lib/ua-parser-js/dist/ua-parser.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","path":"lib/ua-parser-js/dist/ua-parser.pack.js","modified":1,"renderable":1},{"_id":"source/images/avatar.png","path":"images/avatar.png","modified":1,"renderable":0},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","path":"lib/font-awesome/fonts/FontAwesome.otf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","path":"lib/font-awesome/fonts/fontawesome-webfont.eot","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","path":"lib/font-awesome/fonts/fontawesome-webfont.woff","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","path":"lib/font-awesome/fonts/fontawesome-webfont.woff2","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.js","path":"lib/velocity/velocity.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/fancybox_buttons.png","path":"lib/fancybox/source/helpers/fancybox_buttons.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","path":"lib/fancybox/source/helpers/jquery.fancybox-media.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","path":"lib/font-awesome/fonts/fontawesome-webfont.ttf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.js","path":"lib/algolia-instant-search/instantsearch.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","path":"lib/font-awesome/fonts/fontawesome-webfont.svg","modified":1,"renderable":1}],"Cache":[{"_id":"source/.DS_Store","hash":"e0afb3c1cd7beb4f02e0e485aa406d0a7c08318c","modified":1485447547000},{"_id":"themes/next/.bowerrc","hash":"3228a58ed0ece9f85e1e3136352094080b8dece1","modified":1485437807000},{"_id":"themes/next/.editorconfig","hash":"792fd2bd8174ece1a75d5fd24ab16594886f3a7f","modified":1485437807000},{"_id":"themes/next/.gitignore","hash":"5f09fca02e030b7676c1d312cd88ce8fbccf381c","modified":1485437807000},{"_id":"themes/next/.hound.yml","hash":"b76daa84c9ca3ad292c78412603370a367cc2bc3","modified":1485437807000},{"_id":"themes/next/.javascript_ignore","hash":"f9ea3c5395f8feb225a24e2c32baa79afda30c16","modified":1485437807000},{"_id":"themes/next/.jshintrc","hash":"9928f81bd822f6a8d67fdbc909b517178533bca9","modified":1485437807000},{"_id":"themes/next/README.en.md","hash":"3b0c7998cf17f9cf9e1a5bfcd65679a43a00c817","modified":1485437807000},{"_id":"themes/next/README.md","hash":"500b5606eb6a09c979d16128f8b00f4bf9bc95ac","modified":1485437807000},{"_id":"themes/next/_config.yml","hash":"5599ce652b2986f7ddfb3a4bde3cf98a344f46e0","modified":1485481958000},{"_id":"themes/next/bower.json","hash":"5abc236d9cc2512f5457ed57c1fba76669eb7399","modified":1485437807000},{"_id":"themes/next/gulpfile.coffee","hash":"61ef0606a8134894d7ac796bc8d0fa4ba6a94483","modified":1485437807000},{"_id":"themes/next/package.json","hash":"877cb98025e59015532c4c9a04a33e2af4ad56f9","modified":1485437807000},{"_id":"source/about/index.md","hash":"0661ae570bc8735c0d1e1c053e86bcd81252a0ab","modified":1485443740000},{"_id":"source/_posts/2012-03-23-managing-hierarchical-data-in-oracle-1.md","hash":"2df45529d7d6ad8e749c949268b99d49c917daa0","modified":1485480883000},{"_id":"source/_posts/2012-03-24-managing-hierarchical-data-in-oracle-2.md","hash":"e43a2a7175cc307552a0655eeb8ae9a9a5e89952","modified":1485358196000},{"_id":"source/_posts/2012-03-23-what-you-are-doing-in-5-years.md","hash":"367a1cbc9e487dd575ba430fbeda69a7ce3c5ccb","modified":1485358196000},{"_id":"source/_posts/2012-03-25-managing-hierarchical-data-in-oracle-3.md","hash":"7701eda67c7e2fe027bdac3084ff4e7ebc9adfc6","modified":1485358196000},{"_id":"source/_posts/2012-05-12-team-thinking.md","hash":"d563cf27b292cb41272a27674937256fc260ffd3","modified":1485444755000},{"_id":"source/_posts/2012-03-26-managing-hierarchical-data-in-oracle-4.md","hash":"660885a488a17ce142f8bcec308ebc1c6e039815","modified":1485480883000},{"_id":"source/_posts/2013-01-03-start-here-2013.md","hash":"72598e902aaed77b8006d40612b487ba52a08728","modified":1485358196000},{"_id":"source/_posts/2013-01-04-newer-should-be-known-in-mac.md","hash":"9bb7d7930f67b977f5f0cd8f70f9a20dd7742b98","modified":1485480883000},{"_id":"source/_posts/2013-01-16-import-spring-source-code-into-myeclipse.md","hash":"3466081764cca4d745cee80dbc7737b3c4af0134","modified":1485480883000},{"_id":"source/_posts/2013-02-17-gradle-01-build-project-dir.md","hash":"5c3405232bc27db80cf80cddc13c3dc86520609a","modified":1485445843000},{"_id":"source/_posts/2013-01-24-pxe-plus-dhcp-plus-nfs-plus-kickstart-centos5-dot-8-x64.md","hash":"d00fa82b6bd9d8d5b47df26fd6dbcf9ad02a7934","modified":1485480883000},{"_id":"source/_posts/2013-01-22-linux01-install-centos5-dot-8-x64-process.md","hash":"084eadff9d203109632b02056af539c2f5366025","modified":1485480883000},{"_id":"source/_posts/2013-03-03-install-android-development-environment-in-mac.md","hash":"912ed1c7ee8328ddc03417c4b88a830808ab8553","modified":1485480883000},{"_id":"source/_posts/2013-04-14-install-pptp-in-centos6-dot-2-64bit-at-linode.md","hash":"2a0709d5683a8f0d09c14dbeb67f87e7b415b255","modified":1485482749000},{"_id":"source/_posts/2013-02-16-build-openjdk7-in-centos6-dot-3.md","hash":"83400c98182c48517792f492e4106ee890a199d7","modified":1485445225000},{"_id":"source/_posts/2013-02-18-install-lua-in-mac-os.md","hash":"5ad01779d0b5e1312b372a39ddb077a8a6038e35","modified":1485445859000},{"_id":"source/_posts/2013-07-17-linux-03-permission.md","hash":"180d105ecaaa15a569920fb544bfba4833065ba0","modified":1485446086000},{"_id":"source/_posts/2014-08-09-linuxxi-lie-4-pxe-plus-dhcp-plus-nfs-plus-kickstartwu-ren-zhi-shou-pi-liang-an-zhuang-centos6-dot-3-x64.md","hash":"c2f367fe9dcab4f4f6f85cd7f5498ec5ae955ff3","modified":1485358196000},{"_id":"source/_posts/2013-07-16-gradle-02-basic-use.md","hash":"40e273ceec9255aa5245e0ecc7e84817792c9e0e","modified":1485480883000},{"_id":"source/_posts/2014-08-30-learning-fabric3-fab.md","hash":"dc26374e12d4b82b9b1259c1368e6a760f608cdf","modified":1485482695000},{"_id":"source/_posts/2013-06-29-IntelliJ-IDEA-keymap.md","hash":"de5ccb431b38be0d8e375b7f4c264b2ddd4b251a","modified":1485445960000},{"_id":"source/_posts/2014-08-11-learning-fabric-1-overview-and-tutorial.md","hash":"92bab5e2ad21507b97d01ca57d364f0f11da8d2b","modified":1485482685000},{"_id":"source/_posts/2015-03-21-java-gc-basic.md","hash":"11f62e571808c1298c03a18c1e9c164709da95b7","modified":1485482700000},{"_id":"source/_posts/2015-04-10-seemingly-simple-yet-very-difficult-feats.md","hash":"1969a18071efc12dea9e26f1fbfbc69862ce0c25","modified":1485482711000},{"_id":"source/_posts/2014-08-24-learning-fabric2-hosts-and-roles.md","hash":"cdb37ead5216a25b5c1b8c414cc016753efd6567","modified":1485482690000},{"_id":"source/categories/index.md","hash":"2e62d15f2a770aa8b668e1ad28b3413a0d8e55e3","modified":1485441333000},{"_id":"source/_posts/2015-03-31-from-octopress-to-jekyll.md","hash":"0739bfc8115a5c9c86717ac441a007f350661a7e","modified":1485358196000},{"_id":"source/_posts/2015-04-09-what-skills-do-developer-have.md","hash":"803cff04e26bf543c5e39741832703a0094d84d2","modified":1485480883000},{"_id":"source/_posts/2017-01-26-jekyll-to-hexo.md","hash":"806bf74c13e2916bedaa0d41cd04f785be78fe11","modified":1485482581000},{"_id":"source/images/sort_asc_disabled.png","hash":"cf127aab312c10ea8445c9230b3b65fad5013e26","modified":1485358197000},{"_id":"source/images/sort_asc.png","hash":"fdadf7f5935f4a411ab19366c6590546432acd0f","modified":1485358197000},{"_id":"source/images/sort_both.png","hash":"cb35461ff7f6547daed299080563969b41fed878","modified":1485358197000},{"_id":"themes/next/.github/CONTRIBUTING.md","hash":"5ab257af816986cd0e53f9527a92d5934ac70ae9","modified":1485437807000},{"_id":"source/images/sort_desc_disabled.png","hash":"7bc88275f1d99623505dfa0d6730978e5c65525e","modified":1485358197000},{"_id":"source/images/sort_desc.png","hash":"79bc8ee64be969c8c02db30a9317e534a3db7877","modified":1485358197000},{"_id":"source/tags/index.md","hash":"f99263efbdbd89751382d355009754870c9a5393","modified":1485440769000},{"_id":"themes/next/.github/ISSUE_TEMPLATE.md","hash":"c2024ded82143807c28a299c5fe6b927ef3525ff","modified":1485437807000},{"_id":"themes/next/languages/default.yml","hash":"767470a80dc257e23e14c3a78e8c52a46c9d6209","modified":1485437807000},{"_id":"themes/next/languages/de.yml","hash":"1fdea1f84b7f691f5b4dd4d2b43eeb27b10fa0c8","modified":1485437807000},{"_id":"themes/next/languages/fr-FR.yml","hash":"9fca01ef917d33ae2ae6bc04561ec6799dff5351","modified":1485437807000},{"_id":"themes/next/languages/en.yml","hash":"40057d6608e825d06e0864bac4dcd27ed88ada87","modified":1485437807000},{"_id":"themes/next/languages/id.yml","hash":"34396bef27c4ab9e9a3c5d3e3aa94b0e3b3a7b0d","modified":1485437807000},{"_id":"themes/next/languages/ja.yml","hash":"49f12149edcc1892b26a6207328cda64da20116d","modified":1485437807000},{"_id":"themes/next/languages/pt-BR.yml","hash":"7742ba4c0d682cbe1d38305332ebc928abd754b5","modified":1485437807000},{"_id":"themes/next/languages/ko.yml","hash":"b6bc5d6b0c000deb44099b42d3aebb8c49dbfca9","modified":1485437807000},{"_id":"themes/next/languages/pt.yml","hash":"6b660b117314cad93f08757601df3adb04c68beb","modified":1485437807000},{"_id":"themes/next/languages/zh-Hans.yml","hash":"f6c9fafa0f5f0050cd07ca2cf5e38fbae3e28145","modified":1485437807000},{"_id":"themes/next/languages/zh-tw.yml","hash":"c97a5c41149de9b17f33439b0ecf0eff6fdae50e","modified":1485437807000},{"_id":"themes/next/languages/zh-hk.yml","hash":"34c84c6d04447a25bd5eac576922a13947c000e2","modified":1485437807000},{"_id":"themes/next/languages/ru.yml","hash":"257d11e626cbe4b9b78785a764190b9278f95c28","modified":1485437807000},{"_id":"themes/next/layout/_layout.swig","hash":"2fa3c74066843a859fac77803324a1de51044da9","modified":1485437807000},{"_id":"themes/next/layout/archive.swig","hash":"b5b59d70fc1563f482fa07afd435752774ad5981","modified":1485437807000},{"_id":"themes/next/layout/category.swig","hash":"6422d196ceaff4220d54b8af770e7e957f3364ad","modified":1485437807000},{"_id":"themes/next/layout/page.swig","hash":"3727fab9dadb967e9c2204edca787dc72264674a","modified":1485437807000},{"_id":"themes/next/layout/schedule.swig","hash":"1f1cdc268f4ef773fd3ae693bbdf7d0b2f45c3a3","modified":1485437807000},{"_id":"themes/next/scripts/merge-configs.js","hash":"0c56be2e85c694247cfa327ea6d627b99ca265e8","modified":1485437807000},{"_id":"themes/next/layout/tag.swig","hash":"07cf49c49c39a14dfbe9ce8e7d7eea3d4d0a4911","modified":1485437807000},{"_id":"themes/next/layout/index.swig","hash":"427d0b95b854e311ae363088ab39a393bf8fdc8b","modified":1485437807000},{"_id":"themes/next/layout/post.swig","hash":"e2e512142961ddfe77eba29eaa88f4a2ee43ae18","modified":1485437807000},{"_id":"themes/next/test/helpers.js","hash":"a1f5de25154c3724ffc24a91ddc576cdbd60864f","modified":1485437807000},{"_id":"themes/next/test/.jshintrc","hash":"19f93d13d1689fe033c82eb2d5f3ce30b6543cc0","modified":1485437807000},{"_id":"themes/next/test/intern.js","hash":"11fa8a4f5c3b4119a179ae0a2584c8187f907a73","modified":1485437807000},{"_id":"themes/next/source/fonts/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1485437807000},{"_id":"source/images/2012/oracle-01-1.jpg","hash":"1150a384480e02bfb7c723c635333db006e63a01","modified":1485358196000},{"_id":"source/images/2012/oracle-04-1.jpg","hash":"7206dfc212539fa3f81203417c7b6f9bfd0db2ea","modified":1485358196000},{"_id":"source/images/2013/2013-01-16-import-spring-source-code-into-myeclipse.png","hash":"12cd14cb1e4ea588a3242df8e50daf18d25bd22e","modified":1485358196000},{"_id":"themes/next/layout/_custom/header.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1485437807000},{"_id":"themes/next/layout/_macro/post-collapse.swig","hash":"5864f5567ba5efeabcf6ea355013c0b603ee07f2","modified":1485437807000},{"_id":"themes/next/layout/_custom/sidebar.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1485437807000},{"_id":"themes/next/layout/_macro/post.swig","hash":"e6016def9b512188f4c2725399c9adc7bc41cdae","modified":1485437807000},{"_id":"themes/next/layout/_macro/reward.swig","hash":"37e5b7c42ec17b9b6b786c5512bcc481a21c974e","modified":1485437807000},{"_id":"themes/next/layout/_macro/sidebar.swig","hash":"43d8830bb19da4fc7a5773866be19fa066b62645","modified":1485437807000},{"_id":"themes/next/layout/_macro/wechat-subscriber.swig","hash":"14e785adeb0e671ba0ff9a553e6f0d8def6c670c","modified":1485437807000},{"_id":"themes/next/layout/_partials/comments.swig","hash":"78ccfc1dc915247c1fec3c86d742e0f4c2f6d99c","modified":1485437807000},{"_id":"themes/next/layout/_partials/duoshuo-hot-articles.swig","hash":"5d4638c46aef65bf32a01681495b62416ccc98db","modified":1485437807000},{"_id":"themes/next/layout/_partials/footer.swig","hash":"7172c6053118b7c291a56a7860128a652ae66b83","modified":1485437807000},{"_id":"themes/next/layout/_partials/head.swig","hash":"ca56f92e2fa82b03853869f5073ee1a5626a4796","modified":1485437807000},{"_id":"themes/next/layout/_partials/header.swig","hash":"adab5c3f7b173f1b45454787f39dde07aea03483","modified":1485437807000},{"_id":"themes/next/layout/_partials/page-header.swig","hash":"39d613e5a9f8389d4ea52d6082502af8e833b9f2","modified":1485437807000},{"_id":"themes/next/layout/_partials/pagination.swig","hash":"9e8e21d194ef44d271b1cca0bc1448c14d7edf4f","modified":1485437807000},{"_id":"themes/next/layout/_scripts/boostrap.swig","hash":"03aaebe9d50f6acb007ec38cc04acd1cfceb404d","modified":1485437807000},{"_id":"themes/next/layout/_scripts/commons.swig","hash":"766b2bdda29523ed6cd8d7aa197f996022f8fd94","modified":1485437807000},{"_id":"themes/next/layout/_partials/search.swig","hash":"1431719d1dbba3f5ee385eebc46376d1a960b2d5","modified":1485437807000},{"_id":"themes/next/layout/_scripts/baidu-push.swig","hash":"c057b17f79e8261680fbae8dc4e81317a127c799","modified":1485437807000},{"_id":"themes/next/layout/_scripts/vendors.swig","hash":"4512867d80d9eddfc3a0f5fea3c456f33aa9d522","modified":1485437807000},{"_id":"themes/next/scripts/tags/button.js","hash":"62e6dbeb53d07627a048132c79630b45d9a8f2cc","modified":1485437807000},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"535fc542781021c4326dec24d8495cbb1387634a","modified":1485437807000},{"_id":"themes/next/scripts/tags/full-image.js","hash":"8eeb3fb89540299bdbb799edfdfdac3743b50596","modified":1485437807000},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"49252824cd53184dc9b97b2f2d87ff28e1b3ef27","modified":1485437807000},{"_id":"themes/next/scripts/tags/note.js","hash":"6752925eedbdb939d8ec4d11bdfb75199f18dd70","modified":1485437807000},{"_id":"themes/next/source/css/main.styl","hash":"20702c48d6053c92c5bcdbc68e8d0ef1369848a0","modified":1485437807000},{"_id":"themes/next/source/images/algolia_logo.svg","hash":"90035272fa31a3f65b3c0e2cb8a633876ef457dc","modified":1485437807000},{"_id":"themes/next/source/images/avatar.gif","hash":"264082bb3a1af70d5499c7d22b0902cb454b6d12","modified":1485437807000},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1485437807000},{"_id":"themes/next/source/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1485437807000},{"_id":"themes/next/source/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1485437807000},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1485437807000},{"_id":"themes/next/source/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1485437807000},{"_id":"themes/next/source/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1485437807000},{"_id":"themes/next/source/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1485437807000},{"_id":"themes/next/source/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1485437807000},{"_id":"themes/next/source/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1485437807000},{"_id":"themes/next/source/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1485437807000},{"_id":"themes/next/source/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1485437807000},{"_id":"themes/next/source/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1485437807000},{"_id":"themes/next/layout/_scripts/schemes/mist.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1485437807000},{"_id":"themes/next/layout/_scripts/schemes/muse.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1485437807000},{"_id":"themes/next/source/css/_mixins/Mist.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1485437807000},{"_id":"themes/next/source/css/_mixins/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1485437807000},{"_id":"themes/next/source/css/_mixins/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1485437807000},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1485437807000},{"_id":"themes/next/source/css/_variables/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1485437807000},{"_id":"source/images/2013/07/gradle02.png","hash":"7eba3e7cba7511ca964d659c42d0a5fd993aa33f","modified":1485358196000},{"_id":"source/images/2013/04/pptp-xp.jpg","hash":"fe5ca25a6435a8df213bf26d6faa1df28d58b09c","modified":1485358196000},{"_id":"source/images/2013/install-centos/1-15.JPG","hash":"0fd950b326e2fb8eb5cdbcf2beccb16bf52e3468","modified":1485358196000},{"_id":"source/images/2013/install-centos/1_1.JPG","hash":"dc00875028e3c771be5d4f39285ad194be13d021","modified":1485358196000},{"_id":"source/images/2013/install-centos/1_12.JPG","hash":"8c1fcd1bcfe0d43495551abd9dc89349438f201d","modified":1485358196000},{"_id":"source/images/2013/install-centos/1_14.JPG","hash":"f878ed37959238742d284ac2e9b4a18572a7376b","modified":1485358196000},{"_id":"source/images/2013/install-centos/1_14_0.JPG","hash":"3b8199491ae8c51d30f75e9d7462bb7933fecf4b","modified":1485358196000},{"_id":"source/images/2013/install-centos/1_15.JPG","hash":"0fd950b326e2fb8eb5cdbcf2beccb16bf52e3468","modified":1485358196000},{"_id":"source/images/2013/install-centos/1_16.JPG","hash":"bf6238d03b7fb9ec78be8402cda93739261411c4","modified":1485358196000},{"_id":"source/images/2013/install-centos/1_17.JPG","hash":"13d254f0a3fd41aea967f059ca911c796f1048e5","modified":1485358196000},{"_id":"source/images/2013/install-centos/1_18.JPG","hash":"038e19e9e095aa00e2943bf22b10200670b8491c","modified":1485358196000},{"_id":"source/images/2013/install-centos/1_19.JPG","hash":"5b8d08b540116aac9a930cdd8d2bf1428ddbac8c","modified":1485358197000},{"_id":"source/images/2013/install-centos/1_22.JPG","hash":"8802e8e091576d4daf69028194f155fa46b5c20d","modified":1485358197000},{"_id":"source/images/2013/install-centos/1_7.JPG","hash":"0a0d6ca67a912bce9dc0f26a6bf2c0a9b3eb4693","modified":1485358197000},{"_id":"source/images/2013/install-centos/1_8.JPG","hash":"066bb6c59b05a7edaf24c49d0a132b1c237eef85","modified":1485358197000},{"_id":"source/images/2013/install-centos/1_8_1.JPG","hash":"ea2463455789671bc41761140edc6a6825eeb72e","modified":1485358197000},{"_id":"source/images/2013/install-centos/1_8_2.JPG","hash":"63b3e251615f7bba39a6379ef469a682e6c6ead1","modified":1485358197000},{"_id":"source/images/2013/install-centos/1_8_3.JPG","hash":"32222e47b70dcb989e470ce5c9e70475449100ab","modified":1485358197000},{"_id":"source/images/2013/install-centos/1_8_4.JPG","hash":"67fd90d7a83b6bf919abfc7d459722718cae411b","modified":1485358197000},{"_id":"source/images/2013/install-centos/2_1_0.JPG","hash":"b50c9b6da2e5b374521730b01b2e27a32ecc9d95","modified":1485358197000},{"_id":"source/images/2013/install-centos/2_1_1.JPG","hash":"21bdc7d03a9a5f6bab08021de44d6a4030b269dc","modified":1485358197000},{"_id":"source/images/2013/pxe-dhcp-nfs-kickstart/01.jpg","hash":"e1bebdcde1c432b614cd30ff2596023afe63f80f","modified":1485358197000},{"_id":"source/images/2015/0409/01.png","hash":"a86dc25711ad55109695267f189eadceb07f299b","modified":1485358197000},{"_id":"source/images/2015/0409/.png","hash":"a0632f3b31a0378ef5f141bdc30cf448a75d4857","modified":1485358197000},{"_id":"source/images/2015/0409/05.png","hash":"979541d4bc3a6a670f9aba310212a756f7c262b8","modified":1485358197000},{"_id":"source/images/2015/0409/03.png","hash":"511be3bc3c4d8f0c673e37719f8e101248a68dcc","modified":1485358197000},{"_id":"source/images/2015/0409/41.png","hash":"a0632f3b31a0378ef5f141bdc30cf448a75d4857","modified":1485358197000},{"_id":"source/images/2015/0409/43.png","hash":"246611d5555767abfa1cc468ab5e572076811386","modified":1485358197000},{"_id":"source/images/2015/0409/42.png","hash":"c39ad2fcbbc0d406e6f9f9c46d426fe551030e62","modified":1485358197000},{"_id":"source/images/2015/0409/46.png","hash":"81e92d46fbf0ae0ed3e1aad45bde6225919c7aad","modified":1485358197000},{"_id":"source/images/2015/0409/49.png","hash":"44f7529fea1ad3e2bbe34d74f151576ece7bfa1e","modified":1485358197000},{"_id":"source/images/2015/0409/54.png","hash":"e6e346e887dc010e32d60803b04ad63cb0ea1fdc","modified":1485358197000},{"_id":"themes/next/layout/_partials/head/custom-head.swig","hash":"9e1b9666efa77f4cf8d8261bcfa445a9ac608e53","modified":1485437807000},{"_id":"themes/next/layout/_components/algolia-search/dom.swig","hash":"636f1181dd5887a70b4a08ca8f655d4e46635792","modified":1485437807000},{"_id":"themes/next/layout/_components/algolia-search/assets.swig","hash":"28ff4ed6714c59124569ffcbd10f1173d53ca923","modified":1485437807000},{"_id":"themes/next/layout/_partials/head/external-fonts.swig","hash":"7ce76358411184482bb0934e70037949dd0da8ca","modified":1485437807000},{"_id":"themes/next/layout/_partials/search/localsearch.swig","hash":"ff5523d5dacaa77a55a24e50e6e6530c3b98bfad","modified":1485437807000},{"_id":"themes/next/layout/_partials/search/swiftype.swig","hash":"959b7e04a96a5596056e4009b73b6489c117597e","modified":1485437807000},{"_id":"themes/next/layout/_partials/search/tinysou.swig","hash":"eefe2388ff3d424694045eda21346989b123977c","modified":1485437807000},{"_id":"themes/next/layout/_partials/share/add-this.swig","hash":"23e23dc0f76ef3c631f24c65277adf7ea517b383","modified":1485437807000},{"_id":"themes/next/layout/_partials/share/baidushare.swig","hash":"1f1107468aaf03f7d0dcd7eb2b653e2813a675b4","modified":1485437807000},{"_id":"themes/next/layout/_partials/share/duoshuo_share.swig","hash":"89c5a5240ecb223acfe1d12377df5562a943fd5d","modified":1485437807000},{"_id":"themes/next/layout/_partials/share/jiathis.swig","hash":"63315fcf210799f894208c9f512737096df84962","modified":1485437807000},{"_id":"themes/next/layout/_scripts/schemes/pisces.swig","hash":"a44acf9b0d0f44ef3dfc767376a95c984cc127de","modified":1485437807000},{"_id":"themes/next/layout/_scripts/third-party/analytics.swig","hash":"394d9fff7951287cc90f52acc2d4cbfd1bae079d","modified":1485437807000},{"_id":"themes/next/layout/_scripts/third-party/comments.swig","hash":"4abc01bc870e1d7a783cdbd26166edc782a6a4f4","modified":1485437807000},{"_id":"themes/next/layout/_scripts/third-party/lean-analytics.swig","hash":"92dc60821307fc9769bea9b2d60adaeb798342af","modified":1485437807000},{"_id":"themes/next/layout/_scripts/third-party/localsearch.swig","hash":"b460e27db3dcd4ab40b17d8926a5c4e624f293a9","modified":1485437807000},{"_id":"themes/next/layout/_scripts/third-party/mathjax.swig","hash":"6d25596d6a7c57700d37b607f8d9a62d89708683","modified":1485437807000},{"_id":"themes/next/layout/_scripts/third-party/schedule.swig","hash":"22369026c87fc23893c35a7f250b42f3bb1b60f1","modified":1485437807000},{"_id":"themes/next/layout/_scripts/third-party/tinysou.swig","hash":"cb3a5d36dbe1630bab84e03a52733a46df7c219b","modified":1485437807000},{"_id":"themes/next/layout/_scripts/pages/post-details.swig","hash":"069d1357c717572256e5cdee09574ebce529cbae","modified":1485437807000},{"_id":"themes/next/source/css/_custom/custom.styl","hash":"328d9a9696cc2ccf59c67d3c26000d569f46344c","modified":1485437807000},{"_id":"themes/next/source/css/_mixins/Pisces.styl","hash":"715d5b40dc52f319fe4bff0325beb874774d9bd9","modified":1485437807000},{"_id":"themes/next/source/css/_mixins/base.styl","hash":"78a83c38f69a8747bb74e420e6c9eeef1ea76525","modified":1485437807000},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"c8d35a6b9e3bff6d8fdb66de853065af9d37562d","modified":1485437807000},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"c459aa6d607d8bcb747544e74f6ad0b8374aa3b1","modified":1485437807000},{"_id":"themes/next/source/css/_variables/base.styl","hash":"fc185c6cec79593775d1c2440dbe2a71cfbe2e99","modified":1485437807000},{"_id":"themes/next/source/js/src/algolia-search.js","hash":"96b29f69b8b916b22f62c9959a117b5a968200a5","modified":1485437807000},{"_id":"themes/next/source/js/src/affix.js","hash":"978e0422b5bf1b560236d8d10ebc1adcf66392e3","modified":1485437807000},{"_id":"themes/next/source/js/src/bootstrap.js","hash":"39bf93769d9080fa01a9a875183b43198f79bc19","modified":1485437807000},{"_id":"themes/next/source/js/src/hook-duoshuo.js","hash":"a6119070c0119f33e08b29da7d2cce2635eb40a0","modified":1485437807000},{"_id":"themes/next/source/js/src/motion.js","hash":"269414e84df544a4ccb88519f6abae4943db3c67","modified":1485437807000},{"_id":"themes/next/source/js/src/post-details.js","hash":"2038f54e289b6da5def09689e69f623187147be5","modified":1485437807000},{"_id":"themes/next/source/js/src/scrollspy.js","hash":"fe4da1b9fe73518226446f5f27d2831e4426fc35","modified":1485437807000},{"_id":"themes/next/source/js/src/utils.js","hash":"384e17ff857f073060f5bf8c6e4f4b7353236331","modified":1485437807000},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.css","hash":"90ef19edc982645b118b095615838d9c5eaba0de","modified":1485437807000},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","hash":"0387e75e23b1db108a755073fe52a0d03eb391a7","modified":1485437807000},{"_id":"themes/next/source/lib/fancybox/.gitattributes","hash":"2db21acfbd457452462f71cc4048a943ee61b8e0","modified":1485437807000},{"_id":"themes/next/source/lib/fancybox/.bower.json","hash":"cc40a9b11e52348e554c84e4a5c058056f6b7aeb","modified":1485437807000},{"_id":"themes/next/source/lib/fastclick/.bower.json","hash":"93ebd5b35e632f714dcf1753e1f6db77ec74449b","modified":1485437807000},{"_id":"themes/next/source/lib/fastclick/LICENSE","hash":"dcd5b6b43095d9e90353a28b09cb269de8d4838e","modified":1485437807000},{"_id":"themes/next/source/lib/fastclick/README.md","hash":"1decd8e1adad2cd6db0ab50cf56de6035156f4ea","modified":1485437807000},{"_id":"themes/next/source/lib/fastclick/bower.json","hash":"13379463c7463b4b96d13556b46faa4cc38d81e6","modified":1485437807000},{"_id":"themes/next/source/lib/font-awesome/.gitignore","hash":"69d152fa46b517141ec3b1114dd6134724494d83","modified":1485437807000},{"_id":"themes/next/source/lib/font-awesome/.bower.json","hash":"c1072942459fa0880e8a33a1bd929176b62b4171","modified":1485437807000},{"_id":"themes/next/source/lib/font-awesome/.npmignore","hash":"dcf470ab3a358103bb896a539cc03caeda10fa8b","modified":1485437807000},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1485437807000},{"_id":"themes/next/source/lib/font-awesome/bower.json","hash":"279a8a718ab6c930a67c41237f0aac166c1b9440","modified":1485437807000},{"_id":"themes/next/source/lib/jquery/.bower.json","hash":"91745c2cc6c946c7275f952b2b0760b880cea69e","modified":1485437807000},{"_id":"themes/next/source/lib/jquery_lazyload/.bower.json","hash":"b7638afc93e9cd350d0783565ee9a7da6805ad8e","modified":1485437807000},{"_id":"themes/next/source/lib/jquery_lazyload/CONTRIBUTING.md","hash":"4891864c24c28efecd81a6a8d3f261145190f901","modified":1485437807000},{"_id":"themes/next/source/lib/jquery_lazyload/README.md","hash":"895d50fa29759af7835256522e9dd7dac597765c","modified":1485437807000},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.scrollstop.js","hash":"0e9a81785a011c98be5ea821a8ed7d411818cfd1","modified":1485437807000},{"_id":"themes/next/source/lib/jquery_lazyload/bower.json","hash":"65bc85d12197e71c40a55c0cd7f6823995a05222","modified":1485437807000},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.lazyload.js","hash":"481fd478650e12b67c201a0ea41e92743f8b45a3","modified":1485437807000},{"_id":"themes/next/source/lib/velocity/.bower.json","hash":"05f960846f1c7a93dab1d3f9a1121e86812e8c88","modified":1485437807000},{"_id":"themes/next/source/lib/velocity/bower.json","hash":"2ec99573e84c7117368beccb9e94b6bf35d2db03","modified":1485437807000},{"_id":"themes/next/source/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1485437807000},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1485437807000},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1485437807000},{"_id":"source/images/2013/03/android2.png","hash":"8ec9e73da9be58cb6e77564a1c5d477ec04fdb17","modified":1485358196000},{"_id":"source/images/2013/install-centos/1_2.JPG","hash":"12022e5e9485af32e126b7c7ecd0c1761602d01c","modified":1485358197000},{"_id":"source/images/2013/newer-should-be-known-in-mac/01.png","hash":"4de0489d01bd9844288035079ec08c3016b4a434","modified":1485358197000},{"_id":"source/images/2013/newer-should-be-known-in-mac/02.png","hash":"3881b15e1ae8c4a6067dadf1847eebea2a8f40d9","modified":1485358197000},{"_id":"source/images/2013/pxe-dhcp-nfs-kickstart/02.png","hash":"3e3ec26449ead6b6aa18d3b2b8b7f707be23c052","modified":1485358197000},{"_id":"source/images/2013/pxe-dhcp-nfs-kickstart/03.png","hash":"798f9697e8e18caf49882587909c964f895491ba","modified":1485358197000},{"_id":"source/images/2015/0409/02.png","hash":"f6a7bb499ebf83aaeab393cb4a7382af9fc0dc0a","modified":1485358197000},{"_id":"source/images/2015/0409/04.png","hash":"b997cf62141e82185f94e14722f224cc963992c4","modified":1485358197000},{"_id":"source/images/2015/0409/44.png","hash":"89b88095c5290553d2fe158293a404a34a645b8b","modified":1485358197000},{"_id":"source/images/2015/0409/45.png","hash":"f30b19190ec49537e647de27a7c7c2dd69b91f6a","modified":1485358197000},{"_id":"source/images/2015/0409/47.png","hash":"e25b8d79d1ed858f246986cf405a9879479f7e19","modified":1485358197000},{"_id":"source/images/2015/0409/48.png","hash":"92df982f21f6746385b1950113f47bd868571fb3","modified":1485358197000},{"_id":"source/images/2015/0409/50.png","hash":"5e1e5abd1efd6cfdf825591bd9f0c07f5123e5dd","modified":1485358197000},{"_id":"source/images/2015/0409/51.png","hash":"8d1b6dd19783987c268a93e8dee21d9d3515f3b1","modified":1485358197000},{"_id":"source/images/2015/0409/53.png","hash":"c9a1087ebcd2174c51bafce3c2499c1812df72a7","modified":1485358197000},{"_id":"source/images/2015/0409/55.png","hash":"1681ae046e1ab1e50fff4398ea52ede5aa07c5ff","modified":1485358197000},{"_id":"themes/next/source/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1485437807000},{"_id":"source/images/2013/03/android.jpeg","hash":"79f43d5cbf29c7ce7a067825d4a8187143557bf0","modified":1485358196000},{"_id":"source/images/2013/03/android1.png","hash":"fd2cdd1878fe8929481dfa750d423a3ecd375198","modified":1485358196000},{"_id":"source/images/2013/04/pptp-mac-01.png","hash":"4f762cf16469e944f3326de20d39b6c5ed45345d","modified":1485358196000},{"_id":"source/images/2013/04/pptp-mac-02.png","hash":"605af34968a3708004696f050e1d810020ec9a0a","modified":1485358196000},{"_id":"themes/next/layout/_scripts/third-party/analytics/application-insights.swig","hash":"60426bf73f8a89ba61fb1be2df3ad5398e32c4ef","modified":1485437807000},{"_id":"themes/next/layout/_scripts/third-party/analytics/baidu-analytics.swig","hash":"deda6a814ed48debc694c4e0c466f06c127163d0","modified":1485437807000},{"_id":"themes/next/layout/_scripts/third-party/analytics/busuanzi-counter.swig","hash":"4fcbf57c4918528ab51d3d042cff92cf5aefb599","modified":1485437807000},{"_id":"themes/next/layout/_scripts/third-party/analytics/cnzz-analytics.swig","hash":"8160b27bee0aa372c7dc7c8476c05bae57f58d0f","modified":1485437807000},{"_id":"themes/next/layout/_scripts/third-party/analytics/google-analytics.swig","hash":"30a23fa7e816496fdec0e932aa42e2d13098a9c2","modified":1485437807000},{"_id":"themes/next/layout/_scripts/third-party/analytics/facebook-sdk.swig","hash":"394d008e5e94575280407ad8a1607a028026cbc3","modified":1485437807000},{"_id":"themes/next/layout/_scripts/third-party/analytics/tencent-analytics.swig","hash":"3658414379e0e8a34c45c40feadc3edc8dc55f88","modified":1485437807000},{"_id":"themes/next/layout/_scripts/third-party/comments/disqus.swig","hash":"fb1d04ede838b52ca7541973f86c3810f1ad396e","modified":1485437807000},{"_id":"themes/next/layout/_scripts/third-party/comments/duoshuo.swig","hash":"a356b2185d40914447fde817eb3d358ab6b3e4c3","modified":1485437807000},{"_id":"themes/next/layout/_scripts/third-party/comments/gentie.swig","hash":"03592d1d731592103a41ebb87437fe4b0a4c78ca","modified":1485437807000},{"_id":"themes/next/layout/_scripts/third-party/comments/hypercomments.swig","hash":"3e8dc5c6c912628a37e3b5f886bec7b2e5ed14ea","modified":1485437807000},{"_id":"themes/next/layout/_scripts/third-party/comments/youyan.swig","hash":"ea8078fa9e10be2bb042749d8b6a97adc38f914c","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"b49efc66bd055a2d0be7deabfcb02ee72a9a28c8","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/buttons.styl","hash":"0dfb4b3ba3180d7285e66f270e1d3fa0f132c3d2","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/comments.styl","hash":"471f1627891aca5c0e1973e09fbcb01e1510d193","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/components.styl","hash":"10994990d6e0b4d965a728a22cf7f6ee29cae9f6","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/pagination.styl","hash":"711c8830886619d4f4a0598b0cde5499dce50c62","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/tag-cloud.styl","hash":"dd8a3b22fc2f222ac6e6c05bd8a773fb039169c0","modified":1485437807000},{"_id":"themes/next/source/css/_common/outline/outline.styl","hash":"2186be20e317505cd31886f1291429cc21f76703","modified":1485437807000},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"5304f99581da3a31de3ecec959b7adf9002fde83","modified":1485437807000},{"_id":"themes/next/source/css/_common/scaffolding/helpers.styl","hash":"54c90cf7bdbf5c596179d8dae6e671bad1292662","modified":1485437807000},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"ece571f38180febaf02ace8187ead8318a300ea7","modified":1485437807000},{"_id":"themes/next/source/css/_common/scaffolding/scaffolding.styl","hash":"013619c472c7e4b08311c464fcbe9fcf5edde603","modified":1485437807000},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"64f5d56c08d74a338813df1265580ca0cbf0190b","modified":1485437807000},{"_id":"themes/next/source/css/_schemes/Mist/_base.styl","hash":"c2d079788d6fc2e9a191ccdae94e50d55bf849dc","modified":1485437807000},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"5ae7906dc7c1d9468c7f4b4a6feddddc555797a1","modified":1485437807000},{"_id":"themes/next/source/css/_schemes/Mist/_logo.styl","hash":"38e5df90c8689a71c978fd83ba74af3d4e4e5386","modified":1485437807000},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"b0dcca862cd0cc6e732e33d975b476d744911742","modified":1485437807000},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expanded.styl","hash":"fda14bc35be2e1b332809b55b3d07155a833dbf4","modified":1485437807000},{"_id":"themes/next/source/css/_schemes/Mist/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1485437807000},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"9a5581a770af8964064fef7afd3e16963e45547f","modified":1485437807000},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"0efa036a15c18f5abb058b7c0fad1dd9ac5eed4c","modified":1485437807000},{"_id":"themes/next/source/css/_schemes/Muse/_logo.styl","hash":"8829bc556ca38bfec4add4f15a2f028092ac6d46","modified":1485437807000},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"82bbaa6322764779a1ac2e2c8390ce901c7972e2","modified":1485437807000},{"_id":"themes/next/source/css/_schemes/Muse/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1485437807000},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"a0e2030a606c934fb2c5c7373aaae04a1caac4c5","modified":1485437807000},{"_id":"themes/next/source/css/_schemes/Pisces/_brand.styl","hash":"ff9f163bb05c0709577040a875924d36c9ab99d6","modified":1485437807000},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"dcf9fe43b2ef78b923118ba39efedb38760e76b1","modified":1485437807000},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"1408209dfb9a22a0982a30bdbd14842c2b53f264","modified":1485437807000},{"_id":"themes/next/source/css/_schemes/Pisces/_posts.styl","hash":"2f878213cb24c5ddc18877f6d15ec5c5f57745ac","modified":1485437807000},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"9b63bd8effc7cf4b96acdea4d73add7df934a222","modified":1485437807000},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"69ecd6c97e7cdfd822ac8102b45ad0ede85050db","modified":1485437807000},{"_id":"themes/next/source/js/src/schemes/pisces.js","hash":"9ccee9189c910b8a264802d7b2ec305d12dedcd0","modified":1485437807000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1485437807000},{"_id":"themes/next/source/lib/fancybox/source/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1485437807000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1485437807000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1485437807000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1485437807000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1485437807000},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","hash":"5f163444617b6cf267342f06ac166a237bb62df9","modified":1485437807000},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","hash":"53360764b429c212f424399384417ccc233bb3be","modified":1485437807000},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","hash":"1cf3d47b5ccb7cb6e9019c64f2a88d03a64853e4","modified":1485437807000},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.js","hash":"06cef196733a710e77ad7e386ced6963f092dc55","modified":1485437807000},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.min.js","hash":"2cae0f5a6c5d6f3cb993015e6863f9483fc4de18","modified":1485437807000},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","hash":"4eda182cbcc046dbf449aef97c02c230cf80a494","modified":1485437807000},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1485437807000},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","hash":"fb5b49426dee7f1508500e698d1b3c6b04c8fcce","modified":1485437807000},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","hash":"38628e75e4412cc6f11074e03e1c6d257aae495b","modified":1485437807000},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","hash":"214dad442a92d36af77ed0ca1d9092b16687f02f","modified":1485437807000},{"_id":"source/images/avatar.png","hash":"680362e1d877bd520c2b53ca4d4b22acebb90a9e","modified":1485481907000},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","hash":"1b22f17fdc38070de50e6d1ab3a32da71aa2d819","modified":1485437807000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"965ce8f688fedbeed504efd498bc9c1622d12362","modified":1485437807000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"6d7e6a5fc802b13694d8820fc0138037c0977d2e","modified":1485437807000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"97e438cc545714309882fbceadbf344fcaddcec5","modified":1485437807000},{"_id":"themes/next/source/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/footer/footer.styl","hash":"8994ffcce84deac0471532f270f97c44fea54dc0","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/header/header.styl","hash":"ae1ca14e51de67b07dba8f61ec79ee0e2e344574","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/header/headerband.styl","hash":"d27448f199fc2f9980b601bc22b87f08b5d64dd1","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/header/menu.styl","hash":"c890ce7fe933abad7baf39764a01894924854e92","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/header/site-meta.styl","hash":"6c00f6e0978f4d8f9a846a15579963728aaa6a17","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/highlight/diff.styl","hash":"96f32ea6c3265a3889e6abe57587f6e2a2a40dfb","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/header/site-nav.styl","hash":"49c2b2c14a1e7fcc810c6be4b632975d0204c281","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/highlight/highlight.styl","hash":"4b7f81e1006e7acee3d1c840ccba155239f830cc","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/highlight/theme.styl","hash":"b76387934fb6bb75212b23c1a194486892cc495e","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/pages/archive.styl","hash":"7778920dd105fa4de3a7ab206eeba30b1a7bac45","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"4eff5b252d7b614e500fc7d52c97ce325e57d3ab","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/pages/pages.styl","hash":"2039590632bba3943c39319d80ef630af7928185","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/pages/post-detail.styl","hash":"9bf4362a4d0ae151ada84b219d39fbe5bb8c790e","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"a82afbb72d83ee394aedc7b37ac0008a9823b4f4","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/post/post-button.styl","hash":"fdfadbb4483043c7e0afd541ee9712389e633517","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"8fae54591877a73dff0b29b2be2e8935e3c63575","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/post/post-eof.styl","hash":"2cdc094ecf907a02fce25ad4a607cd5c40da0f2b","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/post/post-expand.styl","hash":"b25132fe6a7ad67059a2c3afc60feabb479bdd75","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"387ce23bba52b22a586b2dfb4ec618fe1ffd3926","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/post/post-meta.styl","hash":"7f1aab694caf603809e33cff82beea84cd0128fd","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"c6dab7661a6b8c678b21b7eb273cef7100f970f6","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"e792c8dc41561c96d128e9b421187f1c3dc978a0","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/post/post-tags.styl","hash":"a352ae5b1f8857393bf770d2e638bf15f0c9585d","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/post/post-title.styl","hash":"963105a531403d7aad6d9e5e23e3bfabb8ec065a","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/post/post-type.styl","hash":"10251257aceecb117233c9554dcf8ecfef8e2104","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/post/post.styl","hash":"bfd806d0a9f21446a22df82ac02e37d0075cc3b5","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author-links.styl","hash":"2e7ec9aaa3293941106b1bdd09055246aa3c3dc6","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author.styl","hash":"920343e41c124221a17f050bbb989494d44f7a24","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-blogroll.styl","hash":"c44f6a553ec7ea5508f2054a13be33a62a15d3a9","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-feed-link.styl","hash":"9486ddd2cb255227db102d09a7df4cae0fabad72","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-nav.styl","hash":"45fa7193435a8eae9960267438750b4c9fa9587f","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toc.styl","hash":"7690b9596ec3a49befbe529a5a2649abec0faf76","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toggle.styl","hash":"2d3abbc85b979a648e0e579e45f16a6eba49d1e7","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar.styl","hash":"234facd038f144bd0fe09a31ed1357c5d74c517f","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/sidebar/site-state.styl","hash":"3623e7fa4324ec1307370f33d8f287a9e20a5578","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/tags/blockquote-center.styl","hash":"c2abe4d87148e23e15d49ee225bc650de60baf46","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/tags/full-image.styl","hash":"b8969e1654eec89a0fd10d88b337fee9cb03cd44","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/tags/group-pictures.styl","hash":"4851b981020c5cbc354a1af9b831a2dcb3cf9d39","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/tags/note.styl","hash":"74d0ba86f698165d13402670382a822c8736a556","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/tags/tags.styl","hash":"3eb73cee103b810fa56901577ecb9c9bb1793cff","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/third-party/algolia-search.styl","hash":"eba491ae624b4c843c8be4c94a044085dad4ba0f","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/third-party/baidushare.styl","hash":"93b08815c4d17e2b96fef8530ec1f1064dede6ef","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/third-party/busuanzi-counter.styl","hash":"b03f891883446f3a5548b7cc90d29c77e62f1053","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/third-party/duoshuo.styl","hash":"2340dd9b3202c61d73cc708b790fac5adddbfc7f","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/third-party/gentie.styl","hash":"586a3ec0f1015e7207cd6a2474362e068c341744","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/third-party/jiathis.styl","hash":"327b5f63d55ec26f7663185c1a778440588d9803","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/third-party/localsearch.styl","hash":"637c6b32c58ecf40041be6e911471cd82671919b","modified":1485437807000},{"_id":"themes/next/source/css/_common/components/third-party/third-party.styl","hash":"42348219db93a85d2ee23cb06cebd4d8ab121726","modified":1485437807000},{"_id":"themes/next/source/css/_schemes/Mist/sidebar/sidebar-blogroll.styl","hash":"8b8e8cbce98a9296c8fd77f512ae85d945f65d40","modified":1485437807000},{"_id":"themes/next/source/css/_schemes/Mist/outline/outline.styl","hash":"5dc4859c66305f871e56cba78f64bfe3bf1b5f01","modified":1485437807000},{"_id":"themes/next/source/css/_schemes/Muse/sidebar/sidebar-blogroll.styl","hash":"8b8e8cbce98a9296c8fd77f512ae85d945f65d40","modified":1485437807000},{"_id":"themes/next/source/lib/fancybox/source/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1485437807000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1485437807000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","hash":"91e41741c2e93f732c82aaacec4cfc6e3f3ec876","modified":1485437807000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","hash":"3bdf69ed2469e4fb57f5a95f17300eef891ff90d","modified":1485437807000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1485437807000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","hash":"53e194f4a72e649c04fb586dd57762b8c022800b","modified":1485437807000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","hash":"61d8d967807ef12598d81582fa95b9f600c3ee01","modified":1485437807000},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.js","hash":"9ccc6f8144f54e86df9a3fd33a18368d81cf3a4f","modified":1485437807000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","hash":"c0522272bbaef2acb3d341912754d6ea2d0ecfc0","modified":1485437807000}],"Category":[{"name":"oralce","_id":"ciyf7fk9q0004f2jy7imqj30k"},{"name":"dev","_id":"ciyf7fkam000df2jyxgm5hopc"},{"name":"plan","_id":"ciyf7fkas000if2jyb6e9gtx8"},{"name":"mac","_id":"ciyf7fkax000nf2jynrku88pf"},{"name":"spring","_id":"ciyf7fkb5000rf2jyh5budx19"},{"name":"gradle","_id":"ciyf7fkba000wf2jyf1zbnlwg"},{"name":"linux","_id":"ciyf7fkbn0010f2jy2qre1h64"},{"name":"android","_id":"ciyf7fkbz0018f2jy2h4jwerb"},{"name":"vpn","_id":"ciyf7fkcf001df2jy5uhqh9e9"},{"name":"java","_id":"ciyf7fkcp001if2jyusng6m3r"},{"name":"lua","_id":"ciyf7fkct001lf2jybslqez2o"},{"name":"fabric","_id":"ciyf7fkd4001rf2jypfdf9i8h"},{"name":"idea","_id":"ciyf7fkd8001tf2jycl53ov1h"},{"name":"jvm","_id":"ciyf7fkdf001xf2jy0wojtw7n"},{"name":"随笔","_id":"ciyf7fkdn001zf2jyd187c9bn"},{"name":"开发","_id":"ciyf7fkdr0023f2jy9k6zop1z"},{"name":"hexo","_id":"ciyf7fkdv0025f2jyhhb4lg3o"}],"Data":[],"Page":[{"title":"关于我","date":"2017-01-26T15:14:10.000Z","_content":"\n因为热爱，所以走上开发的不归路。\n\n#联系我\n\ngithub: \t<http://github.com/quxionglie>\n\ntwitter: \t<http://twitter.com/quxionglie>","source":"about/index.md","raw":"---\ntitle: 关于我\ndate: 2017-01-26 23:14:10\n---\n\n因为热爱，所以走上开发的不归路。\n\n#联系我\n\ngithub: \t<http://github.com/quxionglie>\n\ntwitter: \t<http://twitter.com/quxionglie>","updated":"2017-01-26T15:15:40.000Z","path":"about/index.html","comments":1,"layout":"page","_id":"ciyf7fk940000f2jy70libdxw","content":"<p>因为热爱，所以走上开发的不归路。</p>\n<p>#联系我</p>\n<p>github:     <a href=\"http://github.com/quxionglie\" target=\"_blank\" rel=\"external\">http://github.com/quxionglie</a></p>\n<p>twitter:     <a href=\"http://twitter.com/quxionglie\" target=\"_blank\" rel=\"external\">http://twitter.com/quxionglie</a></p>\n","excerpt":"","more":"<p>因为热爱，所以走上开发的不归路。</p>\n<p>#联系我</p>\n<p>github:     <a href=\"http://github.com/quxionglie\">http://github.com/quxionglie</a></p>\n<p>twitter:     <a href=\"http://twitter.com/quxionglie\">http://twitter.com/quxionglie</a></p>\n"},{"title":"分类","date":"2017-01-26T14:32:50.000Z","type":"categories","comments":0,"_content":"","source":"categories/index.md","raw":"---\ntitle: 分类\ndate: 2017-01-26 22:32:50\ntype: \"categories\"\ncomments: false\n---\n","updated":"2017-01-26T14:35:33.000Z","path":"categories/index.html","layout":"page","_id":"ciyf7fk9i0002f2jydtb9jhwb","content":"","excerpt":"","more":""},{"title":"标签","date":"2017-01-26T14:23:01.000Z","type":"tags","comments":0,"_content":"","source":"tags/index.md","raw":"---\ntitle: 标签\ndate: 2017-01-26 22:23:01\ntype: \"tags\"\ncomments: false\n---\n","updated":"2017-01-26T14:26:09.000Z","path":"tags/index.html","layout":"page","_id":"ciyf7fk9u0005f2jyru5jzxxg","content":"","excerpt":"","more":""}],"Post":[{"layout":"post","title":"基于左右值的无限级分类算法-oracle实现01","date":"2012-03-23T06:58:00.000Z","comments":1,"_content":"\n本文参考了：\nMike Hillyer的《Managing Hierarchical Data in MySQL》\n及Yimin的翻译版《MYSQL中分层数据的管理》\n\n<!-- more -->\n\n建表sql\n\n``` sql\nCREATE TABLE nested_category (\n     category_id INT PRIMARY KEY,\n     name VARCHAR(20) NOT NULL,\n     lft INT NOT NULL,\n     rgt INT NOT NULL\n);\n\n-- Create sequence\ncreate sequence SEQ_CATEGORY\nminvalue 1\nmaxvalue 999999999999999999999\nstart with 1\nincrement by 1\nnocache;\n\nINSERT INTO nested_category VALUES(1,'ELECTRONICS',1,20);\nINSERT INTO nested_category VALUES(2,'TELEVISIONS',2,9);\nINSERT INTO nested_category VALUES(3,'TUBE',3,4);\nINSERT INTO nested_category VALUES(4,'LCD',5,6);\nINSERT INTO nested_category VALUES(5,'PLASMA',7,8);\nINSERT INTO nested_category VALUES(6,'PORTABLE ELECTRONICS',10,19);\nINSERT INTO nested_category VALUES(7,'MP3 PLAYERS',11,14);\nINSERT INTO nested_category VALUES(8,'FLASH',12,13);\nINSERT INTO nested_category VALUES(9,'CD PLAYERS',15,16);\nINSERT INTO nested_category VALUES(10,'2 WAY RADIOS',17,18);\n```\n\n![Alt text](/images/2012/oracle-01-1.jpg)\n\n\n##1.检索整树\n\n我们可以通过自连接把父节点连接到子节点上来检索整树，是因为子节点的lft值总是在其\n\n父节点的lft值和rgt值之间：\n\n``` sql\nSELECT node.name\nFROM nested_category  node,\nnested_category  parent\nWHERE node.lft BETWEEN parent.lft AND parent.rgt\nAND parent.name = 'ELECTRONICS'\nORDER BY node.lft;\n```\n```\nELECTRONICS\nTELEVISIONS\nTUBE\nLCD\nPLASMA\nPORTABLE ELECTRONICS\nMP3 PLAYERS\nFLASH\nCD PLAYERS\n2 WAY RADIOS\n```\n\n缩进显示层次\n\n``` sql\nSELECT  lpad( '+',  (COUNT(parent.name)-1),'+')||node.name name\nFROM nested_category node, nested_category  parent\nWHERE node.lft BETWEEN parent.lft AND parent.rgt\nGROUP BY node.name,node.lft\nORDER BY node.lft;\n```\n\n```\nNAME\n-------------------------------------\nELECTRONICS\n+TELEVISIONS\n++TUBE\n++LCD\n++PLASMA\n+PORTABLE ELECTRONICS\n++MP3 PLAYERS\n+++FLASH\n++CD PLAYERS\n++2 WAY RADIOS\n```\n\n##2.检索所有叶子节点\n\n检索出所有的叶子节点，使用嵌套集合模型的方法比邻接表模型的LEFT JOIN方法简单多\n\n了。如果你仔细得看了nested_category表，你可能已经注意到叶子节点的左右值是连续的。要检索出叶子节点，我们只要查找满足rgt=lft+1的节点：\n\n```\nSELECT name\nFROM nested_category\nWHERE rgt = lft + 1;\n```\n```\nNAME\n--------------------\nTUBE\nLCD\nPLASMA\nFLASH\nCD PLAYERS\n2 WAY RADIOS\n```\n\n","source":"_posts/2012-03-23-managing-hierarchical-data-in-oracle-1.md","raw":"---\nlayout: post\ntitle: \"基于左右值的无限级分类算法-oracle实现01\"\ndate: 2012-03-23 14:58\ncomments: true\ncategories: oralce\n---\n\n本文参考了：\nMike Hillyer的《Managing Hierarchical Data in MySQL》\n及Yimin的翻译版《MYSQL中分层数据的管理》\n\n<!-- more -->\n\n建表sql\n\n``` sql\nCREATE TABLE nested_category (\n     category_id INT PRIMARY KEY,\n     name VARCHAR(20) NOT NULL,\n     lft INT NOT NULL,\n     rgt INT NOT NULL\n);\n\n-- Create sequence\ncreate sequence SEQ_CATEGORY\nminvalue 1\nmaxvalue 999999999999999999999\nstart with 1\nincrement by 1\nnocache;\n\nINSERT INTO nested_category VALUES(1,'ELECTRONICS',1,20);\nINSERT INTO nested_category VALUES(2,'TELEVISIONS',2,9);\nINSERT INTO nested_category VALUES(3,'TUBE',3,4);\nINSERT INTO nested_category VALUES(4,'LCD',5,6);\nINSERT INTO nested_category VALUES(5,'PLASMA',7,8);\nINSERT INTO nested_category VALUES(6,'PORTABLE ELECTRONICS',10,19);\nINSERT INTO nested_category VALUES(7,'MP3 PLAYERS',11,14);\nINSERT INTO nested_category VALUES(8,'FLASH',12,13);\nINSERT INTO nested_category VALUES(9,'CD PLAYERS',15,16);\nINSERT INTO nested_category VALUES(10,'2 WAY RADIOS',17,18);\n```\n\n![Alt text](/images/2012/oracle-01-1.jpg)\n\n\n##1.检索整树\n\n我们可以通过自连接把父节点连接到子节点上来检索整树，是因为子节点的lft值总是在其\n\n父节点的lft值和rgt值之间：\n\n``` sql\nSELECT node.name\nFROM nested_category  node,\nnested_category  parent\nWHERE node.lft BETWEEN parent.lft AND parent.rgt\nAND parent.name = 'ELECTRONICS'\nORDER BY node.lft;\n```\n```\nELECTRONICS\nTELEVISIONS\nTUBE\nLCD\nPLASMA\nPORTABLE ELECTRONICS\nMP3 PLAYERS\nFLASH\nCD PLAYERS\n2 WAY RADIOS\n```\n\n缩进显示层次\n\n``` sql\nSELECT  lpad( '+',  (COUNT(parent.name)-1),'+')||node.name name\nFROM nested_category node, nested_category  parent\nWHERE node.lft BETWEEN parent.lft AND parent.rgt\nGROUP BY node.name,node.lft\nORDER BY node.lft;\n```\n\n```\nNAME\n-------------------------------------\nELECTRONICS\n+TELEVISIONS\n++TUBE\n++LCD\n++PLASMA\n+PORTABLE ELECTRONICS\n++MP3 PLAYERS\n+++FLASH\n++CD PLAYERS\n++2 WAY RADIOS\n```\n\n##2.检索所有叶子节点\n\n检索出所有的叶子节点，使用嵌套集合模型的方法比邻接表模型的LEFT JOIN方法简单多\n\n了。如果你仔细得看了nested_category表，你可能已经注意到叶子节点的左右值是连续的。要检索出叶子节点，我们只要查找满足rgt=lft+1的节点：\n\n```\nSELECT name\nFROM nested_category\nWHERE rgt = lft + 1;\n```\n```\nNAME\n--------------------\nTUBE\nLCD\nPLASMA\nFLASH\nCD PLAYERS\n2 WAY RADIOS\n```\n\n","slug":"managing-hierarchical-data-in-oracle-1","published":1,"updated":"2017-01-27T01:34:43.000Z","photos":[],"link":"","_id":"ciyf7fk960001f2jy4b9sdzya","content":"<p>本文参考了：<br>Mike Hillyer的《Managing Hierarchical Data in MySQL》<br>及Yimin的翻译版《MYSQL中分层数据的管理》</p>\n<a id=\"more\"></a>\n<p>建表sql</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> nested_category (</div><div class=\"line\">     category_id <span class=\"built_in\">INT</span> PRIMARY <span class=\"keyword\">KEY</span>,</div><div class=\"line\">     <span class=\"keyword\">name</span> <span class=\"built_in\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span>,</div><div class=\"line\">     lft <span class=\"built_in\">INT</span> <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span>,</div><div class=\"line\">     rgt <span class=\"built_in\">INT</span> <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span></div><div class=\"line\">);</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">-- Create sequence</span></div><div class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">sequence</span> SEQ_CATEGORY</div><div class=\"line\"><span class=\"keyword\">minvalue</span> <span class=\"number\">1</span></div><div class=\"line\">maxvalue <span class=\"number\">999999999999999999999</span></div><div class=\"line\"><span class=\"keyword\">start</span> <span class=\"keyword\">with</span> <span class=\"number\">1</span></div><div class=\"line\"><span class=\"keyword\">increment</span> <span class=\"keyword\">by</span> <span class=\"number\">1</span></div><div class=\"line\">nocache;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category <span class=\"keyword\">VALUES</span>(<span class=\"number\">1</span>,<span class=\"string\">'ELECTRONICS'</span>,<span class=\"number\">1</span>,<span class=\"number\">20</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category <span class=\"keyword\">VALUES</span>(<span class=\"number\">2</span>,<span class=\"string\">'TELEVISIONS'</span>,<span class=\"number\">2</span>,<span class=\"number\">9</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category <span class=\"keyword\">VALUES</span>(<span class=\"number\">3</span>,<span class=\"string\">'TUBE'</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category <span class=\"keyword\">VALUES</span>(<span class=\"number\">4</span>,<span class=\"string\">'LCD'</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category <span class=\"keyword\">VALUES</span>(<span class=\"number\">5</span>,<span class=\"string\">'PLASMA'</span>,<span class=\"number\">7</span>,<span class=\"number\">8</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category <span class=\"keyword\">VALUES</span>(<span class=\"number\">6</span>,<span class=\"string\">'PORTABLE ELECTRONICS'</span>,<span class=\"number\">10</span>,<span class=\"number\">19</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category <span class=\"keyword\">VALUES</span>(<span class=\"number\">7</span>,<span class=\"string\">'MP3 PLAYERS'</span>,<span class=\"number\">11</span>,<span class=\"number\">14</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category <span class=\"keyword\">VALUES</span>(<span class=\"number\">8</span>,<span class=\"string\">'FLASH'</span>,<span class=\"number\">12</span>,<span class=\"number\">13</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category <span class=\"keyword\">VALUES</span>(<span class=\"number\">9</span>,<span class=\"string\">'CD PLAYERS'</span>,<span class=\"number\">15</span>,<span class=\"number\">16</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category <span class=\"keyword\">VALUES</span>(<span class=\"number\">10</span>,<span class=\"string\">'2 WAY RADIOS'</span>,<span class=\"number\">17</span>,<span class=\"number\">18</span>);</div></pre></td></tr></table></figure>\n<p><img src=\"/images/2012/oracle-01-1.jpg\" alt=\"Alt text\"></p>\n<p>##1.检索整树</p>\n<p>我们可以通过自连接把父节点连接到子节点上来检索整树，是因为子节点的lft值总是在其</p>\n<p>父节点的lft值和rgt值之间：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">SELECT</span> node.name</div><div class=\"line\"><span class=\"keyword\">FROM</span> nested_category  node,</div><div class=\"line\">nested_category  <span class=\"keyword\">parent</span></div><div class=\"line\"><span class=\"keyword\">WHERE</span> node.lft <span class=\"keyword\">BETWEEN</span> parent.lft <span class=\"keyword\">AND</span> parent.rgt</div><div class=\"line\"><span class=\"keyword\">AND</span> parent.name = <span class=\"string\">'ELECTRONICS'</span></div><div class=\"line\"><span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> node.lft;</div></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">ELECTRONICS</div><div class=\"line\">TELEVISIONS</div><div class=\"line\">TUBE</div><div class=\"line\">LCD</div><div class=\"line\">PLASMA</div><div class=\"line\">PORTABLE ELECTRONICS</div><div class=\"line\">MP3 PLAYERS</div><div class=\"line\">FLASH</div><div class=\"line\">CD PLAYERS</div><div class=\"line\">2 WAY RADIOS</div></pre></td></tr></table></figure>\n<p>缩进显示层次</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">SELECT</span>  <span class=\"keyword\">lpad</span>( <span class=\"string\">'+'</span>,  (<span class=\"keyword\">COUNT</span>(parent.name)<span class=\"number\">-1</span>),<span class=\"string\">'+'</span>)||node.name <span class=\"keyword\">name</span></div><div class=\"line\"><span class=\"keyword\">FROM</span> nested_category node, nested_category  <span class=\"keyword\">parent</span></div><div class=\"line\"><span class=\"keyword\">WHERE</span> node.lft <span class=\"keyword\">BETWEEN</span> parent.lft <span class=\"keyword\">AND</span> parent.rgt</div><div class=\"line\"><span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> node.name,node.lft</div><div class=\"line\"><span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> node.lft;</div></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">NAME</div><div class=\"line\">-------------------------------------</div><div class=\"line\">ELECTRONICS</div><div class=\"line\">+TELEVISIONS</div><div class=\"line\">++TUBE</div><div class=\"line\">++LCD</div><div class=\"line\">++PLASMA</div><div class=\"line\">+PORTABLE ELECTRONICS</div><div class=\"line\">++MP3 PLAYERS</div><div class=\"line\">+++FLASH</div><div class=\"line\">++CD PLAYERS</div><div class=\"line\">++2 WAY RADIOS</div></pre></td></tr></table></figure>\n<p>##2.检索所有叶子节点</p>\n<p>检索出所有的叶子节点，使用嵌套集合模型的方法比邻接表模型的LEFT JOIN方法简单多</p>\n<p>了。如果你仔细得看了nested_category表，你可能已经注意到叶子节点的左右值是连续的。要检索出叶子节点，我们只要查找满足rgt=lft+1的节点：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">SELECT name</div><div class=\"line\">FROM nested_category</div><div class=\"line\">WHERE rgt = lft + 1;</div></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">NAME</div><div class=\"line\">--------------------</div><div class=\"line\">TUBE</div><div class=\"line\">LCD</div><div class=\"line\">PLASMA</div><div class=\"line\">FLASH</div><div class=\"line\">CD PLAYERS</div><div class=\"line\">2 WAY RADIOS</div></pre></td></tr></table></figure>\n","excerpt":"<p>本文参考了：<br>Mike Hillyer的《Managing Hierarchical Data in MySQL》<br>及Yimin的翻译版《MYSQL中分层数据的管理》</p>","more":"<p>建表sql</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> nested_category (</div><div class=\"line\">     category_id <span class=\"built_in\">INT</span> PRIMARY <span class=\"keyword\">KEY</span>,</div><div class=\"line\">     <span class=\"keyword\">name</span> <span class=\"built_in\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span>,</div><div class=\"line\">     lft <span class=\"built_in\">INT</span> <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span>,</div><div class=\"line\">     rgt <span class=\"built_in\">INT</span> <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span></div><div class=\"line\">);</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">-- Create sequence</span></div><div class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">sequence</span> SEQ_CATEGORY</div><div class=\"line\"><span class=\"keyword\">minvalue</span> <span class=\"number\">1</span></div><div class=\"line\">maxvalue <span class=\"number\">999999999999999999999</span></div><div class=\"line\"><span class=\"keyword\">start</span> <span class=\"keyword\">with</span> <span class=\"number\">1</span></div><div class=\"line\"><span class=\"keyword\">increment</span> <span class=\"keyword\">by</span> <span class=\"number\">1</span></div><div class=\"line\">nocache;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category <span class=\"keyword\">VALUES</span>(<span class=\"number\">1</span>,<span class=\"string\">'ELECTRONICS'</span>,<span class=\"number\">1</span>,<span class=\"number\">20</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category <span class=\"keyword\">VALUES</span>(<span class=\"number\">2</span>,<span class=\"string\">'TELEVISIONS'</span>,<span class=\"number\">2</span>,<span class=\"number\">9</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category <span class=\"keyword\">VALUES</span>(<span class=\"number\">3</span>,<span class=\"string\">'TUBE'</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category <span class=\"keyword\">VALUES</span>(<span class=\"number\">4</span>,<span class=\"string\">'LCD'</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category <span class=\"keyword\">VALUES</span>(<span class=\"number\">5</span>,<span class=\"string\">'PLASMA'</span>,<span class=\"number\">7</span>,<span class=\"number\">8</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category <span class=\"keyword\">VALUES</span>(<span class=\"number\">6</span>,<span class=\"string\">'PORTABLE ELECTRONICS'</span>,<span class=\"number\">10</span>,<span class=\"number\">19</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category <span class=\"keyword\">VALUES</span>(<span class=\"number\">7</span>,<span class=\"string\">'MP3 PLAYERS'</span>,<span class=\"number\">11</span>,<span class=\"number\">14</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category <span class=\"keyword\">VALUES</span>(<span class=\"number\">8</span>,<span class=\"string\">'FLASH'</span>,<span class=\"number\">12</span>,<span class=\"number\">13</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category <span class=\"keyword\">VALUES</span>(<span class=\"number\">9</span>,<span class=\"string\">'CD PLAYERS'</span>,<span class=\"number\">15</span>,<span class=\"number\">16</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category <span class=\"keyword\">VALUES</span>(<span class=\"number\">10</span>,<span class=\"string\">'2 WAY RADIOS'</span>,<span class=\"number\">17</span>,<span class=\"number\">18</span>);</div></pre></td></tr></table></figure>\n<p><img src=\"/images/2012/oracle-01-1.jpg\" alt=\"Alt text\"></p>\n<p>##1.检索整树</p>\n<p>我们可以通过自连接把父节点连接到子节点上来检索整树，是因为子节点的lft值总是在其</p>\n<p>父节点的lft值和rgt值之间：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">SELECT</span> node.name</div><div class=\"line\"><span class=\"keyword\">FROM</span> nested_category  node,</div><div class=\"line\">nested_category  <span class=\"keyword\">parent</span></div><div class=\"line\"><span class=\"keyword\">WHERE</span> node.lft <span class=\"keyword\">BETWEEN</span> parent.lft <span class=\"keyword\">AND</span> parent.rgt</div><div class=\"line\"><span class=\"keyword\">AND</span> parent.name = <span class=\"string\">'ELECTRONICS'</span></div><div class=\"line\"><span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> node.lft;</div></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">ELECTRONICS</div><div class=\"line\">TELEVISIONS</div><div class=\"line\">TUBE</div><div class=\"line\">LCD</div><div class=\"line\">PLASMA</div><div class=\"line\">PORTABLE ELECTRONICS</div><div class=\"line\">MP3 PLAYERS</div><div class=\"line\">FLASH</div><div class=\"line\">CD PLAYERS</div><div class=\"line\">2 WAY RADIOS</div></pre></td></tr></table></figure>\n<p>缩进显示层次</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">SELECT</span>  <span class=\"keyword\">lpad</span>( <span class=\"string\">'+'</span>,  (<span class=\"keyword\">COUNT</span>(parent.name)<span class=\"number\">-1</span>),<span class=\"string\">'+'</span>)||node.name <span class=\"keyword\">name</span></div><div class=\"line\"><span class=\"keyword\">FROM</span> nested_category node, nested_category  <span class=\"keyword\">parent</span></div><div class=\"line\"><span class=\"keyword\">WHERE</span> node.lft <span class=\"keyword\">BETWEEN</span> parent.lft <span class=\"keyword\">AND</span> parent.rgt</div><div class=\"line\"><span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> node.name,node.lft</div><div class=\"line\"><span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> node.lft;</div></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">NAME</div><div class=\"line\">-------------------------------------</div><div class=\"line\">ELECTRONICS</div><div class=\"line\">+TELEVISIONS</div><div class=\"line\">++TUBE</div><div class=\"line\">++LCD</div><div class=\"line\">++PLASMA</div><div class=\"line\">+PORTABLE ELECTRONICS</div><div class=\"line\">++MP3 PLAYERS</div><div class=\"line\">+++FLASH</div><div class=\"line\">++CD PLAYERS</div><div class=\"line\">++2 WAY RADIOS</div></pre></td></tr></table></figure>\n<p>##2.检索所有叶子节点</p>\n<p>检索出所有的叶子节点，使用嵌套集合模型的方法比邻接表模型的LEFT JOIN方法简单多</p>\n<p>了。如果你仔细得看了nested_category表，你可能已经注意到叶子节点的左右值是连续的。要检索出叶子节点，我们只要查找满足rgt=lft+1的节点：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">SELECT name</div><div class=\"line\">FROM nested_category</div><div class=\"line\">WHERE rgt = lft + 1;</div></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">NAME</div><div class=\"line\">--------------------</div><div class=\"line\">TUBE</div><div class=\"line\">LCD</div><div class=\"line\">PLASMA</div><div class=\"line\">FLASH</div><div class=\"line\">CD PLAYERS</div><div class=\"line\">2 WAY RADIOS</div></pre></td></tr></table></figure>"},{"layout":"post","title":"基于左右值的无限级分类算法-oracle实现02","date":"2012-03-24T02:04:00.000Z","comments":1,"_content":"\n<!-- more -->\n\n本文参考了：\nMike Hillyer的《Managing Hierarchical Data in MySQL》\n及Yimin的翻译版《MYSQL中分层数据的管理》\n\n\n#3.检索单一路径\n\n在嵌套集合模型中，我们可以不用多个自连接就可以检索出单一路径：\n\n``` sql\nSELECT parent.name\nFROM nested_category    node,\nnested_category   parent\nWHERE node.lft BETWEEN parent.lft AND parent.rgt\nAND node.name = 'FLASH'\nORDER BY parent.lft;\n```\n\n输出结果\n\n```\nNAME\n--------------------\nELECTRONICS\nPORTABLE ELECTRONICS\nMP3 PLAYERS\nFLASH\n```\n\n#4.检索节点的深度\n\n我们已经知道怎样去呈现一棵整树，但是为了更好的标识出节点在树中所处层次，我们怎样才能检索出节点在树中的深度呢？我们可以在先前的查询语句上增加COUNT函数和GROUP BY子句来实现：\n\n```sql\nSELECT node.name, (COUNT(parent.name) - 1) AS depth\nFROM nested_category node,\nnested_category   parent\nWHERE node.lft BETWEEN parent.lft AND parent.rgt\nGROUP BY node.name  \n```\n\n#5.检索子树的深度\n当我们需要子树的深度信息时，我们不能限制自连接中的node或parent，因为这么做会打乱数据集的顺序。因此，我们添加了第三个自连接作为子查询，来得出子树新起点的深度\n值：\n\n```sql\nSELECT node.name, (COUNT(parent.name) -(sub_tree.depth + 1))   depth\n  FROM nested_category   node,\n  nested_category   parent,\n  nested_category   sub_parent,\n(\n  SELECT node.name, (COUNT(parent.name) - 1)\n  AS depth\n  FROM nested_category   node,\n  nested_category   parent\n  WHERE node.lft BETWEEN parent.lft AND parent.rgt\n  AND node.name = 'PORTABLE ELECTRONICS'\n  GROUP BY node.name \n)  sub_tree\nWHERE node.lft BETWEEN parent.lft AND parent.rgt\nAND node.lft BETWEEN sub_parent.lft AND sub_parent.rgt\nAND sub_parent.name = sub_tree.name\nGROUP BY node.name,node.lft,sub_tree.depth\nORDER BY node.lft;\n```\n\n\n这个查询语句可以检索出任一节点子树的深度值，包括根节点。这里的深度值跟你指定的节点有关。\n","source":"_posts/2012-03-24-managing-hierarchical-data-in-oracle-2.md","raw":"---\nlayout: post\ntitle: \"基于左右值的无限级分类算法-oracle实现02\"\ndate: 2012-03-24 10:04\ncomments: true\ncategories: oralce\n---\n\n<!-- more -->\n\n本文参考了：\nMike Hillyer的《Managing Hierarchical Data in MySQL》\n及Yimin的翻译版《MYSQL中分层数据的管理》\n\n\n#3.检索单一路径\n\n在嵌套集合模型中，我们可以不用多个自连接就可以检索出单一路径：\n\n``` sql\nSELECT parent.name\nFROM nested_category    node,\nnested_category   parent\nWHERE node.lft BETWEEN parent.lft AND parent.rgt\nAND node.name = 'FLASH'\nORDER BY parent.lft;\n```\n\n输出结果\n\n```\nNAME\n--------------------\nELECTRONICS\nPORTABLE ELECTRONICS\nMP3 PLAYERS\nFLASH\n```\n\n#4.检索节点的深度\n\n我们已经知道怎样去呈现一棵整树，但是为了更好的标识出节点在树中所处层次，我们怎样才能检索出节点在树中的深度呢？我们可以在先前的查询语句上增加COUNT函数和GROUP BY子句来实现：\n\n```sql\nSELECT node.name, (COUNT(parent.name) - 1) AS depth\nFROM nested_category node,\nnested_category   parent\nWHERE node.lft BETWEEN parent.lft AND parent.rgt\nGROUP BY node.name  \n```\n\n#5.检索子树的深度\n当我们需要子树的深度信息时，我们不能限制自连接中的node或parent，因为这么做会打乱数据集的顺序。因此，我们添加了第三个自连接作为子查询，来得出子树新起点的深度\n值：\n\n```sql\nSELECT node.name, (COUNT(parent.name) -(sub_tree.depth + 1))   depth\n  FROM nested_category   node,\n  nested_category   parent,\n  nested_category   sub_parent,\n(\n  SELECT node.name, (COUNT(parent.name) - 1)\n  AS depth\n  FROM nested_category   node,\n  nested_category   parent\n  WHERE node.lft BETWEEN parent.lft AND parent.rgt\n  AND node.name = 'PORTABLE ELECTRONICS'\n  GROUP BY node.name \n)  sub_tree\nWHERE node.lft BETWEEN parent.lft AND parent.rgt\nAND node.lft BETWEEN sub_parent.lft AND sub_parent.rgt\nAND sub_parent.name = sub_tree.name\nGROUP BY node.name,node.lft,sub_tree.depth\nORDER BY node.lft;\n```\n\n\n这个查询语句可以检索出任一节点子树的深度值，包括根节点。这里的深度值跟你指定的节点有关。\n","slug":"managing-hierarchical-data-in-oracle-2","published":1,"updated":"2017-01-25T15:29:56.000Z","photos":[],"link":"","_id":"ciyf7fk9k0003f2jyihhkr22t","content":"<a id=\"more\"></a>\n<p>本文参考了：<br>Mike Hillyer的《Managing Hierarchical Data in MySQL》<br>及Yimin的翻译版《MYSQL中分层数据的管理》</p>\n<p>#3.检索单一路径</p>\n<p>在嵌套集合模型中，我们可以不用多个自连接就可以检索出单一路径：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">SELECT</span> parent.name</div><div class=\"line\"><span class=\"keyword\">FROM</span> nested_category    node,</div><div class=\"line\">nested_category   <span class=\"keyword\">parent</span></div><div class=\"line\"><span class=\"keyword\">WHERE</span> node.lft <span class=\"keyword\">BETWEEN</span> parent.lft <span class=\"keyword\">AND</span> parent.rgt</div><div class=\"line\"><span class=\"keyword\">AND</span> node.name = <span class=\"string\">'FLASH'</span></div><div class=\"line\"><span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> parent.lft;</div></pre></td></tr></table></figure>\n<p>输出结果</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">NAME</div><div class=\"line\">--------------------</div><div class=\"line\">ELECTRONICS</div><div class=\"line\">PORTABLE ELECTRONICS</div><div class=\"line\">MP3 PLAYERS</div><div class=\"line\">FLASH</div></pre></td></tr></table></figure>\n<p>#4.检索节点的深度</p>\n<p>我们已经知道怎样去呈现一棵整树，但是为了更好的标识出节点在树中所处层次，我们怎样才能检索出节点在树中的深度呢？我们可以在先前的查询语句上增加COUNT函数和GROUP BY子句来实现：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">SELECT</span> node.name, (<span class=\"keyword\">COUNT</span>(parent.name) - <span class=\"number\">1</span>) <span class=\"keyword\">AS</span> <span class=\"keyword\">depth</span></div><div class=\"line\"><span class=\"keyword\">FROM</span> nested_category node,</div><div class=\"line\">nested_category   <span class=\"keyword\">parent</span></div><div class=\"line\"><span class=\"keyword\">WHERE</span> node.lft <span class=\"keyword\">BETWEEN</span> parent.lft <span class=\"keyword\">AND</span> parent.rgt</div><div class=\"line\"><span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> node.name</div></pre></td></tr></table></figure>\n<p>#5.检索子树的深度<br>当我们需要子树的深度信息时，我们不能限制自连接中的node或parent，因为这么做会打乱数据集的顺序。因此，我们添加了第三个自连接作为子查询，来得出子树新起点的深度<br>值：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">SELECT</span> node.name, (<span class=\"keyword\">COUNT</span>(parent.name) -(sub_tree.depth + <span class=\"number\">1</span>))   <span class=\"keyword\">depth</span></div><div class=\"line\">  <span class=\"keyword\">FROM</span> nested_category   node,</div><div class=\"line\">  nested_category   <span class=\"keyword\">parent</span>,</div><div class=\"line\">  nested_category   sub_parent,</div><div class=\"line\">(</div><div class=\"line\">  <span class=\"keyword\">SELECT</span> node.name, (<span class=\"keyword\">COUNT</span>(parent.name) - <span class=\"number\">1</span>)</div><div class=\"line\">  <span class=\"keyword\">AS</span> <span class=\"keyword\">depth</span></div><div class=\"line\">  <span class=\"keyword\">FROM</span> nested_category   node,</div><div class=\"line\">  nested_category   <span class=\"keyword\">parent</span></div><div class=\"line\">  <span class=\"keyword\">WHERE</span> node.lft <span class=\"keyword\">BETWEEN</span> parent.lft <span class=\"keyword\">AND</span> parent.rgt</div><div class=\"line\">  <span class=\"keyword\">AND</span> node.name = <span class=\"string\">'PORTABLE ELECTRONICS'</span></div><div class=\"line\">  <span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> node.name </div><div class=\"line\">)  sub_tree</div><div class=\"line\"><span class=\"keyword\">WHERE</span> node.lft <span class=\"keyword\">BETWEEN</span> parent.lft <span class=\"keyword\">AND</span> parent.rgt</div><div class=\"line\"><span class=\"keyword\">AND</span> node.lft <span class=\"keyword\">BETWEEN</span> sub_parent.lft <span class=\"keyword\">AND</span> sub_parent.rgt</div><div class=\"line\"><span class=\"keyword\">AND</span> sub_parent.name = sub_tree.name</div><div class=\"line\"><span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> node.name,node.lft,sub_tree.depth</div><div class=\"line\"><span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> node.lft;</div></pre></td></tr></table></figure>\n<p>这个查询语句可以检索出任一节点子树的深度值，包括根节点。这里的深度值跟你指定的节点有关。</p>\n","excerpt":"","more":"<p>本文参考了：<br>Mike Hillyer的《Managing Hierarchical Data in MySQL》<br>及Yimin的翻译版《MYSQL中分层数据的管理》</p>\n<p>#3.检索单一路径</p>\n<p>在嵌套集合模型中，我们可以不用多个自连接就可以检索出单一路径：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">SELECT</span> parent.name</div><div class=\"line\"><span class=\"keyword\">FROM</span> nested_category    node,</div><div class=\"line\">nested_category   <span class=\"keyword\">parent</span></div><div class=\"line\"><span class=\"keyword\">WHERE</span> node.lft <span class=\"keyword\">BETWEEN</span> parent.lft <span class=\"keyword\">AND</span> parent.rgt</div><div class=\"line\"><span class=\"keyword\">AND</span> node.name = <span class=\"string\">'FLASH'</span></div><div class=\"line\"><span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> parent.lft;</div></pre></td></tr></table></figure>\n<p>输出结果</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">NAME</div><div class=\"line\">--------------------</div><div class=\"line\">ELECTRONICS</div><div class=\"line\">PORTABLE ELECTRONICS</div><div class=\"line\">MP3 PLAYERS</div><div class=\"line\">FLASH</div></pre></td></tr></table></figure>\n<p>#4.检索节点的深度</p>\n<p>我们已经知道怎样去呈现一棵整树，但是为了更好的标识出节点在树中所处层次，我们怎样才能检索出节点在树中的深度呢？我们可以在先前的查询语句上增加COUNT函数和GROUP BY子句来实现：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">SELECT</span> node.name, (<span class=\"keyword\">COUNT</span>(parent.name) - <span class=\"number\">1</span>) <span class=\"keyword\">AS</span> <span class=\"keyword\">depth</span></div><div class=\"line\"><span class=\"keyword\">FROM</span> nested_category node,</div><div class=\"line\">nested_category   <span class=\"keyword\">parent</span></div><div class=\"line\"><span class=\"keyword\">WHERE</span> node.lft <span class=\"keyword\">BETWEEN</span> parent.lft <span class=\"keyword\">AND</span> parent.rgt</div><div class=\"line\"><span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> node.name</div></pre></td></tr></table></figure>\n<p>#5.检索子树的深度<br>当我们需要子树的深度信息时，我们不能限制自连接中的node或parent，因为这么做会打乱数据集的顺序。因此，我们添加了第三个自连接作为子查询，来得出子树新起点的深度<br>值：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">SELECT</span> node.name, (<span class=\"keyword\">COUNT</span>(parent.name) -(sub_tree.depth + <span class=\"number\">1</span>))   <span class=\"keyword\">depth</span></div><div class=\"line\">  <span class=\"keyword\">FROM</span> nested_category   node,</div><div class=\"line\">  nested_category   <span class=\"keyword\">parent</span>,</div><div class=\"line\">  nested_category   sub_parent,</div><div class=\"line\">(</div><div class=\"line\">  <span class=\"keyword\">SELECT</span> node.name, (<span class=\"keyword\">COUNT</span>(parent.name) - <span class=\"number\">1</span>)</div><div class=\"line\">  <span class=\"keyword\">AS</span> <span class=\"keyword\">depth</span></div><div class=\"line\">  <span class=\"keyword\">FROM</span> nested_category   node,</div><div class=\"line\">  nested_category   <span class=\"keyword\">parent</span></div><div class=\"line\">  <span class=\"keyword\">WHERE</span> node.lft <span class=\"keyword\">BETWEEN</span> parent.lft <span class=\"keyword\">AND</span> parent.rgt</div><div class=\"line\">  <span class=\"keyword\">AND</span> node.name = <span class=\"string\">'PORTABLE ELECTRONICS'</span></div><div class=\"line\">  <span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> node.name </div><div class=\"line\">)  sub_tree</div><div class=\"line\"><span class=\"keyword\">WHERE</span> node.lft <span class=\"keyword\">BETWEEN</span> parent.lft <span class=\"keyword\">AND</span> parent.rgt</div><div class=\"line\"><span class=\"keyword\">AND</span> node.lft <span class=\"keyword\">BETWEEN</span> sub_parent.lft <span class=\"keyword\">AND</span> sub_parent.rgt</div><div class=\"line\"><span class=\"keyword\">AND</span> sub_parent.name = sub_tree.name</div><div class=\"line\"><span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> node.name,node.lft,sub_tree.depth</div><div class=\"line\"><span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> node.lft;</div></pre></td></tr></table></figure>\n<p>这个查询语句可以检索出任一节点子树的深度值，包括根节点。这里的深度值跟你指定的节点有关。</p>"},{"layout":"post","title":"[转]五年后你在何方","date":"2012-03-23T01:37:00.000Z","comments":1,"_content":"\n转一篇文章，估计知道的人多，但真正实践的人可能很少。\n\n<!-- more -->\n\n故事原文来自《青年文摘》。\n\n　　一九七六年的冬天，当时我十九岁，在休斯顿太空总署的大空梭实验室里工作，同时也在总署旁边的休斯顿大学主修电脑。纵然忙于学校、睡眠与工作之间，这几乎占据了我一天二十四小时的全部时间，但只要有多余的一分钟，我总是会把所有的精力放在我的音乐创作上。\n　　  \n　　我知道写歌词不是我的专长，所以在这段日子里，我处处寻找一位善写歌、词的搭档，与我一起合作创作。我认识了一位朋友，她的名字叫凡內芮（Valerie Johnson）。自从二十多年前离开德州后，就再也没听过她的消息，但是她却在我事业的起步时，给了我最大的鼓励。仅十九岁的凡內芮在德州的诗词比赛中，不知得过多少奖牌。她的写作总是让我爱不释手，当时我们的确合写了许多很好的作品，一直到今天，我仍然认为这些作品充满了特色与创意。\n\n　　一个星期六的周末，凡內芮又热情地邀请我至她家的牧场烤肉。她的家族是德州有名的石油大亨，拥有庞大的牧场。她的家庭虽然极为富有，但她的穿着、所开的车、与她谦诚待人的态度，更让我加倍地打从心底佩服她。凡內芮知道我对音乐的执着。然而，面对那遥远的音乐界及整个美国陌生的唱片市场，我们一点管道都没有。\n\n　　此时，我们两个人坐在德州的乡下，我们哪知道下一步该如何走。\n\n　　突然间，她冒出了一句话：“Visualize, What you are doing in 5 years?﹙想象你五年后在做什么？﹚”。\n\n　　我愣了一下。\n\n　　她转过身来，手指着我说：“嘿！告诉我，你心目中‘最希望’五年后的你在做什么，你那个时候的生活是一个什么样子？”我还来不及回答，她又抢着说： “別急，你先仔细想想，完全想好，确定后再说出来。”我沉思了几分钟，开始告诉她：“第一，五年后，我希望能有一张唱片在市场上，而这张唱片很受欢迎，可以得到许多人的肯定。第二，我住在一个有很多很多音乐的地方，能天天与一些世界一流的乐师一起工作。”\n\n　　凡內芮说：“你确定了吗？”\n\n　　我慢慢稳稳地回答，而且拉了一个很长的Yesssssss！\n\n　　凡內芮接着说：“好，既然你确定了，我们就把这个目标倒算回来。如果第五年，你有一张唱片在市场上，那么你的第四年一定是要跟一家唱片公司签上合约。”\n\n　　“那么你的第三年一定是要有一个完整的作品，可以拿给很多很多的唱片公 司听，对不对？”\n\n　　“那么你的第二年，一定要有很棒的作品开始录音了。”\n\n　　“那么你的第一年，就一定要把你所有要准备录音的作品全部编曲，排练就位准备好。”\n\n　　“那么你的第六个月，就是要把那些没有完成的作品修饰好，然后让你自己可以逐一筛选。”\n\n　　“那么你的第一个月就是要把目前这几首曲子完工。”\n\n　　“那么你的第一个礼拜就是要先列出一整个清单，排出哪些曲子需要修改， 哪些需要完工。”\n\n　　“好了，我们现在不就已经知道你下个星期一要做什么了吗？”凡內芮笑笑地说。\n\n　　“喔，对了。你还说你五年后，要生活在一个有很多音乐的地方，然后与许多一流的乐师一起忙着工作，对吗？”她急忙地补充说。“如果，你的第五年已经在与这些人一起工作，那么你的第四年照道理应该有你自己的一个工作室或录音室。那么你的第三年，可能是先跟这个圈子里的人在一起工作。那么你的第二年，应该不是住在德州，而是已经住在纽约或是洛杉机了。”\n\n　　次年（一九七七年），我辞掉了令许多人羨慕的太空总署的工作，离开了休斯顿，搬到洛杉机。\n\n　　说也奇怪：不敢说是恰好五年，但大约可说是第六年。一九八三年，我的唱片在亚洲开始销起来，我一天二十四小时几乎全都忙着与一些顶尖的音乐高手，日出日落地一起工作。\n\n　　每当我在最困惑的时候，我会静下来问我自己：五年后你“最希望”看到你自己在做什么？\n\n　　如果，你自己都不知道这个答案的话，你又如何要求別人或上帝为你做选择或开路呢？別忘了！在生命中，上帝已经把所有“选择”的权力交在我们的手上了。\n\n　　如果，你对你的生命经常在问“为什么会这样？”、“为什么会那样？”的时候，你不妨试着问一下自己，你是否很“清清楚楚”地知道你自己要的是什么？\n\n　　如果连你自己要的是什么都不知道的话，那么爱你的主又如何帮你安排呢？不是吗？\n\n　　而在你旁边的人，再怎么热心地为你敲锣打鼓，爱你的主也顶多给一些慈悲的安慰。因为连你自己都还没有清楚地告诉他，你要的是什么？那么你又岂能无辜地怪上帝没有为你开路呢？不是吗？ \n","source":"_posts/2012-03-23-what-you-are-doing-in-5-years.md","raw":"---\nlayout: post\ntitle: \"[转]五年后你在何方\"\ndate: 2012-03-23 09:37\ncomments: true\ncategories: \n---\n\n转一篇文章，估计知道的人多，但真正实践的人可能很少。\n\n<!-- more -->\n\n故事原文来自《青年文摘》。\n\n　　一九七六年的冬天，当时我十九岁，在休斯顿太空总署的大空梭实验室里工作，同时也在总署旁边的休斯顿大学主修电脑。纵然忙于学校、睡眠与工作之间，这几乎占据了我一天二十四小时的全部时间，但只要有多余的一分钟，我总是会把所有的精力放在我的音乐创作上。\n　　  \n　　我知道写歌词不是我的专长，所以在这段日子里，我处处寻找一位善写歌、词的搭档，与我一起合作创作。我认识了一位朋友，她的名字叫凡內芮（Valerie Johnson）。自从二十多年前离开德州后，就再也没听过她的消息，但是她却在我事业的起步时，给了我最大的鼓励。仅十九岁的凡內芮在德州的诗词比赛中，不知得过多少奖牌。她的写作总是让我爱不释手，当时我们的确合写了许多很好的作品，一直到今天，我仍然认为这些作品充满了特色与创意。\n\n　　一个星期六的周末，凡內芮又热情地邀请我至她家的牧场烤肉。她的家族是德州有名的石油大亨，拥有庞大的牧场。她的家庭虽然极为富有，但她的穿着、所开的车、与她谦诚待人的态度，更让我加倍地打从心底佩服她。凡內芮知道我对音乐的执着。然而，面对那遥远的音乐界及整个美国陌生的唱片市场，我们一点管道都没有。\n\n　　此时，我们两个人坐在德州的乡下，我们哪知道下一步该如何走。\n\n　　突然间，她冒出了一句话：“Visualize, What you are doing in 5 years?﹙想象你五年后在做什么？﹚”。\n\n　　我愣了一下。\n\n　　她转过身来，手指着我说：“嘿！告诉我，你心目中‘最希望’五年后的你在做什么，你那个时候的生活是一个什么样子？”我还来不及回答，她又抢着说： “別急，你先仔细想想，完全想好，确定后再说出来。”我沉思了几分钟，开始告诉她：“第一，五年后，我希望能有一张唱片在市场上，而这张唱片很受欢迎，可以得到许多人的肯定。第二，我住在一个有很多很多音乐的地方，能天天与一些世界一流的乐师一起工作。”\n\n　　凡內芮说：“你确定了吗？”\n\n　　我慢慢稳稳地回答，而且拉了一个很长的Yesssssss！\n\n　　凡內芮接着说：“好，既然你确定了，我们就把这个目标倒算回来。如果第五年，你有一张唱片在市场上，那么你的第四年一定是要跟一家唱片公司签上合约。”\n\n　　“那么你的第三年一定是要有一个完整的作品，可以拿给很多很多的唱片公 司听，对不对？”\n\n　　“那么你的第二年，一定要有很棒的作品开始录音了。”\n\n　　“那么你的第一年，就一定要把你所有要准备录音的作品全部编曲，排练就位准备好。”\n\n　　“那么你的第六个月，就是要把那些没有完成的作品修饰好，然后让你自己可以逐一筛选。”\n\n　　“那么你的第一个月就是要把目前这几首曲子完工。”\n\n　　“那么你的第一个礼拜就是要先列出一整个清单，排出哪些曲子需要修改， 哪些需要完工。”\n\n　　“好了，我们现在不就已经知道你下个星期一要做什么了吗？”凡內芮笑笑地说。\n\n　　“喔，对了。你还说你五年后，要生活在一个有很多音乐的地方，然后与许多一流的乐师一起忙着工作，对吗？”她急忙地补充说。“如果，你的第五年已经在与这些人一起工作，那么你的第四年照道理应该有你自己的一个工作室或录音室。那么你的第三年，可能是先跟这个圈子里的人在一起工作。那么你的第二年，应该不是住在德州，而是已经住在纽约或是洛杉机了。”\n\n　　次年（一九七七年），我辞掉了令许多人羨慕的太空总署的工作，离开了休斯顿，搬到洛杉机。\n\n　　说也奇怪：不敢说是恰好五年，但大约可说是第六年。一九八三年，我的唱片在亚洲开始销起来，我一天二十四小时几乎全都忙着与一些顶尖的音乐高手，日出日落地一起工作。\n\n　　每当我在最困惑的时候，我会静下来问我自己：五年后你“最希望”看到你自己在做什么？\n\n　　如果，你自己都不知道这个答案的话，你又如何要求別人或上帝为你做选择或开路呢？別忘了！在生命中，上帝已经把所有“选择”的权力交在我们的手上了。\n\n　　如果，你对你的生命经常在问“为什么会这样？”、“为什么会那样？”的时候，你不妨试着问一下自己，你是否很“清清楚楚”地知道你自己要的是什么？\n\n　　如果连你自己要的是什么都不知道的话，那么爱你的主又如何帮你安排呢？不是吗？\n\n　　而在你旁边的人，再怎么热心地为你敲锣打鼓，爱你的主也顶多给一些慈悲的安慰。因为连你自己都还没有清楚地告诉他，你要的是什么？那么你又岂能无辜地怪上帝没有为你开路呢？不是吗？ \n","slug":"what-you-are-doing-in-5-years","published":1,"updated":"2017-01-25T15:29:56.000Z","photos":[],"link":"","_id":"ciyf7fk9v0006f2jyzvwv3s2v","content":"<p>转一篇文章，估计知道的人多，但真正实践的人可能很少。</p>\n<a id=\"more\"></a>\n<p>故事原文来自《青年文摘》。</p>\n<p>　　一九七六年的冬天，当时我十九岁，在休斯顿太空总署的大空梭实验室里工作，同时也在总署旁边的休斯顿大学主修电脑。纵然忙于学校、睡眠与工作之间，这几乎占据了我一天二十四小时的全部时间，但只要有多余的一分钟，我总是会把所有的精力放在我的音乐创作上。<br>　　<br>　　我知道写歌词不是我的专长，所以在这段日子里，我处处寻找一位善写歌、词的搭档，与我一起合作创作。我认识了一位朋友，她的名字叫凡內芮（Valerie Johnson）。自从二十多年前离开德州后，就再也没听过她的消息，但是她却在我事业的起步时，给了我最大的鼓励。仅十九岁的凡內芮在德州的诗词比赛中，不知得过多少奖牌。她的写作总是让我爱不释手，当时我们的确合写了许多很好的作品，一直到今天，我仍然认为这些作品充满了特色与创意。</p>\n<p>　　一个星期六的周末，凡內芮又热情地邀请我至她家的牧场烤肉。她的家族是德州有名的石油大亨，拥有庞大的牧场。她的家庭虽然极为富有，但她的穿着、所开的车、与她谦诚待人的态度，更让我加倍地打从心底佩服她。凡內芮知道我对音乐的执着。然而，面对那遥远的音乐界及整个美国陌生的唱片市场，我们一点管道都没有。</p>\n<p>　　此时，我们两个人坐在德州的乡下，我们哪知道下一步该如何走。</p>\n<p>　　突然间，她冒出了一句话：“Visualize, What you are doing in 5 years?﹙想象你五年后在做什么？﹚”。</p>\n<p>　　我愣了一下。</p>\n<p>　　她转过身来，手指着我说：“嘿！告诉我，你心目中‘最希望’五年后的你在做什么，你那个时候的生活是一个什么样子？”我还来不及回答，她又抢着说： “別急，你先仔细想想，完全想好，确定后再说出来。”我沉思了几分钟，开始告诉她：“第一，五年后，我希望能有一张唱片在市场上，而这张唱片很受欢迎，可以得到许多人的肯定。第二，我住在一个有很多很多音乐的地方，能天天与一些世界一流的乐师一起工作。”</p>\n<p>　　凡內芮说：“你确定了吗？”</p>\n<p>　　我慢慢稳稳地回答，而且拉了一个很长的Yesssssss！</p>\n<p>　　凡內芮接着说：“好，既然你确定了，我们就把这个目标倒算回来。如果第五年，你有一张唱片在市场上，那么你的第四年一定是要跟一家唱片公司签上合约。”</p>\n<p>　　“那么你的第三年一定是要有一个完整的作品，可以拿给很多很多的唱片公 司听，对不对？”</p>\n<p>　　“那么你的第二年，一定要有很棒的作品开始录音了。”</p>\n<p>　　“那么你的第一年，就一定要把你所有要准备录音的作品全部编曲，排练就位准备好。”</p>\n<p>　　“那么你的第六个月，就是要把那些没有完成的作品修饰好，然后让你自己可以逐一筛选。”</p>\n<p>　　“那么你的第一个月就是要把目前这几首曲子完工。”</p>\n<p>　　“那么你的第一个礼拜就是要先列出一整个清单，排出哪些曲子需要修改， 哪些需要完工。”</p>\n<p>　　“好了，我们现在不就已经知道你下个星期一要做什么了吗？”凡內芮笑笑地说。</p>\n<p>　　“喔，对了。你还说你五年后，要生活在一个有很多音乐的地方，然后与许多一流的乐师一起忙着工作，对吗？”她急忙地补充说。“如果，你的第五年已经在与这些人一起工作，那么你的第四年照道理应该有你自己的一个工作室或录音室。那么你的第三年，可能是先跟这个圈子里的人在一起工作。那么你的第二年，应该不是住在德州，而是已经住在纽约或是洛杉机了。”</p>\n<p>　　次年（一九七七年），我辞掉了令许多人羨慕的太空总署的工作，离开了休斯顿，搬到洛杉机。</p>\n<p>　　说也奇怪：不敢说是恰好五年，但大约可说是第六年。一九八三年，我的唱片在亚洲开始销起来，我一天二十四小时几乎全都忙着与一些顶尖的音乐高手，日出日落地一起工作。</p>\n<p>　　每当我在最困惑的时候，我会静下来问我自己：五年后你“最希望”看到你自己在做什么？</p>\n<p>　　如果，你自己都不知道这个答案的话，你又如何要求別人或上帝为你做选择或开路呢？別忘了！在生命中，上帝已经把所有“选择”的权力交在我们的手上了。</p>\n<p>　　如果，你对你的生命经常在问“为什么会这样？”、“为什么会那样？”的时候，你不妨试着问一下自己，你是否很“清清楚楚”地知道你自己要的是什么？</p>\n<p>　　如果连你自己要的是什么都不知道的话，那么爱你的主又如何帮你安排呢？不是吗？</p>\n<p>　　而在你旁边的人，再怎么热心地为你敲锣打鼓，爱你的主也顶多给一些慈悲的安慰。因为连你自己都还没有清楚地告诉他，你要的是什么？那么你又岂能无辜地怪上帝没有为你开路呢？不是吗？ </p>\n","excerpt":"<p>转一篇文章，估计知道的人多，但真正实践的人可能很少。</p>","more":"<p>故事原文来自《青年文摘》。</p>\n<p>　　一九七六年的冬天，当时我十九岁，在休斯顿太空总署的大空梭实验室里工作，同时也在总署旁边的休斯顿大学主修电脑。纵然忙于学校、睡眠与工作之间，这几乎占据了我一天二十四小时的全部时间，但只要有多余的一分钟，我总是会把所有的精力放在我的音乐创作上。<br>　　<br>　　我知道写歌词不是我的专长，所以在这段日子里，我处处寻找一位善写歌、词的搭档，与我一起合作创作。我认识了一位朋友，她的名字叫凡內芮（Valerie Johnson）。自从二十多年前离开德州后，就再也没听过她的消息，但是她却在我事业的起步时，给了我最大的鼓励。仅十九岁的凡內芮在德州的诗词比赛中，不知得过多少奖牌。她的写作总是让我爱不释手，当时我们的确合写了许多很好的作品，一直到今天，我仍然认为这些作品充满了特色与创意。</p>\n<p>　　一个星期六的周末，凡內芮又热情地邀请我至她家的牧场烤肉。她的家族是德州有名的石油大亨，拥有庞大的牧场。她的家庭虽然极为富有，但她的穿着、所开的车、与她谦诚待人的态度，更让我加倍地打从心底佩服她。凡內芮知道我对音乐的执着。然而，面对那遥远的音乐界及整个美国陌生的唱片市场，我们一点管道都没有。</p>\n<p>　　此时，我们两个人坐在德州的乡下，我们哪知道下一步该如何走。</p>\n<p>　　突然间，她冒出了一句话：“Visualize, What you are doing in 5 years?﹙想象你五年后在做什么？﹚”。</p>\n<p>　　我愣了一下。</p>\n<p>　　她转过身来，手指着我说：“嘿！告诉我，你心目中‘最希望’五年后的你在做什么，你那个时候的生活是一个什么样子？”我还来不及回答，她又抢着说： “別急，你先仔细想想，完全想好，确定后再说出来。”我沉思了几分钟，开始告诉她：“第一，五年后，我希望能有一张唱片在市场上，而这张唱片很受欢迎，可以得到许多人的肯定。第二，我住在一个有很多很多音乐的地方，能天天与一些世界一流的乐师一起工作。”</p>\n<p>　　凡內芮说：“你确定了吗？”</p>\n<p>　　我慢慢稳稳地回答，而且拉了一个很长的Yesssssss！</p>\n<p>　　凡內芮接着说：“好，既然你确定了，我们就把这个目标倒算回来。如果第五年，你有一张唱片在市场上，那么你的第四年一定是要跟一家唱片公司签上合约。”</p>\n<p>　　“那么你的第三年一定是要有一个完整的作品，可以拿给很多很多的唱片公 司听，对不对？”</p>\n<p>　　“那么你的第二年，一定要有很棒的作品开始录音了。”</p>\n<p>　　“那么你的第一年，就一定要把你所有要准备录音的作品全部编曲，排练就位准备好。”</p>\n<p>　　“那么你的第六个月，就是要把那些没有完成的作品修饰好，然后让你自己可以逐一筛选。”</p>\n<p>　　“那么你的第一个月就是要把目前这几首曲子完工。”</p>\n<p>　　“那么你的第一个礼拜就是要先列出一整个清单，排出哪些曲子需要修改， 哪些需要完工。”</p>\n<p>　　“好了，我们现在不就已经知道你下个星期一要做什么了吗？”凡內芮笑笑地说。</p>\n<p>　　“喔，对了。你还说你五年后，要生活在一个有很多音乐的地方，然后与许多一流的乐师一起忙着工作，对吗？”她急忙地补充说。“如果，你的第五年已经在与这些人一起工作，那么你的第四年照道理应该有你自己的一个工作室或录音室。那么你的第三年，可能是先跟这个圈子里的人在一起工作。那么你的第二年，应该不是住在德州，而是已经住在纽约或是洛杉机了。”</p>\n<p>　　次年（一九七七年），我辞掉了令许多人羨慕的太空总署的工作，离开了休斯顿，搬到洛杉机。</p>\n<p>　　说也奇怪：不敢说是恰好五年，但大约可说是第六年。一九八三年，我的唱片在亚洲开始销起来，我一天二十四小时几乎全都忙着与一些顶尖的音乐高手，日出日落地一起工作。</p>\n<p>　　每当我在最困惑的时候，我会静下来问我自己：五年后你“最希望”看到你自己在做什么？</p>\n<p>　　如果，你自己都不知道这个答案的话，你又如何要求別人或上帝为你做选择或开路呢？別忘了！在生命中，上帝已经把所有“选择”的权力交在我们的手上了。</p>\n<p>　　如果，你对你的生命经常在问“为什么会这样？”、“为什么会那样？”的时候，你不妨试着问一下自己，你是否很“清清楚楚”地知道你自己要的是什么？</p>\n<p>　　如果连你自己要的是什么都不知道的话，那么爱你的主又如何帮你安排呢？不是吗？</p>\n<p>　　而在你旁边的人，再怎么热心地为你敲锣打鼓，爱你的主也顶多给一些慈悲的安慰。因为连你自己都还没有清楚地告诉他，你要的是什么？那么你又岂能无辜地怪上帝没有为你开路呢？不是吗？ </p>"},{"layout":"post","title":"基于左右值的无限级分类算法-oracle实现03","date":"2012-03-25T02:19:00.000Z","comments":1,"_content":"\n<!-- more -->\n\n本文参考了：\nMike Hillyer的《Managing Hierarchical Data in MySQL》\n及Yimin的翻译版《MYSQL中分层数据的管理》\n\n#6.检索节点的直接子节点\n\n可以想象一下，你在零售网站上呈现电子产品的分类。当用户点击分类后，你将要呈现该分类下的产品，同时也需列出该分类下的直接子分类，而不是该分类下的全部分类。为此，我们只呈现该节点及其直接子节点，不再呈现更深层次的节点。例如，当呈现PORTABLE ELECTRONICS分类时，我们同时只呈现MP3 PLAYERS、CD PLAYERS和2 WAY RADIOS分类，而不呈现FLASH分类。\n要实现它非常的简单，在先前的查询语句上添加HAVING子句：\n\n``` sql\nSELECT node.name, (COUNT(parent.name) -(\n     sub_tree.depth + 1))   depth\n     FROM nested_category   node,\n     nested_category   parent,\n     nested_category   sub_parent,\n(\n     SELECT node.name, (COUNT(parent.name) -1)\n     AS depth\n     FROM nested_category   node,\n     nested_category   parent\n     WHERE node.lft BETWEEN parent.lft AND parent.rgt\n     AND node.name = 'PORTABLE ELECTRONICS'\n     GROUP BY node.name\n     ORDER BY node.lft\n)  sub_tree\nWHERE node.lft BETWEEN parent.lft AND parent.rgt\nAND node.lft BETWEEN sub_parent.lft AND sub_parent.rgt\nAND sub_parent.name = sub_tree.name\nGROUP BY node.name,sub_tree.depth\nHAVING (COUNT(parent.name) -(sub_tree.depth + 1)) <= 1\n```\n```\nNAME DEPTH\n-------------------- ----------\nPORTABLE ELECTRONICS 　　0\nCD PLAYERS 　　　　　　　　  1 \n2 WAY RADIOS 　　　　　      1\nMP3 PLAYERS 　　　　　　　　1\n```\n\n#7.嵌套集合模型中集合函数的应用\n\n让我们添加一个产品表，我们可以使用它来示例集合函数的应用：\n\n``` sql\nCREATE TABLE product(product_id,\n  product_id INT   PRIMARY KEY,\n  name VARCHAR(40),\n  category_id INT NOT NULL\n);\n\n-- Create sequence\ncreate sequence SEQ_PRODUCT\nminvalue 1\nmaxvalue 999999999\nstart with 1\nincrement by 1\nnocache;\n\n\nINSERT INTO product(product_id, name, category_id) VALUES(SEQ_PRODUCT.NEXTVAL, '20\" TV',3);\nINSERT INTO product(product_id, name, category_id) VALUES(SEQ_PRODUCT.NEXTVAL, '36\" TV',3);\nINSERT INTO product(product_id, name, category_id) VALUES(SEQ_PRODUCT.NEXTVAL, 'SuperLCD42\"',4);\nINSERT INTO product(product_id, name, category_id) VALUES(SEQ_PRODUCT.NEXTVAL, 'UltraPlasma62\"',5);\nINSERT INTO product(product_id, name, category_id) VALUES(SEQ_PRODUCT.NEXTVAL, 'Value Plasma 38\"',5);\nINSERT INTO product(product_id, name, category_id) VALUES(SEQ_PRODUCT.NEXTVAL, 'PowerMP35gb',7);\nINSERT INTO product(product_id, name, category_id) VALUES(SEQ_PRODUCT.NEXTVAL, 'SuperPlayer1gb',8);\nINSERT INTO product(product_id, name, category_id) VALUES(SEQ_PRODUCT.NEXTVAL, 'Porta CD',9);\nINSERT INTO product(product_id, name, category_id) VALUES(SEQ_PRODUCT.NEXTVAL, 'CD To go!',9);\nINSERT INTO product(product_id, name, category_id) VALUES(SEQ_PRODUCT.NEXTVAL, 'Family Talk 360',10);\n```\n\n现在，让我们写一个查询语句，在检索分类树的同时，计算出各分类下的产品数量：\n\n``` sql\nSELECT parent.name, COUNT(product.name)\nFROM nested_category   node ,\nnested_category   parent,\nproduct\nWHERE   node.lft BETWEEN parent.lft AND parent.rgt\n     AND node.category_id = product.category_id\n     GROUP BY parent.name;\n```\n\n这条查询语句在检索整树的查询语句上增加了COUNT和GROUP BY子句，同时在WHERE子句中引用了product表和一个自连接。\n","source":"_posts/2012-03-25-managing-hierarchical-data-in-oracle-3.md","raw":"---\nlayout: post\ntitle: \"基于左右值的无限级分类算法-oracle实现03\"\ndate: 2012-03-25 10:19\ncomments: true\ncategories: oralce\n---\n\n<!-- more -->\n\n本文参考了：\nMike Hillyer的《Managing Hierarchical Data in MySQL》\n及Yimin的翻译版《MYSQL中分层数据的管理》\n\n#6.检索节点的直接子节点\n\n可以想象一下，你在零售网站上呈现电子产品的分类。当用户点击分类后，你将要呈现该分类下的产品，同时也需列出该分类下的直接子分类，而不是该分类下的全部分类。为此，我们只呈现该节点及其直接子节点，不再呈现更深层次的节点。例如，当呈现PORTABLE ELECTRONICS分类时，我们同时只呈现MP3 PLAYERS、CD PLAYERS和2 WAY RADIOS分类，而不呈现FLASH分类。\n要实现它非常的简单，在先前的查询语句上添加HAVING子句：\n\n``` sql\nSELECT node.name, (COUNT(parent.name) -(\n     sub_tree.depth + 1))   depth\n     FROM nested_category   node,\n     nested_category   parent,\n     nested_category   sub_parent,\n(\n     SELECT node.name, (COUNT(parent.name) -1)\n     AS depth\n     FROM nested_category   node,\n     nested_category   parent\n     WHERE node.lft BETWEEN parent.lft AND parent.rgt\n     AND node.name = 'PORTABLE ELECTRONICS'\n     GROUP BY node.name\n     ORDER BY node.lft\n)  sub_tree\nWHERE node.lft BETWEEN parent.lft AND parent.rgt\nAND node.lft BETWEEN sub_parent.lft AND sub_parent.rgt\nAND sub_parent.name = sub_tree.name\nGROUP BY node.name,sub_tree.depth\nHAVING (COUNT(parent.name) -(sub_tree.depth + 1)) <= 1\n```\n```\nNAME DEPTH\n-------------------- ----------\nPORTABLE ELECTRONICS 　　0\nCD PLAYERS 　　　　　　　　  1 \n2 WAY RADIOS 　　　　　      1\nMP3 PLAYERS 　　　　　　　　1\n```\n\n#7.嵌套集合模型中集合函数的应用\n\n让我们添加一个产品表，我们可以使用它来示例集合函数的应用：\n\n``` sql\nCREATE TABLE product(product_id,\n  product_id INT   PRIMARY KEY,\n  name VARCHAR(40),\n  category_id INT NOT NULL\n);\n\n-- Create sequence\ncreate sequence SEQ_PRODUCT\nminvalue 1\nmaxvalue 999999999\nstart with 1\nincrement by 1\nnocache;\n\n\nINSERT INTO product(product_id, name, category_id) VALUES(SEQ_PRODUCT.NEXTVAL, '20\" TV',3);\nINSERT INTO product(product_id, name, category_id) VALUES(SEQ_PRODUCT.NEXTVAL, '36\" TV',3);\nINSERT INTO product(product_id, name, category_id) VALUES(SEQ_PRODUCT.NEXTVAL, 'SuperLCD42\"',4);\nINSERT INTO product(product_id, name, category_id) VALUES(SEQ_PRODUCT.NEXTVAL, 'UltraPlasma62\"',5);\nINSERT INTO product(product_id, name, category_id) VALUES(SEQ_PRODUCT.NEXTVAL, 'Value Plasma 38\"',5);\nINSERT INTO product(product_id, name, category_id) VALUES(SEQ_PRODUCT.NEXTVAL, 'PowerMP35gb',7);\nINSERT INTO product(product_id, name, category_id) VALUES(SEQ_PRODUCT.NEXTVAL, 'SuperPlayer1gb',8);\nINSERT INTO product(product_id, name, category_id) VALUES(SEQ_PRODUCT.NEXTVAL, 'Porta CD',9);\nINSERT INTO product(product_id, name, category_id) VALUES(SEQ_PRODUCT.NEXTVAL, 'CD To go!',9);\nINSERT INTO product(product_id, name, category_id) VALUES(SEQ_PRODUCT.NEXTVAL, 'Family Talk 360',10);\n```\n\n现在，让我们写一个查询语句，在检索分类树的同时，计算出各分类下的产品数量：\n\n``` sql\nSELECT parent.name, COUNT(product.name)\nFROM nested_category   node ,\nnested_category   parent,\nproduct\nWHERE   node.lft BETWEEN parent.lft AND parent.rgt\n     AND node.category_id = product.category_id\n     GROUP BY parent.name;\n```\n\n这条查询语句在检索整树的查询语句上增加了COUNT和GROUP BY子句，同时在WHERE子句中引用了product表和一个自连接。\n","slug":"managing-hierarchical-data-in-oracle-3","published":1,"updated":"2017-01-25T15:29:56.000Z","photos":[],"link":"","_id":"ciyf7fka00007f2jy4op324p9","content":"<a id=\"more\"></a>\n<p>本文参考了：<br>Mike Hillyer的《Managing Hierarchical Data in MySQL》<br>及Yimin的翻译版《MYSQL中分层数据的管理》</p>\n<p>#6.检索节点的直接子节点</p>\n<p>可以想象一下，你在零售网站上呈现电子产品的分类。当用户点击分类后，你将要呈现该分类下的产品，同时也需列出该分类下的直接子分类，而不是该分类下的全部分类。为此，我们只呈现该节点及其直接子节点，不再呈现更深层次的节点。例如，当呈现PORTABLE ELECTRONICS分类时，我们同时只呈现MP3 PLAYERS、CD PLAYERS和2 WAY RADIOS分类，而不呈现FLASH分类。<br>要实现它非常的简单，在先前的查询语句上添加HAVING子句：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">SELECT</span> node.name, (<span class=\"keyword\">COUNT</span>(parent.name) -(</div><div class=\"line\">     sub_tree.depth + <span class=\"number\">1</span>))   <span class=\"keyword\">depth</span></div><div class=\"line\">     <span class=\"keyword\">FROM</span> nested_category   node,</div><div class=\"line\">     nested_category   <span class=\"keyword\">parent</span>,</div><div class=\"line\">     nested_category   sub_parent,</div><div class=\"line\">(</div><div class=\"line\">     <span class=\"keyword\">SELECT</span> node.name, (<span class=\"keyword\">COUNT</span>(parent.name) <span class=\"number\">-1</span>)</div><div class=\"line\">     <span class=\"keyword\">AS</span> <span class=\"keyword\">depth</span></div><div class=\"line\">     <span class=\"keyword\">FROM</span> nested_category   node,</div><div class=\"line\">     nested_category   <span class=\"keyword\">parent</span></div><div class=\"line\">     <span class=\"keyword\">WHERE</span> node.lft <span class=\"keyword\">BETWEEN</span> parent.lft <span class=\"keyword\">AND</span> parent.rgt</div><div class=\"line\">     <span class=\"keyword\">AND</span> node.name = <span class=\"string\">'PORTABLE ELECTRONICS'</span></div><div class=\"line\">     <span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> node.name</div><div class=\"line\">     <span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> node.lft</div><div class=\"line\">)  sub_tree</div><div class=\"line\"><span class=\"keyword\">WHERE</span> node.lft <span class=\"keyword\">BETWEEN</span> parent.lft <span class=\"keyword\">AND</span> parent.rgt</div><div class=\"line\"><span class=\"keyword\">AND</span> node.lft <span class=\"keyword\">BETWEEN</span> sub_parent.lft <span class=\"keyword\">AND</span> sub_parent.rgt</div><div class=\"line\"><span class=\"keyword\">AND</span> sub_parent.name = sub_tree.name</div><div class=\"line\"><span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> node.name,sub_tree.depth</div><div class=\"line\"><span class=\"keyword\">HAVING</span> (<span class=\"keyword\">COUNT</span>(parent.name) -(sub_tree.depth + <span class=\"number\">1</span>)) &lt;= <span class=\"number\">1</span></div></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">NAME DEPTH</div><div class=\"line\">-------------------- ----------</div><div class=\"line\">PORTABLE ELECTRONICS 　　0</div><div class=\"line\">CD PLAYERS 　　　　　　　　  1 </div><div class=\"line\">2 WAY RADIOS 　　　　　      1</div><div class=\"line\">MP3 PLAYERS 　　　　　　　　1</div></pre></td></tr></table></figure>\n<p>#7.嵌套集合模型中集合函数的应用</p>\n<p>让我们添加一个产品表，我们可以使用它来示例集合函数的应用：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> product(product_id,</div><div class=\"line\">  product_id <span class=\"built_in\">INT</span>   PRIMARY <span class=\"keyword\">KEY</span>,</div><div class=\"line\">  <span class=\"keyword\">name</span> <span class=\"built_in\">VARCHAR</span>(<span class=\"number\">40</span>),</div><div class=\"line\">  category_id <span class=\"built_in\">INT</span> <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span></div><div class=\"line\">);</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">-- Create sequence</span></div><div class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">sequence</span> SEQ_PRODUCT</div><div class=\"line\"><span class=\"keyword\">minvalue</span> <span class=\"number\">1</span></div><div class=\"line\">maxvalue <span class=\"number\">999999999</span></div><div class=\"line\"><span class=\"keyword\">start</span> <span class=\"keyword\">with</span> <span class=\"number\">1</span></div><div class=\"line\"><span class=\"keyword\">increment</span> <span class=\"keyword\">by</span> <span class=\"number\">1</span></div><div class=\"line\">nocache;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> product(product_id, <span class=\"keyword\">name</span>, category_id) <span class=\"keyword\">VALUES</span>(SEQ_PRODUCT.NEXTVAL, <span class=\"string\">'20\" TV'</span>,<span class=\"number\">3</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> product(product_id, <span class=\"keyword\">name</span>, category_id) <span class=\"keyword\">VALUES</span>(SEQ_PRODUCT.NEXTVAL, <span class=\"string\">'36\" TV'</span>,<span class=\"number\">3</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> product(product_id, <span class=\"keyword\">name</span>, category_id) <span class=\"keyword\">VALUES</span>(SEQ_PRODUCT.NEXTVAL, <span class=\"string\">'SuperLCD42\"'</span>,<span class=\"number\">4</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> product(product_id, <span class=\"keyword\">name</span>, category_id) <span class=\"keyword\">VALUES</span>(SEQ_PRODUCT.NEXTVAL, <span class=\"string\">'UltraPlasma62\"'</span>,<span class=\"number\">5</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> product(product_id, <span class=\"keyword\">name</span>, category_id) <span class=\"keyword\">VALUES</span>(SEQ_PRODUCT.NEXTVAL, <span class=\"string\">'Value Plasma 38\"'</span>,<span class=\"number\">5</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> product(product_id, <span class=\"keyword\">name</span>, category_id) <span class=\"keyword\">VALUES</span>(SEQ_PRODUCT.NEXTVAL, <span class=\"string\">'PowerMP35gb'</span>,<span class=\"number\">7</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> product(product_id, <span class=\"keyword\">name</span>, category_id) <span class=\"keyword\">VALUES</span>(SEQ_PRODUCT.NEXTVAL, <span class=\"string\">'SuperPlayer1gb'</span>,<span class=\"number\">8</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> product(product_id, <span class=\"keyword\">name</span>, category_id) <span class=\"keyword\">VALUES</span>(SEQ_PRODUCT.NEXTVAL, <span class=\"string\">'Porta CD'</span>,<span class=\"number\">9</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> product(product_id, <span class=\"keyword\">name</span>, category_id) <span class=\"keyword\">VALUES</span>(SEQ_PRODUCT.NEXTVAL, <span class=\"string\">'CD To go!'</span>,<span class=\"number\">9</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> product(product_id, <span class=\"keyword\">name</span>, category_id) <span class=\"keyword\">VALUES</span>(SEQ_PRODUCT.NEXTVAL, <span class=\"string\">'Family Talk 360'</span>,<span class=\"number\">10</span>);</div></pre></td></tr></table></figure>\n<p>现在，让我们写一个查询语句，在检索分类树的同时，计算出各分类下的产品数量：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">SELECT</span> parent.name, <span class=\"keyword\">COUNT</span>(product.name)</div><div class=\"line\"><span class=\"keyword\">FROM</span> nested_category   node ,</div><div class=\"line\">nested_category   <span class=\"keyword\">parent</span>,</div><div class=\"line\">product</div><div class=\"line\"><span class=\"keyword\">WHERE</span>   node.lft <span class=\"keyword\">BETWEEN</span> parent.lft <span class=\"keyword\">AND</span> parent.rgt</div><div class=\"line\">     <span class=\"keyword\">AND</span> node.category_id = product.category_id</div><div class=\"line\">     <span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> parent.name;</div></pre></td></tr></table></figure>\n<p>这条查询语句在检索整树的查询语句上增加了COUNT和GROUP BY子句，同时在WHERE子句中引用了product表和一个自连接。</p>\n","excerpt":"","more":"<p>本文参考了：<br>Mike Hillyer的《Managing Hierarchical Data in MySQL》<br>及Yimin的翻译版《MYSQL中分层数据的管理》</p>\n<p>#6.检索节点的直接子节点</p>\n<p>可以想象一下，你在零售网站上呈现电子产品的分类。当用户点击分类后，你将要呈现该分类下的产品，同时也需列出该分类下的直接子分类，而不是该分类下的全部分类。为此，我们只呈现该节点及其直接子节点，不再呈现更深层次的节点。例如，当呈现PORTABLE ELECTRONICS分类时，我们同时只呈现MP3 PLAYERS、CD PLAYERS和2 WAY RADIOS分类，而不呈现FLASH分类。<br>要实现它非常的简单，在先前的查询语句上添加HAVING子句：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">SELECT</span> node.name, (<span class=\"keyword\">COUNT</span>(parent.name) -(</div><div class=\"line\">     sub_tree.depth + <span class=\"number\">1</span>))   <span class=\"keyword\">depth</span></div><div class=\"line\">     <span class=\"keyword\">FROM</span> nested_category   node,</div><div class=\"line\">     nested_category   <span class=\"keyword\">parent</span>,</div><div class=\"line\">     nested_category   sub_parent,</div><div class=\"line\">(</div><div class=\"line\">     <span class=\"keyword\">SELECT</span> node.name, (<span class=\"keyword\">COUNT</span>(parent.name) <span class=\"number\">-1</span>)</div><div class=\"line\">     <span class=\"keyword\">AS</span> <span class=\"keyword\">depth</span></div><div class=\"line\">     <span class=\"keyword\">FROM</span> nested_category   node,</div><div class=\"line\">     nested_category   <span class=\"keyword\">parent</span></div><div class=\"line\">     <span class=\"keyword\">WHERE</span> node.lft <span class=\"keyword\">BETWEEN</span> parent.lft <span class=\"keyword\">AND</span> parent.rgt</div><div class=\"line\">     <span class=\"keyword\">AND</span> node.name = <span class=\"string\">'PORTABLE ELECTRONICS'</span></div><div class=\"line\">     <span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> node.name</div><div class=\"line\">     <span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> node.lft</div><div class=\"line\">)  sub_tree</div><div class=\"line\"><span class=\"keyword\">WHERE</span> node.lft <span class=\"keyword\">BETWEEN</span> parent.lft <span class=\"keyword\">AND</span> parent.rgt</div><div class=\"line\"><span class=\"keyword\">AND</span> node.lft <span class=\"keyword\">BETWEEN</span> sub_parent.lft <span class=\"keyword\">AND</span> sub_parent.rgt</div><div class=\"line\"><span class=\"keyword\">AND</span> sub_parent.name = sub_tree.name</div><div class=\"line\"><span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> node.name,sub_tree.depth</div><div class=\"line\"><span class=\"keyword\">HAVING</span> (<span class=\"keyword\">COUNT</span>(parent.name) -(sub_tree.depth + <span class=\"number\">1</span>)) &lt;= <span class=\"number\">1</span></div></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">NAME DEPTH</div><div class=\"line\">-------------------- ----------</div><div class=\"line\">PORTABLE ELECTRONICS 　　0</div><div class=\"line\">CD PLAYERS 　　　　　　　　  1 </div><div class=\"line\">2 WAY RADIOS 　　　　　      1</div><div class=\"line\">MP3 PLAYERS 　　　　　　　　1</div></pre></td></tr></table></figure>\n<p>#7.嵌套集合模型中集合函数的应用</p>\n<p>让我们添加一个产品表，我们可以使用它来示例集合函数的应用：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> product(product_id,</div><div class=\"line\">  product_id <span class=\"built_in\">INT</span>   PRIMARY <span class=\"keyword\">KEY</span>,</div><div class=\"line\">  <span class=\"keyword\">name</span> <span class=\"built_in\">VARCHAR</span>(<span class=\"number\">40</span>),</div><div class=\"line\">  category_id <span class=\"built_in\">INT</span> <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span></div><div class=\"line\">);</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">-- Create sequence</span></div><div class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">sequence</span> SEQ_PRODUCT</div><div class=\"line\"><span class=\"keyword\">minvalue</span> <span class=\"number\">1</span></div><div class=\"line\">maxvalue <span class=\"number\">999999999</span></div><div class=\"line\"><span class=\"keyword\">start</span> <span class=\"keyword\">with</span> <span class=\"number\">1</span></div><div class=\"line\"><span class=\"keyword\">increment</span> <span class=\"keyword\">by</span> <span class=\"number\">1</span></div><div class=\"line\">nocache;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> product(product_id, <span class=\"keyword\">name</span>, category_id) <span class=\"keyword\">VALUES</span>(SEQ_PRODUCT.NEXTVAL, <span class=\"string\">'20\" TV'</span>,<span class=\"number\">3</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> product(product_id, <span class=\"keyword\">name</span>, category_id) <span class=\"keyword\">VALUES</span>(SEQ_PRODUCT.NEXTVAL, <span class=\"string\">'36\" TV'</span>,<span class=\"number\">3</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> product(product_id, <span class=\"keyword\">name</span>, category_id) <span class=\"keyword\">VALUES</span>(SEQ_PRODUCT.NEXTVAL, <span class=\"string\">'SuperLCD42\"'</span>,<span class=\"number\">4</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> product(product_id, <span class=\"keyword\">name</span>, category_id) <span class=\"keyword\">VALUES</span>(SEQ_PRODUCT.NEXTVAL, <span class=\"string\">'UltraPlasma62\"'</span>,<span class=\"number\">5</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> product(product_id, <span class=\"keyword\">name</span>, category_id) <span class=\"keyword\">VALUES</span>(SEQ_PRODUCT.NEXTVAL, <span class=\"string\">'Value Plasma 38\"'</span>,<span class=\"number\">5</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> product(product_id, <span class=\"keyword\">name</span>, category_id) <span class=\"keyword\">VALUES</span>(SEQ_PRODUCT.NEXTVAL, <span class=\"string\">'PowerMP35gb'</span>,<span class=\"number\">7</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> product(product_id, <span class=\"keyword\">name</span>, category_id) <span class=\"keyword\">VALUES</span>(SEQ_PRODUCT.NEXTVAL, <span class=\"string\">'SuperPlayer1gb'</span>,<span class=\"number\">8</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> product(product_id, <span class=\"keyword\">name</span>, category_id) <span class=\"keyword\">VALUES</span>(SEQ_PRODUCT.NEXTVAL, <span class=\"string\">'Porta CD'</span>,<span class=\"number\">9</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> product(product_id, <span class=\"keyword\">name</span>, category_id) <span class=\"keyword\">VALUES</span>(SEQ_PRODUCT.NEXTVAL, <span class=\"string\">'CD To go!'</span>,<span class=\"number\">9</span>);</div><div class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> product(product_id, <span class=\"keyword\">name</span>, category_id) <span class=\"keyword\">VALUES</span>(SEQ_PRODUCT.NEXTVAL, <span class=\"string\">'Family Talk 360'</span>,<span class=\"number\">10</span>);</div></pre></td></tr></table></figure>\n<p>现在，让我们写一个查询语句，在检索分类树的同时，计算出各分类下的产品数量：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">SELECT</span> parent.name, <span class=\"keyword\">COUNT</span>(product.name)</div><div class=\"line\"><span class=\"keyword\">FROM</span> nested_category   node ,</div><div class=\"line\">nested_category   <span class=\"keyword\">parent</span>,</div><div class=\"line\">product</div><div class=\"line\"><span class=\"keyword\">WHERE</span>   node.lft <span class=\"keyword\">BETWEEN</span> parent.lft <span class=\"keyword\">AND</span> parent.rgt</div><div class=\"line\">     <span class=\"keyword\">AND</span> node.category_id = product.category_id</div><div class=\"line\">     <span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> parent.name;</div></pre></td></tr></table></figure>\n<p>这条查询语句在检索整树的查询语句上增加了COUNT和GROUP BY子句，同时在WHERE子句中引用了product表和一个自连接。</p>"},{"layout":"post","title":"关于团队一些思考","date":"2012-05-12T08:16:00.000Z","_content":"\n目录\n\n```\n 1.\t团队思考\n  1.1.\ttoruk框架的启示\n  1.2.\thui99的问题\n  1.3.\tcmmi3评估中暴露的问题\n   (1)\t杨ting在访谈前背\"答案\"时才知道OSSP是什么？\n   (2)\t我们作为“编码测试”人员，在访谈时却被问了许多需求设计、配置、QA的问题，我们几个人都没回答上来。\n  1.4.\t代码是否可以共享?\n 2. 员工、团队与成长\n 3. 总结\n```\n\n# 团队思考\n## toruk框架的启示\ntoruk框架目标\n\n```\na)\t相对于hui99使用的spring+ibatis2框架（或其它框架），使开发过程更加简单，提高效率;\nb)\t使公司具有不可替代的元素。turuk便是其中之一。\n```\n\n(1)\t如果想开发过程简单，是否有更好的开源框架(技术/方案)?\n如使用spring3 REST风格，使用Spring的注释式编程！\n(2)\t如果非要开发toruk，是否数据库这块可重用ibatis2而不是重新造轮子？\n(3)\t部分项目已经使用了toruk框架，可能以后还有项目会用到。\n\n```\ntoruk的研发人员全部离职之后，toruk框架的理念、技术、知识、代码真的传下来了吗？\n还有人非常了解toruk的源码吗？\n还有人去主导toruk的研发吗？\ntoruk存在的bug，还会有人去fix吗?\ntoruk还会在公司存活多久呢？\n```\n\n(4)\ttoruk（或其它）的知识为什么没有完全成为公司的财产，而随着人员的流失而流失了？是什么原因造成了这些问题？\n\n## hui99的问题\nhui99有很多频道：机票、酒店、旅游、团购、租车、购物、电子优惠券、手机充值、社区等, 还有一个IVR系统在使用！去年年底的时候又加了一个分销商/积分系统上去。当初开发分配任务时，基本上都是每个频道由某个人单独负责的。从去年开始，陆续有人离职了，项目转由我整体负责了。但我对其它各频道业务不是很清楚，而相关负责的人已经离职，没有留下太多的文档（或文档已经过时），代码风格不一（包括缩进、代码的格式化都或多或少有点问题）、结构混乱,中间夹杂点小bug，也确实让人头痛。\n\n```\n(1)\t“每个人按照频道划分开发任务”，这种任务分配的模式是否过时？\n或者说每个频道的功能还可以分得细一点，然后团队一起开发。或每个频道进行交叉开发。\n(2)\t开发过程中，团队间是否可以评审一下代码，而保持风格的一致性?\n(3)\t同事离职了，你怎样才能更快的理解他的负责频道（或模块）业务和代码？\n```\n\n## cmmi3评估中暴露的问题\n公司今年过完年之后，确定实施CMMI3评审，而评审工作在4月份开始进行。两个月时间，四个项目(三个虚假项目),上千个文档需要准备。4月10多号开始背\"答案\"，4月22日开始访谈，我是作为”编码测试”人员进行访谈的。\n\t评审过程中，有两件事情让我印象比较深刻：\n\n### 杨ting在访谈前背\"答案\"时才知道OSSP是什么？\n她已经写文档两个月了，所有的CMMI3的流程和文档都是根据OSSP来编写的。\n这是谁的问题？个人问题？石老师(培训老师)的问题？CMMI负责人的问题？公司培训的问题？…\n这到底是什么问题？如何去解决这个问题？\n\n### 我们作为“编码测试”人员，在访谈时却被问了许多需求设计、配置、QA的问题，我们几个人都没回答上来。\n几天背\"答案\"下来没有什么效果，主任评估师都没问到（你想让他问的）问题上。CMMI中编码测试不是编码测试人员的问题，团队成员间的工作都是有关联的。\n在团队中，你知道别人做的具体工作吗？你知道别人的工作对你的影响吗？你真的知道你负责工作的内容吗？\n\n## 代码是否可以共享?\n去年年底的时候，建行团要改版（代理商版）。\n具体的开发任务分配是：国栋负责平台后台、我负责分行后台、杨文涛负责商户后台。其中有一个功能模块：团购商品状态转换的, 平台、分行、商户后台都有涉及到，商户后台只有\"提交审核\"的操作，但分行后台和平台后台包括商品状态的所有操作。\n基本功能介绍如下：\n\n```\n商品状态：暂存、待审核、上架。\n相关操作有：提交审核、上架、下架、重新编辑。\n状态转换关系是：\n暂存\t\t－提交审核\t－>\t待审核\n待审核\t－上架\t    －>\t上架\n上架\t\t－下架       －>\t待审核\n待审核\t－重新编辑\t－> 暂存\n```\n我在任务确定后，就忙着做其它项目去了。我一回来，就code自已负责的代码去了。\n\n但问题来了,状态转换的操作我是通过商品状态机类ProductStateMachine实现的，其它地方要用的话直接调就行了，商户后台这边则是直接操作数据库。同样的功能，实现的方式不同，方法的命名不同，若不修改就会给后期的维护带来问题。\n\n为什么会出现此类的问题呢？任务确定之后，各人只埋头负责自己的部分，而完全不理会其他人的工作，只要功能实现了，其它的都是小问题。事实真的是这样吗？当别人提出你的功能有更好的实现方案时，所有人都会心甘情愿的修改自己\"辛辛苦苦\"写的代码吗？团队代码风格、方法命名等如何保持一致呢？…\n\n你也许会觉得责任在于分配任务的人，为什么分的任务会有交叉呢？但(1)是人总会犯点错;(2)这就好像项目的成败决定于分配任务的人一样，个人决定成败，而非整个团队。\n\t\n可以思考的问题：\n\n```\n(1)\t任务为什么要这么分？是不是可以做得更好？\n(2)\t代码是否可以共享?\n```\n\n# 员工、团队与成长\n新人进公司一年多来快速成长了吗?如果没成长，是招聘时看错人了吗？是员工的个人问题，还是公司或团队本身的问题？\n\n公司需要生存发展，员工需要更好的工资(尤其是物价在疯涨的时候)、更好的发展，公司与员工是互相博弈的过程。\n\n薪资不高、没有发展、没有成长，这不是在耽误人家的宝贵青春吗？\n\n```\n但公司的发展靠的是人啊？\n(1)\t好的氛围，才会引入、留住好的人。\n(2)\t好的人，才会有好的制度，并且保持好这个制度，毕竟制度是人定的。\n(3)\t好的人和好的制度，才会遇到好的客户。\n```\n\n是先有项目才有人，还是有了人，才会有项目？\n\n做项目是仅仅为了做项目吗？如何打造一个全面成功的项目？\n\n项目开发中，团队真的在成长吗？\n\n《走出软件作坊》 \t阿朱\n> 在项目管理中，我发现人是最重要的，但是很遗憾，总是能看到不少心胸狭窄、眼光短浅的老板，把员工当傻瓜，把客户当傻子。其实人对了，世界就对了。\n\n《从优秀到卓越》\t柯林斯\n> 实现跨越公司的领导者首先是设法得到合适的人才（不合适的下车），然后才决定将汽车开向何方。\n\t\n 五年思想工作者 梦想风暴\n> 去年带了一个项目，在那个项目里，我做了一个尝试。我把项目的目标订在了人才培养，而非传统意义的交付。于是，在这个过程中，我花了大量的精力去教新员工写代码，帮他们设定个人成长目标，教他们做事，带着他们吃好玩好……就是这样一个几乎都是由新ThoughtWorker——甚至大多是毕业生——组成的项目组，后来，这个项目成了Michael Chen口中最接近他心目中全面成功的项目。\n\n# 总结\n* 员工离职之后，知识、经验会留下来吗？\n* 团队中的知识在流通吗？\n* 项目中，团队成员在成长吗？团队在成长吗？团队会反思总结吗？\n* 除了员工自我驱动外，公司有为员工做过职业规划吗？\n* 团队怎样才能写出更好的代码(Beautiful Code)？\n\n----\n\n你需要什么样的团队?\n\n","source":"_posts/2012-05-12-team-thinking.md","raw":"---\nlayout: post\ntitle: \"关于团队一些思考\"\ncategories: dev\ndate: 2012-05-12 16:16\n---\n\n目录\n\n```\n 1.\t团队思考\n  1.1.\ttoruk框架的启示\n  1.2.\thui99的问题\n  1.3.\tcmmi3评估中暴露的问题\n   (1)\t杨ting在访谈前背\"答案\"时才知道OSSP是什么？\n   (2)\t我们作为“编码测试”人员，在访谈时却被问了许多需求设计、配置、QA的问题，我们几个人都没回答上来。\n  1.4.\t代码是否可以共享?\n 2. 员工、团队与成长\n 3. 总结\n```\n\n# 团队思考\n## toruk框架的启示\ntoruk框架目标\n\n```\na)\t相对于hui99使用的spring+ibatis2框架（或其它框架），使开发过程更加简单，提高效率;\nb)\t使公司具有不可替代的元素。turuk便是其中之一。\n```\n\n(1)\t如果想开发过程简单，是否有更好的开源框架(技术/方案)?\n如使用spring3 REST风格，使用Spring的注释式编程！\n(2)\t如果非要开发toruk，是否数据库这块可重用ibatis2而不是重新造轮子？\n(3)\t部分项目已经使用了toruk框架，可能以后还有项目会用到。\n\n```\ntoruk的研发人员全部离职之后，toruk框架的理念、技术、知识、代码真的传下来了吗？\n还有人非常了解toruk的源码吗？\n还有人去主导toruk的研发吗？\ntoruk存在的bug，还会有人去fix吗?\ntoruk还会在公司存活多久呢？\n```\n\n(4)\ttoruk（或其它）的知识为什么没有完全成为公司的财产，而随着人员的流失而流失了？是什么原因造成了这些问题？\n\n## hui99的问题\nhui99有很多频道：机票、酒店、旅游、团购、租车、购物、电子优惠券、手机充值、社区等, 还有一个IVR系统在使用！去年年底的时候又加了一个分销商/积分系统上去。当初开发分配任务时，基本上都是每个频道由某个人单独负责的。从去年开始，陆续有人离职了，项目转由我整体负责了。但我对其它各频道业务不是很清楚，而相关负责的人已经离职，没有留下太多的文档（或文档已经过时），代码风格不一（包括缩进、代码的格式化都或多或少有点问题）、结构混乱,中间夹杂点小bug，也确实让人头痛。\n\n```\n(1)\t“每个人按照频道划分开发任务”，这种任务分配的模式是否过时？\n或者说每个频道的功能还可以分得细一点，然后团队一起开发。或每个频道进行交叉开发。\n(2)\t开发过程中，团队间是否可以评审一下代码，而保持风格的一致性?\n(3)\t同事离职了，你怎样才能更快的理解他的负责频道（或模块）业务和代码？\n```\n\n## cmmi3评估中暴露的问题\n公司今年过完年之后，确定实施CMMI3评审，而评审工作在4月份开始进行。两个月时间，四个项目(三个虚假项目),上千个文档需要准备。4月10多号开始背\"答案\"，4月22日开始访谈，我是作为”编码测试”人员进行访谈的。\n\t评审过程中，有两件事情让我印象比较深刻：\n\n### 杨ting在访谈前背\"答案\"时才知道OSSP是什么？\n她已经写文档两个月了，所有的CMMI3的流程和文档都是根据OSSP来编写的。\n这是谁的问题？个人问题？石老师(培训老师)的问题？CMMI负责人的问题？公司培训的问题？…\n这到底是什么问题？如何去解决这个问题？\n\n### 我们作为“编码测试”人员，在访谈时却被问了许多需求设计、配置、QA的问题，我们几个人都没回答上来。\n几天背\"答案\"下来没有什么效果，主任评估师都没问到（你想让他问的）问题上。CMMI中编码测试不是编码测试人员的问题，团队成员间的工作都是有关联的。\n在团队中，你知道别人做的具体工作吗？你知道别人的工作对你的影响吗？你真的知道你负责工作的内容吗？\n\n## 代码是否可以共享?\n去年年底的时候，建行团要改版（代理商版）。\n具体的开发任务分配是：国栋负责平台后台、我负责分行后台、杨文涛负责商户后台。其中有一个功能模块：团购商品状态转换的, 平台、分行、商户后台都有涉及到，商户后台只有\"提交审核\"的操作，但分行后台和平台后台包括商品状态的所有操作。\n基本功能介绍如下：\n\n```\n商品状态：暂存、待审核、上架。\n相关操作有：提交审核、上架、下架、重新编辑。\n状态转换关系是：\n暂存\t\t－提交审核\t－>\t待审核\n待审核\t－上架\t    －>\t上架\n上架\t\t－下架       －>\t待审核\n待审核\t－重新编辑\t－> 暂存\n```\n我在任务确定后，就忙着做其它项目去了。我一回来，就code自已负责的代码去了。\n\n但问题来了,状态转换的操作我是通过商品状态机类ProductStateMachine实现的，其它地方要用的话直接调就行了，商户后台这边则是直接操作数据库。同样的功能，实现的方式不同，方法的命名不同，若不修改就会给后期的维护带来问题。\n\n为什么会出现此类的问题呢？任务确定之后，各人只埋头负责自己的部分，而完全不理会其他人的工作，只要功能实现了，其它的都是小问题。事实真的是这样吗？当别人提出你的功能有更好的实现方案时，所有人都会心甘情愿的修改自己\"辛辛苦苦\"写的代码吗？团队代码风格、方法命名等如何保持一致呢？…\n\n你也许会觉得责任在于分配任务的人，为什么分的任务会有交叉呢？但(1)是人总会犯点错;(2)这就好像项目的成败决定于分配任务的人一样，个人决定成败，而非整个团队。\n\t\n可以思考的问题：\n\n```\n(1)\t任务为什么要这么分？是不是可以做得更好？\n(2)\t代码是否可以共享?\n```\n\n# 员工、团队与成长\n新人进公司一年多来快速成长了吗?如果没成长，是招聘时看错人了吗？是员工的个人问题，还是公司或团队本身的问题？\n\n公司需要生存发展，员工需要更好的工资(尤其是物价在疯涨的时候)、更好的发展，公司与员工是互相博弈的过程。\n\n薪资不高、没有发展、没有成长，这不是在耽误人家的宝贵青春吗？\n\n```\n但公司的发展靠的是人啊？\n(1)\t好的氛围，才会引入、留住好的人。\n(2)\t好的人，才会有好的制度，并且保持好这个制度，毕竟制度是人定的。\n(3)\t好的人和好的制度，才会遇到好的客户。\n```\n\n是先有项目才有人，还是有了人，才会有项目？\n\n做项目是仅仅为了做项目吗？如何打造一个全面成功的项目？\n\n项目开发中，团队真的在成长吗？\n\n《走出软件作坊》 \t阿朱\n> 在项目管理中，我发现人是最重要的，但是很遗憾，总是能看到不少心胸狭窄、眼光短浅的老板，把员工当傻瓜，把客户当傻子。其实人对了，世界就对了。\n\n《从优秀到卓越》\t柯林斯\n> 实现跨越公司的领导者首先是设法得到合适的人才（不合适的下车），然后才决定将汽车开向何方。\n\t\n 五年思想工作者 梦想风暴\n> 去年带了一个项目，在那个项目里，我做了一个尝试。我把项目的目标订在了人才培养，而非传统意义的交付。于是，在这个过程中，我花了大量的精力去教新员工写代码，帮他们设定个人成长目标，教他们做事，带着他们吃好玩好……就是这样一个几乎都是由新ThoughtWorker——甚至大多是毕业生——组成的项目组，后来，这个项目成了Michael Chen口中最接近他心目中全面成功的项目。\n\n# 总结\n* 员工离职之后，知识、经验会留下来吗？\n* 团队中的知识在流通吗？\n* 项目中，团队成员在成长吗？团队在成长吗？团队会反思总结吗？\n* 除了员工自我驱动外，公司有为员工做过职业规划吗？\n* 团队怎样才能写出更好的代码(Beautiful Code)？\n\n----\n\n你需要什么样的团队?\n\n","slug":"team-thinking","published":1,"updated":"2017-01-26T15:32:35.000Z","comments":1,"photos":[],"link":"","_id":"ciyf7fka60008f2jyazcjyiqx","content":"<p>目录</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">1.\t团队思考</div><div class=\"line\"> 1.1.\ttoruk框架的启示</div><div class=\"line\"> 1.2.\thui99的问题</div><div class=\"line\"> 1.3.\tcmmi3评估中暴露的问题</div><div class=\"line\">  (1)\t杨ting在访谈前背&quot;答案&quot;时才知道OSSP是什么？</div><div class=\"line\">  (2)\t我们作为“编码测试”人员，在访谈时却被问了许多需求设计、配置、QA的问题，我们几个人都没回答上来。</div><div class=\"line\"> 1.4.\t代码是否可以共享?</div><div class=\"line\">2. 员工、团队与成长</div><div class=\"line\">3. 总结</div></pre></td></tr></table></figure>\n<h1 id=\"团队思考\"><a href=\"#团队思考\" class=\"headerlink\" title=\"团队思考\"></a>团队思考</h1><h2 id=\"toruk框架的启示\"><a href=\"#toruk框架的启示\" class=\"headerlink\" title=\"toruk框架的启示\"></a>toruk框架的启示</h2><p>toruk框架目标</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">a)\t相对于hui99使用的spring+ibatis2框架（或其它框架），使开发过程更加简单，提高效率;</div><div class=\"line\">b)\t使公司具有不可替代的元素。turuk便是其中之一。</div></pre></td></tr></table></figure>\n<p>(1)    如果想开发过程简单，是否有更好的开源框架(技术/方案)?<br>如使用spring3 REST风格，使用Spring的注释式编程！<br>(2)    如果非要开发toruk，是否数据库这块可重用ibatis2而不是重新造轮子？<br>(3)    部分项目已经使用了toruk框架，可能以后还有项目会用到。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">toruk的研发人员全部离职之后，toruk框架的理念、技术、知识、代码真的传下来了吗？</div><div class=\"line\">还有人非常了解toruk的源码吗？</div><div class=\"line\">还有人去主导toruk的研发吗？</div><div class=\"line\">toruk存在的bug，还会有人去fix吗?</div><div class=\"line\">toruk还会在公司存活多久呢？</div></pre></td></tr></table></figure>\n<p>(4)    toruk（或其它）的知识为什么没有完全成为公司的财产，而随着人员的流失而流失了？是什么原因造成了这些问题？</p>\n<h2 id=\"hui99的问题\"><a href=\"#hui99的问题\" class=\"headerlink\" title=\"hui99的问题\"></a>hui99的问题</h2><p>hui99有很多频道：机票、酒店、旅游、团购、租车、购物、电子优惠券、手机充值、社区等, 还有一个IVR系统在使用！去年年底的时候又加了一个分销商/积分系统上去。当初开发分配任务时，基本上都是每个频道由某个人单独负责的。从去年开始，陆续有人离职了，项目转由我整体负责了。但我对其它各频道业务不是很清楚，而相关负责的人已经离职，没有留下太多的文档（或文档已经过时），代码风格不一（包括缩进、代码的格式化都或多或少有点问题）、结构混乱,中间夹杂点小bug，也确实让人头痛。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">(1)\t“每个人按照频道划分开发任务”，这种任务分配的模式是否过时？</div><div class=\"line\">或者说每个频道的功能还可以分得细一点，然后团队一起开发。或每个频道进行交叉开发。</div><div class=\"line\">(2)\t开发过程中，团队间是否可以评审一下代码，而保持风格的一致性?</div><div class=\"line\">(3)\t同事离职了，你怎样才能更快的理解他的负责频道（或模块）业务和代码？</div></pre></td></tr></table></figure>\n<h2 id=\"cmmi3评估中暴露的问题\"><a href=\"#cmmi3评估中暴露的问题\" class=\"headerlink\" title=\"cmmi3评估中暴露的问题\"></a>cmmi3评估中暴露的问题</h2><p>公司今年过完年之后，确定实施CMMI3评审，而评审工作在4月份开始进行。两个月时间，四个项目(三个虚假项目),上千个文档需要准备。4月10多号开始背”答案”，4月22日开始访谈，我是作为”编码测试”人员进行访谈的。<br>    评审过程中，有两件事情让我印象比较深刻：</p>\n<h3 id=\"杨ting在访谈前背”答案”时才知道OSSP是什么？\"><a href=\"#杨ting在访谈前背”答案”时才知道OSSP是什么？\" class=\"headerlink\" title=\"杨ting在访谈前背”答案”时才知道OSSP是什么？\"></a>杨ting在访谈前背”答案”时才知道OSSP是什么？</h3><p>她已经写文档两个月了，所有的CMMI3的流程和文档都是根据OSSP来编写的。<br>这是谁的问题？个人问题？石老师(培训老师)的问题？CMMI负责人的问题？公司培训的问题？…<br>这到底是什么问题？如何去解决这个问题？</p>\n<h3 id=\"我们作为“编码测试”人员，在访谈时却被问了许多需求设计、配置、QA的问题，我们几个人都没回答上来。\"><a href=\"#我们作为“编码测试”人员，在访谈时却被问了许多需求设计、配置、QA的问题，我们几个人都没回答上来。\" class=\"headerlink\" title=\"我们作为“编码测试”人员，在访谈时却被问了许多需求设计、配置、QA的问题，我们几个人都没回答上来。\"></a>我们作为“编码测试”人员，在访谈时却被问了许多需求设计、配置、QA的问题，我们几个人都没回答上来。</h3><p>几天背”答案”下来没有什么效果，主任评估师都没问到（你想让他问的）问题上。CMMI中编码测试不是编码测试人员的问题，团队成员间的工作都是有关联的。<br>在团队中，你知道别人做的具体工作吗？你知道别人的工作对你的影响吗？你真的知道你负责工作的内容吗？</p>\n<h2 id=\"代码是否可以共享\"><a href=\"#代码是否可以共享\" class=\"headerlink\" title=\"代码是否可以共享?\"></a>代码是否可以共享?</h2><p>去年年底的时候，建行团要改版（代理商版）。<br>具体的开发任务分配是：国栋负责平台后台、我负责分行后台、杨文涛负责商户后台。其中有一个功能模块：团购商品状态转换的, 平台、分行、商户后台都有涉及到，商户后台只有”提交审核”的操作，但分行后台和平台后台包括商品状态的所有操作。<br>基本功能介绍如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">商品状态：暂存、待审核、上架。</div><div class=\"line\">相关操作有：提交审核、上架、下架、重新编辑。</div><div class=\"line\">状态转换关系是：</div><div class=\"line\">暂存\t\t－提交审核\t－&gt;\t待审核</div><div class=\"line\">待审核\t－上架\t    －&gt;\t上架</div><div class=\"line\">上架\t\t－下架       －&gt;\t待审核</div><div class=\"line\">待审核\t－重新编辑\t－&gt; 暂存</div></pre></td></tr></table></figure>\n<p>我在任务确定后，就忙着做其它项目去了。我一回来，就code自已负责的代码去了。</p>\n<p>但问题来了,状态转换的操作我是通过商品状态机类ProductStateMachine实现的，其它地方要用的话直接调就行了，商户后台这边则是直接操作数据库。同样的功能，实现的方式不同，方法的命名不同，若不修改就会给后期的维护带来问题。</p>\n<p>为什么会出现此类的问题呢？任务确定之后，各人只埋头负责自己的部分，而完全不理会其他人的工作，只要功能实现了，其它的都是小问题。事实真的是这样吗？当别人提出你的功能有更好的实现方案时，所有人都会心甘情愿的修改自己”辛辛苦苦”写的代码吗？团队代码风格、方法命名等如何保持一致呢？…</p>\n<p>你也许会觉得责任在于分配任务的人，为什么分的任务会有交叉呢？但(1)是人总会犯点错;(2)这就好像项目的成败决定于分配任务的人一样，个人决定成败，而非整个团队。</p>\n<p>可以思考的问题：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">(1)\t任务为什么要这么分？是不是可以做得更好？</div><div class=\"line\">(2)\t代码是否可以共享?</div></pre></td></tr></table></figure>\n<h1 id=\"员工、团队与成长\"><a href=\"#员工、团队与成长\" class=\"headerlink\" title=\"员工、团队与成长\"></a>员工、团队与成长</h1><p>新人进公司一年多来快速成长了吗?如果没成长，是招聘时看错人了吗？是员工的个人问题，还是公司或团队本身的问题？</p>\n<p>公司需要生存发展，员工需要更好的工资(尤其是物价在疯涨的时候)、更好的发展，公司与员工是互相博弈的过程。</p>\n<p>薪资不高、没有发展、没有成长，这不是在耽误人家的宝贵青春吗？</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">但公司的发展靠的是人啊？</div><div class=\"line\">(1)\t好的氛围，才会引入、留住好的人。</div><div class=\"line\">(2)\t好的人，才会有好的制度，并且保持好这个制度，毕竟制度是人定的。</div><div class=\"line\">(3)\t好的人和好的制度，才会遇到好的客户。</div></pre></td></tr></table></figure>\n<p>是先有项目才有人，还是有了人，才会有项目？</p>\n<p>做项目是仅仅为了做项目吗？如何打造一个全面成功的项目？</p>\n<p>项目开发中，团队真的在成长吗？</p>\n<p>《走出软件作坊》     阿朱</p>\n<blockquote>\n<p>在项目管理中，我发现人是最重要的，但是很遗憾，总是能看到不少心胸狭窄、眼光短浅的老板，把员工当傻瓜，把客户当傻子。其实人对了，世界就对了。</p>\n</blockquote>\n<p>《从优秀到卓越》    柯林斯</p>\n<blockquote>\n<p>实现跨越公司的领导者首先是设法得到合适的人才（不合适的下车），然后才决定将汽车开向何方。</p>\n</blockquote>\n<p> 五年思想工作者 梦想风暴</p>\n<blockquote>\n<p>去年带了一个项目，在那个项目里，我做了一个尝试。我把项目的目标订在了人才培养，而非传统意义的交付。于是，在这个过程中，我花了大量的精力去教新员工写代码，帮他们设定个人成长目标，教他们做事，带着他们吃好玩好……就是这样一个几乎都是由新ThoughtWorker——甚至大多是毕业生——组成的项目组，后来，这个项目成了Michael Chen口中最接近他心目中全面成功的项目。</p>\n</blockquote>\n<h1 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h1><ul>\n<li>员工离职之后，知识、经验会留下来吗？</li>\n<li>团队中的知识在流通吗？</li>\n<li>项目中，团队成员在成长吗？团队在成长吗？团队会反思总结吗？</li>\n<li>除了员工自我驱动外，公司有为员工做过职业规划吗？</li>\n<li>团队怎样才能写出更好的代码(Beautiful Code)？</li>\n</ul>\n<hr>\n<p>你需要什么样的团队?</p>\n","excerpt":"","more":"<p>目录</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">1.\t团队思考</div><div class=\"line\"> 1.1.\ttoruk框架的启示</div><div class=\"line\"> 1.2.\thui99的问题</div><div class=\"line\"> 1.3.\tcmmi3评估中暴露的问题</div><div class=\"line\">  (1)\t杨ting在访谈前背&quot;答案&quot;时才知道OSSP是什么？</div><div class=\"line\">  (2)\t我们作为“编码测试”人员，在访谈时却被问了许多需求设计、配置、QA的问题，我们几个人都没回答上来。</div><div class=\"line\"> 1.4.\t代码是否可以共享?</div><div class=\"line\">2. 员工、团队与成长</div><div class=\"line\">3. 总结</div></pre></td></tr></table></figure>\n<h1 id=\"团队思考\"><a href=\"#团队思考\" class=\"headerlink\" title=\"团队思考\"></a>团队思考</h1><h2 id=\"toruk框架的启示\"><a href=\"#toruk框架的启示\" class=\"headerlink\" title=\"toruk框架的启示\"></a>toruk框架的启示</h2><p>toruk框架目标</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">a)\t相对于hui99使用的spring+ibatis2框架（或其它框架），使开发过程更加简单，提高效率;</div><div class=\"line\">b)\t使公司具有不可替代的元素。turuk便是其中之一。</div></pre></td></tr></table></figure>\n<p>(1)    如果想开发过程简单，是否有更好的开源框架(技术/方案)?<br>如使用spring3 REST风格，使用Spring的注释式编程！<br>(2)    如果非要开发toruk，是否数据库这块可重用ibatis2而不是重新造轮子？<br>(3)    部分项目已经使用了toruk框架，可能以后还有项目会用到。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">toruk的研发人员全部离职之后，toruk框架的理念、技术、知识、代码真的传下来了吗？</div><div class=\"line\">还有人非常了解toruk的源码吗？</div><div class=\"line\">还有人去主导toruk的研发吗？</div><div class=\"line\">toruk存在的bug，还会有人去fix吗?</div><div class=\"line\">toruk还会在公司存活多久呢？</div></pre></td></tr></table></figure>\n<p>(4)    toruk（或其它）的知识为什么没有完全成为公司的财产，而随着人员的流失而流失了？是什么原因造成了这些问题？</p>\n<h2 id=\"hui99的问题\"><a href=\"#hui99的问题\" class=\"headerlink\" title=\"hui99的问题\"></a>hui99的问题</h2><p>hui99有很多频道：机票、酒店、旅游、团购、租车、购物、电子优惠券、手机充值、社区等, 还有一个IVR系统在使用！去年年底的时候又加了一个分销商/积分系统上去。当初开发分配任务时，基本上都是每个频道由某个人单独负责的。从去年开始，陆续有人离职了，项目转由我整体负责了。但我对其它各频道业务不是很清楚，而相关负责的人已经离职，没有留下太多的文档（或文档已经过时），代码风格不一（包括缩进、代码的格式化都或多或少有点问题）、结构混乱,中间夹杂点小bug，也确实让人头痛。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">(1)\t“每个人按照频道划分开发任务”，这种任务分配的模式是否过时？</div><div class=\"line\">或者说每个频道的功能还可以分得细一点，然后团队一起开发。或每个频道进行交叉开发。</div><div class=\"line\">(2)\t开发过程中，团队间是否可以评审一下代码，而保持风格的一致性?</div><div class=\"line\">(3)\t同事离职了，你怎样才能更快的理解他的负责频道（或模块）业务和代码？</div></pre></td></tr></table></figure>\n<h2 id=\"cmmi3评估中暴露的问题\"><a href=\"#cmmi3评估中暴露的问题\" class=\"headerlink\" title=\"cmmi3评估中暴露的问题\"></a>cmmi3评估中暴露的问题</h2><p>公司今年过完年之后，确定实施CMMI3评审，而评审工作在4月份开始进行。两个月时间，四个项目(三个虚假项目),上千个文档需要准备。4月10多号开始背”答案”，4月22日开始访谈，我是作为”编码测试”人员进行访谈的。<br>    评审过程中，有两件事情让我印象比较深刻：</p>\n<h3 id=\"杨ting在访谈前背”答案”时才知道OSSP是什么？\"><a href=\"#杨ting在访谈前背”答案”时才知道OSSP是什么？\" class=\"headerlink\" title=\"杨ting在访谈前背”答案”时才知道OSSP是什么？\"></a>杨ting在访谈前背”答案”时才知道OSSP是什么？</h3><p>她已经写文档两个月了，所有的CMMI3的流程和文档都是根据OSSP来编写的。<br>这是谁的问题？个人问题？石老师(培训老师)的问题？CMMI负责人的问题？公司培训的问题？…<br>这到底是什么问题？如何去解决这个问题？</p>\n<h3 id=\"我们作为“编码测试”人员，在访谈时却被问了许多需求设计、配置、QA的问题，我们几个人都没回答上来。\"><a href=\"#我们作为“编码测试”人员，在访谈时却被问了许多需求设计、配置、QA的问题，我们几个人都没回答上来。\" class=\"headerlink\" title=\"我们作为“编码测试”人员，在访谈时却被问了许多需求设计、配置、QA的问题，我们几个人都没回答上来。\"></a>我们作为“编码测试”人员，在访谈时却被问了许多需求设计、配置、QA的问题，我们几个人都没回答上来。</h3><p>几天背”答案”下来没有什么效果，主任评估师都没问到（你想让他问的）问题上。CMMI中编码测试不是编码测试人员的问题，团队成员间的工作都是有关联的。<br>在团队中，你知道别人做的具体工作吗？你知道别人的工作对你的影响吗？你真的知道你负责工作的内容吗？</p>\n<h2 id=\"代码是否可以共享\"><a href=\"#代码是否可以共享\" class=\"headerlink\" title=\"代码是否可以共享?\"></a>代码是否可以共享?</h2><p>去年年底的时候，建行团要改版（代理商版）。<br>具体的开发任务分配是：国栋负责平台后台、我负责分行后台、杨文涛负责商户后台。其中有一个功能模块：团购商品状态转换的, 平台、分行、商户后台都有涉及到，商户后台只有”提交审核”的操作，但分行后台和平台后台包括商品状态的所有操作。<br>基本功能介绍如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">商品状态：暂存、待审核、上架。</div><div class=\"line\">相关操作有：提交审核、上架、下架、重新编辑。</div><div class=\"line\">状态转换关系是：</div><div class=\"line\">暂存\t\t－提交审核\t－&gt;\t待审核</div><div class=\"line\">待审核\t－上架\t    －&gt;\t上架</div><div class=\"line\">上架\t\t－下架       －&gt;\t待审核</div><div class=\"line\">待审核\t－重新编辑\t－&gt; 暂存</div></pre></td></tr></table></figure>\n<p>我在任务确定后，就忙着做其它项目去了。我一回来，就code自已负责的代码去了。</p>\n<p>但问题来了,状态转换的操作我是通过商品状态机类ProductStateMachine实现的，其它地方要用的话直接调就行了，商户后台这边则是直接操作数据库。同样的功能，实现的方式不同，方法的命名不同，若不修改就会给后期的维护带来问题。</p>\n<p>为什么会出现此类的问题呢？任务确定之后，各人只埋头负责自己的部分，而完全不理会其他人的工作，只要功能实现了，其它的都是小问题。事实真的是这样吗？当别人提出你的功能有更好的实现方案时，所有人都会心甘情愿的修改自己”辛辛苦苦”写的代码吗？团队代码风格、方法命名等如何保持一致呢？…</p>\n<p>你也许会觉得责任在于分配任务的人，为什么分的任务会有交叉呢？但(1)是人总会犯点错;(2)这就好像项目的成败决定于分配任务的人一样，个人决定成败，而非整个团队。</p>\n<p>可以思考的问题：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">(1)\t任务为什么要这么分？是不是可以做得更好？</div><div class=\"line\">(2)\t代码是否可以共享?</div></pre></td></tr></table></figure>\n<h1 id=\"员工、团队与成长\"><a href=\"#员工、团队与成长\" class=\"headerlink\" title=\"员工、团队与成长\"></a>员工、团队与成长</h1><p>新人进公司一年多来快速成长了吗?如果没成长，是招聘时看错人了吗？是员工的个人问题，还是公司或团队本身的问题？</p>\n<p>公司需要生存发展，员工需要更好的工资(尤其是物价在疯涨的时候)、更好的发展，公司与员工是互相博弈的过程。</p>\n<p>薪资不高、没有发展、没有成长，这不是在耽误人家的宝贵青春吗？</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">但公司的发展靠的是人啊？</div><div class=\"line\">(1)\t好的氛围，才会引入、留住好的人。</div><div class=\"line\">(2)\t好的人，才会有好的制度，并且保持好这个制度，毕竟制度是人定的。</div><div class=\"line\">(3)\t好的人和好的制度，才会遇到好的客户。</div></pre></td></tr></table></figure>\n<p>是先有项目才有人，还是有了人，才会有项目？</p>\n<p>做项目是仅仅为了做项目吗？如何打造一个全面成功的项目？</p>\n<p>项目开发中，团队真的在成长吗？</p>\n<p>《走出软件作坊》     阿朱</p>\n<blockquote>\n<p>在项目管理中，我发现人是最重要的，但是很遗憾，总是能看到不少心胸狭窄、眼光短浅的老板，把员工当傻瓜，把客户当傻子。其实人对了，世界就对了。</p>\n</blockquote>\n<p>《从优秀到卓越》    柯林斯</p>\n<blockquote>\n<p>实现跨越公司的领导者首先是设法得到合适的人才（不合适的下车），然后才决定将汽车开向何方。</p>\n</blockquote>\n<p> 五年思想工作者 梦想风暴</p>\n<blockquote>\n<p>去年带了一个项目，在那个项目里，我做了一个尝试。我把项目的目标订在了人才培养，而非传统意义的交付。于是，在这个过程中，我花了大量的精力去教新员工写代码，帮他们设定个人成长目标，教他们做事，带着他们吃好玩好……就是这样一个几乎都是由新ThoughtWorker——甚至大多是毕业生——组成的项目组，后来，这个项目成了Michael Chen口中最接近他心目中全面成功的项目。</p>\n</blockquote>\n<h1 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h1><ul>\n<li>员工离职之后，知识、经验会留下来吗？</li>\n<li>团队中的知识在流通吗？</li>\n<li>项目中，团队成员在成长吗？团队在成长吗？团队会反思总结吗？</li>\n<li>除了员工自我驱动外，公司有为员工做过职业规划吗？</li>\n<li>团队怎样才能写出更好的代码(Beautiful Code)？</li>\n</ul>\n<hr>\n<p>你需要什么样的团队?</p>\n"},{"layout":"post","title":"基于左右值的无限级分类算法-oracle实现04","date":"2012-03-26T02:29:00.000Z","comments":1,"_content":"<!--more-->\n本文参考了：\nMike Hillyer的《Managing Hierarchical Data in MySQL》\n及Yimin的翻译版《MYSQL中分层数据的管理》\n\n#8.新增节点\n到现在，我们已经知道了如何去查询我们的树，是时候去关注一下如何增加一个新节点来更\n新我们的树了。让我们再一次观察一下我们的嵌套集合图：\n\n![Alt text](/images/2012/oracle-04-1.jpg)\n\n\n当我们想要在TELEVISIONS和PORTABLE ELECTRONICS节点之间新增一个节点，新节点的lft和rgt 的 值为10和11，所有该节点的右边节点的lft和rgt值都将加2，之后我们再添加新节点并赋相应的lft和rgt值。在MySQL 5中可以使用存储过程来完成，我假设当前大部分读者使用的是MySQL 4.1版本，因为这是最新的稳定版本。所以，我使用了锁表（LOCKTABLES）语句来隔离查询：\n\n``` sql\n--增加平行节点\nprocedure add_node(\n  cname nested_category.name%type,\n  add_name nested_category.name%type\n)\nis\n  myRight nested_category.rgt%type ;        \nBEGIN\n  SELECT rgt into myRight FROM nested_category WHERE name = cname;\n  UPDATE nested_category SET rgt = rgt + 2 WHERE rgt > myRight;\n  UPDATE nested_category SET lft = lft + 2 WHERE lft > myRight;\n  INSERT INTO nested_category(CATEGORY_ID,name, lft, rgt) VALUES(SEQ_CATEGORY.nextval,add_name, myRight + 1, myRight + 2); \n  commit; \nexception\n    when others then\n    rollback;  \nend;\n```\n \n``` sql\nEXECUTE pkg_category.add_node('TELEVISIONS','GAME CONSOLES');\n```\n\n我们可以检验一下新节点插入的正确性：\n\n``` sql\nSELECT  lpad( '+',  (COUNT(parent.name)-1),'+')||node.name name\nFROM nested_category node, nested_category  parent\nWHERE node.lft BETWEEN parent.lft AND parent.rgt\nGROUP BY node.name,node.lft\nORDER BY node.lft;\n```\n\n输出结果\n\n```\nNAME\n----------------------------------\nELECTRONICS\n+TELEVISIONS\n++TUBE\n++LCD\n++PLASMA\n+GAME CONSOLES\n+PORTABLE ELECTRONICS\n++MP3 PLAYERS\n+++FLASH\n++CD PLAYERS\n++2 WAY RADIOS\n```\n\n如果我们想要在叶子节点下增加节点，我们得稍微修改一下查询语句。让我们在2 WAY RADIOS叶子节点下添加FRS节点吧：\n\n```sql\n--在叶子节点下增加节点\nprocedure add_child_node(\n  cname nested_category.name%type,\n  add_name nested_category.name%type\n)\nis\n  myLeft nested_category.lft%type ;       \nBEGIN\n  SELECT lft into myLeft FROM nested_category WHERE name = cname;\n  UPDATE nested_category SET rgt = rgt + 2 WHERE rgt > myLeft;\n  UPDATE nested_category SET lft = lft + 2 WHERE lft > myLeft;\n  INSERT INTO nested_category(CATEGORY_ID, name, lft, rgt) VALUES(SEQ_CATEGORY.nextval, add_name, myLeft + 1, myLeft + 2);\n  commit;\nexception\n    when others then\n    rollback; \nend;\n\n\nEXECUTE pkg_category.add_child_node('2 WAY RADIOS','FRS');\n\n\nSELECT  lpad( '+',  (COUNT(parent.name)-1),'+')||node.name name\nFROM nested_category node, nested_category  parent\nWHERE node.lft BETWEEN parent.lft AND parent.rgt\nGROUP BY node.name,node.lft\nORDER BY node.lft;\n```\n\n输出结果\n\n```\nNAME\n----------------------------------\nELECTRONICS\n+TELEVISIONS\n++TUBE\n++LCD\n++PLASMA\n+GAME CONSOLES\n+PORTABLE ELECTRONICS\n++MP3 PLAYERS\n+++FLASH\n++CD PLAYERS\n++2 WAY RADIOS\n+++FRS\n```\n\n在这个例子中，我们扩大了新产生的父节点(2 WAY RADIOS节点）的右值及其所有它的右边节点的左右值，之后置新增节点于新父节点之下。正如你所看到的，我们新增的节点已经完全融入了嵌套集合中：\n\n#9.删除节点\n\n最后还有个基础任务，删除节点。删除节点的处理过程跟节点在分层数据中所处的位置有关，删除一个叶子节点比删除一个子节点要简单得多，因为删除子节点的时候，我们需要去处理孤立节点。 \n  \n删除一个叶子节点的过程正好是新增一个叶子节点的逆过程，我们在删除节点的同时该节点右边所有节点的左右值和该父节点的右值都会减去该节点的宽度值2：\n\n```sql\n--删除叶子节点\nprocedure delete_leaf_node(leaf_name nested_category.name%type)\nis\n  myLeft nested_category.lft%type ;  \n  myRight nested_category.rgt%type ;  \n  myWidth integer ;  \nBEGIN\n    SELECT  lft , rgt , (rgt - lft+ 1) into   myLeft , myRight, myWidth  FROM nested_category\n    WHERE name = leaf_name;\n\n    DELETE FROM nested_category WHERE lft BETWEEN  myLeft AND  myRight;\n    UPDATE nested_category SET rgt = rgt - myWidth WHERE rgt >  myRight;\n    UPDATE nested_category SET lft = lft - myWidth WHERE lft >  myRight;\n    commit;\nexception\n    when others then\n    rollback;   \nend;\n\n--我们再一次检验一下节点已经成功删除,而且没有打乱数据的层次：\nEXECUTE pkg_category.delete_leaf_node('GAME CONSOLES');\n\nSELECT  lpad( '+',  (COUNT(parent.name)-1),'+')||node.name name\nFROM nested_category node, nested_category  parent\nWHERE node.lft BETWEEN parent.lft AND parent.rgt\nGROUP BY node.name,node.lft\nORDER BY node.lft;\n```\n\n输出结果\n\n```\nNAME\n--------------------------------------------------------------------------------\nELECTRONICS\n+TELEVISIONS\n++TUBE\n++LCD\n++PLASMA\n+PORTABLE ELECTRONICS\n++MP3 PLAYERS\n+++FLASH\n++CD PLAYERS\n++2 WAY RADIOS\n+++FRS\n```\n这个方法可以完美地删除节点及其子节点：\n\n\tEXECUTE pkg_category.delete_leaf_node('MP3 PLAYERS');\n\t\n再次验证我们已经成功的删除了一棵子树：\n\n```\nNAME\n---------------------------- \nELECTRONICS\n+TELEVISIONS\n++TUBE\n++LCD\n++PLASMA\n+PORTABLE ELECTRONICS\n++CD PLAYERS\n++2 WAY RADIOS\n+++FRS\n```\n\n有时，我们只删除该节点，而不删除该节点的子节点。在一些情况下，你希望改变其名字为占位符，直到替代名字的出现，比如你开除了一个主管（需要更换主管）。在另外一些情况下，你希望子节点挂到该删除节点的父节点下：\n\n```sql\n--删除该节点，而不删除该节点的子节点\nprocedure delete_node_only(node_name nested_category.name%type)\nis\n  myLeft nested_category.lft%type ;  \n  myRight nested_category.rgt%type ;  \n  myWidth integer ;  \nBEGIN\n    SELECT  lft , rgt , (rgt - lft+ 1) into   myLeft , myRight, myWidth  FROM nested_category\n    WHERE name = node_name;\n\n    DELETE FROM nested_category WHERE lft = myLeft;\n    UPDATE nested_category SET rgt = rgt - 1, lft = lft - 1 WHERE lft BETWEEN  myLeft AND  myRight;\n    UPDATE nested_category SET rgt = rgt - 2 WHERE rgt >  myRight;\n    UPDATE nested_category SET lft = lft - 2 WHERE lft >  myRight;\n    commit;\nexception\n    when others then\n    rollback;\nend;\n```\n\n\n在这个例子中，我们对该节点所有右边节点的左右值都减去了2（因为不考虑其子节点，该节点的宽度为2），对该节点的子节点的左右值都减去了1（弥补由于失去父节点的左值造成的裂缝）。我们再一次确认，那些节点是否都晋升了：\n\n```sql\nEXECUTE pkg_category.delete_node_only('PORTABLE ELECTRONICS');\n\nSELECT  lpad( '+',  (COUNT(parent.name)-1),'+')||node.name name\nFROM nested_category node, nested_category  parent\nWHERE node.lft BETWEEN parent.lft AND parent.rgt\nGROUP BY node.name,node.lft\nORDER BY node.lft;\n```\n\n输出结果  \n\n```\nNAME\n--------------------- \nELECTRONICS\n+TELEVISIONS\n++TUBE\n++LCD\n++PLASMA\n+CD PLAYERS\n+2 WAY RADIOS\n++FRS\n\n8 rows selected\n```\n\n有时，当删除节点的时候，把该节点的一个子节点挂载到该节点的父节点下，而其他节点挂到该节点父节点的兄弟节点下，考虑到篇幅这种情况不在这里解说了。\n\n#10.相关包sql\n\n```sql\ncreate or replace package pkg_category  is\n--增加平行节点 \nprocedure add_node(\n  cname nested_category.name%type,\n  add_name nested_category.name%type\n);\n\n--在叶子节点下增加节点\nprocedure add_child_node(\n  cname nested_category.name%type,\n  add_name nested_category.name%type\n);\n\n--删除叶子节点\nprocedure delete_leaf_node(leaf_name nested_category.name%type);\n\n--删除该节点，而不删除该节点的子节点\nprocedure delete_node_only(node_name nested_category.name%type);\n\nend pkg_category;\n```\n\n\n```sql\ncreate or replace package body pkg_category is\n\n--增加平行节点\nprocedure add_node(\n  cname nested_category.name%type,\n  add_name nested_category.name%type\n)\nis\n  myRight nested_category.rgt%type ;        \nBEGIN\n  SELECT rgt into myRight FROM nested_category WHERE name = cname;\n  UPDATE nested_category SET rgt = rgt + 2 WHERE rgt > myRight;\n  UPDATE nested_category SET lft = lft + 2 WHERE lft > myRight;\n  INSERT INTO nested_category(CATEGORY_ID,name, lft, rgt) VALUES(SEQ_CATEGORY.nextval,add_name, myRight + 1, myRight + 2); \n  commit; \nexception\n    when others then\n    rollback;  \nend;\n\n--在叶子节点下增加节点\nprocedure add_child_node(\n  cname nested_category.name%type,\n  add_name nested_category.name%type\n)\nis\n  myLeft nested_category.lft%type ;        \nBEGIN\n  SELECT lft into myLeft FROM nested_category WHERE name = cname;\n  UPDATE nested_category SET rgt = rgt + 2 WHERE rgt > myLeft;\n  UPDATE nested_category SET lft = lft + 2 WHERE lft > myLeft;\n  INSERT INTO nested_category(CATEGORY_ID, name, lft, rgt) VALUES(SEQ_CATEGORY.nextval, add_name, myLeft + 1, myLeft + 2);\n  commit; \nexception\n    when others then\n    rollback;  \nend;\n \n\n--删除叶子节点\nprocedure delete_leaf_node(leaf_name nested_category.name%type) \nis\n  myLeft nested_category.lft%type ;   \n  myRight nested_category.rgt%type ;   \n  myWidth integer ;   \nBEGIN\n    SELECT  lft , rgt , (rgt - lft+ 1) into   myLeft , myRight, myWidth  FROM nested_category \n    WHERE name = leaf_name;\n\n    DELETE FROM nested_category WHERE lft BETWEEN  myLeft AND  myRight;\n    UPDATE nested_category SET rgt = rgt - myWidth WHERE rgt >  myRight;\n    UPDATE nested_category SET lft = lft - myWidth WHERE lft >  myRight;\n    commit; \nexception\n    when others then\n    rollback;    \nend;\n\n--删除该节点，而不删除该节点的子节点\nprocedure delete_node_only(node_name nested_category.name%type)\nis\n  myLeft nested_category.lft%type ;   \n  myRight nested_category.rgt%type ;   \n  myWidth integer ;   \nBEGIN\n    SELECT  lft , rgt , (rgt - lft+ 1) into   myLeft , myRight, myWidth  FROM nested_category \n    WHERE name = node_name;\n\n    DELETE FROM nested_category WHERE lft = myLeft;\n    UPDATE nested_category SET rgt = rgt - 1, lft = lft - 1 WHERE lft BETWEEN  myLeft AND  myRight;\n    UPDATE nested_category SET rgt = rgt - 2 WHERE rgt >  myRight;\n    UPDATE nested_category SET lft = lft - 2 WHERE lft >  myRight;\n    commit; \nexception\n    when others then\n    rollback;\nend;\n\nend pkg_category;\n```\n\n\n","source":"_posts/2012-03-26-managing-hierarchical-data-in-oracle-4.md","raw":"---\nlayout: post\ntitle: \"基于左右值的无限级分类算法-oracle实现04\"\ndate: 2012-03-26 10:29\ncomments: true\ncategories: oralce\n---\n<!--more-->\n本文参考了：\nMike Hillyer的《Managing Hierarchical Data in MySQL》\n及Yimin的翻译版《MYSQL中分层数据的管理》\n\n#8.新增节点\n到现在，我们已经知道了如何去查询我们的树，是时候去关注一下如何增加一个新节点来更\n新我们的树了。让我们再一次观察一下我们的嵌套集合图：\n\n![Alt text](/images/2012/oracle-04-1.jpg)\n\n\n当我们想要在TELEVISIONS和PORTABLE ELECTRONICS节点之间新增一个节点，新节点的lft和rgt 的 值为10和11，所有该节点的右边节点的lft和rgt值都将加2，之后我们再添加新节点并赋相应的lft和rgt值。在MySQL 5中可以使用存储过程来完成，我假设当前大部分读者使用的是MySQL 4.1版本，因为这是最新的稳定版本。所以，我使用了锁表（LOCKTABLES）语句来隔离查询：\n\n``` sql\n--增加平行节点\nprocedure add_node(\n  cname nested_category.name%type,\n  add_name nested_category.name%type\n)\nis\n  myRight nested_category.rgt%type ;        \nBEGIN\n  SELECT rgt into myRight FROM nested_category WHERE name = cname;\n  UPDATE nested_category SET rgt = rgt + 2 WHERE rgt > myRight;\n  UPDATE nested_category SET lft = lft + 2 WHERE lft > myRight;\n  INSERT INTO nested_category(CATEGORY_ID,name, lft, rgt) VALUES(SEQ_CATEGORY.nextval,add_name, myRight + 1, myRight + 2); \n  commit; \nexception\n    when others then\n    rollback;  \nend;\n```\n \n``` sql\nEXECUTE pkg_category.add_node('TELEVISIONS','GAME CONSOLES');\n```\n\n我们可以检验一下新节点插入的正确性：\n\n``` sql\nSELECT  lpad( '+',  (COUNT(parent.name)-1),'+')||node.name name\nFROM nested_category node, nested_category  parent\nWHERE node.lft BETWEEN parent.lft AND parent.rgt\nGROUP BY node.name,node.lft\nORDER BY node.lft;\n```\n\n输出结果\n\n```\nNAME\n----------------------------------\nELECTRONICS\n+TELEVISIONS\n++TUBE\n++LCD\n++PLASMA\n+GAME CONSOLES\n+PORTABLE ELECTRONICS\n++MP3 PLAYERS\n+++FLASH\n++CD PLAYERS\n++2 WAY RADIOS\n```\n\n如果我们想要在叶子节点下增加节点，我们得稍微修改一下查询语句。让我们在2 WAY RADIOS叶子节点下添加FRS节点吧：\n\n```sql\n--在叶子节点下增加节点\nprocedure add_child_node(\n  cname nested_category.name%type,\n  add_name nested_category.name%type\n)\nis\n  myLeft nested_category.lft%type ;       \nBEGIN\n  SELECT lft into myLeft FROM nested_category WHERE name = cname;\n  UPDATE nested_category SET rgt = rgt + 2 WHERE rgt > myLeft;\n  UPDATE nested_category SET lft = lft + 2 WHERE lft > myLeft;\n  INSERT INTO nested_category(CATEGORY_ID, name, lft, rgt) VALUES(SEQ_CATEGORY.nextval, add_name, myLeft + 1, myLeft + 2);\n  commit;\nexception\n    when others then\n    rollback; \nend;\n\n\nEXECUTE pkg_category.add_child_node('2 WAY RADIOS','FRS');\n\n\nSELECT  lpad( '+',  (COUNT(parent.name)-1),'+')||node.name name\nFROM nested_category node, nested_category  parent\nWHERE node.lft BETWEEN parent.lft AND parent.rgt\nGROUP BY node.name,node.lft\nORDER BY node.lft;\n```\n\n输出结果\n\n```\nNAME\n----------------------------------\nELECTRONICS\n+TELEVISIONS\n++TUBE\n++LCD\n++PLASMA\n+GAME CONSOLES\n+PORTABLE ELECTRONICS\n++MP3 PLAYERS\n+++FLASH\n++CD PLAYERS\n++2 WAY RADIOS\n+++FRS\n```\n\n在这个例子中，我们扩大了新产生的父节点(2 WAY RADIOS节点）的右值及其所有它的右边节点的左右值，之后置新增节点于新父节点之下。正如你所看到的，我们新增的节点已经完全融入了嵌套集合中：\n\n#9.删除节点\n\n最后还有个基础任务，删除节点。删除节点的处理过程跟节点在分层数据中所处的位置有关，删除一个叶子节点比删除一个子节点要简单得多，因为删除子节点的时候，我们需要去处理孤立节点。 \n  \n删除一个叶子节点的过程正好是新增一个叶子节点的逆过程，我们在删除节点的同时该节点右边所有节点的左右值和该父节点的右值都会减去该节点的宽度值2：\n\n```sql\n--删除叶子节点\nprocedure delete_leaf_node(leaf_name nested_category.name%type)\nis\n  myLeft nested_category.lft%type ;  \n  myRight nested_category.rgt%type ;  \n  myWidth integer ;  \nBEGIN\n    SELECT  lft , rgt , (rgt - lft+ 1) into   myLeft , myRight, myWidth  FROM nested_category\n    WHERE name = leaf_name;\n\n    DELETE FROM nested_category WHERE lft BETWEEN  myLeft AND  myRight;\n    UPDATE nested_category SET rgt = rgt - myWidth WHERE rgt >  myRight;\n    UPDATE nested_category SET lft = lft - myWidth WHERE lft >  myRight;\n    commit;\nexception\n    when others then\n    rollback;   \nend;\n\n--我们再一次检验一下节点已经成功删除,而且没有打乱数据的层次：\nEXECUTE pkg_category.delete_leaf_node('GAME CONSOLES');\n\nSELECT  lpad( '+',  (COUNT(parent.name)-1),'+')||node.name name\nFROM nested_category node, nested_category  parent\nWHERE node.lft BETWEEN parent.lft AND parent.rgt\nGROUP BY node.name,node.lft\nORDER BY node.lft;\n```\n\n输出结果\n\n```\nNAME\n--------------------------------------------------------------------------------\nELECTRONICS\n+TELEVISIONS\n++TUBE\n++LCD\n++PLASMA\n+PORTABLE ELECTRONICS\n++MP3 PLAYERS\n+++FLASH\n++CD PLAYERS\n++2 WAY RADIOS\n+++FRS\n```\n这个方法可以完美地删除节点及其子节点：\n\n\tEXECUTE pkg_category.delete_leaf_node('MP3 PLAYERS');\n\t\n再次验证我们已经成功的删除了一棵子树：\n\n```\nNAME\n---------------------------- \nELECTRONICS\n+TELEVISIONS\n++TUBE\n++LCD\n++PLASMA\n+PORTABLE ELECTRONICS\n++CD PLAYERS\n++2 WAY RADIOS\n+++FRS\n```\n\n有时，我们只删除该节点，而不删除该节点的子节点。在一些情况下，你希望改变其名字为占位符，直到替代名字的出现，比如你开除了一个主管（需要更换主管）。在另外一些情况下，你希望子节点挂到该删除节点的父节点下：\n\n```sql\n--删除该节点，而不删除该节点的子节点\nprocedure delete_node_only(node_name nested_category.name%type)\nis\n  myLeft nested_category.lft%type ;  \n  myRight nested_category.rgt%type ;  \n  myWidth integer ;  \nBEGIN\n    SELECT  lft , rgt , (rgt - lft+ 1) into   myLeft , myRight, myWidth  FROM nested_category\n    WHERE name = node_name;\n\n    DELETE FROM nested_category WHERE lft = myLeft;\n    UPDATE nested_category SET rgt = rgt - 1, lft = lft - 1 WHERE lft BETWEEN  myLeft AND  myRight;\n    UPDATE nested_category SET rgt = rgt - 2 WHERE rgt >  myRight;\n    UPDATE nested_category SET lft = lft - 2 WHERE lft >  myRight;\n    commit;\nexception\n    when others then\n    rollback;\nend;\n```\n\n\n在这个例子中，我们对该节点所有右边节点的左右值都减去了2（因为不考虑其子节点，该节点的宽度为2），对该节点的子节点的左右值都减去了1（弥补由于失去父节点的左值造成的裂缝）。我们再一次确认，那些节点是否都晋升了：\n\n```sql\nEXECUTE pkg_category.delete_node_only('PORTABLE ELECTRONICS');\n\nSELECT  lpad( '+',  (COUNT(parent.name)-1),'+')||node.name name\nFROM nested_category node, nested_category  parent\nWHERE node.lft BETWEEN parent.lft AND parent.rgt\nGROUP BY node.name,node.lft\nORDER BY node.lft;\n```\n\n输出结果  \n\n```\nNAME\n--------------------- \nELECTRONICS\n+TELEVISIONS\n++TUBE\n++LCD\n++PLASMA\n+CD PLAYERS\n+2 WAY RADIOS\n++FRS\n\n8 rows selected\n```\n\n有时，当删除节点的时候，把该节点的一个子节点挂载到该节点的父节点下，而其他节点挂到该节点父节点的兄弟节点下，考虑到篇幅这种情况不在这里解说了。\n\n#10.相关包sql\n\n```sql\ncreate or replace package pkg_category  is\n--增加平行节点 \nprocedure add_node(\n  cname nested_category.name%type,\n  add_name nested_category.name%type\n);\n\n--在叶子节点下增加节点\nprocedure add_child_node(\n  cname nested_category.name%type,\n  add_name nested_category.name%type\n);\n\n--删除叶子节点\nprocedure delete_leaf_node(leaf_name nested_category.name%type);\n\n--删除该节点，而不删除该节点的子节点\nprocedure delete_node_only(node_name nested_category.name%type);\n\nend pkg_category;\n```\n\n\n```sql\ncreate or replace package body pkg_category is\n\n--增加平行节点\nprocedure add_node(\n  cname nested_category.name%type,\n  add_name nested_category.name%type\n)\nis\n  myRight nested_category.rgt%type ;        \nBEGIN\n  SELECT rgt into myRight FROM nested_category WHERE name = cname;\n  UPDATE nested_category SET rgt = rgt + 2 WHERE rgt > myRight;\n  UPDATE nested_category SET lft = lft + 2 WHERE lft > myRight;\n  INSERT INTO nested_category(CATEGORY_ID,name, lft, rgt) VALUES(SEQ_CATEGORY.nextval,add_name, myRight + 1, myRight + 2); \n  commit; \nexception\n    when others then\n    rollback;  \nend;\n\n--在叶子节点下增加节点\nprocedure add_child_node(\n  cname nested_category.name%type,\n  add_name nested_category.name%type\n)\nis\n  myLeft nested_category.lft%type ;        \nBEGIN\n  SELECT lft into myLeft FROM nested_category WHERE name = cname;\n  UPDATE nested_category SET rgt = rgt + 2 WHERE rgt > myLeft;\n  UPDATE nested_category SET lft = lft + 2 WHERE lft > myLeft;\n  INSERT INTO nested_category(CATEGORY_ID, name, lft, rgt) VALUES(SEQ_CATEGORY.nextval, add_name, myLeft + 1, myLeft + 2);\n  commit; \nexception\n    when others then\n    rollback;  \nend;\n \n\n--删除叶子节点\nprocedure delete_leaf_node(leaf_name nested_category.name%type) \nis\n  myLeft nested_category.lft%type ;   \n  myRight nested_category.rgt%type ;   \n  myWidth integer ;   \nBEGIN\n    SELECT  lft , rgt , (rgt - lft+ 1) into   myLeft , myRight, myWidth  FROM nested_category \n    WHERE name = leaf_name;\n\n    DELETE FROM nested_category WHERE lft BETWEEN  myLeft AND  myRight;\n    UPDATE nested_category SET rgt = rgt - myWidth WHERE rgt >  myRight;\n    UPDATE nested_category SET lft = lft - myWidth WHERE lft >  myRight;\n    commit; \nexception\n    when others then\n    rollback;    \nend;\n\n--删除该节点，而不删除该节点的子节点\nprocedure delete_node_only(node_name nested_category.name%type)\nis\n  myLeft nested_category.lft%type ;   \n  myRight nested_category.rgt%type ;   \n  myWidth integer ;   \nBEGIN\n    SELECT  lft , rgt , (rgt - lft+ 1) into   myLeft , myRight, myWidth  FROM nested_category \n    WHERE name = node_name;\n\n    DELETE FROM nested_category WHERE lft = myLeft;\n    UPDATE nested_category SET rgt = rgt - 1, lft = lft - 1 WHERE lft BETWEEN  myLeft AND  myRight;\n    UPDATE nested_category SET rgt = rgt - 2 WHERE rgt >  myRight;\n    UPDATE nested_category SET lft = lft - 2 WHERE lft >  myRight;\n    commit; \nexception\n    when others then\n    rollback;\nend;\n\nend pkg_category;\n```\n\n\n","slug":"managing-hierarchical-data-in-oracle-4","published":1,"updated":"2017-01-27T01:34:43.000Z","photos":[],"link":"","_id":"ciyf7fkaa000af2jyzon67xb7","content":"<a id=\"more\"></a>\n<p>本文参考了：<br>Mike Hillyer的《Managing Hierarchical Data in MySQL》<br>及Yimin的翻译版《MYSQL中分层数据的管理》</p>\n<p>#8.新增节点<br>到现在，我们已经知道了如何去查询我们的树，是时候去关注一下如何增加一个新节点来更<br>新我们的树了。让我们再一次观察一下我们的嵌套集合图：</p>\n<p><img src=\"/images/2012/oracle-04-1.jpg\" alt=\"Alt text\"></p>\n<p>当我们想要在TELEVISIONS和PORTABLE ELECTRONICS节点之间新增一个节点，新节点的lft和rgt 的 值为10和11，所有该节点的右边节点的lft和rgt值都将加2，之后我们再添加新节点并赋相应的lft和rgt值。在MySQL 5中可以使用存储过程来完成，我假设当前大部分读者使用的是MySQL 4.1版本，因为这是最新的稳定版本。所以，我使用了锁表（LOCKTABLES）语句来隔离查询：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">--增加平行节点</span></div><div class=\"line\">procedure add_node(</div><div class=\"line\">  cname nested_category.name%type,</div><div class=\"line\">  add_name nested_category.name%type</div><div class=\"line\">)</div><div class=\"line\">is</div><div class=\"line\">  myRight nested_category.rgt%type ;        </div><div class=\"line\"><span class=\"keyword\">BEGIN</span></div><div class=\"line\">  <span class=\"keyword\">SELECT</span> rgt <span class=\"keyword\">into</span> myRight <span class=\"keyword\">FROM</span> nested_category <span class=\"keyword\">WHERE</span> <span class=\"keyword\">name</span> = cname;</div><div class=\"line\">  <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> rgt = rgt + <span class=\"number\">2</span> <span class=\"keyword\">WHERE</span> rgt &gt; myRight;</div><div class=\"line\">  <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> lft = lft + <span class=\"number\">2</span> <span class=\"keyword\">WHERE</span> lft &gt; myRight;</div><div class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category(CATEGORY_ID,<span class=\"keyword\">name</span>, lft, rgt) <span class=\"keyword\">VALUES</span>(SEQ_CATEGORY.nextval,add_name, myRight + <span class=\"number\">1</span>, myRight + <span class=\"number\">2</span>); </div><div class=\"line\">  <span class=\"keyword\">commit</span>; </div><div class=\"line\">exception</div><div class=\"line\">    when others then</div><div class=\"line\">    <span class=\"keyword\">rollback</span>;  </div><div class=\"line\"><span class=\"keyword\">end</span>;</div></pre></td></tr></table></figure>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">EXECUTE</span> pkg_category.add_node(<span class=\"string\">'TELEVISIONS'</span>,<span class=\"string\">'GAME CONSOLES'</span>);</div></pre></td></tr></table></figure>\n<p>我们可以检验一下新节点插入的正确性：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">SELECT</span>  <span class=\"keyword\">lpad</span>( <span class=\"string\">'+'</span>,  (<span class=\"keyword\">COUNT</span>(parent.name)<span class=\"number\">-1</span>),<span class=\"string\">'+'</span>)||node.name <span class=\"keyword\">name</span></div><div class=\"line\"><span class=\"keyword\">FROM</span> nested_category node, nested_category  <span class=\"keyword\">parent</span></div><div class=\"line\"><span class=\"keyword\">WHERE</span> node.lft <span class=\"keyword\">BETWEEN</span> parent.lft <span class=\"keyword\">AND</span> parent.rgt</div><div class=\"line\"><span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> node.name,node.lft</div><div class=\"line\"><span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> node.lft;</div></pre></td></tr></table></figure>\n<p>输出结果</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">NAME</div><div class=\"line\">----------------------------------</div><div class=\"line\">ELECTRONICS</div><div class=\"line\">+TELEVISIONS</div><div class=\"line\">++TUBE</div><div class=\"line\">++LCD</div><div class=\"line\">++PLASMA</div><div class=\"line\">+GAME CONSOLES</div><div class=\"line\">+PORTABLE ELECTRONICS</div><div class=\"line\">++MP3 PLAYERS</div><div class=\"line\">+++FLASH</div><div class=\"line\">++CD PLAYERS</div><div class=\"line\">++2 WAY RADIOS</div></pre></td></tr></table></figure>\n<p>如果我们想要在叶子节点下增加节点，我们得稍微修改一下查询语句。让我们在2 WAY RADIOS叶子节点下添加FRS节点吧：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">--在叶子节点下增加节点</span></div><div class=\"line\">procedure add_child_node(</div><div class=\"line\">  cname nested_category.name%type,</div><div class=\"line\">  add_name nested_category.name%type</div><div class=\"line\">)</div><div class=\"line\">is</div><div class=\"line\">  myLeft nested_category.lft%type ;       </div><div class=\"line\"><span class=\"keyword\">BEGIN</span></div><div class=\"line\">  <span class=\"keyword\">SELECT</span> lft <span class=\"keyword\">into</span> myLeft <span class=\"keyword\">FROM</span> nested_category <span class=\"keyword\">WHERE</span> <span class=\"keyword\">name</span> = cname;</div><div class=\"line\">  <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> rgt = rgt + <span class=\"number\">2</span> <span class=\"keyword\">WHERE</span> rgt &gt; myLeft;</div><div class=\"line\">  <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> lft = lft + <span class=\"number\">2</span> <span class=\"keyword\">WHERE</span> lft &gt; myLeft;</div><div class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category(CATEGORY_ID, <span class=\"keyword\">name</span>, lft, rgt) <span class=\"keyword\">VALUES</span>(SEQ_CATEGORY.nextval, add_name, myLeft + <span class=\"number\">1</span>, myLeft + <span class=\"number\">2</span>);</div><div class=\"line\">  <span class=\"keyword\">commit</span>;</div><div class=\"line\">exception</div><div class=\"line\">    when others then</div><div class=\"line\">    <span class=\"keyword\">rollback</span>; </div><div class=\"line\"><span class=\"keyword\">end</span>;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">EXECUTE</span> pkg_category.add_child_node(<span class=\"string\">'2 WAY RADIOS'</span>,<span class=\"string\">'FRS'</span>);</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">SELECT</span>  <span class=\"keyword\">lpad</span>( <span class=\"string\">'+'</span>,  (<span class=\"keyword\">COUNT</span>(parent.name)<span class=\"number\">-1</span>),<span class=\"string\">'+'</span>)||node.name <span class=\"keyword\">name</span></div><div class=\"line\"><span class=\"keyword\">FROM</span> nested_category node, nested_category  <span class=\"keyword\">parent</span></div><div class=\"line\"><span class=\"keyword\">WHERE</span> node.lft <span class=\"keyword\">BETWEEN</span> parent.lft <span class=\"keyword\">AND</span> parent.rgt</div><div class=\"line\"><span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> node.name,node.lft</div><div class=\"line\"><span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> node.lft;</div></pre></td></tr></table></figure>\n<p>输出结果</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">NAME</div><div class=\"line\">----------------------------------</div><div class=\"line\">ELECTRONICS</div><div class=\"line\">+TELEVISIONS</div><div class=\"line\">++TUBE</div><div class=\"line\">++LCD</div><div class=\"line\">++PLASMA</div><div class=\"line\">+GAME CONSOLES</div><div class=\"line\">+PORTABLE ELECTRONICS</div><div class=\"line\">++MP3 PLAYERS</div><div class=\"line\">+++FLASH</div><div class=\"line\">++CD PLAYERS</div><div class=\"line\">++2 WAY RADIOS</div><div class=\"line\">+++FRS</div></pre></td></tr></table></figure>\n<p>在这个例子中，我们扩大了新产生的父节点(2 WAY RADIOS节点）的右值及其所有它的右边节点的左右值，之后置新增节点于新父节点之下。正如你所看到的，我们新增的节点已经完全融入了嵌套集合中：</p>\n<p>#9.删除节点</p>\n<p>最后还有个基础任务，删除节点。删除节点的处理过程跟节点在分层数据中所处的位置有关，删除一个叶子节点比删除一个子节点要简单得多，因为删除子节点的时候，我们需要去处理孤立节点。 </p>\n<p>删除一个叶子节点的过程正好是新增一个叶子节点的逆过程，我们在删除节点的同时该节点右边所有节点的左右值和该父节点的右值都会减去该节点的宽度值2：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">--删除叶子节点</span></div><div class=\"line\">procedure delete_leaf_node(leaf_name nested_category.name%type)</div><div class=\"line\">is</div><div class=\"line\">  myLeft nested_category.lft%type ;  </div><div class=\"line\">  myRight nested_category.rgt%type ;  </div><div class=\"line\">  myWidth integer ;  </div><div class=\"line\"><span class=\"keyword\">BEGIN</span></div><div class=\"line\">    <span class=\"keyword\">SELECT</span>  lft , rgt , (rgt - lft+ <span class=\"number\">1</span>) <span class=\"keyword\">into</span>   myLeft , myRight, myWidth  <span class=\"keyword\">FROM</span> nested_category</div><div class=\"line\">    <span class=\"keyword\">WHERE</span> <span class=\"keyword\">name</span> = leaf_name;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> nested_category <span class=\"keyword\">WHERE</span> lft <span class=\"keyword\">BETWEEN</span>  myLeft <span class=\"keyword\">AND</span>  myRight;</div><div class=\"line\">    <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> rgt = rgt - myWidth <span class=\"keyword\">WHERE</span> rgt &gt;  myRight;</div><div class=\"line\">    <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> lft = lft - myWidth <span class=\"keyword\">WHERE</span> lft &gt;  myRight;</div><div class=\"line\">    <span class=\"keyword\">commit</span>;</div><div class=\"line\">exception</div><div class=\"line\">    when others then</div><div class=\"line\">    <span class=\"keyword\">rollback</span>;   </div><div class=\"line\"><span class=\"keyword\">end</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--我们再一次检验一下节点已经成功删除,而且没有打乱数据的层次：</span></div><div class=\"line\"><span class=\"keyword\">EXECUTE</span> pkg_category.delete_leaf_node(<span class=\"string\">'GAME CONSOLES'</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">SELECT</span>  <span class=\"keyword\">lpad</span>( <span class=\"string\">'+'</span>,  (<span class=\"keyword\">COUNT</span>(parent.name)<span class=\"number\">-1</span>),<span class=\"string\">'+'</span>)||node.name <span class=\"keyword\">name</span></div><div class=\"line\"><span class=\"keyword\">FROM</span> nested_category node, nested_category  <span class=\"keyword\">parent</span></div><div class=\"line\"><span class=\"keyword\">WHERE</span> node.lft <span class=\"keyword\">BETWEEN</span> parent.lft <span class=\"keyword\">AND</span> parent.rgt</div><div class=\"line\"><span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> node.name,node.lft</div><div class=\"line\"><span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> node.lft;</div></pre></td></tr></table></figure>\n<p>输出结果</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">NAME</div><div class=\"line\">--------------------------------------------------------------------------------</div><div class=\"line\">ELECTRONICS</div><div class=\"line\">+TELEVISIONS</div><div class=\"line\">++TUBE</div><div class=\"line\">++LCD</div><div class=\"line\">++PLASMA</div><div class=\"line\">+PORTABLE ELECTRONICS</div><div class=\"line\">++MP3 PLAYERS</div><div class=\"line\">+++FLASH</div><div class=\"line\">++CD PLAYERS</div><div class=\"line\">++2 WAY RADIOS</div><div class=\"line\">+++FRS</div></pre></td></tr></table></figure>\n<p>这个方法可以完美地删除节点及其子节点：</p>\n<pre><code>EXECUTE pkg_category.delete_leaf_node(&apos;MP3 PLAYERS&apos;);\n</code></pre><p>再次验证我们已经成功的删除了一棵子树：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">NAME</div><div class=\"line\">---------------------------- </div><div class=\"line\">ELECTRONICS</div><div class=\"line\">+TELEVISIONS</div><div class=\"line\">++TUBE</div><div class=\"line\">++LCD</div><div class=\"line\">++PLASMA</div><div class=\"line\">+PORTABLE ELECTRONICS</div><div class=\"line\">++CD PLAYERS</div><div class=\"line\">++2 WAY RADIOS</div><div class=\"line\">+++FRS</div></pre></td></tr></table></figure>\n<p>有时，我们只删除该节点，而不删除该节点的子节点。在一些情况下，你希望改变其名字为占位符，直到替代名字的出现，比如你开除了一个主管（需要更换主管）。在另外一些情况下，你希望子节点挂到该删除节点的父节点下：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">--删除该节点，而不删除该节点的子节点</span></div><div class=\"line\">procedure delete_node_only(node_name nested_category.name%type)</div><div class=\"line\">is</div><div class=\"line\">  myLeft nested_category.lft%type ;  </div><div class=\"line\">  myRight nested_category.rgt%type ;  </div><div class=\"line\">  myWidth integer ;  </div><div class=\"line\"><span class=\"keyword\">BEGIN</span></div><div class=\"line\">    <span class=\"keyword\">SELECT</span>  lft , rgt , (rgt - lft+ <span class=\"number\">1</span>) <span class=\"keyword\">into</span>   myLeft , myRight, myWidth  <span class=\"keyword\">FROM</span> nested_category</div><div class=\"line\">    <span class=\"keyword\">WHERE</span> <span class=\"keyword\">name</span> = node_name;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> nested_category <span class=\"keyword\">WHERE</span> lft = myLeft;</div><div class=\"line\">    <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> rgt = rgt - <span class=\"number\">1</span>, lft = lft - <span class=\"number\">1</span> <span class=\"keyword\">WHERE</span> lft <span class=\"keyword\">BETWEEN</span>  myLeft <span class=\"keyword\">AND</span>  myRight;</div><div class=\"line\">    <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> rgt = rgt - <span class=\"number\">2</span> <span class=\"keyword\">WHERE</span> rgt &gt;  myRight;</div><div class=\"line\">    <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> lft = lft - <span class=\"number\">2</span> <span class=\"keyword\">WHERE</span> lft &gt;  myRight;</div><div class=\"line\">    <span class=\"keyword\">commit</span>;</div><div class=\"line\">exception</div><div class=\"line\">    when others then</div><div class=\"line\">    <span class=\"keyword\">rollback</span>;</div><div class=\"line\"><span class=\"keyword\">end</span>;</div></pre></td></tr></table></figure>\n<p>在这个例子中，我们对该节点所有右边节点的左右值都减去了2（因为不考虑其子节点，该节点的宽度为2），对该节点的子节点的左右值都减去了1（弥补由于失去父节点的左值造成的裂缝）。我们再一次确认，那些节点是否都晋升了：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">EXECUTE</span> pkg_category.delete_node_only(<span class=\"string\">'PORTABLE ELECTRONICS'</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">SELECT</span>  <span class=\"keyword\">lpad</span>( <span class=\"string\">'+'</span>,  (<span class=\"keyword\">COUNT</span>(parent.name)<span class=\"number\">-1</span>),<span class=\"string\">'+'</span>)||node.name <span class=\"keyword\">name</span></div><div class=\"line\"><span class=\"keyword\">FROM</span> nested_category node, nested_category  <span class=\"keyword\">parent</span></div><div class=\"line\"><span class=\"keyword\">WHERE</span> node.lft <span class=\"keyword\">BETWEEN</span> parent.lft <span class=\"keyword\">AND</span> parent.rgt</div><div class=\"line\"><span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> node.name,node.lft</div><div class=\"line\"><span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> node.lft;</div></pre></td></tr></table></figure>\n<p>输出结果  </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">NAME</div><div class=\"line\">--------------------- </div><div class=\"line\">ELECTRONICS</div><div class=\"line\">+TELEVISIONS</div><div class=\"line\">++TUBE</div><div class=\"line\">++LCD</div><div class=\"line\">++PLASMA</div><div class=\"line\">+CD PLAYERS</div><div class=\"line\">+2 WAY RADIOS</div><div class=\"line\">++FRS</div><div class=\"line\"></div><div class=\"line\">8 rows selected</div></pre></td></tr></table></figure>\n<p>有时，当删除节点的时候，把该节点的一个子节点挂载到该节点的父节点下，而其他节点挂到该节点父节点的兄弟节点下，考虑到篇幅这种情况不在这里解说了。</p>\n<p>#10.相关包sql</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">or</span> <span class=\"keyword\">replace</span> <span class=\"keyword\">package</span> pkg_category  <span class=\"keyword\">is</span></div><div class=\"line\"><span class=\"comment\">--增加平行节点 </span></div><div class=\"line\"><span class=\"keyword\">procedure</span> add_node(</div><div class=\"line\">  cname nested_category.name%<span class=\"keyword\">type</span>,</div><div class=\"line\">  add_name nested_category.name%<span class=\"keyword\">type</span></div><div class=\"line\">);</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--在叶子节点下增加节点</span></div><div class=\"line\">procedure add_child_node(</div><div class=\"line\">  cname nested_category.name%type,</div><div class=\"line\">  add_name nested_category.name%type</div><div class=\"line\">);</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--删除叶子节点</span></div><div class=\"line\">procedure delete_leaf_node(leaf_name nested_category.name%type);</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--删除该节点，而不删除该节点的子节点</span></div><div class=\"line\">procedure delete_node_only(node_name nested_category.name%type);</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">end</span> pkg_category;</div></pre></td></tr></table></figure>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">or</span> <span class=\"keyword\">replace</span> <span class=\"keyword\">package</span> <span class=\"keyword\">body</span> pkg_category <span class=\"keyword\">is</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--增加平行节点</span></div><div class=\"line\"><span class=\"keyword\">procedure</span> add_node(</div><div class=\"line\">  cname nested_category.name%<span class=\"keyword\">type</span>,</div><div class=\"line\">  add_name nested_category.name%<span class=\"keyword\">type</span></div><div class=\"line\">)</div><div class=\"line\"><span class=\"keyword\">is</span></div><div class=\"line\">  myRight nested_category.rgt%<span class=\"keyword\">type</span> ;        </div><div class=\"line\"><span class=\"keyword\">BEGIN</span></div><div class=\"line\">  <span class=\"keyword\">SELECT</span> rgt <span class=\"keyword\">into</span> myRight <span class=\"keyword\">FROM</span> nested_category <span class=\"keyword\">WHERE</span> <span class=\"keyword\">name</span> = cname;</div><div class=\"line\">  <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> rgt = rgt + <span class=\"number\">2</span> <span class=\"keyword\">WHERE</span> rgt &gt; myRight;</div><div class=\"line\">  <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> lft = lft + <span class=\"number\">2</span> <span class=\"keyword\">WHERE</span> lft &gt; myRight;</div><div class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category(CATEGORY_ID,<span class=\"keyword\">name</span>, lft, rgt) <span class=\"keyword\">VALUES</span>(SEQ_CATEGORY.nextval,add_name, myRight + <span class=\"number\">1</span>, myRight + <span class=\"number\">2</span>); </div><div class=\"line\">  <span class=\"keyword\">commit</span>; </div><div class=\"line\">exception</div><div class=\"line\">    when others then</div><div class=\"line\">    <span class=\"keyword\">rollback</span>;  </div><div class=\"line\"><span class=\"keyword\">end</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--在叶子节点下增加节点</span></div><div class=\"line\">procedure add_child_node(</div><div class=\"line\">  cname nested_category.name%type,</div><div class=\"line\">  add_name nested_category.name%type</div><div class=\"line\">)</div><div class=\"line\">is</div><div class=\"line\">  myLeft nested_category.lft%type ;        </div><div class=\"line\"><span class=\"keyword\">BEGIN</span></div><div class=\"line\">  <span class=\"keyword\">SELECT</span> lft <span class=\"keyword\">into</span> myLeft <span class=\"keyword\">FROM</span> nested_category <span class=\"keyword\">WHERE</span> <span class=\"keyword\">name</span> = cname;</div><div class=\"line\">  <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> rgt = rgt + <span class=\"number\">2</span> <span class=\"keyword\">WHERE</span> rgt &gt; myLeft;</div><div class=\"line\">  <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> lft = lft + <span class=\"number\">2</span> <span class=\"keyword\">WHERE</span> lft &gt; myLeft;</div><div class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category(CATEGORY_ID, <span class=\"keyword\">name</span>, lft, rgt) <span class=\"keyword\">VALUES</span>(SEQ_CATEGORY.nextval, add_name, myLeft + <span class=\"number\">1</span>, myLeft + <span class=\"number\">2</span>);</div><div class=\"line\">  <span class=\"keyword\">commit</span>; </div><div class=\"line\">exception</div><div class=\"line\">    when others then</div><div class=\"line\">    <span class=\"keyword\">rollback</span>;  </div><div class=\"line\"><span class=\"keyword\">end</span>;</div><div class=\"line\"> </div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--删除叶子节点</span></div><div class=\"line\">procedure delete_leaf_node(leaf_name nested_category.name%type) </div><div class=\"line\">is</div><div class=\"line\">  myLeft nested_category.lft%type ;   </div><div class=\"line\">  myRight nested_category.rgt%type ;   </div><div class=\"line\">  myWidth integer ;   </div><div class=\"line\"><span class=\"keyword\">BEGIN</span></div><div class=\"line\">    <span class=\"keyword\">SELECT</span>  lft , rgt , (rgt - lft+ <span class=\"number\">1</span>) <span class=\"keyword\">into</span>   myLeft , myRight, myWidth  <span class=\"keyword\">FROM</span> nested_category </div><div class=\"line\">    <span class=\"keyword\">WHERE</span> <span class=\"keyword\">name</span> = leaf_name;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> nested_category <span class=\"keyword\">WHERE</span> lft <span class=\"keyword\">BETWEEN</span>  myLeft <span class=\"keyword\">AND</span>  myRight;</div><div class=\"line\">    <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> rgt = rgt - myWidth <span class=\"keyword\">WHERE</span> rgt &gt;  myRight;</div><div class=\"line\">    <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> lft = lft - myWidth <span class=\"keyword\">WHERE</span> lft &gt;  myRight;</div><div class=\"line\">    <span class=\"keyword\">commit</span>; </div><div class=\"line\">exception</div><div class=\"line\">    when others then</div><div class=\"line\">    <span class=\"keyword\">rollback</span>;    </div><div class=\"line\"><span class=\"keyword\">end</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--删除该节点，而不删除该节点的子节点</span></div><div class=\"line\">procedure delete_node_only(node_name nested_category.name%type)</div><div class=\"line\">is</div><div class=\"line\">  myLeft nested_category.lft%type ;   </div><div class=\"line\">  myRight nested_category.rgt%type ;   </div><div class=\"line\">  myWidth integer ;   </div><div class=\"line\"><span class=\"keyword\">BEGIN</span></div><div class=\"line\">    <span class=\"keyword\">SELECT</span>  lft , rgt , (rgt - lft+ <span class=\"number\">1</span>) <span class=\"keyword\">into</span>   myLeft , myRight, myWidth  <span class=\"keyword\">FROM</span> nested_category </div><div class=\"line\">    <span class=\"keyword\">WHERE</span> <span class=\"keyword\">name</span> = node_name;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> nested_category <span class=\"keyword\">WHERE</span> lft = myLeft;</div><div class=\"line\">    <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> rgt = rgt - <span class=\"number\">1</span>, lft = lft - <span class=\"number\">1</span> <span class=\"keyword\">WHERE</span> lft <span class=\"keyword\">BETWEEN</span>  myLeft <span class=\"keyword\">AND</span>  myRight;</div><div class=\"line\">    <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> rgt = rgt - <span class=\"number\">2</span> <span class=\"keyword\">WHERE</span> rgt &gt;  myRight;</div><div class=\"line\">    <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> lft = lft - <span class=\"number\">2</span> <span class=\"keyword\">WHERE</span> lft &gt;  myRight;</div><div class=\"line\">    <span class=\"keyword\">commit</span>; </div><div class=\"line\">exception</div><div class=\"line\">    when others then</div><div class=\"line\">    <span class=\"keyword\">rollback</span>;</div><div class=\"line\"><span class=\"keyword\">end</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">end</span> pkg_category;</div></pre></td></tr></table></figure>\n","excerpt":"","more":"<p>本文参考了：<br>Mike Hillyer的《Managing Hierarchical Data in MySQL》<br>及Yimin的翻译版《MYSQL中分层数据的管理》</p>\n<p>#8.新增节点<br>到现在，我们已经知道了如何去查询我们的树，是时候去关注一下如何增加一个新节点来更<br>新我们的树了。让我们再一次观察一下我们的嵌套集合图：</p>\n<p><img src=\"/images/2012/oracle-04-1.jpg\" alt=\"Alt text\"></p>\n<p>当我们想要在TELEVISIONS和PORTABLE ELECTRONICS节点之间新增一个节点，新节点的lft和rgt 的 值为10和11，所有该节点的右边节点的lft和rgt值都将加2，之后我们再添加新节点并赋相应的lft和rgt值。在MySQL 5中可以使用存储过程来完成，我假设当前大部分读者使用的是MySQL 4.1版本，因为这是最新的稳定版本。所以，我使用了锁表（LOCKTABLES）语句来隔离查询：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">--增加平行节点</span></div><div class=\"line\">procedure add_node(</div><div class=\"line\">  cname nested_category.name%type,</div><div class=\"line\">  add_name nested_category.name%type</div><div class=\"line\">)</div><div class=\"line\">is</div><div class=\"line\">  myRight nested_category.rgt%type ;        </div><div class=\"line\"><span class=\"keyword\">BEGIN</span></div><div class=\"line\">  <span class=\"keyword\">SELECT</span> rgt <span class=\"keyword\">into</span> myRight <span class=\"keyword\">FROM</span> nested_category <span class=\"keyword\">WHERE</span> <span class=\"keyword\">name</span> = cname;</div><div class=\"line\">  <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> rgt = rgt + <span class=\"number\">2</span> <span class=\"keyword\">WHERE</span> rgt &gt; myRight;</div><div class=\"line\">  <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> lft = lft + <span class=\"number\">2</span> <span class=\"keyword\">WHERE</span> lft &gt; myRight;</div><div class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category(CATEGORY_ID,<span class=\"keyword\">name</span>, lft, rgt) <span class=\"keyword\">VALUES</span>(SEQ_CATEGORY.nextval,add_name, myRight + <span class=\"number\">1</span>, myRight + <span class=\"number\">2</span>); </div><div class=\"line\">  <span class=\"keyword\">commit</span>; </div><div class=\"line\">exception</div><div class=\"line\">    when others then</div><div class=\"line\">    <span class=\"keyword\">rollback</span>;  </div><div class=\"line\"><span class=\"keyword\">end</span>;</div></pre></td></tr></table></figure>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">EXECUTE</span> pkg_category.add_node(<span class=\"string\">'TELEVISIONS'</span>,<span class=\"string\">'GAME CONSOLES'</span>);</div></pre></td></tr></table></figure>\n<p>我们可以检验一下新节点插入的正确性：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">SELECT</span>  <span class=\"keyword\">lpad</span>( <span class=\"string\">'+'</span>,  (<span class=\"keyword\">COUNT</span>(parent.name)<span class=\"number\">-1</span>),<span class=\"string\">'+'</span>)||node.name <span class=\"keyword\">name</span></div><div class=\"line\"><span class=\"keyword\">FROM</span> nested_category node, nested_category  <span class=\"keyword\">parent</span></div><div class=\"line\"><span class=\"keyword\">WHERE</span> node.lft <span class=\"keyword\">BETWEEN</span> parent.lft <span class=\"keyword\">AND</span> parent.rgt</div><div class=\"line\"><span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> node.name,node.lft</div><div class=\"line\"><span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> node.lft;</div></pre></td></tr></table></figure>\n<p>输出结果</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">NAME</div><div class=\"line\">----------------------------------</div><div class=\"line\">ELECTRONICS</div><div class=\"line\">+TELEVISIONS</div><div class=\"line\">++TUBE</div><div class=\"line\">++LCD</div><div class=\"line\">++PLASMA</div><div class=\"line\">+GAME CONSOLES</div><div class=\"line\">+PORTABLE ELECTRONICS</div><div class=\"line\">++MP3 PLAYERS</div><div class=\"line\">+++FLASH</div><div class=\"line\">++CD PLAYERS</div><div class=\"line\">++2 WAY RADIOS</div></pre></td></tr></table></figure>\n<p>如果我们想要在叶子节点下增加节点，我们得稍微修改一下查询语句。让我们在2 WAY RADIOS叶子节点下添加FRS节点吧：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">--在叶子节点下增加节点</span></div><div class=\"line\">procedure add_child_node(</div><div class=\"line\">  cname nested_category.name%type,</div><div class=\"line\">  add_name nested_category.name%type</div><div class=\"line\">)</div><div class=\"line\">is</div><div class=\"line\">  myLeft nested_category.lft%type ;       </div><div class=\"line\"><span class=\"keyword\">BEGIN</span></div><div class=\"line\">  <span class=\"keyword\">SELECT</span> lft <span class=\"keyword\">into</span> myLeft <span class=\"keyword\">FROM</span> nested_category <span class=\"keyword\">WHERE</span> <span class=\"keyword\">name</span> = cname;</div><div class=\"line\">  <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> rgt = rgt + <span class=\"number\">2</span> <span class=\"keyword\">WHERE</span> rgt &gt; myLeft;</div><div class=\"line\">  <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> lft = lft + <span class=\"number\">2</span> <span class=\"keyword\">WHERE</span> lft &gt; myLeft;</div><div class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category(CATEGORY_ID, <span class=\"keyword\">name</span>, lft, rgt) <span class=\"keyword\">VALUES</span>(SEQ_CATEGORY.nextval, add_name, myLeft + <span class=\"number\">1</span>, myLeft + <span class=\"number\">2</span>);</div><div class=\"line\">  <span class=\"keyword\">commit</span>;</div><div class=\"line\">exception</div><div class=\"line\">    when others then</div><div class=\"line\">    <span class=\"keyword\">rollback</span>; </div><div class=\"line\"><span class=\"keyword\">end</span>;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">EXECUTE</span> pkg_category.add_child_node(<span class=\"string\">'2 WAY RADIOS'</span>,<span class=\"string\">'FRS'</span>);</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">SELECT</span>  <span class=\"keyword\">lpad</span>( <span class=\"string\">'+'</span>,  (<span class=\"keyword\">COUNT</span>(parent.name)<span class=\"number\">-1</span>),<span class=\"string\">'+'</span>)||node.name <span class=\"keyword\">name</span></div><div class=\"line\"><span class=\"keyword\">FROM</span> nested_category node, nested_category  <span class=\"keyword\">parent</span></div><div class=\"line\"><span class=\"keyword\">WHERE</span> node.lft <span class=\"keyword\">BETWEEN</span> parent.lft <span class=\"keyword\">AND</span> parent.rgt</div><div class=\"line\"><span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> node.name,node.lft</div><div class=\"line\"><span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> node.lft;</div></pre></td></tr></table></figure>\n<p>输出结果</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">NAME</div><div class=\"line\">----------------------------------</div><div class=\"line\">ELECTRONICS</div><div class=\"line\">+TELEVISIONS</div><div class=\"line\">++TUBE</div><div class=\"line\">++LCD</div><div class=\"line\">++PLASMA</div><div class=\"line\">+GAME CONSOLES</div><div class=\"line\">+PORTABLE ELECTRONICS</div><div class=\"line\">++MP3 PLAYERS</div><div class=\"line\">+++FLASH</div><div class=\"line\">++CD PLAYERS</div><div class=\"line\">++2 WAY RADIOS</div><div class=\"line\">+++FRS</div></pre></td></tr></table></figure>\n<p>在这个例子中，我们扩大了新产生的父节点(2 WAY RADIOS节点）的右值及其所有它的右边节点的左右值，之后置新增节点于新父节点之下。正如你所看到的，我们新增的节点已经完全融入了嵌套集合中：</p>\n<p>#9.删除节点</p>\n<p>最后还有个基础任务，删除节点。删除节点的处理过程跟节点在分层数据中所处的位置有关，删除一个叶子节点比删除一个子节点要简单得多，因为删除子节点的时候，我们需要去处理孤立节点。 </p>\n<p>删除一个叶子节点的过程正好是新增一个叶子节点的逆过程，我们在删除节点的同时该节点右边所有节点的左右值和该父节点的右值都会减去该节点的宽度值2：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">--删除叶子节点</span></div><div class=\"line\">procedure delete_leaf_node(leaf_name nested_category.name%type)</div><div class=\"line\">is</div><div class=\"line\">  myLeft nested_category.lft%type ;  </div><div class=\"line\">  myRight nested_category.rgt%type ;  </div><div class=\"line\">  myWidth integer ;  </div><div class=\"line\"><span class=\"keyword\">BEGIN</span></div><div class=\"line\">    <span class=\"keyword\">SELECT</span>  lft , rgt , (rgt - lft+ <span class=\"number\">1</span>) <span class=\"keyword\">into</span>   myLeft , myRight, myWidth  <span class=\"keyword\">FROM</span> nested_category</div><div class=\"line\">    <span class=\"keyword\">WHERE</span> <span class=\"keyword\">name</span> = leaf_name;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> nested_category <span class=\"keyword\">WHERE</span> lft <span class=\"keyword\">BETWEEN</span>  myLeft <span class=\"keyword\">AND</span>  myRight;</div><div class=\"line\">    <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> rgt = rgt - myWidth <span class=\"keyword\">WHERE</span> rgt &gt;  myRight;</div><div class=\"line\">    <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> lft = lft - myWidth <span class=\"keyword\">WHERE</span> lft &gt;  myRight;</div><div class=\"line\">    <span class=\"keyword\">commit</span>;</div><div class=\"line\">exception</div><div class=\"line\">    when others then</div><div class=\"line\">    <span class=\"keyword\">rollback</span>;   </div><div class=\"line\"><span class=\"keyword\">end</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--我们再一次检验一下节点已经成功删除,而且没有打乱数据的层次：</span></div><div class=\"line\"><span class=\"keyword\">EXECUTE</span> pkg_category.delete_leaf_node(<span class=\"string\">'GAME CONSOLES'</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">SELECT</span>  <span class=\"keyword\">lpad</span>( <span class=\"string\">'+'</span>,  (<span class=\"keyword\">COUNT</span>(parent.name)<span class=\"number\">-1</span>),<span class=\"string\">'+'</span>)||node.name <span class=\"keyword\">name</span></div><div class=\"line\"><span class=\"keyword\">FROM</span> nested_category node, nested_category  <span class=\"keyword\">parent</span></div><div class=\"line\"><span class=\"keyword\">WHERE</span> node.lft <span class=\"keyword\">BETWEEN</span> parent.lft <span class=\"keyword\">AND</span> parent.rgt</div><div class=\"line\"><span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> node.name,node.lft</div><div class=\"line\"><span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> node.lft;</div></pre></td></tr></table></figure>\n<p>输出结果</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">NAME</div><div class=\"line\">--------------------------------------------------------------------------------</div><div class=\"line\">ELECTRONICS</div><div class=\"line\">+TELEVISIONS</div><div class=\"line\">++TUBE</div><div class=\"line\">++LCD</div><div class=\"line\">++PLASMA</div><div class=\"line\">+PORTABLE ELECTRONICS</div><div class=\"line\">++MP3 PLAYERS</div><div class=\"line\">+++FLASH</div><div class=\"line\">++CD PLAYERS</div><div class=\"line\">++2 WAY RADIOS</div><div class=\"line\">+++FRS</div></pre></td></tr></table></figure>\n<p>这个方法可以完美地删除节点及其子节点：</p>\n<pre><code>EXECUTE pkg_category.delete_leaf_node(&apos;MP3 PLAYERS&apos;);\n</code></pre><p>再次验证我们已经成功的删除了一棵子树：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">NAME</div><div class=\"line\">---------------------------- </div><div class=\"line\">ELECTRONICS</div><div class=\"line\">+TELEVISIONS</div><div class=\"line\">++TUBE</div><div class=\"line\">++LCD</div><div class=\"line\">++PLASMA</div><div class=\"line\">+PORTABLE ELECTRONICS</div><div class=\"line\">++CD PLAYERS</div><div class=\"line\">++2 WAY RADIOS</div><div class=\"line\">+++FRS</div></pre></td></tr></table></figure>\n<p>有时，我们只删除该节点，而不删除该节点的子节点。在一些情况下，你希望改变其名字为占位符，直到替代名字的出现，比如你开除了一个主管（需要更换主管）。在另外一些情况下，你希望子节点挂到该删除节点的父节点下：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">--删除该节点，而不删除该节点的子节点</span></div><div class=\"line\">procedure delete_node_only(node_name nested_category.name%type)</div><div class=\"line\">is</div><div class=\"line\">  myLeft nested_category.lft%type ;  </div><div class=\"line\">  myRight nested_category.rgt%type ;  </div><div class=\"line\">  myWidth integer ;  </div><div class=\"line\"><span class=\"keyword\">BEGIN</span></div><div class=\"line\">    <span class=\"keyword\">SELECT</span>  lft , rgt , (rgt - lft+ <span class=\"number\">1</span>) <span class=\"keyword\">into</span>   myLeft , myRight, myWidth  <span class=\"keyword\">FROM</span> nested_category</div><div class=\"line\">    <span class=\"keyword\">WHERE</span> <span class=\"keyword\">name</span> = node_name;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> nested_category <span class=\"keyword\">WHERE</span> lft = myLeft;</div><div class=\"line\">    <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> rgt = rgt - <span class=\"number\">1</span>, lft = lft - <span class=\"number\">1</span> <span class=\"keyword\">WHERE</span> lft <span class=\"keyword\">BETWEEN</span>  myLeft <span class=\"keyword\">AND</span>  myRight;</div><div class=\"line\">    <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> rgt = rgt - <span class=\"number\">2</span> <span class=\"keyword\">WHERE</span> rgt &gt;  myRight;</div><div class=\"line\">    <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> lft = lft - <span class=\"number\">2</span> <span class=\"keyword\">WHERE</span> lft &gt;  myRight;</div><div class=\"line\">    <span class=\"keyword\">commit</span>;</div><div class=\"line\">exception</div><div class=\"line\">    when others then</div><div class=\"line\">    <span class=\"keyword\">rollback</span>;</div><div class=\"line\"><span class=\"keyword\">end</span>;</div></pre></td></tr></table></figure>\n<p>在这个例子中，我们对该节点所有右边节点的左右值都减去了2（因为不考虑其子节点，该节点的宽度为2），对该节点的子节点的左右值都减去了1（弥补由于失去父节点的左值造成的裂缝）。我们再一次确认，那些节点是否都晋升了：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">EXECUTE</span> pkg_category.delete_node_only(<span class=\"string\">'PORTABLE ELECTRONICS'</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">SELECT</span>  <span class=\"keyword\">lpad</span>( <span class=\"string\">'+'</span>,  (<span class=\"keyword\">COUNT</span>(parent.name)<span class=\"number\">-1</span>),<span class=\"string\">'+'</span>)||node.name <span class=\"keyword\">name</span></div><div class=\"line\"><span class=\"keyword\">FROM</span> nested_category node, nested_category  <span class=\"keyword\">parent</span></div><div class=\"line\"><span class=\"keyword\">WHERE</span> node.lft <span class=\"keyword\">BETWEEN</span> parent.lft <span class=\"keyword\">AND</span> parent.rgt</div><div class=\"line\"><span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> node.name,node.lft</div><div class=\"line\"><span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> node.lft;</div></pre></td></tr></table></figure>\n<p>输出结果  </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">NAME</div><div class=\"line\">--------------------- </div><div class=\"line\">ELECTRONICS</div><div class=\"line\">+TELEVISIONS</div><div class=\"line\">++TUBE</div><div class=\"line\">++LCD</div><div class=\"line\">++PLASMA</div><div class=\"line\">+CD PLAYERS</div><div class=\"line\">+2 WAY RADIOS</div><div class=\"line\">++FRS</div><div class=\"line\"></div><div class=\"line\">8 rows selected</div></pre></td></tr></table></figure>\n<p>有时，当删除节点的时候，把该节点的一个子节点挂载到该节点的父节点下，而其他节点挂到该节点父节点的兄弟节点下，考虑到篇幅这种情况不在这里解说了。</p>\n<p>#10.相关包sql</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">or</span> <span class=\"keyword\">replace</span> <span class=\"keyword\">package</span> pkg_category  <span class=\"keyword\">is</span></div><div class=\"line\"><span class=\"comment\">--增加平行节点 </span></div><div class=\"line\"><span class=\"keyword\">procedure</span> add_node(</div><div class=\"line\">  cname nested_category.name%<span class=\"keyword\">type</span>,</div><div class=\"line\">  add_name nested_category.name%<span class=\"keyword\">type</span></div><div class=\"line\">);</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--在叶子节点下增加节点</span></div><div class=\"line\">procedure add_child_node(</div><div class=\"line\">  cname nested_category.name%type,</div><div class=\"line\">  add_name nested_category.name%type</div><div class=\"line\">);</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--删除叶子节点</span></div><div class=\"line\">procedure delete_leaf_node(leaf_name nested_category.name%type);</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--删除该节点，而不删除该节点的子节点</span></div><div class=\"line\">procedure delete_node_only(node_name nested_category.name%type);</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">end</span> pkg_category;</div></pre></td></tr></table></figure>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">or</span> <span class=\"keyword\">replace</span> <span class=\"keyword\">package</span> <span class=\"keyword\">body</span> pkg_category <span class=\"keyword\">is</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--增加平行节点</span></div><div class=\"line\"><span class=\"keyword\">procedure</span> add_node(</div><div class=\"line\">  cname nested_category.name%<span class=\"keyword\">type</span>,</div><div class=\"line\">  add_name nested_category.name%<span class=\"keyword\">type</span></div><div class=\"line\">)</div><div class=\"line\"><span class=\"keyword\">is</span></div><div class=\"line\">  myRight nested_category.rgt%<span class=\"keyword\">type</span> ;        </div><div class=\"line\"><span class=\"keyword\">BEGIN</span></div><div class=\"line\">  <span class=\"keyword\">SELECT</span> rgt <span class=\"keyword\">into</span> myRight <span class=\"keyword\">FROM</span> nested_category <span class=\"keyword\">WHERE</span> <span class=\"keyword\">name</span> = cname;</div><div class=\"line\">  <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> rgt = rgt + <span class=\"number\">2</span> <span class=\"keyword\">WHERE</span> rgt &gt; myRight;</div><div class=\"line\">  <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> lft = lft + <span class=\"number\">2</span> <span class=\"keyword\">WHERE</span> lft &gt; myRight;</div><div class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category(CATEGORY_ID,<span class=\"keyword\">name</span>, lft, rgt) <span class=\"keyword\">VALUES</span>(SEQ_CATEGORY.nextval,add_name, myRight + <span class=\"number\">1</span>, myRight + <span class=\"number\">2</span>); </div><div class=\"line\">  <span class=\"keyword\">commit</span>; </div><div class=\"line\">exception</div><div class=\"line\">    when others then</div><div class=\"line\">    <span class=\"keyword\">rollback</span>;  </div><div class=\"line\"><span class=\"keyword\">end</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--在叶子节点下增加节点</span></div><div class=\"line\">procedure add_child_node(</div><div class=\"line\">  cname nested_category.name%type,</div><div class=\"line\">  add_name nested_category.name%type</div><div class=\"line\">)</div><div class=\"line\">is</div><div class=\"line\">  myLeft nested_category.lft%type ;        </div><div class=\"line\"><span class=\"keyword\">BEGIN</span></div><div class=\"line\">  <span class=\"keyword\">SELECT</span> lft <span class=\"keyword\">into</span> myLeft <span class=\"keyword\">FROM</span> nested_category <span class=\"keyword\">WHERE</span> <span class=\"keyword\">name</span> = cname;</div><div class=\"line\">  <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> rgt = rgt + <span class=\"number\">2</span> <span class=\"keyword\">WHERE</span> rgt &gt; myLeft;</div><div class=\"line\">  <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> lft = lft + <span class=\"number\">2</span> <span class=\"keyword\">WHERE</span> lft &gt; myLeft;</div><div class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> nested_category(CATEGORY_ID, <span class=\"keyword\">name</span>, lft, rgt) <span class=\"keyword\">VALUES</span>(SEQ_CATEGORY.nextval, add_name, myLeft + <span class=\"number\">1</span>, myLeft + <span class=\"number\">2</span>);</div><div class=\"line\">  <span class=\"keyword\">commit</span>; </div><div class=\"line\">exception</div><div class=\"line\">    when others then</div><div class=\"line\">    <span class=\"keyword\">rollback</span>;  </div><div class=\"line\"><span class=\"keyword\">end</span>;</div><div class=\"line\"> </div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--删除叶子节点</span></div><div class=\"line\">procedure delete_leaf_node(leaf_name nested_category.name%type) </div><div class=\"line\">is</div><div class=\"line\">  myLeft nested_category.lft%type ;   </div><div class=\"line\">  myRight nested_category.rgt%type ;   </div><div class=\"line\">  myWidth integer ;   </div><div class=\"line\"><span class=\"keyword\">BEGIN</span></div><div class=\"line\">    <span class=\"keyword\">SELECT</span>  lft , rgt , (rgt - lft+ <span class=\"number\">1</span>) <span class=\"keyword\">into</span>   myLeft , myRight, myWidth  <span class=\"keyword\">FROM</span> nested_category </div><div class=\"line\">    <span class=\"keyword\">WHERE</span> <span class=\"keyword\">name</span> = leaf_name;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> nested_category <span class=\"keyword\">WHERE</span> lft <span class=\"keyword\">BETWEEN</span>  myLeft <span class=\"keyword\">AND</span>  myRight;</div><div class=\"line\">    <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> rgt = rgt - myWidth <span class=\"keyword\">WHERE</span> rgt &gt;  myRight;</div><div class=\"line\">    <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> lft = lft - myWidth <span class=\"keyword\">WHERE</span> lft &gt;  myRight;</div><div class=\"line\">    <span class=\"keyword\">commit</span>; </div><div class=\"line\">exception</div><div class=\"line\">    when others then</div><div class=\"line\">    <span class=\"keyword\">rollback</span>;    </div><div class=\"line\"><span class=\"keyword\">end</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--删除该节点，而不删除该节点的子节点</span></div><div class=\"line\">procedure delete_node_only(node_name nested_category.name%type)</div><div class=\"line\">is</div><div class=\"line\">  myLeft nested_category.lft%type ;   </div><div class=\"line\">  myRight nested_category.rgt%type ;   </div><div class=\"line\">  myWidth integer ;   </div><div class=\"line\"><span class=\"keyword\">BEGIN</span></div><div class=\"line\">    <span class=\"keyword\">SELECT</span>  lft , rgt , (rgt - lft+ <span class=\"number\">1</span>) <span class=\"keyword\">into</span>   myLeft , myRight, myWidth  <span class=\"keyword\">FROM</span> nested_category </div><div class=\"line\">    <span class=\"keyword\">WHERE</span> <span class=\"keyword\">name</span> = node_name;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> nested_category <span class=\"keyword\">WHERE</span> lft = myLeft;</div><div class=\"line\">    <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> rgt = rgt - <span class=\"number\">1</span>, lft = lft - <span class=\"number\">1</span> <span class=\"keyword\">WHERE</span> lft <span class=\"keyword\">BETWEEN</span>  myLeft <span class=\"keyword\">AND</span>  myRight;</div><div class=\"line\">    <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> rgt = rgt - <span class=\"number\">2</span> <span class=\"keyword\">WHERE</span> rgt &gt;  myRight;</div><div class=\"line\">    <span class=\"keyword\">UPDATE</span> nested_category <span class=\"keyword\">SET</span> lft = lft - <span class=\"number\">2</span> <span class=\"keyword\">WHERE</span> lft &gt;  myRight;</div><div class=\"line\">    <span class=\"keyword\">commit</span>; </div><div class=\"line\">exception</div><div class=\"line\">    when others then</div><div class=\"line\">    <span class=\"keyword\">rollback</span>;</div><div class=\"line\"><span class=\"keyword\">end</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">end</span> pkg_category;</div></pre></td></tr></table></figure>"},{"layout":"post","title":"2012简单总结与2013展望","date":"2013-01-03T15:00:00.000Z","comments":1,"_content":"2012年主要做了几件事：  \n（1）年初时，自学了一阵linux运维，但由于学习效率太低。于是到了四月份，就拜师学艺了。从六月份到现在一直坚持在学习。初级运维算是没问题了，现在是在研究中级运维的知识。收获是蛮大的，有时候早上起来听视频写文档，周未也窝在家研究，半年下来，linux基本原理、100多个命令操作、系统安装与调优、软件的安装与配置与调优等等都基本OK了。  \n（2）下半年研究起了JVM调优方面的知识，现在也是有点心得，跟Q群的人在YY上做了一次分享。  \n（3）本来想学习hadoop的，由于时间关系，只能放到明年了。  \n（4）12月份研究了一下lucene的源码。知道了搜索引擎的理论上的知识，只看了lucene索引部分的源码，搜索部分还要抽时间精力完善,文档也待补充。  \n\n2013年计划：   \n（1）继续学习linux运维(中高级)的知识。初级运维的基本都是单机房的问题，现在开始研究多机房的问题。    2013-06-29 写下了许多文档，部分问题还要钻研！    \n（2）学习大数据处理Hadoop。  \t\n2013-06-29 正在跟tigerfish 学hadoop   \n（3）学习数据分析与处理，也顺便研究一下数学方面的知识。现在已经花了400RMB报了tigerfish一个R语言学习班,不知道学完是否能拿回300RMB先？  \n2013-06-29 已完成，获优异证书。学习也有所获  \n（4）工作学习的PC转到MacBook Pro上。  \n2013-06-29 离不开她了！  \n（5）全面实践GTD与番茄工作法。  \n（6）最重要的一点：计划每个月写4、5篇博客，一年下来能坚持写50篇左右。  \n（7）熟悉python。虽然现在能用python写点简单的东西，但离精通还远着呢！  \n（8）坚持看英文原版图书。目前有两本书-《High Performance MySQL》，《MySQL High Availability》待看。  \n（9）研究jdk(部分)、spring等框架底层源码  \n","source":"_posts/2013-01-03-start-here-2013.md","raw":"---\nlayout: post\ntitle: \"2012简单总结与2013展望\"\ndate: 2013-01-03 23:00\ncomments: true\ncategories: plan\n---\n2012年主要做了几件事：  \n（1）年初时，自学了一阵linux运维，但由于学习效率太低。于是到了四月份，就拜师学艺了。从六月份到现在一直坚持在学习。初级运维算是没问题了，现在是在研究中级运维的知识。收获是蛮大的，有时候早上起来听视频写文档，周未也窝在家研究，半年下来，linux基本原理、100多个命令操作、系统安装与调优、软件的安装与配置与调优等等都基本OK了。  \n（2）下半年研究起了JVM调优方面的知识，现在也是有点心得，跟Q群的人在YY上做了一次分享。  \n（3）本来想学习hadoop的，由于时间关系，只能放到明年了。  \n（4）12月份研究了一下lucene的源码。知道了搜索引擎的理论上的知识，只看了lucene索引部分的源码，搜索部分还要抽时间精力完善,文档也待补充。  \n\n2013年计划：   \n（1）继续学习linux运维(中高级)的知识。初级运维的基本都是单机房的问题，现在开始研究多机房的问题。    2013-06-29 写下了许多文档，部分问题还要钻研！    \n（2）学习大数据处理Hadoop。  \t\n2013-06-29 正在跟tigerfish 学hadoop   \n（3）学习数据分析与处理，也顺便研究一下数学方面的知识。现在已经花了400RMB报了tigerfish一个R语言学习班,不知道学完是否能拿回300RMB先？  \n2013-06-29 已完成，获优异证书。学习也有所获  \n（4）工作学习的PC转到MacBook Pro上。  \n2013-06-29 离不开她了！  \n（5）全面实践GTD与番茄工作法。  \n（6）最重要的一点：计划每个月写4、5篇博客，一年下来能坚持写50篇左右。  \n（7）熟悉python。虽然现在能用python写点简单的东西，但离精通还远着呢！  \n（8）坚持看英文原版图书。目前有两本书-《High Performance MySQL》，《MySQL High Availability》待看。  \n（9）研究jdk(部分)、spring等框架底层源码  \n","slug":"start-here-2013","published":1,"updated":"2017-01-25T15:29:56.000Z","photos":[],"link":"","_id":"ciyf7fkaj000cf2jy48dzf8xz","content":"<p>2012年主要做了几件事：<br>（1）年初时，自学了一阵linux运维，但由于学习效率太低。于是到了四月份，就拜师学艺了。从六月份到现在一直坚持在学习。初级运维算是没问题了，现在是在研究中级运维的知识。收获是蛮大的，有时候早上起来听视频写文档，周未也窝在家研究，半年下来，linux基本原理、100多个命令操作、系统安装与调优、软件的安装与配置与调优等等都基本OK了。<br>（2）下半年研究起了JVM调优方面的知识，现在也是有点心得，跟Q群的人在YY上做了一次分享。<br>（3）本来想学习hadoop的，由于时间关系，只能放到明年了。<br>（4）12月份研究了一下lucene的源码。知道了搜索引擎的理论上的知识，只看了lucene索引部分的源码，搜索部分还要抽时间精力完善,文档也待补充。  </p>\n<p>2013年计划：<br>（1）继续学习linux运维(中高级)的知识。初级运维的基本都是单机房的问题，现在开始研究多机房的问题。    2013-06-29 写下了许多文档，部分问题还要钻研！<br>（2）学习大数据处理Hadoop。<br>2013-06-29 正在跟tigerfish 学hadoop<br>（3）学习数据分析与处理，也顺便研究一下数学方面的知识。现在已经花了400RMB报了tigerfish一个R语言学习班,不知道学完是否能拿回300RMB先？<br>2013-06-29 已完成，获优异证书。学习也有所获<br>（4）工作学习的PC转到MacBook Pro上。<br>2013-06-29 离不开她了！<br>（5）全面实践GTD与番茄工作法。<br>（6）最重要的一点：计划每个月写4、5篇博客，一年下来能坚持写50篇左右。<br>（7）熟悉python。虽然现在能用python写点简单的东西，但离精通还远着呢！<br>（8）坚持看英文原版图书。目前有两本书-《High Performance MySQL》，《MySQL High Availability》待看。<br>（9）研究jdk(部分)、spring等框架底层源码  </p>\n","excerpt":"","more":"<p>2012年主要做了几件事：<br>（1）年初时，自学了一阵linux运维，但由于学习效率太低。于是到了四月份，就拜师学艺了。从六月份到现在一直坚持在学习。初级运维算是没问题了，现在是在研究中级运维的知识。收获是蛮大的，有时候早上起来听视频写文档，周未也窝在家研究，半年下来，linux基本原理、100多个命令操作、系统安装与调优、软件的安装与配置与调优等等都基本OK了。<br>（2）下半年研究起了JVM调优方面的知识，现在也是有点心得，跟Q群的人在YY上做了一次分享。<br>（3）本来想学习hadoop的，由于时间关系，只能放到明年了。<br>（4）12月份研究了一下lucene的源码。知道了搜索引擎的理论上的知识，只看了lucene索引部分的源码，搜索部分还要抽时间精力完善,文档也待补充。  </p>\n<p>2013年计划：<br>（1）继续学习linux运维(中高级)的知识。初级运维的基本都是单机房的问题，现在开始研究多机房的问题。    2013-06-29 写下了许多文档，部分问题还要钻研！<br>（2）学习大数据处理Hadoop。<br>2013-06-29 正在跟tigerfish 学hadoop<br>（3）学习数据分析与处理，也顺便研究一下数学方面的知识。现在已经花了400RMB报了tigerfish一个R语言学习班,不知道学完是否能拿回300RMB先？<br>2013-06-29 已完成，获优异证书。学习也有所获<br>（4）工作学习的PC转到MacBook Pro上。<br>2013-06-29 离不开她了！<br>（5）全面实践GTD与番茄工作法。<br>（6）最重要的一点：计划每个月写4、5篇博客，一年下来能坚持写50篇左右。<br>（7）熟悉python。虽然现在能用python写点简单的东西，但离精通还远着呢！<br>（8）坚持看英文原版图书。目前有两本书-《High Performance MySQL》，《MySQL High Availability》待看。<br>（9）研究jdk(部分)、spring等框架底层源码  </p>\n"},{"layout":"post","title":"mac新手必备","date":"2013-01-04T11:46:00.000Z","comments":1,"_content":"\nmac必备工具集\n\n<!-- more -->\n\n## Alfred(必备)\n\nAlfred is an award-winning productivity application for Mac OS X, which aims to save you time in searching your local computer and the web.\n\n![img01](/images/2013/newer-should-be-known-in-mac/01.png)\n\n![img01](/images/2013/newer-should-be-known-in-mac/02.png)\n\n\n## OS X 键盘快捷键\n\n完整的快捷键可参考：http://support.apple.com/kb/HT1343?viewlocale=zh_CN  \n#####Mac截图快捷键 \n来源：http://www.dnzs123.com/html/os/mac/672.html\n\n全屏截图：Command-Shift-3\n指定区域截图：Command-Shift-4\n指定程序窗口截图：Commnad-Shift-4-Space\n\n使用快捷键 Command-Shift-4 并用鼠标选取需要截图的区域后，不要松开鼠标，然后你有几种选择：  \n1. 按住鼠标的同时，按空格键，这时你能通过移动鼠标来移动整个已选择区域。   \n2. 按住鼠标的同时，按 Shift 键，这时你能通过横向或竖向移动鼠标来改变已选择区域的长或高。  \n3. 按住鼠标的同时，按 Option 键，这时你通过移动鼠标可以改变已选择区域的半径大小。   \n4. 当你使用快捷键后发现想停止截图，在按住鼠标的同时只要按Esc就会中止截图的过程，不会保存任何文件。   \n如果不改变设置, 所有截图会默认保存到桌面，也就是 Desktop 文件夹。  \n\n常用的快捷键：http://www.douban.com/group/topic/27163791/\n## office套件\n\n为了更好的的兼容windows中的word，我目前装的是mac word2011,你也可以安装iwork或者使用开源的open office。\n\n## Google Chrome浏览器\n虽然用自带的浏览器Safari已经够用，但我还是多装了一个Chrome浏览器。\n\n## Evernote\n必备。笔记本工具，不必多说了。但我目前使用的时候经常抛异常出来，不知道是否是兼容性或稳定性做得还不够好！\n\n## Xcode\n开发必备！可以从app store免费下载,先安装 XCode, 然后安装 Command Line Tools。\n\n## MacPorts或Homebrew(建议)\n### MacPorts\nMacPorts就像apt-get、yum一样，可以快速安装些软件。\n你可以使用dmg或源码安装两种方式。但是我发现我的电脑在使用dmg安装一直卡在run scripts，故最后我还是使用源码安装了。\n从http://distfiles.macports.org/MacPorts/MacPorts-2.1.2.tar.gz下载源码包。\n\n```\ntar zxf MacPorts-2.1.2.tar.gz\ncd MacPorts-2.1.2\n./configure\nmake && sudo make install\n```\n\n更多的使用方式，你可能参考一下这篇:\n\nMac OS X中MacPorts安装和使用\nhttp://www.ccvita.com/434.html\n\n### Homebrew\n官网http://mxcl.github.com/homebrew/\nThe missing package manager for OS X\n\nInstall Homebrew\n```\nruby -e \"$(curl -fsSL https://raw.github.com/mxcl/homebrew/go)\"\n```\n\n## 版本控制工具svn客户端\n\n如果你不习惯命令行下svn操作，你可以安装一下Versions客户端，这个有30天的试用期。  \n但是要注意的是：有时候在命令行下操作更简单方便！\n\n## jdk与eclipse(myeclipse)\n\n如果你是搞Java开发，这应该难不倒你！\n\n## php+mysql\n\n相关安装配置可参考这篇文章：  \n在Mac OS X中配置Apache ＋ PHP ＋ MySQL  \nhttp://dancewithnet.com/2010/05/09/run-apache-php-mysql-in-mac-os-x/\n\n## OmniGraffle Professional 顶级流程图软件\n\n真的非常好用。功能强大，有很多模板。http://graffletopia.com/ 是目前最受欢迎的OmniGraffle模板站。\n\n## 其它：QQ、迅雷等，都有相应mac版。\n\n建议：虽然windows下的工具mac下都有相应替代产品，但熟悉命令行基本命令(如tar、find、grep、svn、sed等)的操作，会让你更加得心应手。","source":"_posts/2013-01-04-newer-should-be-known-in-mac.md","raw":"---\nlayout: post\ntitle: \"mac新手必备\"\ndate: 2013-01-04 19:46\ncomments: true\ncategories: mac\n---\n\nmac必备工具集\n\n<!-- more -->\n\n## Alfred(必备)\n\nAlfred is an award-winning productivity application for Mac OS X, which aims to save you time in searching your local computer and the web.\n\n![img01](/images/2013/newer-should-be-known-in-mac/01.png)\n\n![img01](/images/2013/newer-should-be-known-in-mac/02.png)\n\n\n## OS X 键盘快捷键\n\n完整的快捷键可参考：http://support.apple.com/kb/HT1343?viewlocale=zh_CN  \n#####Mac截图快捷键 \n来源：http://www.dnzs123.com/html/os/mac/672.html\n\n全屏截图：Command-Shift-3\n指定区域截图：Command-Shift-4\n指定程序窗口截图：Commnad-Shift-4-Space\n\n使用快捷键 Command-Shift-4 并用鼠标选取需要截图的区域后，不要松开鼠标，然后你有几种选择：  \n1. 按住鼠标的同时，按空格键，这时你能通过移动鼠标来移动整个已选择区域。   \n2. 按住鼠标的同时，按 Shift 键，这时你能通过横向或竖向移动鼠标来改变已选择区域的长或高。  \n3. 按住鼠标的同时，按 Option 键，这时你通过移动鼠标可以改变已选择区域的半径大小。   \n4. 当你使用快捷键后发现想停止截图，在按住鼠标的同时只要按Esc就会中止截图的过程，不会保存任何文件。   \n如果不改变设置, 所有截图会默认保存到桌面，也就是 Desktop 文件夹。  \n\n常用的快捷键：http://www.douban.com/group/topic/27163791/\n## office套件\n\n为了更好的的兼容windows中的word，我目前装的是mac word2011,你也可以安装iwork或者使用开源的open office。\n\n## Google Chrome浏览器\n虽然用自带的浏览器Safari已经够用，但我还是多装了一个Chrome浏览器。\n\n## Evernote\n必备。笔记本工具，不必多说了。但我目前使用的时候经常抛异常出来，不知道是否是兼容性或稳定性做得还不够好！\n\n## Xcode\n开发必备！可以从app store免费下载,先安装 XCode, 然后安装 Command Line Tools。\n\n## MacPorts或Homebrew(建议)\n### MacPorts\nMacPorts就像apt-get、yum一样，可以快速安装些软件。\n你可以使用dmg或源码安装两种方式。但是我发现我的电脑在使用dmg安装一直卡在run scripts，故最后我还是使用源码安装了。\n从http://distfiles.macports.org/MacPorts/MacPorts-2.1.2.tar.gz下载源码包。\n\n```\ntar zxf MacPorts-2.1.2.tar.gz\ncd MacPorts-2.1.2\n./configure\nmake && sudo make install\n```\n\n更多的使用方式，你可能参考一下这篇:\n\nMac OS X中MacPorts安装和使用\nhttp://www.ccvita.com/434.html\n\n### Homebrew\n官网http://mxcl.github.com/homebrew/\nThe missing package manager for OS X\n\nInstall Homebrew\n```\nruby -e \"$(curl -fsSL https://raw.github.com/mxcl/homebrew/go)\"\n```\n\n## 版本控制工具svn客户端\n\n如果你不习惯命令行下svn操作，你可以安装一下Versions客户端，这个有30天的试用期。  \n但是要注意的是：有时候在命令行下操作更简单方便！\n\n## jdk与eclipse(myeclipse)\n\n如果你是搞Java开发，这应该难不倒你！\n\n## php+mysql\n\n相关安装配置可参考这篇文章：  \n在Mac OS X中配置Apache ＋ PHP ＋ MySQL  \nhttp://dancewithnet.com/2010/05/09/run-apache-php-mysql-in-mac-os-x/\n\n## OmniGraffle Professional 顶级流程图软件\n\n真的非常好用。功能强大，有很多模板。http://graffletopia.com/ 是目前最受欢迎的OmniGraffle模板站。\n\n## 其它：QQ、迅雷等，都有相应mac版。\n\n建议：虽然windows下的工具mac下都有相应替代产品，但熟悉命令行基本命令(如tar、find、grep、svn、sed等)的操作，会让你更加得心应手。","slug":"newer-should-be-known-in-mac","published":1,"updated":"2017-01-27T01:34:43.000Z","photos":[],"link":"","_id":"ciyf7fkao000ff2jybv2ozhwd","content":"<p>mac必备工具集</p>\n<a id=\"more\"></a>\n<h2 id=\"Alfred-必备\"><a href=\"#Alfred-必备\" class=\"headerlink\" title=\"Alfred(必备)\"></a>Alfred(必备)</h2><p>Alfred is an award-winning productivity application for Mac OS X, which aims to save you time in searching your local computer and the web.</p>\n<p><img src=\"/images/2013/newer-should-be-known-in-mac/01.png\" alt=\"img01\"></p>\n<p><img src=\"/images/2013/newer-should-be-known-in-mac/02.png\" alt=\"img01\"></p>\n<h2 id=\"OS-X-键盘快捷键\"><a href=\"#OS-X-键盘快捷键\" class=\"headerlink\" title=\"OS X 键盘快捷键\"></a>OS X 键盘快捷键</h2><p>完整的快捷键可参考：<a href=\"http://support.apple.com/kb/HT1343?viewlocale=zh_CN\" target=\"_blank\" rel=\"external\">http://support.apple.com/kb/HT1343?viewlocale=zh_CN</a>  </p>\n<p>#####Mac截图快捷键<br>来源：<a href=\"http://www.dnzs123.com/html/os/mac/672.html\" target=\"_blank\" rel=\"external\">http://www.dnzs123.com/html/os/mac/672.html</a></p>\n<p>全屏截图：Command-Shift-3<br>指定区域截图：Command-Shift-4<br>指定程序窗口截图：Commnad-Shift-4-Space</p>\n<p>使用快捷键 Command-Shift-4 并用鼠标选取需要截图的区域后，不要松开鼠标，然后你有几种选择：  </p>\n<ol>\n<li>按住鼠标的同时，按空格键，这时你能通过移动鼠标来移动整个已选择区域。   </li>\n<li>按住鼠标的同时，按 Shift 键，这时你能通过横向或竖向移动鼠标来改变已选择区域的长或高。  </li>\n<li>按住鼠标的同时，按 Option 键，这时你通过移动鼠标可以改变已选择区域的半径大小。   </li>\n<li>当你使用快捷键后发现想停止截图，在按住鼠标的同时只要按Esc就会中止截图的过程，不会保存任何文件。<br>如果不改变设置, 所有截图会默认保存到桌面，也就是 Desktop 文件夹。  </li>\n</ol>\n<p>常用的快捷键：<a href=\"http://www.douban.com/group/topic/27163791/\" target=\"_blank\" rel=\"external\">http://www.douban.com/group/topic/27163791/</a></p>\n<h2 id=\"office套件\"><a href=\"#office套件\" class=\"headerlink\" title=\"office套件\"></a>office套件</h2><p>为了更好的的兼容windows中的word，我目前装的是mac word2011,你也可以安装iwork或者使用开源的open office。</p>\n<h2 id=\"Google-Chrome浏览器\"><a href=\"#Google-Chrome浏览器\" class=\"headerlink\" title=\"Google Chrome浏览器\"></a>Google Chrome浏览器</h2><p>虽然用自带的浏览器Safari已经够用，但我还是多装了一个Chrome浏览器。</p>\n<h2 id=\"Evernote\"><a href=\"#Evernote\" class=\"headerlink\" title=\"Evernote\"></a>Evernote</h2><p>必备。笔记本工具，不必多说了。但我目前使用的时候经常抛异常出来，不知道是否是兼容性或稳定性做得还不够好！</p>\n<h2 id=\"Xcode\"><a href=\"#Xcode\" class=\"headerlink\" title=\"Xcode\"></a>Xcode</h2><p>开发必备！可以从app store免费下载,先安装 XCode, 然后安装 Command Line Tools。</p>\n<h2 id=\"MacPorts或Homebrew-建议\"><a href=\"#MacPorts或Homebrew-建议\" class=\"headerlink\" title=\"MacPorts或Homebrew(建议)\"></a>MacPorts或Homebrew(建议)</h2><h3 id=\"MacPorts\"><a href=\"#MacPorts\" class=\"headerlink\" title=\"MacPorts\"></a>MacPorts</h3><p>MacPorts就像apt-get、yum一样，可以快速安装些软件。<br>你可以使用dmg或源码安装两种方式。但是我发现我的电脑在使用dmg安装一直卡在run scripts，故最后我还是使用源码安装了。<br>从<a href=\"http://distfiles.macports.org/MacPorts/MacPorts-2.1.2.tar.gz下载源码包。\" target=\"_blank\" rel=\"external\">http://distfiles.macports.org/MacPorts/MacPorts-2.1.2.tar.gz下载源码包。</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">tar zxf MacPorts-2.1.2.tar.gz</div><div class=\"line\">cd MacPorts-2.1.2</div><div class=\"line\">./configure</div><div class=\"line\">make &amp;&amp; sudo make install</div></pre></td></tr></table></figure>\n<p>更多的使用方式，你可能参考一下这篇:</p>\n<p>Mac OS X中MacPorts安装和使用<br><a href=\"http://www.ccvita.com/434.html\" target=\"_blank\" rel=\"external\">http://www.ccvita.com/434.html</a></p>\n<h3 id=\"Homebrew\"><a href=\"#Homebrew\" class=\"headerlink\" title=\"Homebrew\"></a>Homebrew</h3><p>官网<a href=\"http://mxcl.github.com/homebrew/\" target=\"_blank\" rel=\"external\">http://mxcl.github.com/homebrew/</a><br>The missing package manager for OS X</p>\n<p>Install Homebrew<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ruby -e &quot;$(curl -fsSL https://raw.github.com/mxcl/homebrew/go)&quot;</div></pre></td></tr></table></figure></p>\n<h2 id=\"版本控制工具svn客户端\"><a href=\"#版本控制工具svn客户端\" class=\"headerlink\" title=\"版本控制工具svn客户端\"></a>版本控制工具svn客户端</h2><p>如果你不习惯命令行下svn操作，你可以安装一下Versions客户端，这个有30天的试用期。<br>但是要注意的是：有时候在命令行下操作更简单方便！</p>\n<h2 id=\"jdk与eclipse-myeclipse\"><a href=\"#jdk与eclipse-myeclipse\" class=\"headerlink\" title=\"jdk与eclipse(myeclipse)\"></a>jdk与eclipse(myeclipse)</h2><p>如果你是搞Java开发，这应该难不倒你！</p>\n<h2 id=\"php-mysql\"><a href=\"#php-mysql\" class=\"headerlink\" title=\"php+mysql\"></a>php+mysql</h2><p>相关安装配置可参考这篇文章：<br>在Mac OS X中配置Apache ＋ PHP ＋ MySQL<br><a href=\"http://dancewithnet.com/2010/05/09/run-apache-php-mysql-in-mac-os-x/\" target=\"_blank\" rel=\"external\">http://dancewithnet.com/2010/05/09/run-apache-php-mysql-in-mac-os-x/</a></p>\n<h2 id=\"OmniGraffle-Professional-顶级流程图软件\"><a href=\"#OmniGraffle-Professional-顶级流程图软件\" class=\"headerlink\" title=\"OmniGraffle Professional 顶级流程图软件\"></a>OmniGraffle Professional 顶级流程图软件</h2><p>真的非常好用。功能强大，有很多模板。<a href=\"http://graffletopia.com/\" target=\"_blank\" rel=\"external\">http://graffletopia.com/</a> 是目前最受欢迎的OmniGraffle模板站。</p>\n<h2 id=\"其它：QQ、迅雷等，都有相应mac版。\"><a href=\"#其它：QQ、迅雷等，都有相应mac版。\" class=\"headerlink\" title=\"其它：QQ、迅雷等，都有相应mac版。\"></a>其它：QQ、迅雷等，都有相应mac版。</h2><p>建议：虽然windows下的工具mac下都有相应替代产品，但熟悉命令行基本命令(如tar、find、grep、svn、sed等)的操作，会让你更加得心应手。</p>\n","excerpt":"<p>mac必备工具集</p>","more":"<h2 id=\"Alfred-必备\"><a href=\"#Alfred-必备\" class=\"headerlink\" title=\"Alfred(必备)\"></a>Alfred(必备)</h2><p>Alfred is an award-winning productivity application for Mac OS X, which aims to save you time in searching your local computer and the web.</p>\n<p><img src=\"/images/2013/newer-should-be-known-in-mac/01.png\" alt=\"img01\"></p>\n<p><img src=\"/images/2013/newer-should-be-known-in-mac/02.png\" alt=\"img01\"></p>\n<h2 id=\"OS-X-键盘快捷键\"><a href=\"#OS-X-键盘快捷键\" class=\"headerlink\" title=\"OS X 键盘快捷键\"></a>OS X 键盘快捷键</h2><p>完整的快捷键可参考：<a href=\"http://support.apple.com/kb/HT1343?viewlocale=zh_CN\">http://support.apple.com/kb/HT1343?viewlocale=zh_CN</a>  </p>\n<p>#####Mac截图快捷键<br>来源：<a href=\"http://www.dnzs123.com/html/os/mac/672.html\">http://www.dnzs123.com/html/os/mac/672.html</a></p>\n<p>全屏截图：Command-Shift-3<br>指定区域截图：Command-Shift-4<br>指定程序窗口截图：Commnad-Shift-4-Space</p>\n<p>使用快捷键 Command-Shift-4 并用鼠标选取需要截图的区域后，不要松开鼠标，然后你有几种选择：  </p>\n<ol>\n<li>按住鼠标的同时，按空格键，这时你能通过移动鼠标来移动整个已选择区域。   </li>\n<li>按住鼠标的同时，按 Shift 键，这时你能通过横向或竖向移动鼠标来改变已选择区域的长或高。  </li>\n<li>按住鼠标的同时，按 Option 键，这时你通过移动鼠标可以改变已选择区域的半径大小。   </li>\n<li>当你使用快捷键后发现想停止截图，在按住鼠标的同时只要按Esc就会中止截图的过程，不会保存任何文件。<br>如果不改变设置, 所有截图会默认保存到桌面，也就是 Desktop 文件夹。  </li>\n</ol>\n<p>常用的快捷键：<a href=\"http://www.douban.com/group/topic/27163791/\">http://www.douban.com/group/topic/27163791/</a></p>\n<h2 id=\"office套件\"><a href=\"#office套件\" class=\"headerlink\" title=\"office套件\"></a>office套件</h2><p>为了更好的的兼容windows中的word，我目前装的是mac word2011,你也可以安装iwork或者使用开源的open office。</p>\n<h2 id=\"Google-Chrome浏览器\"><a href=\"#Google-Chrome浏览器\" class=\"headerlink\" title=\"Google Chrome浏览器\"></a>Google Chrome浏览器</h2><p>虽然用自带的浏览器Safari已经够用，但我还是多装了一个Chrome浏览器。</p>\n<h2 id=\"Evernote\"><a href=\"#Evernote\" class=\"headerlink\" title=\"Evernote\"></a>Evernote</h2><p>必备。笔记本工具，不必多说了。但我目前使用的时候经常抛异常出来，不知道是否是兼容性或稳定性做得还不够好！</p>\n<h2 id=\"Xcode\"><a href=\"#Xcode\" class=\"headerlink\" title=\"Xcode\"></a>Xcode</h2><p>开发必备！可以从app store免费下载,先安装 XCode, 然后安装 Command Line Tools。</p>\n<h2 id=\"MacPorts或Homebrew-建议\"><a href=\"#MacPorts或Homebrew-建议\" class=\"headerlink\" title=\"MacPorts或Homebrew(建议)\"></a>MacPorts或Homebrew(建议)</h2><h3 id=\"MacPorts\"><a href=\"#MacPorts\" class=\"headerlink\" title=\"MacPorts\"></a>MacPorts</h3><p>MacPorts就像apt-get、yum一样，可以快速安装些软件。<br>你可以使用dmg或源码安装两种方式。但是我发现我的电脑在使用dmg安装一直卡在run scripts，故最后我还是使用源码安装了。<br>从<a href=\"http://distfiles.macports.org/MacPorts/MacPorts-2.1.2.tar.gz下载源码包。\">http://distfiles.macports.org/MacPorts/MacPorts-2.1.2.tar.gz下载源码包。</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">tar zxf MacPorts-2.1.2.tar.gz</div><div class=\"line\">cd MacPorts-2.1.2</div><div class=\"line\">./configure</div><div class=\"line\">make &amp;&amp; sudo make install</div></pre></td></tr></table></figure>\n<p>更多的使用方式，你可能参考一下这篇:</p>\n<p>Mac OS X中MacPorts安装和使用<br><a href=\"http://www.ccvita.com/434.html\">http://www.ccvita.com/434.html</a></p>\n<h3 id=\"Homebrew\"><a href=\"#Homebrew\" class=\"headerlink\" title=\"Homebrew\"></a>Homebrew</h3><p>官网<a href=\"http://mxcl.github.com/homebrew/\">http://mxcl.github.com/homebrew/</a><br>The missing package manager for OS X</p>\n<p>Install Homebrew<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ruby -e &quot;$(curl -fsSL https://raw.github.com/mxcl/homebrew/go)&quot;</div></pre></td></tr></table></figure></p>\n<h2 id=\"版本控制工具svn客户端\"><a href=\"#版本控制工具svn客户端\" class=\"headerlink\" title=\"版本控制工具svn客户端\"></a>版本控制工具svn客户端</h2><p>如果你不习惯命令行下svn操作，你可以安装一下Versions客户端，这个有30天的试用期。<br>但是要注意的是：有时候在命令行下操作更简单方便！</p>\n<h2 id=\"jdk与eclipse-myeclipse\"><a href=\"#jdk与eclipse-myeclipse\" class=\"headerlink\" title=\"jdk与eclipse(myeclipse)\"></a>jdk与eclipse(myeclipse)</h2><p>如果你是搞Java开发，这应该难不倒你！</p>\n<h2 id=\"php-mysql\"><a href=\"#php-mysql\" class=\"headerlink\" title=\"php+mysql\"></a>php+mysql</h2><p>相关安装配置可参考这篇文章：<br>在Mac OS X中配置Apache ＋ PHP ＋ MySQL<br><a href=\"http://dancewithnet.com/2010/05/09/run-apache-php-mysql-in-mac-os-x/\">http://dancewithnet.com/2010/05/09/run-apache-php-mysql-in-mac-os-x/</a></p>\n<h2 id=\"OmniGraffle-Professional-顶级流程图软件\"><a href=\"#OmniGraffle-Professional-顶级流程图软件\" class=\"headerlink\" title=\"OmniGraffle Professional 顶级流程图软件\"></a>OmniGraffle Professional 顶级流程图软件</h2><p>真的非常好用。功能强大，有很多模板。<a href=\"http://graffletopia.com/\">http://graffletopia.com/</a> 是目前最受欢迎的OmniGraffle模板站。</p>\n<h2 id=\"其它：QQ、迅雷等，都有相应mac版。\"><a href=\"#其它：QQ、迅雷等，都有相应mac版。\" class=\"headerlink\" title=\"其它：QQ、迅雷等，都有相应mac版。\"></a>其它：QQ、迅雷等，都有相应mac版。</h2><p>建议：虽然windows下的工具mac下都有相应替代产品，但熟悉命令行基本命令(如tar、find、grep、svn、sed等)的操作，会让你更加得心应手。</p>"},{"layout":"post","title":"导入spring3.2源码到myeclipse中","date":"2013-01-16T08:31:00.000Z","comments":1,"_content":"\nspring3.2通过新的基于Gradle的构建来构建项目，它取代了之前的Ant+Ivy系统。\n本文就介绍如何将spring3.2的源码导入到myeclipse中。\n\n<!-- more -->\n\n大伙可先参考一下spring的官方文档说明：https://github.com/SpringSource/spring-framework\n\n```\nBuilding from source  \nThe Spring Framework uses a Gradle-based build system. In the instructions below, ./gradlew is invoked from the root of the source tree and serves as a cross-platform, self-contained bootstrap mechanism for the build. The only prerequisites are Git and JDK 1.7+.（先决条件是Git和JDK 1.7+）  \ncheck out sources  \n\tgit clone git://github.com/SpringSource/spring-framework.git\n \ncompile and test, build all jars, distribution zips and docs    \n\t./gradlew build\n \ninstall all spring-* jars into your local Maven cache  \n\t./gradlew install\nimport sources into your IDE  \nRun ./import-into-eclipse.sh or read import-into-idea.md as appropriate.  \n```\n\n###本人电脑环境：mac OS X 10.8.2，jdk1.7.0_11,git 1.7.10.2\n\n``` bash\nlie-mac:spring xionglie$ java -version\njava version \"1.7.0_11\"\nJava(TM) SE Runtime Environment (build 1.7.0_11-b21)\nJava HotSpot(TM) 64-Bit Server VM (build 23.6-b04, mixed mode)\nlie-mac:spring xionglie$ git --version\ngit version 1.7.10.2 (Apple Git-33)\n\n操作过程：\nlie-mac:~ xionglie$ cd ~/Downloads/spring/\nlie-mac:spring xionglie$ git clone git://github.com/SpringSource/spring-framework.git\nlie-mac:spring xionglie$ cd spring-framework\nlie-mac:spring-framework xionglie$ ./import-into-eclipse.sh \n```\n\n注意：   \n（1）.这里会执行5步操作，在第2步和第4步都要各导入(import)全部项目(~/Downloads/spring/spring-framework)到myeclipse中，相当于要导入两次，你只单独导入第4步的项目是不行的。    \n（2）STEP 1的时间会比较长，如果执行不下去，请多次执行 ./import-into-eclipse.sh ；    \n（3）myeclipse的编译环境要修改为jdk7,不要使用默认的jdk6。如我的jdk7的ire-home为 ：/Library/Java/JavaVirtualMachines/jdk1.7.0_11.jdk/Contents/Home        \n\nSpring Framework Eclipse/STS project import guide\nThis script will guide you through the process of importing the\nSpring Framework sources into Eclipse/STS. It is recommended that you\nhave a recent version of the SpringSource Tool Suite (this script has\nbeen tested against STS 2.9.2.RELEASE), but at the minimum you will\nneed Eclipse + AJDT.  \nIf you need to download and install STS, please do that now by\nvisiting http://springsource.org/downloads/sts\nOtherwise, press enter and we'll begin. (按enter)  \n \n \n## STEP 1: Generate subproject Eclipse metadata\nThe first step will be to generate Eclipse project metadata for each  \nof the spring-* subprojects. This happens via the built-in   \n\"Gradle wrapper\" script (./gradlew in this directory). If this is your  \nfirst time using the Gradle wrapper, this step may take a few minutes  \nwhile a Gradle distribution is downloaded for you.  \nThe command run will be:\n\n```\n./gradlew cleanEclipse :spring-oxm:compileTestJava eclipse -x :eclipse\nPress enter when ready. (按enter)\n:buildSrc:compileJava UP-TO-DATE\n:buildSrc:compileGroovy UP-TO-DATE\n:buildSrc:processResources UP-TO-DATE\n\n…省略….\nBUILD SUCCESSFUL\n\n\nTotal time: 10 mins 30.351 secs\n```\n\n## STEP 2: Import subprojects into Eclipse/STS\nWithin Eclipse/STS, do the following:\n\tFile > Import... > Existing Projects into Workspace\n\\>When prompted for the 'root directory', provide /Users/xionglie/Downloads/spring/spring-framework    \n\\> Press enter. You will see the modules show up under \"Projects\"  \n\\> All projects should be selected/checked. Click Finish.   \n\\> When the project import is complete, you should have no errors.    \nWhen the above is complete, return here and press the enter key.   \n\n## STEP 3: generate root project Eclipse metadata\nUnfortunately, Eclipse does not allow for importing project  \nhierarchies, so we had to skip root project metadata generation in the  \nduring step 1. In this step we simply generate root project metadata  \nso you can import it in the next step.\nThe command run will be:\n\n```\n./gradlew :eclipse\nPress the enter key when ready.\n:buildSrc:compileJava UP-TO-DATE\n:buildSrc:compileGroovy UP-TO-DATE\n:buildSrc:processResources UP-TO-DATE\n:buildSrc:classes UP-TO-DATE\n:buildSrc:jar UP-TO-DATE\n:buildSrc:assemble UP-TO-DATE\n:buildSrc:compileTestJava UP-TO-DATE\n:buildSrc:compileTestGroovy UP-TO-DATE\n:buildSrc:processTestResources UP-TO-DATE\n:buildSrc:testClasses UP-TO-DATE\n:buildSrc:test UP-TO-DATE\n:buildSrc:check UP-TO-DATE\n:buildSrc:build UP-TO-DATE\n:eclipseClasspath\n:eclipseJdtPrepare\n:eclipseJdt\n:eclipseProject\n:eclipseSettings\n:eclipseWstComponent\n:eclipse\nBUILD SUCCESSFUL\nTotal time: 16.551 secs\n```\n## STEP 4: Import root project into Eclipse/STS\nFollow the project import steps listed in step 2 above to import the\nroot project.   \nPress enter when complete, and move on to the final step.\n\n## STEP 5: Enable Git support for all projects\n- In the Eclipse/STS Package Explorer, select all spring* projects.\n- Right-click to open the context menu and select Team > Share Project…\n- In the Share Project dialog that appears, select Git and press Next\n- Check \"Use or create repository in parent folder of project\"\n- Click Finish\nWhen complete, you'll have Git support enabled for all projects.  \nYou're ready to code! Goodbye!\n\n## 最终导入结果：\n![Alt text](/images/2013/2013-01-16-import-spring-source-code-into-myeclipse.png)\n\n\n","source":"_posts/2013-01-16-import-spring-source-code-into-myeclipse.md","raw":"---\nlayout: post\ntitle: \"导入spring3.2源码到myeclipse中\"\ndate: 2013-01-16 16:31\ncomments: true\ncategories: spring\n---\n\nspring3.2通过新的基于Gradle的构建来构建项目，它取代了之前的Ant+Ivy系统。\n本文就介绍如何将spring3.2的源码导入到myeclipse中。\n\n<!-- more -->\n\n大伙可先参考一下spring的官方文档说明：https://github.com/SpringSource/spring-framework\n\n```\nBuilding from source  \nThe Spring Framework uses a Gradle-based build system. In the instructions below, ./gradlew is invoked from the root of the source tree and serves as a cross-platform, self-contained bootstrap mechanism for the build. The only prerequisites are Git and JDK 1.7+.（先决条件是Git和JDK 1.7+）  \ncheck out sources  \n\tgit clone git://github.com/SpringSource/spring-framework.git\n \ncompile and test, build all jars, distribution zips and docs    \n\t./gradlew build\n \ninstall all spring-* jars into your local Maven cache  \n\t./gradlew install\nimport sources into your IDE  \nRun ./import-into-eclipse.sh or read import-into-idea.md as appropriate.  \n```\n\n###本人电脑环境：mac OS X 10.8.2，jdk1.7.0_11,git 1.7.10.2\n\n``` bash\nlie-mac:spring xionglie$ java -version\njava version \"1.7.0_11\"\nJava(TM) SE Runtime Environment (build 1.7.0_11-b21)\nJava HotSpot(TM) 64-Bit Server VM (build 23.6-b04, mixed mode)\nlie-mac:spring xionglie$ git --version\ngit version 1.7.10.2 (Apple Git-33)\n\n操作过程：\nlie-mac:~ xionglie$ cd ~/Downloads/spring/\nlie-mac:spring xionglie$ git clone git://github.com/SpringSource/spring-framework.git\nlie-mac:spring xionglie$ cd spring-framework\nlie-mac:spring-framework xionglie$ ./import-into-eclipse.sh \n```\n\n注意：   \n（1）.这里会执行5步操作，在第2步和第4步都要各导入(import)全部项目(~/Downloads/spring/spring-framework)到myeclipse中，相当于要导入两次，你只单独导入第4步的项目是不行的。    \n（2）STEP 1的时间会比较长，如果执行不下去，请多次执行 ./import-into-eclipse.sh ；    \n（3）myeclipse的编译环境要修改为jdk7,不要使用默认的jdk6。如我的jdk7的ire-home为 ：/Library/Java/JavaVirtualMachines/jdk1.7.0_11.jdk/Contents/Home        \n\nSpring Framework Eclipse/STS project import guide\nThis script will guide you through the process of importing the\nSpring Framework sources into Eclipse/STS. It is recommended that you\nhave a recent version of the SpringSource Tool Suite (this script has\nbeen tested against STS 2.9.2.RELEASE), but at the minimum you will\nneed Eclipse + AJDT.  \nIf you need to download and install STS, please do that now by\nvisiting http://springsource.org/downloads/sts\nOtherwise, press enter and we'll begin. (按enter)  \n \n \n## STEP 1: Generate subproject Eclipse metadata\nThe first step will be to generate Eclipse project metadata for each  \nof the spring-* subprojects. This happens via the built-in   \n\"Gradle wrapper\" script (./gradlew in this directory). If this is your  \nfirst time using the Gradle wrapper, this step may take a few minutes  \nwhile a Gradle distribution is downloaded for you.  \nThe command run will be:\n\n```\n./gradlew cleanEclipse :spring-oxm:compileTestJava eclipse -x :eclipse\nPress enter when ready. (按enter)\n:buildSrc:compileJava UP-TO-DATE\n:buildSrc:compileGroovy UP-TO-DATE\n:buildSrc:processResources UP-TO-DATE\n\n…省略….\nBUILD SUCCESSFUL\n\n\nTotal time: 10 mins 30.351 secs\n```\n\n## STEP 2: Import subprojects into Eclipse/STS\nWithin Eclipse/STS, do the following:\n\tFile > Import... > Existing Projects into Workspace\n\\>When prompted for the 'root directory', provide /Users/xionglie/Downloads/spring/spring-framework    \n\\> Press enter. You will see the modules show up under \"Projects\"  \n\\> All projects should be selected/checked. Click Finish.   \n\\> When the project import is complete, you should have no errors.    \nWhen the above is complete, return here and press the enter key.   \n\n## STEP 3: generate root project Eclipse metadata\nUnfortunately, Eclipse does not allow for importing project  \nhierarchies, so we had to skip root project metadata generation in the  \nduring step 1. In this step we simply generate root project metadata  \nso you can import it in the next step.\nThe command run will be:\n\n```\n./gradlew :eclipse\nPress the enter key when ready.\n:buildSrc:compileJava UP-TO-DATE\n:buildSrc:compileGroovy UP-TO-DATE\n:buildSrc:processResources UP-TO-DATE\n:buildSrc:classes UP-TO-DATE\n:buildSrc:jar UP-TO-DATE\n:buildSrc:assemble UP-TO-DATE\n:buildSrc:compileTestJava UP-TO-DATE\n:buildSrc:compileTestGroovy UP-TO-DATE\n:buildSrc:processTestResources UP-TO-DATE\n:buildSrc:testClasses UP-TO-DATE\n:buildSrc:test UP-TO-DATE\n:buildSrc:check UP-TO-DATE\n:buildSrc:build UP-TO-DATE\n:eclipseClasspath\n:eclipseJdtPrepare\n:eclipseJdt\n:eclipseProject\n:eclipseSettings\n:eclipseWstComponent\n:eclipse\nBUILD SUCCESSFUL\nTotal time: 16.551 secs\n```\n## STEP 4: Import root project into Eclipse/STS\nFollow the project import steps listed in step 2 above to import the\nroot project.   \nPress enter when complete, and move on to the final step.\n\n## STEP 5: Enable Git support for all projects\n- In the Eclipse/STS Package Explorer, select all spring* projects.\n- Right-click to open the context menu and select Team > Share Project…\n- In the Share Project dialog that appears, select Git and press Next\n- Check \"Use or create repository in parent folder of project\"\n- Click Finish\nWhen complete, you'll have Git support enabled for all projects.  \nYou're ready to code! Goodbye!\n\n## 最终导入结果：\n![Alt text](/images/2013/2013-01-16-import-spring-source-code-into-myeclipse.png)\n\n\n","slug":"import-spring-source-code-into-myeclipse","published":1,"updated":"2017-01-27T01:34:43.000Z","photos":[],"link":"","_id":"ciyf7fkaq000hf2jy0l49zzjx","content":"<p>spring3.2通过新的基于Gradle的构建来构建项目，它取代了之前的Ant+Ivy系统。<br>本文就介绍如何将spring3.2的源码导入到myeclipse中。</p>\n<a id=\"more\"></a>\n<p>大伙可先参考一下spring的官方文档说明：<a href=\"https://github.com/SpringSource/spring-framework\" target=\"_blank\" rel=\"external\">https://github.com/SpringSource/spring-framework</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">Building from source  </div><div class=\"line\">The Spring Framework uses a Gradle-based build system. In the instructions below, ./gradlew is invoked from the root of the source tree and serves as a cross-platform, self-contained bootstrap mechanism for the build. The only prerequisites are Git and JDK 1.7+.（先决条件是Git和JDK 1.7+）  </div><div class=\"line\">check out sources  </div><div class=\"line\">\tgit clone git://github.com/SpringSource/spring-framework.git</div><div class=\"line\"> </div><div class=\"line\">compile and test, build all jars, distribution zips and docs    </div><div class=\"line\">\t./gradlew build</div><div class=\"line\"> </div><div class=\"line\">install all spring-* jars into your local Maven cache  </div><div class=\"line\">\t./gradlew install</div><div class=\"line\">import sources into your IDE  </div><div class=\"line\">Run ./import-into-eclipse.sh or read import-into-idea.md as appropriate.</div></pre></td></tr></table></figure>\n<p>###本人电脑环境：mac OS X 10.8.2，jdk1.7.0_11,git 1.7.10.2</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">lie-mac:spring xionglie$ java -version</div><div class=\"line\">java version <span class=\"string\">\"1.7.0_11\"</span></div><div class=\"line\">Java(TM) SE Runtime Environment (build 1.7.0_11-b21)</div><div class=\"line\">Java HotSpot(TM) 64-Bit Server VM (build 23.6-b04, mixed mode)</div><div class=\"line\">lie-mac:spring xionglie$ git --version</div><div class=\"line\">git version 1.7.10.2 (Apple Git-33)</div><div class=\"line\"></div><div class=\"line\">操作过程：</div><div class=\"line\">lie-mac:~ xionglie$ <span class=\"built_in\">cd</span> ~/Downloads/spring/</div><div class=\"line\">lie-mac:spring xionglie$ git <span class=\"built_in\">clone</span> git://github.com/SpringSource/spring-framework.git</div><div class=\"line\">lie-mac:spring xionglie$ <span class=\"built_in\">cd</span> spring-framework</div><div class=\"line\">lie-mac:spring-framework xionglie$ ./import-into-eclipse.sh</div></pre></td></tr></table></figure>\n<p>注意：<br>（1）.这里会执行5步操作，在第2步和第4步都要各导入(import)全部项目(~/Downloads/spring/spring-framework)到myeclipse中，相当于要导入两次，你只单独导入第4步的项目是不行的。<br>（2）STEP 1的时间会比较长，如果执行不下去，请多次执行 ./import-into-eclipse.sh ；<br>（3）myeclipse的编译环境要修改为jdk7,不要使用默认的jdk6。如我的jdk7的ire-home为 ：/Library/Java/JavaVirtualMachines/jdk1.7.0_11.jdk/Contents/Home        </p>\n<p>Spring Framework Eclipse/STS project import guide<br>This script will guide you through the process of importing the<br>Spring Framework sources into Eclipse/STS. It is recommended that you<br>have a recent version of the SpringSource Tool Suite (this script has<br>been tested against STS 2.9.2.RELEASE), but at the minimum you will<br>need Eclipse + AJDT.<br>If you need to download and install STS, please do that now by<br>visiting <a href=\"http://springsource.org/downloads/sts\" target=\"_blank\" rel=\"external\">http://springsource.org/downloads/sts</a><br>Otherwise, press enter and we’ll begin. (按enter)  </p>\n<h2 id=\"STEP-1-Generate-subproject-Eclipse-metadata\"><a href=\"#STEP-1-Generate-subproject-Eclipse-metadata\" class=\"headerlink\" title=\"STEP 1: Generate subproject Eclipse metadata\"></a>STEP 1: Generate subproject Eclipse metadata</h2><p>The first step will be to generate Eclipse project metadata for each<br>of the spring-* subprojects. This happens via the built-in<br>“Gradle wrapper” script (./gradlew in this directory). If this is your<br>first time using the Gradle wrapper, this step may take a few minutes<br>while a Gradle distribution is downloaded for you.<br>The command run will be:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">./gradlew cleanEclipse :spring-oxm:compileTestJava eclipse -x :eclipse</div><div class=\"line\">Press enter when ready. (按enter)</div><div class=\"line\">:buildSrc:compileJava UP-TO-DATE</div><div class=\"line\">:buildSrc:compileGroovy UP-TO-DATE</div><div class=\"line\">:buildSrc:processResources UP-TO-DATE</div><div class=\"line\"></div><div class=\"line\">…省略….</div><div class=\"line\">BUILD SUCCESSFUL</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Total time: 10 mins 30.351 secs</div></pre></td></tr></table></figure>\n<h2 id=\"STEP-2-Import-subprojects-into-Eclipse-STS\"><a href=\"#STEP-2-Import-subprojects-into-Eclipse-STS\" class=\"headerlink\" title=\"STEP 2: Import subprojects into Eclipse/STS\"></a>STEP 2: Import subprojects into Eclipse/STS</h2><p>Within Eclipse/STS, do the following:<br>    File &gt; Import… &gt; Existing Projects into Workspace<br>>When prompted for the ‘root directory’, provide /Users/xionglie/Downloads/spring/spring-framework<br>> Press enter. You will see the modules show up under “Projects”<br>> All projects should be selected/checked. Click Finish.<br>> When the project import is complete, you should have no errors.<br>When the above is complete, return here and press the enter key.   </p>\n<h2 id=\"STEP-3-generate-root-project-Eclipse-metadata\"><a href=\"#STEP-3-generate-root-project-Eclipse-metadata\" class=\"headerlink\" title=\"STEP 3: generate root project Eclipse metadata\"></a>STEP 3: generate root project Eclipse metadata</h2><p>Unfortunately, Eclipse does not allow for importing project<br>hierarchies, so we had to skip root project metadata generation in the<br>during step 1. In this step we simply generate root project metadata<br>so you can import it in the next step.<br>The command run will be:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div></pre></td><td class=\"code\"><pre><div class=\"line\">./gradlew :eclipse</div><div class=\"line\">Press the enter key when ready.</div><div class=\"line\">:buildSrc:compileJava UP-TO-DATE</div><div class=\"line\">:buildSrc:compileGroovy UP-TO-DATE</div><div class=\"line\">:buildSrc:processResources UP-TO-DATE</div><div class=\"line\">:buildSrc:classes UP-TO-DATE</div><div class=\"line\">:buildSrc:jar UP-TO-DATE</div><div class=\"line\">:buildSrc:assemble UP-TO-DATE</div><div class=\"line\">:buildSrc:compileTestJava UP-TO-DATE</div><div class=\"line\">:buildSrc:compileTestGroovy UP-TO-DATE</div><div class=\"line\">:buildSrc:processTestResources UP-TO-DATE</div><div class=\"line\">:buildSrc:testClasses UP-TO-DATE</div><div class=\"line\">:buildSrc:test UP-TO-DATE</div><div class=\"line\">:buildSrc:check UP-TO-DATE</div><div class=\"line\">:buildSrc:build UP-TO-DATE</div><div class=\"line\">:eclipseClasspath</div><div class=\"line\">:eclipseJdtPrepare</div><div class=\"line\">:eclipseJdt</div><div class=\"line\">:eclipseProject</div><div class=\"line\">:eclipseSettings</div><div class=\"line\">:eclipseWstComponent</div><div class=\"line\">:eclipse</div><div class=\"line\">BUILD SUCCESSFUL</div><div class=\"line\">Total time: 16.551 secs</div></pre></td></tr></table></figure>\n<h2 id=\"STEP-4-Import-root-project-into-Eclipse-STS\"><a href=\"#STEP-4-Import-root-project-into-Eclipse-STS\" class=\"headerlink\" title=\"STEP 4: Import root project into Eclipse/STS\"></a>STEP 4: Import root project into Eclipse/STS</h2><p>Follow the project import steps listed in step 2 above to import the<br>root project.<br>Press enter when complete, and move on to the final step.</p>\n<h2 id=\"STEP-5-Enable-Git-support-for-all-projects\"><a href=\"#STEP-5-Enable-Git-support-for-all-projects\" class=\"headerlink\" title=\"STEP 5: Enable Git support for all projects\"></a>STEP 5: Enable Git support for all projects</h2><ul>\n<li>In the Eclipse/STS Package Explorer, select all spring* projects.</li>\n<li>Right-click to open the context menu and select Team &gt; Share Project…</li>\n<li>In the Share Project dialog that appears, select Git and press Next</li>\n<li>Check “Use or create repository in parent folder of project”</li>\n<li>Click Finish<br>When complete, you’ll have Git support enabled for all projects.<br>You’re ready to code! Goodbye!</li>\n</ul>\n<h2 id=\"最终导入结果：\"><a href=\"#最终导入结果：\" class=\"headerlink\" title=\"最终导入结果：\"></a>最终导入结果：</h2><p><img src=\"/images/2013/2013-01-16-import-spring-source-code-into-myeclipse.png\" alt=\"Alt text\"></p>\n","excerpt":"<p>spring3.2通过新的基于Gradle的构建来构建项目，它取代了之前的Ant+Ivy系统。<br>本文就介绍如何将spring3.2的源码导入到myeclipse中。</p>","more":"<p>大伙可先参考一下spring的官方文档说明：<a href=\"https://github.com/SpringSource/spring-framework\">https://github.com/SpringSource/spring-framework</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">Building from source  </div><div class=\"line\">The Spring Framework uses a Gradle-based build system. In the instructions below, ./gradlew is invoked from the root of the source tree and serves as a cross-platform, self-contained bootstrap mechanism for the build. The only prerequisites are Git and JDK 1.7+.（先决条件是Git和JDK 1.7+）  </div><div class=\"line\">check out sources  </div><div class=\"line\">\tgit clone git://github.com/SpringSource/spring-framework.git</div><div class=\"line\"> </div><div class=\"line\">compile and test, build all jars, distribution zips and docs    </div><div class=\"line\">\t./gradlew build</div><div class=\"line\"> </div><div class=\"line\">install all spring-* jars into your local Maven cache  </div><div class=\"line\">\t./gradlew install</div><div class=\"line\">import sources into your IDE  </div><div class=\"line\">Run ./import-into-eclipse.sh or read import-into-idea.md as appropriate.</div></pre></td></tr></table></figure>\n<p>###本人电脑环境：mac OS X 10.8.2，jdk1.7.0_11,git 1.7.10.2</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">lie-mac:spring xionglie$ java -version</div><div class=\"line\">java version <span class=\"string\">\"1.7.0_11\"</span></div><div class=\"line\">Java(TM) SE Runtime Environment (build 1.7.0_11-b21)</div><div class=\"line\">Java HotSpot(TM) 64-Bit Server VM (build 23.6-b04, mixed mode)</div><div class=\"line\">lie-mac:spring xionglie$ git --version</div><div class=\"line\">git version 1.7.10.2 (Apple Git-33)</div><div class=\"line\"></div><div class=\"line\">操作过程：</div><div class=\"line\">lie-mac:~ xionglie$ <span class=\"built_in\">cd</span> ~/Downloads/spring/</div><div class=\"line\">lie-mac:spring xionglie$ git <span class=\"built_in\">clone</span> git://github.com/SpringSource/spring-framework.git</div><div class=\"line\">lie-mac:spring xionglie$ <span class=\"built_in\">cd</span> spring-framework</div><div class=\"line\">lie-mac:spring-framework xionglie$ ./import-into-eclipse.sh</div></pre></td></tr></table></figure>\n<p>注意：<br>（1）.这里会执行5步操作，在第2步和第4步都要各导入(import)全部项目(~/Downloads/spring/spring-framework)到myeclipse中，相当于要导入两次，你只单独导入第4步的项目是不行的。<br>（2）STEP 1的时间会比较长，如果执行不下去，请多次执行 ./import-into-eclipse.sh ；<br>（3）myeclipse的编译环境要修改为jdk7,不要使用默认的jdk6。如我的jdk7的ire-home为 ：/Library/Java/JavaVirtualMachines/jdk1.7.0_11.jdk/Contents/Home        </p>\n<p>Spring Framework Eclipse/STS project import guide<br>This script will guide you through the process of importing the<br>Spring Framework sources into Eclipse/STS. It is recommended that you<br>have a recent version of the SpringSource Tool Suite (this script has<br>been tested against STS 2.9.2.RELEASE), but at the minimum you will<br>need Eclipse + AJDT.<br>If you need to download and install STS, please do that now by<br>visiting <a href=\"http://springsource.org/downloads/sts\">http://springsource.org/downloads/sts</a><br>Otherwise, press enter and we’ll begin. (按enter)  </p>\n<h2 id=\"STEP-1-Generate-subproject-Eclipse-metadata\"><a href=\"#STEP-1-Generate-subproject-Eclipse-metadata\" class=\"headerlink\" title=\"STEP 1: Generate subproject Eclipse metadata\"></a>STEP 1: Generate subproject Eclipse metadata</h2><p>The first step will be to generate Eclipse project metadata for each<br>of the spring-* subprojects. This happens via the built-in<br>“Gradle wrapper” script (./gradlew in this directory). If this is your<br>first time using the Gradle wrapper, this step may take a few minutes<br>while a Gradle distribution is downloaded for you.<br>The command run will be:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">./gradlew cleanEclipse :spring-oxm:compileTestJava eclipse -x :eclipse</div><div class=\"line\">Press enter when ready. (按enter)</div><div class=\"line\">:buildSrc:compileJava UP-TO-DATE</div><div class=\"line\">:buildSrc:compileGroovy UP-TO-DATE</div><div class=\"line\">:buildSrc:processResources UP-TO-DATE</div><div class=\"line\"></div><div class=\"line\">…省略….</div><div class=\"line\">BUILD SUCCESSFUL</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Total time: 10 mins 30.351 secs</div></pre></td></tr></table></figure>\n<h2 id=\"STEP-2-Import-subprojects-into-Eclipse-STS\"><a href=\"#STEP-2-Import-subprojects-into-Eclipse-STS\" class=\"headerlink\" title=\"STEP 2: Import subprojects into Eclipse/STS\"></a>STEP 2: Import subprojects into Eclipse/STS</h2><p>Within Eclipse/STS, do the following:<br>    File &gt; Import… &gt; Existing Projects into Workspace<br>>When prompted for the ‘root directory’, provide /Users/xionglie/Downloads/spring/spring-framework<br>> Press enter. You will see the modules show up under “Projects”<br>> All projects should be selected/checked. Click Finish.<br>> When the project import is complete, you should have no errors.<br>When the above is complete, return here and press the enter key.   </p>\n<h2 id=\"STEP-3-generate-root-project-Eclipse-metadata\"><a href=\"#STEP-3-generate-root-project-Eclipse-metadata\" class=\"headerlink\" title=\"STEP 3: generate root project Eclipse metadata\"></a>STEP 3: generate root project Eclipse metadata</h2><p>Unfortunately, Eclipse does not allow for importing project<br>hierarchies, so we had to skip root project metadata generation in the<br>during step 1. In this step we simply generate root project metadata<br>so you can import it in the next step.<br>The command run will be:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div></pre></td><td class=\"code\"><pre><div class=\"line\">./gradlew :eclipse</div><div class=\"line\">Press the enter key when ready.</div><div class=\"line\">:buildSrc:compileJava UP-TO-DATE</div><div class=\"line\">:buildSrc:compileGroovy UP-TO-DATE</div><div class=\"line\">:buildSrc:processResources UP-TO-DATE</div><div class=\"line\">:buildSrc:classes UP-TO-DATE</div><div class=\"line\">:buildSrc:jar UP-TO-DATE</div><div class=\"line\">:buildSrc:assemble UP-TO-DATE</div><div class=\"line\">:buildSrc:compileTestJava UP-TO-DATE</div><div class=\"line\">:buildSrc:compileTestGroovy UP-TO-DATE</div><div class=\"line\">:buildSrc:processTestResources UP-TO-DATE</div><div class=\"line\">:buildSrc:testClasses UP-TO-DATE</div><div class=\"line\">:buildSrc:test UP-TO-DATE</div><div class=\"line\">:buildSrc:check UP-TO-DATE</div><div class=\"line\">:buildSrc:build UP-TO-DATE</div><div class=\"line\">:eclipseClasspath</div><div class=\"line\">:eclipseJdtPrepare</div><div class=\"line\">:eclipseJdt</div><div class=\"line\">:eclipseProject</div><div class=\"line\">:eclipseSettings</div><div class=\"line\">:eclipseWstComponent</div><div class=\"line\">:eclipse</div><div class=\"line\">BUILD SUCCESSFUL</div><div class=\"line\">Total time: 16.551 secs</div></pre></td></tr></table></figure>\n<h2 id=\"STEP-4-Import-root-project-into-Eclipse-STS\"><a href=\"#STEP-4-Import-root-project-into-Eclipse-STS\" class=\"headerlink\" title=\"STEP 4: Import root project into Eclipse/STS\"></a>STEP 4: Import root project into Eclipse/STS</h2><p>Follow the project import steps listed in step 2 above to import the<br>root project.<br>Press enter when complete, and move on to the final step.</p>\n<h2 id=\"STEP-5-Enable-Git-support-for-all-projects\"><a href=\"#STEP-5-Enable-Git-support-for-all-projects\" class=\"headerlink\" title=\"STEP 5: Enable Git support for all projects\"></a>STEP 5: Enable Git support for all projects</h2><ul>\n<li>In the Eclipse/STS Package Explorer, select all spring* projects.</li>\n<li>Right-click to open the context menu and select Team &gt; Share Project…</li>\n<li>In the Share Project dialog that appears, select Git and press Next</li>\n<li>Check “Use or create repository in parent folder of project”</li>\n<li>Click Finish<br>When complete, you’ll have Git support enabled for all projects.<br>You’re ready to code! Goodbye!</li>\n</ul>\n<h2 id=\"最终导入结果：\"><a href=\"#最终导入结果：\" class=\"headerlink\" title=\"最终导入结果：\"></a>最终导入结果：</h2><p><img src=\"/images/2013/2013-01-16-import-spring-source-code-into-myeclipse.png\" alt=\"Alt text\"></p>"},{"layout":"post","title":"使用gradle构建项目01-建立项目目录结构 ","date":"2013-02-17T14:01:00.000Z","comments":1,"_content":"gradle的目录的结构规范和maven是一样的，我们来看一下Maven标准目录结构  \n\n<!-- more -->\n\nIntroduction to the Standard Directory Layout  \n[http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html](http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html )\n\n```\nsrc/main/java\t\t#Application/Library sources\nsrc/main/resources\t#Application/Library resources\nsrc/main/filters\t#Resource filter files\nsrc/main/assembly\t#Assembly descriptors\nsrc/main/config\t\t#Configuration files\nsrc/main/scripts\t#Application/Library scripts\nsrc/main/webapp\t\t#Web application sources\nsrc/test/java\t\t#Test sources\nsrc/test/resources\t#Test resources\nsrc/test/filters\t#Test resource filter files\nsrc/site\t\t\t#Site\nLICENSE.txt\t\t\t#Project's license\nNOTICE.txt\t\t\t#Notices and attributions required by libraries that the project depends on\nREADME.txt\t\t\t#Project's readme\n```\n\n## 方法1：使用shell脚本\n```bash\n\tproject_name=testProject  \n\tmkdir -p ${project_name}  \n\tcd ${project_name} \n\tmkdir -p src/main/{java,resources} \n\tmkdir -p src/test/{java,resources} \n\t\n\t#生成web项目\n\tmkdir -p src/main/webapp\n```\n\t\n## 方法2：自定义task\n\n### (1)创建一个testProject目录  \n### (2)在testProject目录build.gradle：  \n\n```\napply plugin: 'java'\napply plugin: 'war'\n\ntask createJavaProject << {\n\tsourceSets*.java.srcDirs*.each { it.mkdirs() }\n\tsourceSets*.resources.srcDirs*.each { it.mkdirs()}\n}\n\ntask createWebProject(dependsOn: 'createJavaProject') << {\n\tdef webAppDir = file(\"$webAppDirName\")\n\twebAppDir.mkdirs()\n}\n\n```\n\n### (3)命令行运行 \n\ngradle createJavaProject  \t=>java项目   \ngradle createWebProject \t=>web项目  \n \n\n```bash\nxionglie@lie-mac:/tmp/testProject $ gradle createJavaProject\n:createJavaProject\n\nBUILD SUCCESSFUL\n\nTotal time: 3.31 secs\nxionglie@lie-mac:/tmp/testProject $ tree\n.\n├── build.gradle\n└── src\n    ├── main\n    │   ├── java\n    │   └── resources\n    └── test\n        ├── java\n        └── resources\n\n7 directories, 1 file\nxionglie@lie-mac:/tmp/testProject $ rm -rf src/\nxionglie@lie-mac:/tmp/testProject $ gradle createWebProject\n:createJavaProject\n:createWebProject\n\nBUILD SUCCESSFUL\n\nTotal time: 3.46 secs\nxionglie@lie-mac:/tmp/testProject $ tree\n.\n├── build.gradle\n└── src\n    ├── main\n    │   ├── java\n    │   ├── resources\n    │   └── webapp\n    └── test\n        ├── java\n        └── resources\n\n8 directories, 1 file\nxionglie@lie-mac:/tmp/testProject $ \n```\n","source":"_posts/2013-02-17-gradle-01-build-project-dir.md","raw":"---\nlayout: post\ntitle: \"使用gradle构建项目01-建立项目目录结构 \"\ndate: 2013-02-17 22:01\ncomments: true\ncategories: gradle\n---\ngradle的目录的结构规范和maven是一样的，我们来看一下Maven标准目录结构  \n\n<!-- more -->\n\nIntroduction to the Standard Directory Layout  \n[http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html](http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html )\n\n```\nsrc/main/java\t\t#Application/Library sources\nsrc/main/resources\t#Application/Library resources\nsrc/main/filters\t#Resource filter files\nsrc/main/assembly\t#Assembly descriptors\nsrc/main/config\t\t#Configuration files\nsrc/main/scripts\t#Application/Library scripts\nsrc/main/webapp\t\t#Web application sources\nsrc/test/java\t\t#Test sources\nsrc/test/resources\t#Test resources\nsrc/test/filters\t#Test resource filter files\nsrc/site\t\t\t#Site\nLICENSE.txt\t\t\t#Project's license\nNOTICE.txt\t\t\t#Notices and attributions required by libraries that the project depends on\nREADME.txt\t\t\t#Project's readme\n```\n\n## 方法1：使用shell脚本\n```bash\n\tproject_name=testProject  \n\tmkdir -p ${project_name}  \n\tcd ${project_name} \n\tmkdir -p src/main/{java,resources} \n\tmkdir -p src/test/{java,resources} \n\t\n\t#生成web项目\n\tmkdir -p src/main/webapp\n```\n\t\n## 方法2：自定义task\n\n### (1)创建一个testProject目录  \n### (2)在testProject目录build.gradle：  \n\n```\napply plugin: 'java'\napply plugin: 'war'\n\ntask createJavaProject << {\n\tsourceSets*.java.srcDirs*.each { it.mkdirs() }\n\tsourceSets*.resources.srcDirs*.each { it.mkdirs()}\n}\n\ntask createWebProject(dependsOn: 'createJavaProject') << {\n\tdef webAppDir = file(\"$webAppDirName\")\n\twebAppDir.mkdirs()\n}\n\n```\n\n### (3)命令行运行 \n\ngradle createJavaProject  \t=>java项目   \ngradle createWebProject \t=>web项目  \n \n\n```bash\nxionglie@lie-mac:/tmp/testProject $ gradle createJavaProject\n:createJavaProject\n\nBUILD SUCCESSFUL\n\nTotal time: 3.31 secs\nxionglie@lie-mac:/tmp/testProject $ tree\n.\n├── build.gradle\n└── src\n    ├── main\n    │   ├── java\n    │   └── resources\n    └── test\n        ├── java\n        └── resources\n\n7 directories, 1 file\nxionglie@lie-mac:/tmp/testProject $ rm -rf src/\nxionglie@lie-mac:/tmp/testProject $ gradle createWebProject\n:createJavaProject\n:createWebProject\n\nBUILD SUCCESSFUL\n\nTotal time: 3.46 secs\nxionglie@lie-mac:/tmp/testProject $ tree\n.\n├── build.gradle\n└── src\n    ├── main\n    │   ├── java\n    │   ├── resources\n    │   └── webapp\n    └── test\n        ├── java\n        └── resources\n\n8 directories, 1 file\nxionglie@lie-mac:/tmp/testProject $ \n```\n","slug":"gradle-01-build-project-dir","published":1,"updated":"2017-01-26T15:50:43.000Z","photos":[],"link":"","_id":"ciyf7fkat000kf2jy1j3vk1ll","content":"<p>gradle的目录的结构规范和maven是一样的，我们来看一下Maven标准目录结构  </p>\n<a id=\"more\"></a>\n<p>Introduction to the Standard Directory Layout<br><a href=\"http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html\" target=\"_blank\" rel=\"external\">http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">src/main/java\t\t#Application/Library sources</div><div class=\"line\">src/main/resources\t#Application/Library resources</div><div class=\"line\">src/main/filters\t#Resource filter files</div><div class=\"line\">src/main/assembly\t#Assembly descriptors</div><div class=\"line\">src/main/config\t\t#Configuration files</div><div class=\"line\">src/main/scripts\t#Application/Library scripts</div><div class=\"line\">src/main/webapp\t\t#Web application sources</div><div class=\"line\">src/test/java\t\t#Test sources</div><div class=\"line\">src/test/resources\t#Test resources</div><div class=\"line\">src/test/filters\t#Test resource filter files</div><div class=\"line\">src/site\t\t\t#Site</div><div class=\"line\">LICENSE.txt\t\t\t#Project&apos;s license</div><div class=\"line\">NOTICE.txt\t\t\t#Notices and attributions required by libraries that the project depends on</div><div class=\"line\">README.txt\t\t\t#Project&apos;s readme</div></pre></td></tr></table></figure>\n<h2 id=\"方法1：使用shell脚本\"><a href=\"#方法1：使用shell脚本\" class=\"headerlink\" title=\"方法1：使用shell脚本\"></a>方法1：使用shell脚本</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">project_name=<span class=\"built_in\">test</span>Project  </div><div class=\"line\">mkdir -p <span class=\"variable\">$&#123;project_name&#125;</span>  </div><div class=\"line\"><span class=\"built_in\">cd</span> <span class=\"variable\">$&#123;project_name&#125;</span> </div><div class=\"line\">mkdir -p src/main/&#123;java,resources&#125; </div><div class=\"line\">mkdir -p src/<span class=\"built_in\">test</span>/&#123;java,resources&#125; </div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#生成web项目</span></div><div class=\"line\">mkdir -p src/main/webapp</div></pre></td></tr></table></figure>\n<h2 id=\"方法2：自定义task\"><a href=\"#方法2：自定义task\" class=\"headerlink\" title=\"方法2：自定义task\"></a>方法2：自定义task</h2><h3 id=\"1-创建一个testProject目录\"><a href=\"#1-创建一个testProject目录\" class=\"headerlink\" title=\"(1)创建一个testProject目录\"></a>(1)创建一个testProject目录</h3><h3 id=\"2-在testProject目录build-gradle：\"><a href=\"#2-在testProject目录build-gradle：\" class=\"headerlink\" title=\"(2)在testProject目录build.gradle：\"></a>(2)在testProject目录build.gradle：</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">apply plugin: &apos;java&apos;</div><div class=\"line\">apply plugin: &apos;war&apos;</div><div class=\"line\"></div><div class=\"line\">task createJavaProject &lt;&lt; &#123;</div><div class=\"line\">\tsourceSets*.java.srcDirs*.each &#123; it.mkdirs() &#125;</div><div class=\"line\">\tsourceSets*.resources.srcDirs*.each &#123; it.mkdirs()&#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">task createWebProject(dependsOn: &apos;createJavaProject&apos;) &lt;&lt; &#123;</div><div class=\"line\">\tdef webAppDir = file(&quot;$webAppDirName&quot;)</div><div class=\"line\">\twebAppDir.mkdirs()</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"3-命令行运行\"><a href=\"#3-命令行运行\" class=\"headerlink\" title=\"(3)命令行运行\"></a>(3)命令行运行</h3><p>gradle createJavaProject      =&gt;java项目<br>gradle createWebProject     =&gt;web项目  </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div></pre></td><td class=\"code\"><pre><div class=\"line\">xionglie@lie-mac:/tmp/<span class=\"built_in\">test</span>Project $ gradle createJavaProject</div><div class=\"line\">:createJavaProject</div><div class=\"line\"></div><div class=\"line\">BUILD SUCCESSFUL</div><div class=\"line\"></div><div class=\"line\">Total time: 3.31 secs</div><div class=\"line\">xionglie@lie-mac:/tmp/<span class=\"built_in\">test</span>Project $ tree</div><div class=\"line\">.</div><div class=\"line\">├── build.gradle</div><div class=\"line\">└── src</div><div class=\"line\">    ├── main</div><div class=\"line\">    │   ├── java</div><div class=\"line\">    │   └── resources</div><div class=\"line\">    └── <span class=\"built_in\">test</span></div><div class=\"line\">        ├── java</div><div class=\"line\">        └── resources</div><div class=\"line\"></div><div class=\"line\">7 directories, 1 file</div><div class=\"line\">xionglie@lie-mac:/tmp/<span class=\"built_in\">test</span>Project $ rm -rf src/</div><div class=\"line\">xionglie@lie-mac:/tmp/<span class=\"built_in\">test</span>Project $ gradle createWebProject</div><div class=\"line\">:createJavaProject</div><div class=\"line\">:createWebProject</div><div class=\"line\"></div><div class=\"line\">BUILD SUCCESSFUL</div><div class=\"line\"></div><div class=\"line\">Total time: 3.46 secs</div><div class=\"line\">xionglie@lie-mac:/tmp/<span class=\"built_in\">test</span>Project $ tree</div><div class=\"line\">.</div><div class=\"line\">├── build.gradle</div><div class=\"line\">└── src</div><div class=\"line\">    ├── main</div><div class=\"line\">    │   ├── java</div><div class=\"line\">    │   ├── resources</div><div class=\"line\">    │   └── webapp</div><div class=\"line\">    └── <span class=\"built_in\">test</span></div><div class=\"line\">        ├── java</div><div class=\"line\">        └── resources</div><div class=\"line\"></div><div class=\"line\">8 directories, 1 file</div><div class=\"line\">xionglie@lie-mac:/tmp/<span class=\"built_in\">test</span>Project $</div></pre></td></tr></table></figure>\n","excerpt":"<p>gradle的目录的结构规范和maven是一样的，我们来看一下Maven标准目录结构  </p>","more":"<p>Introduction to the Standard Directory Layout<br><a href=\"http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html\">http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">src/main/java\t\t#Application/Library sources</div><div class=\"line\">src/main/resources\t#Application/Library resources</div><div class=\"line\">src/main/filters\t#Resource filter files</div><div class=\"line\">src/main/assembly\t#Assembly descriptors</div><div class=\"line\">src/main/config\t\t#Configuration files</div><div class=\"line\">src/main/scripts\t#Application/Library scripts</div><div class=\"line\">src/main/webapp\t\t#Web application sources</div><div class=\"line\">src/test/java\t\t#Test sources</div><div class=\"line\">src/test/resources\t#Test resources</div><div class=\"line\">src/test/filters\t#Test resource filter files</div><div class=\"line\">src/site\t\t\t#Site</div><div class=\"line\">LICENSE.txt\t\t\t#Project&apos;s license</div><div class=\"line\">NOTICE.txt\t\t\t#Notices and attributions required by libraries that the project depends on</div><div class=\"line\">README.txt\t\t\t#Project&apos;s readme</div></pre></td></tr></table></figure>\n<h2 id=\"方法1：使用shell脚本\"><a href=\"#方法1：使用shell脚本\" class=\"headerlink\" title=\"方法1：使用shell脚本\"></a>方法1：使用shell脚本</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">project_name=<span class=\"built_in\">test</span>Project  </div><div class=\"line\">mkdir -p <span class=\"variable\">$&#123;project_name&#125;</span>  </div><div class=\"line\"><span class=\"built_in\">cd</span> <span class=\"variable\">$&#123;project_name&#125;</span> </div><div class=\"line\">mkdir -p src/main/&#123;java,resources&#125; </div><div class=\"line\">mkdir -p src/<span class=\"built_in\">test</span>/&#123;java,resources&#125; </div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#生成web项目</span></div><div class=\"line\">mkdir -p src/main/webapp</div></pre></td></tr></table></figure>\n<h2 id=\"方法2：自定义task\"><a href=\"#方法2：自定义task\" class=\"headerlink\" title=\"方法2：自定义task\"></a>方法2：自定义task</h2><h3 id=\"1-创建一个testProject目录\"><a href=\"#1-创建一个testProject目录\" class=\"headerlink\" title=\"(1)创建一个testProject目录\"></a>(1)创建一个testProject目录</h3><h3 id=\"2-在testProject目录build-gradle：\"><a href=\"#2-在testProject目录build-gradle：\" class=\"headerlink\" title=\"(2)在testProject目录build.gradle：\"></a>(2)在testProject目录build.gradle：</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">apply plugin: &apos;java&apos;</div><div class=\"line\">apply plugin: &apos;war&apos;</div><div class=\"line\"></div><div class=\"line\">task createJavaProject &lt;&lt; &#123;</div><div class=\"line\">\tsourceSets*.java.srcDirs*.each &#123; it.mkdirs() &#125;</div><div class=\"line\">\tsourceSets*.resources.srcDirs*.each &#123; it.mkdirs()&#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">task createWebProject(dependsOn: &apos;createJavaProject&apos;) &lt;&lt; &#123;</div><div class=\"line\">\tdef webAppDir = file(&quot;$webAppDirName&quot;)</div><div class=\"line\">\twebAppDir.mkdirs()</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"3-命令行运行\"><a href=\"#3-命令行运行\" class=\"headerlink\" title=\"(3)命令行运行\"></a>(3)命令行运行</h3><p>gradle createJavaProject      =&gt;java项目<br>gradle createWebProject     =&gt;web项目  </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div></pre></td><td class=\"code\"><pre><div class=\"line\">xionglie@lie-mac:/tmp/<span class=\"built_in\">test</span>Project $ gradle createJavaProject</div><div class=\"line\">:createJavaProject</div><div class=\"line\"></div><div class=\"line\">BUILD SUCCESSFUL</div><div class=\"line\"></div><div class=\"line\">Total time: 3.31 secs</div><div class=\"line\">xionglie@lie-mac:/tmp/<span class=\"built_in\">test</span>Project $ tree</div><div class=\"line\">.</div><div class=\"line\">├── build.gradle</div><div class=\"line\">└── src</div><div class=\"line\">    ├── main</div><div class=\"line\">    │   ├── java</div><div class=\"line\">    │   └── resources</div><div class=\"line\">    └── <span class=\"built_in\">test</span></div><div class=\"line\">        ├── java</div><div class=\"line\">        └── resources</div><div class=\"line\"></div><div class=\"line\">7 directories, 1 file</div><div class=\"line\">xionglie@lie-mac:/tmp/<span class=\"built_in\">test</span>Project $ rm -rf src/</div><div class=\"line\">xionglie@lie-mac:/tmp/<span class=\"built_in\">test</span>Project $ gradle createWebProject</div><div class=\"line\">:createJavaProject</div><div class=\"line\">:createWebProject</div><div class=\"line\"></div><div class=\"line\">BUILD SUCCESSFUL</div><div class=\"line\"></div><div class=\"line\">Total time: 3.46 secs</div><div class=\"line\">xionglie@lie-mac:/tmp/<span class=\"built_in\">test</span>Project $ tree</div><div class=\"line\">.</div><div class=\"line\">├── build.gradle</div><div class=\"line\">└── src</div><div class=\"line\">    ├── main</div><div class=\"line\">    │   ├── java</div><div class=\"line\">    │   ├── resources</div><div class=\"line\">    │   └── webapp</div><div class=\"line\">    └── <span class=\"built_in\">test</span></div><div class=\"line\">        ├── java</div><div class=\"line\">        └── resources</div><div class=\"line\"></div><div class=\"line\">8 directories, 1 file</div><div class=\"line\">xionglie@lie-mac:/tmp/<span class=\"built_in\">test</span>Project $</div></pre></td></tr></table></figure>"},{"layout":"post","title":"linux系列2 - pxe+dhcp+nfs+kickstart无人值守批量安装Centos5.8 x64","date":"2013-01-24T10:05:00.000Z","comments":1,"_content":"\n上文进到，如果我们要安装几十上百台服务器，如何做呢？总不能一台一台人工安装吧！\n本文就来解决这个问题，看一下如何实现批量无人值守安装centos5.8 x64。\n\n<!-- more -->\n\n```\n目录 \n1.\t原理介绍\t\n1.1.\t什么是PXE\t\n1.2.\t什么是KickStart\t\n1.3.\t无人值守安装原理\t\n1.4.\t无人值守安装过程详细说明\t\n1.5.\tPXE+kickStart安装条件\t\n2.\t安装环境\t\n2.1.\tKickstart服务器环境说明\t\n3.\t一键安装脚本\t\n4.\t安装说明\t\n4.1.\t挂载系统安装盘\t\n4.2.\t设置nfs\t8\n4.3.\t设置tftp\t\n4.4.\t配置DHCP\t\n4.5.\t配置ks.cfg文件\t\n5. OS安装过程\n```\n\n#1. 原理介绍\n##1.1.\t什么是PXE\n严格来说，PXE并不是一种安装方式，而是一种引导方式。进行PXE安装的必要条件是在要安装的计算机中必须包含一个PXE支持的网卡(NIC)，即网卡中必须要有PXE Client。PXE(Pre-boot Execution Environment)协议可以使计算机通过网络启动。此协议分为Client端和Server端，而PXE Client则在网卡的ROM中。当计算机引导时，BIOS把PXE Client调入内存中执行，然后由PXE Client将放置在远端的文件通过网络下载到本地运行。运行PXE协议需要设置DHCP服务器和TFTP服务器。DHCP服务器会给PXE Client(将要安装系统的主机)分配一个IP地址，由于是给PXE Client分配IP地址，所以在配置DHCP服务器时需要增加相应的PXE设置。此外，在PXE Client的ROM中，已经存在了TFTP Client，那么它就可以通过TFTP协议到TFTP Server上下载所需的文件了。\n##1.2.\t什么是KickStart\nKickStart是一种无人值守的安装方式。它的工作原理是在安装过程中记录典型的需要人工干预填写的各种参数，并生成一个名为ks.cfg的文件。如果在安装过程中(不只局限于生成KickStart安装文件的机器)出现要填写参数的情况，安装程序首先会去查找KickStart生成的文件，如果找到合适的参数，就采用所找到的参数；如果没有找到合适的参数，便需要安装者手工干预了。所以，如果KickStart文件涵盖了安装过程中可能出现的所有需要填写的参数，那么安装者完全可以只告诉安装程序从何处取ks.cfg文件，然后就去忙自己的事情。等安装完毕，安装程序会根据ks.cfg中的设置重启系统，并结束安装。\n\n1.1、1.2资料来源：  \n《构建高可用Linux服务器（第2版）》   \nbook.51cto.com/art/201208/354168.htm\n\n##1.3. 无人值守安装原理\n客户机通过支持pxe的网卡向网络中发送请求DHCP信息的广播，请求获取ip地址等信息，网络中的DHCP服务器收到请求验证通过后，给客户机返回ip地址和相关信息(TFTP服务器地址、启动文件等),之后，客户机向网络中的TFTP服务器请求并下载操作系统安装所需要的文件。在这个过程中需要一台服务器来提供启动文件、安装文件、安装过程中的自动应答文件。\n\n\n\n##1.4.\t无人值守安装过程详细说明\n![alt txt](/images/2013/pxe-dhcp-nfs-kickstart/01.jpg)\n\n\n(1)\tPXE client向DHCP server发送请求   \n将支持PXE网络接口卡(NIC)的计算机的BIOS设置为以PXE方式启动，此时，PXE Client通过PXE Boot ROM会以UDP(简单用户数据协议)的形式在网络中发送一个广播请求，请求DHCP服务器分配IP地址等相关信息。\n\n(2)\tDHCP server应答PXE client  \nDHCP Server收到客户端请求，验证是否来自合法的PXE Client请求，验证通过后，它会回应PXE Client，回应中包含了为PXE Client分配的IP地址、pxelinux启动程序(TFTP)的位置，以及配置文件所在位置。\n\n(3)\tPXE client请求下载启动文件  \n客户端收到服务器的回应后，会向TFTP服务器请求传送启动系统安装所需文件。这些启动文件包括：pxelinux.0、pxelinux.cfg/default、vmlinuz、initrd.img等文件。\n\n(4)\tTFTP服务器响应客户端请求并传送文件  \n当TFTP服务器收到客户端请求后，它们之间会有更多的信息在客户端和服务器之间做应答，用以决定启动参数。BootROM由TFTP通讯协议从Boot Server下载启动安装程序所必须的文件（pxelinux.0、pxelinux.cfg/default）。default文件下载完成后，会根据该文件中定义的引导顺序，启动linux安装程序的引导内核。\n\n(5)\t请求下载自动应答文件   \npxe client通过pxelinux.cfg/default文件成功引导linux安装内核后，安装程序首先确定你通过什么安装来安装linux,如果是通过网络安装（NFS,FTP,HTTP）,则会在这个时候初始化网络，并定位安装系统所需的二进制包以及配置文件的位置。接着会读取该文件中指定的自动应答文件ks.cfg,然后根据ks.cfg中文件位置请求下载相关文件。  \n\n(6)\t客户端安装操作系统\n将ks.cfg文件下载回来后，通过该文件找到os server(可以是http,NFS,FTP等)，并按照该文件的配置请求下载安装过程中需要的软件包。   \nOS server和客户端建立连接后，将开始传输软件包。客户端开始安装操作系统，安装完成后，提示重新引导计算机。  \n\nPXE client是需要安装linux的客户机，TFTP Server、DHCP Server和NFS Server运行在另外一台或多台Linux Server上。Bootstrap文件、配置文件、Linux内核都放置在Linux Server上的TFTP服务器的根目录下。而linux的系统安装相关文件则存在NFS Server的共享目录中。   \nPXE client工作过程中，需要三个二进制文件：Bootstrap、Linux内核和Linux根文件系统。Bootstrap文件是可执行程序，它向用户提供简单的控制界面，并根据用户的选择，下载合适的Linux内核及根文件系统。   \n\n1.3,1.4资料感谢老男孩老师#\n  \n##1.5. PXE+kickStart安装条件  \n(1)\tDHCP 服务器  \n(2)\tTFTP 服务器\t\n(3)\tKickStart所生成的ks.cfg配置文件\t\n(4)\t一台存放系统安装文件的服务器，如 NFS、HTTP 或 FTP 服务器  \n(5)\t带有 PXE 支持网卡的待安装主机  \n\n#2. 安装环境\n##2.1.\tKickstart服务器环境说明\n###操作系统：\n\n``` bash\n[root@lie-pc ~]# cat /etc/redhat-release \nCentOS release 5.8 (Final) \n[root@lie-pc ~]# uname -mi\nx86_64 x86_64\n#内核版本：\n[root@lie-pc ~]# uname -r\n2.6.18-308.el5\n```\n\n####主机网络参数设置：\n主机名:\t\tlie-pc   \n网卡eth0:\t10.0.0.34  \n默认网关:\t\t10.0.0.2  \n子网掩码:\t\t255.255.255.0  \n\n#3. 一键安装脚本\nauto_install_centos.sh\n\n```bash\n#!/bin/bash\n # auto install kickstart server\n # the os root's passwd is 123456\n #\n # Filename: auto_install_centos.sh\n # Author: alex\n # Date:   2012-10-17  \n # Email:  xionglie.qu@gmail.com  \n #------------Environment------------  \n #   Linux 2.6.18-308.el5  i686 or x86_64\n #   CentOS release 5.8 (Final)\n #-----------------------------------  \n \n KICKSTART_SERVER_IP=`/sbin/ifconfig eth0 | grep 'inet addr' | awk '{print $2}' | awk -F: '{print $2}'`\n KICKSTART_SERVER_NET_ID=`echo ${KICKSTART_SERVER_IP} | cut -d '.' -f1-3 `\n KICKSTART_SERVER_SUBNET=${KICKSTART_SERVER_NET_ID}.0\n KICKSTART_SERVER_NETMASK=255.255.255.0\n KICKSTART_SERVER_ROUTE=${KICKSTART_SERVER_NET_ID}.2\n KICKSTART_SERVER_DHCP_IP_START=${KICKSTART_SERVER_NET_ID}.128\n KICKSTART_SERVER_DHCP_IP_END=${KICKSTART_SERVER_NET_ID}.254\n \n \n echo \"----- 1.配置nfs服务器 --------------\"\n #创建共享目录\n mkdir -p /data/sys\n mount -o loop /root/CentOS-5.8-x86_64-bin-DVD-1of2.iso /data/sys\n echo \"mount -o loop /root/CentOS-5.8-x86_64-bin-DVD-1of2.iso /data/sys\" >>/etc/rc.local\n \n #如果是用光盘就用下面的命令\n #mount /dev/cdrom /data/sys\n #echo \"mount /dev/cdrom /data/sys\" >>/etc/rc.local\n ls -l /data/sys\n \n #安装nfs,分发共享目录\n rpm -qa | grep nfs\n cat > /etc/exports << EOF\n /data/sys ${KICKSTART_SERVER_SUBNET}/24(ro,sync)\n /data/kickstart ${KICKSTART_SERVER_SUBNET}/24(ro,sync)\n EOF\n cat /etc/exports\n \n #启动nfs,设置开机启动\n /etc/init.d/portmap restart\n /etc/init.d/nfs restart\n showmount -e 127.0.0.1\n \n chkconfig portmap on\n chkconfig nfs on\n chkconfig --list | egrep \"nfs|portmap\"\n \n echo \"----- 2.配置TFTP服务器 --------------\"\n yum -y install tftp-server* -y\n sed -i '/disable.*=/ s#yes#no#' /etc/xinetd.d/tftp\n /etc/init.d/xinetd restart\n chkconfig xinetd on\n \n /bin/cp /usr/lib/syslinux/pxelinux.0 /tftpboot/\n /bin/cp /data/sys/images/pxeboot/vmlinuz /tftpboot/\n /bin/cp /data/sys/images/pxeboot/initrd.img /tftpboot/\n \n mkdir /tftpboot/pxelinux.cfg -p\n /bin/cp /data/sys/isolinux/isolinux.cfg /tftpboot/pxelinux.cfg/default\n chmod a+r /tftpboot/pxelinux.cfg/default\n sed -i \"s#default linux#default text#\" /tftpboot/pxelinux.cfg/default\n sed -i \"s#append initrd=initrd.img text#append ks=nfs:${KICKSTART_SERVER_IP}:/data/kickstart/ks.cfg ksdevice=eth0 initrd=initrd.img text#\" /tftpboot/pxelinux.cfg/default\n \n echo \"----- 3.配置DHCP --------------\"\n yum -y install dhcp*\n #/bin/cp /usr/share/doc/dhcp-3.0.5/dhcpd.conf.sample /etc/dhcpd.conf\n \n cat > /etc/dhcpd.conf << EOF\n ddns-update-style none;\n ignore client-updates;\n allow booting;\n allow bootp;\n default-lease-time 21600;\n max-lease-time 43200;\n option routers ${KICKSTART_SERVER_ROUTE};\n \n subnet ${KICKSTART_SERVER_SUBNET} netmask ${KICKSTART_SERVER_NETMASK} {\n range dynamic-bootp ${KICKSTART_SERVER_DHCP_IP_START} ${KICKSTART_SERVER_DHCP_IP_END};\n next-server ${KICKSTART_SERVER_IP};\n filename \"/data/kickstart/ks.cfg\";\n next-server ${KICKSTART_SERVER_IP};\n filename \"pxelinux.0\";\n }\n EOF\n \n /etc/init.d/dhcpd restart\n #出错的话，cat /var/log/message\n \n chkconfig dhcpd on\n chkconfig --list dhcpd\n \n echo \"----- 4.配置kickstart --------------\"\n mkdir -p /data/kickstart/\n #/bin/cp /root/anaconda-ks.cfg /data/kickstart/ks.cfg\n #chmod 644 /data/kickstart/ks.cfg\n \n cat > /data/kickstart/ks.cfg << EOF \n install\n nfs --server=${KICKSTART_SERVER_IP} --dir=/data/sys\n lang en_US.UTF-8\n keyboard us\n network --device=eth0 --bootproto=dhcp --onboot=on --hostname stu412\n #network --device=eth1 --bootproto=dhcp --onboot=on\n \n #root password\n rootpw 123456\n #rootpw --iscrypted \\$1\\$dQVhf2.F\\$wUhtrf7gHDN8Q6EtlrWSF.\n \n \n authconfig --enableshadow --enablemd5\n selinux --disabled\n firewall --disabled\n timezone --utc Asia/Shanghai\n bootloader --location=mbr --driveorder=sda\n firstboot --disabled\n logging --level=info\n zerombr\n \n \n #clearpart --linux\n clearpart --all\n part /boot --fstype ext3 --size=200 --asprimary\n part swap --size=512 --asprimary\n part / --fstype ext3 --size=1 --grow --asprimary\n reboot\n \n %packages\n @base\n @core\n @development-libs\n @development-tools\n @editors\n @system-tools\n @x-software-development\n \n %post\n #!/bin/bash\n mkdir -p /application/tools\n mkdir -p /server/scripts\n \n EOF\n \n echo \"-----done-----\"\n\n```\n\n\n#4. 安装说明\n##4.1.\t挂载系统安装盘\n\n```\n#创建共享目录\nmkdir -p /data/sys\nmount -o loop /root/CentOS-5.8-x86_64-bin-DVD-1of2.iso /data/sys\necho \"mount -o loop /root/CentOS-5.8-x86_64-bin-DVD-1of2.iso /data/sys\" >>/etc/rc.local\n \n#如果是用光盘就用下面的命令\n#mount /dev/cdrom /data/sys\n#echo \"mount /dev/cdrom /data/sys\" >>/etc/rc.local\nls -l /data/sys\n```\n\n##4.2. 设置nfs \n\n操作过程：\n\n```bash\n#安装nfs,分发共享目录\ncat > /etc/exports << EOF\n/data/sys ${KICKSTART_SERVER_SUBNET}/24(ro,sync)\n/data/kickstart ${KICKSTART_SERVER_SUBNET}/24(ro,sync)\nEOF\n```\n\n```\n[root@lie-pc ~]# cat /etc/exports \n/data/sys 10.0.0.0/24(ro,sync)\n/data/kickstart 10.0.0.0/24(ro,sync)\n\n[root@lie-pc ~]# showmount -e localhost \nExport list for localhost: \n/data/sys 10.0.0.0/24 \n/data/kickstart 10.0.0.0/24\n```\n\n##4.3. 设置tftp\n操作命令：\n\n```\n yum -y install tftp-server* -y\n sed -i '/disable.*=/ s#yes#no#' /etc/xinetd.d/tftp\n /etc/init.d/xinetd restart\n chkconfig xinetd on\n \n /bin/cp /usr/lib/syslinux/pxelinux.0 /tftpboot/\n /bin/cp /data/sys/images/pxeboot/vmlinuz /tftpboot/\n /bin/cp /data/sys/images/pxeboot/initrd.img /tftpboot/\n \n mkdir /tftpboot/pxelinux.cfg -p\n /bin/cp /data/sys/isolinux/isolinux.cfg /tftpboot/pxelinux.cfg/default\n chmod a+r /tftpboot/pxelinux.cfg/default\n sed -i \"s#default linux#default text#\" /tftpboot/pxelinux.cfg/default\n sed -i \"s#append initrd=initrd.img text#append ks=nfs:${KICKSTART_SERVER_IP}:/data/kickstart/ks.cfg ksdevice=eth0 initrd=initrd.img text#\" /tftpboot/pxelinux.cfg/default\n```\n\n```\n[root@lie-pc ~]# cat /etc/xinetd.d/tftp \n# default: off\n# description: The tftp server serves files using the trivial file transfer \\\n#\tprotocol. The tftp protocol is often used to boot diskless \\\n#\tworkstations, download configuration files to network-aware printers, \\\n#\tand to start the installation process for some operating systems.\nservice tftp\n{\n  　　socket_type\t = dgram\n  　　protocol\t = udp\n  　　wait\t = yes\n  　　user\t = root\n  　　server\t = /usr/sbin/in.tftpd\n  　　server_args\t = -s /tftpboot\n  　　disable\t = no #将yes改为no\n  　　per_source\t = 11\n  　　cps\t = 100 2\n     　flags\t = IPv4\n}\n[root@lie-pc ~]# cat /tftpboot/pxelinux.cfg/default\ndefault text\nprompt 1\ntimeout 600\ndisplay boot.msg\nF1 boot.msg\nF2 options.msg\nF3 general.msg\nF4 param.msg\nF5 rescue.msg\nlabel linux\n　　kernel vmlinuz\n　　append initrd=initrd.img\nlabel text\n　　kernel vmlinuz\n　　append ks=nfs:10.0.0.34:/data/kickstart/ks.cfg ksdevice=eth0 initrd=initrd.img text\nlabel ks\n　　kernel vmlinuz\n　　append ks initrd=initrd.img\nlabel local\n　　localboot 1\nlabel memtest86\n　　kernel memtest　　\n　　append -\n```\n\n##4.4. 配置DHCP\n操作命令：\n\n```bash\nyum -y install dhcp*\ncat > /etc/dhcpd.conf << EOF\nddns-update-style none;\nignore client-updates;\nallow booting;\nallow bootp;\ndefault-lease-time 21600;\nmax-lease-time 43200;\noption routers ${KICKSTART_SERVER_ROUTE};\n\nsubnet ${KICKSTART_SERVER_SUBNET} netmask ${KICKSTART_SERVER_NETMASK} {\n　　range dynamic-bootp ${KICKSTART_SERVER_DHCP_IP_START} ${KICKSTART_SERVER_DHCP_IP_END};\n　　next-server ${KICKSTART_SERVER_IP};\n　　filename \"/data/kickstart/ks.cfg\";\n　　next-server ${KICKSTART_SERVER_IP};\n　　filename \"pxelinux.0\";\n}\nEOF\n```\n\n```\n[root@lie-pc ~]# cat /etc/dhcpd.conf\nddns-update-style none;\nignore client-updates;\nallow booting;\nallow bootp;\ndefault-lease-time 21600;\nmax-lease-time 43200;\noption routers 10.0.0.2;\n\nsubnet 10.0.0.0 netmask 255.255.255.0 {\n　　range dynamic-bootp 10.0.0.128 10.0.0.254;\n　　next-server 10.0.0.34;\n　　filename \"/data/kickstart/ks.cfg\";\n　　next-server 10.0.0.34;\n　　filename \"pxelinux.0\";\n}\n\n```\n\n\n##4.5. 配置ks.cfg文件\n\n```\n[root@lie-pc ~]# cat /data/kickstart/ks.cfg \ninstall\t #安装系统而不是升级\nnfs --server=10.0.0.34 --dir=/data/sys\t#nfs安装\nlang en_US.UTF-8\t #字符集\nkeyboard us\t\nnetwork --device=eth0 --bootproto=dhcp --onboot=on --hostname lie-pc\n#network --device=eth1 --bootproto=dhcp --onboot=on\n#网络配置\n\n#root password\nrootpw 123456\t #root用户密码，也可以使用下面加密方式\n#rootpw --iscrypted $1$dQVhf2.F$wUhtrf7gHDN8Q6EtlrWSF.\n\n\nauthconfig --enableshadow --enablemd5\t #系统认证信息\nselinux --disabled\t #关闭selinux\nfirewall --disabled #关闭iptables\ntimezone --utc Asia/Shanghai #时区\nbootloader --location=mbr --driveorder=sda\nfirstboot --disabled #禁止安装后的Agent设置\nlogging --level=info #日志级别\nzerombr\t #清除mbr引导信息\n\n##### 系统分区设置 #####\n#clearpart --linux\nclearpart --all\npart /boot --fstype ext3 --size=200 --asprimary\npart swap --size=512 --asprimary\npart / --fstype ext3 --size=1 --grow --asprimary\nreboot\t #安装后重启\n\n##### 安装包的选择 #####\n%packages\n@base\n@core\n@development-libs\n@development-tools\n@editors\n@system-tools\n@x-software-development\n\n\n##### 安装后的操作 #####\n\n%post\n#!/bin/bash\nmkdir -p /application/tools\nmkdir -p /server/scripts\n```\n\n#5. OS安装过程\n\n在服务器上执行上面一键安装脚本(auto_install_centos.sh)之后， 新建一个VM虚拟机,直接启动！\n![alt txt](/images/2013/pxe-dhcp-nfs-kickstart/02.png)\n\n![alt txt](/images/2013/pxe-dhcp-nfs-kickstart/03.png)\n","source":"_posts/2013-01-24-pxe-plus-dhcp-plus-nfs-plus-kickstart-centos5-dot-8-x64.md","raw":"---\nlayout: post\ntitle: \"linux系列2 - pxe+dhcp+nfs+kickstart无人值守批量安装Centos5.8 x64\"\ndate: 2013-01-24 18:05\ncomments: true\ncategories: linux\n---\n\n上文进到，如果我们要安装几十上百台服务器，如何做呢？总不能一台一台人工安装吧！\n本文就来解决这个问题，看一下如何实现批量无人值守安装centos5.8 x64。\n\n<!-- more -->\n\n```\n目录 \n1.\t原理介绍\t\n1.1.\t什么是PXE\t\n1.2.\t什么是KickStart\t\n1.3.\t无人值守安装原理\t\n1.4.\t无人值守安装过程详细说明\t\n1.5.\tPXE+kickStart安装条件\t\n2.\t安装环境\t\n2.1.\tKickstart服务器环境说明\t\n3.\t一键安装脚本\t\n4.\t安装说明\t\n4.1.\t挂载系统安装盘\t\n4.2.\t设置nfs\t8\n4.3.\t设置tftp\t\n4.4.\t配置DHCP\t\n4.5.\t配置ks.cfg文件\t\n5. OS安装过程\n```\n\n#1. 原理介绍\n##1.1.\t什么是PXE\n严格来说，PXE并不是一种安装方式，而是一种引导方式。进行PXE安装的必要条件是在要安装的计算机中必须包含一个PXE支持的网卡(NIC)，即网卡中必须要有PXE Client。PXE(Pre-boot Execution Environment)协议可以使计算机通过网络启动。此协议分为Client端和Server端，而PXE Client则在网卡的ROM中。当计算机引导时，BIOS把PXE Client调入内存中执行，然后由PXE Client将放置在远端的文件通过网络下载到本地运行。运行PXE协议需要设置DHCP服务器和TFTP服务器。DHCP服务器会给PXE Client(将要安装系统的主机)分配一个IP地址，由于是给PXE Client分配IP地址，所以在配置DHCP服务器时需要增加相应的PXE设置。此外，在PXE Client的ROM中，已经存在了TFTP Client，那么它就可以通过TFTP协议到TFTP Server上下载所需的文件了。\n##1.2.\t什么是KickStart\nKickStart是一种无人值守的安装方式。它的工作原理是在安装过程中记录典型的需要人工干预填写的各种参数，并生成一个名为ks.cfg的文件。如果在安装过程中(不只局限于生成KickStart安装文件的机器)出现要填写参数的情况，安装程序首先会去查找KickStart生成的文件，如果找到合适的参数，就采用所找到的参数；如果没有找到合适的参数，便需要安装者手工干预了。所以，如果KickStart文件涵盖了安装过程中可能出现的所有需要填写的参数，那么安装者完全可以只告诉安装程序从何处取ks.cfg文件，然后就去忙自己的事情。等安装完毕，安装程序会根据ks.cfg中的设置重启系统，并结束安装。\n\n1.1、1.2资料来源：  \n《构建高可用Linux服务器（第2版）》   \nbook.51cto.com/art/201208/354168.htm\n\n##1.3. 无人值守安装原理\n客户机通过支持pxe的网卡向网络中发送请求DHCP信息的广播，请求获取ip地址等信息，网络中的DHCP服务器收到请求验证通过后，给客户机返回ip地址和相关信息(TFTP服务器地址、启动文件等),之后，客户机向网络中的TFTP服务器请求并下载操作系统安装所需要的文件。在这个过程中需要一台服务器来提供启动文件、安装文件、安装过程中的自动应答文件。\n\n\n\n##1.4.\t无人值守安装过程详细说明\n![alt txt](/images/2013/pxe-dhcp-nfs-kickstart/01.jpg)\n\n\n(1)\tPXE client向DHCP server发送请求   \n将支持PXE网络接口卡(NIC)的计算机的BIOS设置为以PXE方式启动，此时，PXE Client通过PXE Boot ROM会以UDP(简单用户数据协议)的形式在网络中发送一个广播请求，请求DHCP服务器分配IP地址等相关信息。\n\n(2)\tDHCP server应答PXE client  \nDHCP Server收到客户端请求，验证是否来自合法的PXE Client请求，验证通过后，它会回应PXE Client，回应中包含了为PXE Client分配的IP地址、pxelinux启动程序(TFTP)的位置，以及配置文件所在位置。\n\n(3)\tPXE client请求下载启动文件  \n客户端收到服务器的回应后，会向TFTP服务器请求传送启动系统安装所需文件。这些启动文件包括：pxelinux.0、pxelinux.cfg/default、vmlinuz、initrd.img等文件。\n\n(4)\tTFTP服务器响应客户端请求并传送文件  \n当TFTP服务器收到客户端请求后，它们之间会有更多的信息在客户端和服务器之间做应答，用以决定启动参数。BootROM由TFTP通讯协议从Boot Server下载启动安装程序所必须的文件（pxelinux.0、pxelinux.cfg/default）。default文件下载完成后，会根据该文件中定义的引导顺序，启动linux安装程序的引导内核。\n\n(5)\t请求下载自动应答文件   \npxe client通过pxelinux.cfg/default文件成功引导linux安装内核后，安装程序首先确定你通过什么安装来安装linux,如果是通过网络安装（NFS,FTP,HTTP）,则会在这个时候初始化网络，并定位安装系统所需的二进制包以及配置文件的位置。接着会读取该文件中指定的自动应答文件ks.cfg,然后根据ks.cfg中文件位置请求下载相关文件。  \n\n(6)\t客户端安装操作系统\n将ks.cfg文件下载回来后，通过该文件找到os server(可以是http,NFS,FTP等)，并按照该文件的配置请求下载安装过程中需要的软件包。   \nOS server和客户端建立连接后，将开始传输软件包。客户端开始安装操作系统，安装完成后，提示重新引导计算机。  \n\nPXE client是需要安装linux的客户机，TFTP Server、DHCP Server和NFS Server运行在另外一台或多台Linux Server上。Bootstrap文件、配置文件、Linux内核都放置在Linux Server上的TFTP服务器的根目录下。而linux的系统安装相关文件则存在NFS Server的共享目录中。   \nPXE client工作过程中，需要三个二进制文件：Bootstrap、Linux内核和Linux根文件系统。Bootstrap文件是可执行程序，它向用户提供简单的控制界面，并根据用户的选择，下载合适的Linux内核及根文件系统。   \n\n1.3,1.4资料感谢老男孩老师#\n  \n##1.5. PXE+kickStart安装条件  \n(1)\tDHCP 服务器  \n(2)\tTFTP 服务器\t\n(3)\tKickStart所生成的ks.cfg配置文件\t\n(4)\t一台存放系统安装文件的服务器，如 NFS、HTTP 或 FTP 服务器  \n(5)\t带有 PXE 支持网卡的待安装主机  \n\n#2. 安装环境\n##2.1.\tKickstart服务器环境说明\n###操作系统：\n\n``` bash\n[root@lie-pc ~]# cat /etc/redhat-release \nCentOS release 5.8 (Final) \n[root@lie-pc ~]# uname -mi\nx86_64 x86_64\n#内核版本：\n[root@lie-pc ~]# uname -r\n2.6.18-308.el5\n```\n\n####主机网络参数设置：\n主机名:\t\tlie-pc   \n网卡eth0:\t10.0.0.34  \n默认网关:\t\t10.0.0.2  \n子网掩码:\t\t255.255.255.0  \n\n#3. 一键安装脚本\nauto_install_centos.sh\n\n```bash\n#!/bin/bash\n # auto install kickstart server\n # the os root's passwd is 123456\n #\n # Filename: auto_install_centos.sh\n # Author: alex\n # Date:   2012-10-17  \n # Email:  xionglie.qu@gmail.com  \n #------------Environment------------  \n #   Linux 2.6.18-308.el5  i686 or x86_64\n #   CentOS release 5.8 (Final)\n #-----------------------------------  \n \n KICKSTART_SERVER_IP=`/sbin/ifconfig eth0 | grep 'inet addr' | awk '{print $2}' | awk -F: '{print $2}'`\n KICKSTART_SERVER_NET_ID=`echo ${KICKSTART_SERVER_IP} | cut -d '.' -f1-3 `\n KICKSTART_SERVER_SUBNET=${KICKSTART_SERVER_NET_ID}.0\n KICKSTART_SERVER_NETMASK=255.255.255.0\n KICKSTART_SERVER_ROUTE=${KICKSTART_SERVER_NET_ID}.2\n KICKSTART_SERVER_DHCP_IP_START=${KICKSTART_SERVER_NET_ID}.128\n KICKSTART_SERVER_DHCP_IP_END=${KICKSTART_SERVER_NET_ID}.254\n \n \n echo \"----- 1.配置nfs服务器 --------------\"\n #创建共享目录\n mkdir -p /data/sys\n mount -o loop /root/CentOS-5.8-x86_64-bin-DVD-1of2.iso /data/sys\n echo \"mount -o loop /root/CentOS-5.8-x86_64-bin-DVD-1of2.iso /data/sys\" >>/etc/rc.local\n \n #如果是用光盘就用下面的命令\n #mount /dev/cdrom /data/sys\n #echo \"mount /dev/cdrom /data/sys\" >>/etc/rc.local\n ls -l /data/sys\n \n #安装nfs,分发共享目录\n rpm -qa | grep nfs\n cat > /etc/exports << EOF\n /data/sys ${KICKSTART_SERVER_SUBNET}/24(ro,sync)\n /data/kickstart ${KICKSTART_SERVER_SUBNET}/24(ro,sync)\n EOF\n cat /etc/exports\n \n #启动nfs,设置开机启动\n /etc/init.d/portmap restart\n /etc/init.d/nfs restart\n showmount -e 127.0.0.1\n \n chkconfig portmap on\n chkconfig nfs on\n chkconfig --list | egrep \"nfs|portmap\"\n \n echo \"----- 2.配置TFTP服务器 --------------\"\n yum -y install tftp-server* -y\n sed -i '/disable.*=/ s#yes#no#' /etc/xinetd.d/tftp\n /etc/init.d/xinetd restart\n chkconfig xinetd on\n \n /bin/cp /usr/lib/syslinux/pxelinux.0 /tftpboot/\n /bin/cp /data/sys/images/pxeboot/vmlinuz /tftpboot/\n /bin/cp /data/sys/images/pxeboot/initrd.img /tftpboot/\n \n mkdir /tftpboot/pxelinux.cfg -p\n /bin/cp /data/sys/isolinux/isolinux.cfg /tftpboot/pxelinux.cfg/default\n chmod a+r /tftpboot/pxelinux.cfg/default\n sed -i \"s#default linux#default text#\" /tftpboot/pxelinux.cfg/default\n sed -i \"s#append initrd=initrd.img text#append ks=nfs:${KICKSTART_SERVER_IP}:/data/kickstart/ks.cfg ksdevice=eth0 initrd=initrd.img text#\" /tftpboot/pxelinux.cfg/default\n \n echo \"----- 3.配置DHCP --------------\"\n yum -y install dhcp*\n #/bin/cp /usr/share/doc/dhcp-3.0.5/dhcpd.conf.sample /etc/dhcpd.conf\n \n cat > /etc/dhcpd.conf << EOF\n ddns-update-style none;\n ignore client-updates;\n allow booting;\n allow bootp;\n default-lease-time 21600;\n max-lease-time 43200;\n option routers ${KICKSTART_SERVER_ROUTE};\n \n subnet ${KICKSTART_SERVER_SUBNET} netmask ${KICKSTART_SERVER_NETMASK} {\n range dynamic-bootp ${KICKSTART_SERVER_DHCP_IP_START} ${KICKSTART_SERVER_DHCP_IP_END};\n next-server ${KICKSTART_SERVER_IP};\n filename \"/data/kickstart/ks.cfg\";\n next-server ${KICKSTART_SERVER_IP};\n filename \"pxelinux.0\";\n }\n EOF\n \n /etc/init.d/dhcpd restart\n #出错的话，cat /var/log/message\n \n chkconfig dhcpd on\n chkconfig --list dhcpd\n \n echo \"----- 4.配置kickstart --------------\"\n mkdir -p /data/kickstart/\n #/bin/cp /root/anaconda-ks.cfg /data/kickstart/ks.cfg\n #chmod 644 /data/kickstart/ks.cfg\n \n cat > /data/kickstart/ks.cfg << EOF \n install\n nfs --server=${KICKSTART_SERVER_IP} --dir=/data/sys\n lang en_US.UTF-8\n keyboard us\n network --device=eth0 --bootproto=dhcp --onboot=on --hostname stu412\n #network --device=eth1 --bootproto=dhcp --onboot=on\n \n #root password\n rootpw 123456\n #rootpw --iscrypted \\$1\\$dQVhf2.F\\$wUhtrf7gHDN8Q6EtlrWSF.\n \n \n authconfig --enableshadow --enablemd5\n selinux --disabled\n firewall --disabled\n timezone --utc Asia/Shanghai\n bootloader --location=mbr --driveorder=sda\n firstboot --disabled\n logging --level=info\n zerombr\n \n \n #clearpart --linux\n clearpart --all\n part /boot --fstype ext3 --size=200 --asprimary\n part swap --size=512 --asprimary\n part / --fstype ext3 --size=1 --grow --asprimary\n reboot\n \n %packages\n @base\n @core\n @development-libs\n @development-tools\n @editors\n @system-tools\n @x-software-development\n \n %post\n #!/bin/bash\n mkdir -p /application/tools\n mkdir -p /server/scripts\n \n EOF\n \n echo \"-----done-----\"\n\n```\n\n\n#4. 安装说明\n##4.1.\t挂载系统安装盘\n\n```\n#创建共享目录\nmkdir -p /data/sys\nmount -o loop /root/CentOS-5.8-x86_64-bin-DVD-1of2.iso /data/sys\necho \"mount -o loop /root/CentOS-5.8-x86_64-bin-DVD-1of2.iso /data/sys\" >>/etc/rc.local\n \n#如果是用光盘就用下面的命令\n#mount /dev/cdrom /data/sys\n#echo \"mount /dev/cdrom /data/sys\" >>/etc/rc.local\nls -l /data/sys\n```\n\n##4.2. 设置nfs \n\n操作过程：\n\n```bash\n#安装nfs,分发共享目录\ncat > /etc/exports << EOF\n/data/sys ${KICKSTART_SERVER_SUBNET}/24(ro,sync)\n/data/kickstart ${KICKSTART_SERVER_SUBNET}/24(ro,sync)\nEOF\n```\n\n```\n[root@lie-pc ~]# cat /etc/exports \n/data/sys 10.0.0.0/24(ro,sync)\n/data/kickstart 10.0.0.0/24(ro,sync)\n\n[root@lie-pc ~]# showmount -e localhost \nExport list for localhost: \n/data/sys 10.0.0.0/24 \n/data/kickstart 10.0.0.0/24\n```\n\n##4.3. 设置tftp\n操作命令：\n\n```\n yum -y install tftp-server* -y\n sed -i '/disable.*=/ s#yes#no#' /etc/xinetd.d/tftp\n /etc/init.d/xinetd restart\n chkconfig xinetd on\n \n /bin/cp /usr/lib/syslinux/pxelinux.0 /tftpboot/\n /bin/cp /data/sys/images/pxeboot/vmlinuz /tftpboot/\n /bin/cp /data/sys/images/pxeboot/initrd.img /tftpboot/\n \n mkdir /tftpboot/pxelinux.cfg -p\n /bin/cp /data/sys/isolinux/isolinux.cfg /tftpboot/pxelinux.cfg/default\n chmod a+r /tftpboot/pxelinux.cfg/default\n sed -i \"s#default linux#default text#\" /tftpboot/pxelinux.cfg/default\n sed -i \"s#append initrd=initrd.img text#append ks=nfs:${KICKSTART_SERVER_IP}:/data/kickstart/ks.cfg ksdevice=eth0 initrd=initrd.img text#\" /tftpboot/pxelinux.cfg/default\n```\n\n```\n[root@lie-pc ~]# cat /etc/xinetd.d/tftp \n# default: off\n# description: The tftp server serves files using the trivial file transfer \\\n#\tprotocol. The tftp protocol is often used to boot diskless \\\n#\tworkstations, download configuration files to network-aware printers, \\\n#\tand to start the installation process for some operating systems.\nservice tftp\n{\n  　　socket_type\t = dgram\n  　　protocol\t = udp\n  　　wait\t = yes\n  　　user\t = root\n  　　server\t = /usr/sbin/in.tftpd\n  　　server_args\t = -s /tftpboot\n  　　disable\t = no #将yes改为no\n  　　per_source\t = 11\n  　　cps\t = 100 2\n     　flags\t = IPv4\n}\n[root@lie-pc ~]# cat /tftpboot/pxelinux.cfg/default\ndefault text\nprompt 1\ntimeout 600\ndisplay boot.msg\nF1 boot.msg\nF2 options.msg\nF3 general.msg\nF4 param.msg\nF5 rescue.msg\nlabel linux\n　　kernel vmlinuz\n　　append initrd=initrd.img\nlabel text\n　　kernel vmlinuz\n　　append ks=nfs:10.0.0.34:/data/kickstart/ks.cfg ksdevice=eth0 initrd=initrd.img text\nlabel ks\n　　kernel vmlinuz\n　　append ks initrd=initrd.img\nlabel local\n　　localboot 1\nlabel memtest86\n　　kernel memtest　　\n　　append -\n```\n\n##4.4. 配置DHCP\n操作命令：\n\n```bash\nyum -y install dhcp*\ncat > /etc/dhcpd.conf << EOF\nddns-update-style none;\nignore client-updates;\nallow booting;\nallow bootp;\ndefault-lease-time 21600;\nmax-lease-time 43200;\noption routers ${KICKSTART_SERVER_ROUTE};\n\nsubnet ${KICKSTART_SERVER_SUBNET} netmask ${KICKSTART_SERVER_NETMASK} {\n　　range dynamic-bootp ${KICKSTART_SERVER_DHCP_IP_START} ${KICKSTART_SERVER_DHCP_IP_END};\n　　next-server ${KICKSTART_SERVER_IP};\n　　filename \"/data/kickstart/ks.cfg\";\n　　next-server ${KICKSTART_SERVER_IP};\n　　filename \"pxelinux.0\";\n}\nEOF\n```\n\n```\n[root@lie-pc ~]# cat /etc/dhcpd.conf\nddns-update-style none;\nignore client-updates;\nallow booting;\nallow bootp;\ndefault-lease-time 21600;\nmax-lease-time 43200;\noption routers 10.0.0.2;\n\nsubnet 10.0.0.0 netmask 255.255.255.0 {\n　　range dynamic-bootp 10.0.0.128 10.0.0.254;\n　　next-server 10.0.0.34;\n　　filename \"/data/kickstart/ks.cfg\";\n　　next-server 10.0.0.34;\n　　filename \"pxelinux.0\";\n}\n\n```\n\n\n##4.5. 配置ks.cfg文件\n\n```\n[root@lie-pc ~]# cat /data/kickstart/ks.cfg \ninstall\t #安装系统而不是升级\nnfs --server=10.0.0.34 --dir=/data/sys\t#nfs安装\nlang en_US.UTF-8\t #字符集\nkeyboard us\t\nnetwork --device=eth0 --bootproto=dhcp --onboot=on --hostname lie-pc\n#network --device=eth1 --bootproto=dhcp --onboot=on\n#网络配置\n\n#root password\nrootpw 123456\t #root用户密码，也可以使用下面加密方式\n#rootpw --iscrypted $1$dQVhf2.F$wUhtrf7gHDN8Q6EtlrWSF.\n\n\nauthconfig --enableshadow --enablemd5\t #系统认证信息\nselinux --disabled\t #关闭selinux\nfirewall --disabled #关闭iptables\ntimezone --utc Asia/Shanghai #时区\nbootloader --location=mbr --driveorder=sda\nfirstboot --disabled #禁止安装后的Agent设置\nlogging --level=info #日志级别\nzerombr\t #清除mbr引导信息\n\n##### 系统分区设置 #####\n#clearpart --linux\nclearpart --all\npart /boot --fstype ext3 --size=200 --asprimary\npart swap --size=512 --asprimary\npart / --fstype ext3 --size=1 --grow --asprimary\nreboot\t #安装后重启\n\n##### 安装包的选择 #####\n%packages\n@base\n@core\n@development-libs\n@development-tools\n@editors\n@system-tools\n@x-software-development\n\n\n##### 安装后的操作 #####\n\n%post\n#!/bin/bash\nmkdir -p /application/tools\nmkdir -p /server/scripts\n```\n\n#5. OS安装过程\n\n在服务器上执行上面一键安装脚本(auto_install_centos.sh)之后， 新建一个VM虚拟机,直接启动！\n![alt txt](/images/2013/pxe-dhcp-nfs-kickstart/02.png)\n\n![alt txt](/images/2013/pxe-dhcp-nfs-kickstart/03.png)\n","slug":"pxe-plus-dhcp-plus-nfs-plus-kickstart-centos5-dot-8-x64","published":1,"updated":"2017-01-27T01:34:43.000Z","photos":[],"link":"","_id":"ciyf7fkau000lf2jyay0dwc54","content":"<p>上文进到，如果我们要安装几十上百台服务器，如何做呢？总不能一台一台人工安装吧！<br>本文就来解决这个问题，看一下如何实现批量无人值守安装centos5.8 x64。</p>\n<a id=\"more\"></a>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\">目录 </div><div class=\"line\">1.\t原理介绍\t</div><div class=\"line\">1.1.\t什么是PXE\t</div><div class=\"line\">1.2.\t什么是KickStart\t</div><div class=\"line\">1.3.\t无人值守安装原理\t</div><div class=\"line\">1.4.\t无人值守安装过程详细说明\t</div><div class=\"line\">1.5.\tPXE+kickStart安装条件\t</div><div class=\"line\">2.\t安装环境\t</div><div class=\"line\">2.1.\tKickstart服务器环境说明\t</div><div class=\"line\">3.\t一键安装脚本\t</div><div class=\"line\">4.\t安装说明\t</div><div class=\"line\">4.1.\t挂载系统安装盘\t</div><div class=\"line\">4.2.\t设置nfs\t8</div><div class=\"line\">4.3.\t设置tftp\t</div><div class=\"line\">4.4.\t配置DHCP\t</div><div class=\"line\">4.5.\t配置ks.cfg文件\t</div><div class=\"line\">5. OS安装过程</div></pre></td></tr></table></figure>\n<p>#1. 原理介绍</p>\n<p>##1.1.    什么是PXE<br>严格来说，PXE并不是一种安装方式，而是一种引导方式。进行PXE安装的必要条件是在要安装的计算机中必须包含一个PXE支持的网卡(NIC)，即网卡中必须要有PXE Client。PXE(Pre-boot Execution Environment)协议可以使计算机通过网络启动。此协议分为Client端和Server端，而PXE Client则在网卡的ROM中。当计算机引导时，BIOS把PXE Client调入内存中执行，然后由PXE Client将放置在远端的文件通过网络下载到本地运行。运行PXE协议需要设置DHCP服务器和TFTP服务器。DHCP服务器会给PXE Client(将要安装系统的主机)分配一个IP地址，由于是给PXE Client分配IP地址，所以在配置DHCP服务器时需要增加相应的PXE设置。此外，在PXE Client的ROM中，已经存在了TFTP Client，那么它就可以通过TFTP协议到TFTP Server上下载所需的文件了。</p>\n<p>##1.2.    什么是KickStart<br>KickStart是一种无人值守的安装方式。它的工作原理是在安装过程中记录典型的需要人工干预填写的各种参数，并生成一个名为ks.cfg的文件。如果在安装过程中(不只局限于生成KickStart安装文件的机器)出现要填写参数的情况，安装程序首先会去查找KickStart生成的文件，如果找到合适的参数，就采用所找到的参数；如果没有找到合适的参数，便需要安装者手工干预了。所以，如果KickStart文件涵盖了安装过程中可能出现的所有需要填写的参数，那么安装者完全可以只告诉安装程序从何处取ks.cfg文件，然后就去忙自己的事情。等安装完毕，安装程序会根据ks.cfg中的设置重启系统，并结束安装。</p>\n<p>1.1、1.2资料来源：<br>《构建高可用Linux服务器（第2版）》<br>book.51cto.com/art/201208/354168.htm</p>\n<p>##1.3. 无人值守安装原理<br>客户机通过支持pxe的网卡向网络中发送请求DHCP信息的广播，请求获取ip地址等信息，网络中的DHCP服务器收到请求验证通过后，给客户机返回ip地址和相关信息(TFTP服务器地址、启动文件等),之后，客户机向网络中的TFTP服务器请求并下载操作系统安装所需要的文件。在这个过程中需要一台服务器来提供启动文件、安装文件、安装过程中的自动应答文件。</p>\n<p>##1.4.    无人值守安装过程详细说明<br><img src=\"/images/2013/pxe-dhcp-nfs-kickstart/01.jpg\" alt=\"alt txt\"></p>\n<p>(1)    PXE client向DHCP server发送请求<br>将支持PXE网络接口卡(NIC)的计算机的BIOS设置为以PXE方式启动，此时，PXE Client通过PXE Boot ROM会以UDP(简单用户数据协议)的形式在网络中发送一个广播请求，请求DHCP服务器分配IP地址等相关信息。</p>\n<p>(2)    DHCP server应答PXE client<br>DHCP Server收到客户端请求，验证是否来自合法的PXE Client请求，验证通过后，它会回应PXE Client，回应中包含了为PXE Client分配的IP地址、pxelinux启动程序(TFTP)的位置，以及配置文件所在位置。</p>\n<p>(3)    PXE client请求下载启动文件<br>客户端收到服务器的回应后，会向TFTP服务器请求传送启动系统安装所需文件。这些启动文件包括：pxelinux.0、pxelinux.cfg/default、vmlinuz、initrd.img等文件。</p>\n<p>(4)    TFTP服务器响应客户端请求并传送文件<br>当TFTP服务器收到客户端请求后，它们之间会有更多的信息在客户端和服务器之间做应答，用以决定启动参数。BootROM由TFTP通讯协议从Boot Server下载启动安装程序所必须的文件（pxelinux.0、pxelinux.cfg/default）。default文件下载完成后，会根据该文件中定义的引导顺序，启动linux安装程序的引导内核。</p>\n<p>(5)    请求下载自动应答文件<br>pxe client通过pxelinux.cfg/default文件成功引导linux安装内核后，安装程序首先确定你通过什么安装来安装linux,如果是通过网络安装（NFS,FTP,HTTP）,则会在这个时候初始化网络，并定位安装系统所需的二进制包以及配置文件的位置。接着会读取该文件中指定的自动应答文件ks.cfg,然后根据ks.cfg中文件位置请求下载相关文件。  </p>\n<p>(6)    客户端安装操作系统<br>将ks.cfg文件下载回来后，通过该文件找到os server(可以是http,NFS,FTP等)，并按照该文件的配置请求下载安装过程中需要的软件包。<br>OS server和客户端建立连接后，将开始传输软件包。客户端开始安装操作系统，安装完成后，提示重新引导计算机。  </p>\n<p>PXE client是需要安装linux的客户机，TFTP Server、DHCP Server和NFS Server运行在另外一台或多台Linux Server上。Bootstrap文件、配置文件、Linux内核都放置在Linux Server上的TFTP服务器的根目录下。而linux的系统安装相关文件则存在NFS Server的共享目录中。<br>PXE client工作过程中，需要三个二进制文件：Bootstrap、Linux内核和Linux根文件系统。Bootstrap文件是可执行程序，它向用户提供简单的控制界面，并根据用户的选择，下载合适的Linux内核及根文件系统。   </p>\n<p>1.3,1.4资料感谢老男孩老师#</p>\n<p>##1.5. PXE+kickStart安装条件<br>(1)    DHCP 服务器<br>(2)    TFTP 服务器<br>(3)    KickStart所生成的ks.cfg配置文件<br>(4)    一台存放系统安装文件的服务器，如 NFS、HTTP 或 FTP 服务器<br>(5)    带有 PXE 支持网卡的待安装主机  </p>\n<p>#2. 安装环境</p>\n<p>##2.1.    Kickstart服务器环境说明</p>\n<p>###操作系统：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]<span class=\"comment\"># cat /etc/redhat-release </span></div><div class=\"line\">CentOS release 5.8 (Final) </div><div class=\"line\">[root@lie-pc ~]<span class=\"comment\"># uname -mi</span></div><div class=\"line\">x86_64 x86_64</div><div class=\"line\"><span class=\"comment\">#内核版本：</span></div><div class=\"line\">[root@lie-pc ~]<span class=\"comment\"># uname -r</span></div><div class=\"line\">2.6.18-308.el5</div></pre></td></tr></table></figure>\n<p>####主机网络参数设置：<br>主机名:        lie-pc<br>网卡eth0:    10.0.0.34<br>默认网关:        10.0.0.2<br>子网掩码:        255.255.255.0  </p>\n<p>#3. 一键安装脚本<br>auto_install_centos.sh</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">#!/bin/bash</span></div><div class=\"line\"> <span class=\"comment\"># auto install kickstart server</span></div><div class=\"line\"> <span class=\"comment\"># the os root's passwd is 123456</span></div><div class=\"line\"> <span class=\"comment\">#</span></div><div class=\"line\"> <span class=\"comment\"># Filename: auto_install_centos.sh</span></div><div class=\"line\"> <span class=\"comment\"># Author: alex</span></div><div class=\"line\"> <span class=\"comment\"># Date:   2012-10-17  </span></div><div class=\"line\"> <span class=\"comment\"># Email:  xionglie.qu@gmail.com  </span></div><div class=\"line\"> <span class=\"comment\">#------------Environment------------  </span></div><div class=\"line\"> <span class=\"comment\">#   Linux 2.6.18-308.el5  i686 or x86_64</span></div><div class=\"line\"> <span class=\"comment\">#   CentOS release 5.8 (Final)</span></div><div class=\"line\"> <span class=\"comment\">#-----------------------------------  </span></div><div class=\"line\"> </div><div class=\"line\"> KICKSTART_SERVER_IP=`/sbin/ifconfig eth0 | grep <span class=\"string\">'inet addr'</span> | awk <span class=\"string\">'&#123;print $2&#125;'</span> | awk -F: <span class=\"string\">'&#123;print $2&#125;'</span>`</div><div class=\"line\"> KICKSTART_SERVER_NET_ID=`<span class=\"built_in\">echo</span> <span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span> | cut <span class=\"_\">-d</span> <span class=\"string\">'.'</span> <span class=\"_\">-f</span>1-3 `</div><div class=\"line\"> KICKSTART_SERVER_SUBNET=<span class=\"variable\">$&#123;KICKSTART_SERVER_NET_ID&#125;</span>.0</div><div class=\"line\"> KICKSTART_SERVER_NETMASK=255.255.255.0</div><div class=\"line\"> KICKSTART_SERVER_ROUTE=<span class=\"variable\">$&#123;KICKSTART_SERVER_NET_ID&#125;</span>.2</div><div class=\"line\"> KICKSTART_SERVER_DHCP_IP_START=<span class=\"variable\">$&#123;KICKSTART_SERVER_NET_ID&#125;</span>.128</div><div class=\"line\"> KICKSTART_SERVER_DHCP_IP_END=<span class=\"variable\">$&#123;KICKSTART_SERVER_NET_ID&#125;</span>.254</div><div class=\"line\"> </div><div class=\"line\"> </div><div class=\"line\"> <span class=\"built_in\">echo</span> <span class=\"string\">\"----- 1.配置nfs服务器 --------------\"</span></div><div class=\"line\"> <span class=\"comment\">#创建共享目录</span></div><div class=\"line\"> mkdir -p /data/sys</div><div class=\"line\"> mount -o loop /root/CentOS-5.8-x86_64-bin-DVD-1of2.iso /data/sys</div><div class=\"line\"> <span class=\"built_in\">echo</span> <span class=\"string\">\"mount -o loop /root/CentOS-5.8-x86_64-bin-DVD-1of2.iso /data/sys\"</span> &gt;&gt;/etc/rc.local</div><div class=\"line\"> </div><div class=\"line\"> <span class=\"comment\">#如果是用光盘就用下面的命令</span></div><div class=\"line\"> <span class=\"comment\">#mount /dev/cdrom /data/sys</span></div><div class=\"line\"> <span class=\"comment\">#echo \"mount /dev/cdrom /data/sys\" &gt;&gt;/etc/rc.local</span></div><div class=\"line\"> ls <span class=\"_\">-l</span> /data/sys</div><div class=\"line\"> </div><div class=\"line\"> <span class=\"comment\">#安装nfs,分发共享目录</span></div><div class=\"line\"> rpm -qa | grep nfs</div><div class=\"line\"> cat &gt; /etc/exports &lt;&lt; EOF</div><div class=\"line\"> /data/sys <span class=\"variable\">$&#123;KICKSTART_SERVER_SUBNET&#125;</span>/24(ro,sync)</div><div class=\"line\"> /data/kickstart <span class=\"variable\">$&#123;KICKSTART_SERVER_SUBNET&#125;</span>/24(ro,sync)</div><div class=\"line\"> EOF</div><div class=\"line\"> cat /etc/exports</div><div class=\"line\"> </div><div class=\"line\"> <span class=\"comment\">#启动nfs,设置开机启动</span></div><div class=\"line\"> /etc/init.d/portmap restart</div><div class=\"line\"> /etc/init.d/nfs restart</div><div class=\"line\"> showmount <span class=\"_\">-e</span> 127.0.0.1</div><div class=\"line\"> </div><div class=\"line\"> chkconfig portmap on</div><div class=\"line\"> chkconfig nfs on</div><div class=\"line\"> chkconfig --list | egrep <span class=\"string\">\"nfs|portmap\"</span></div><div class=\"line\"> </div><div class=\"line\"> <span class=\"built_in\">echo</span> <span class=\"string\">\"----- 2.配置TFTP服务器 --------------\"</span></div><div class=\"line\"> yum -y install tftp-server* -y</div><div class=\"line\"> sed -i <span class=\"string\">'/disable.*=/ s#yes#no#'</span> /etc/xinetd.d/tftp</div><div class=\"line\"> /etc/init.d/xinetd restart</div><div class=\"line\"> chkconfig xinetd on</div><div class=\"line\"> </div><div class=\"line\"> /bin/cp /usr/lib/syslinux/pxelinux.0 /tftpboot/</div><div class=\"line\"> /bin/cp /data/sys/images/pxeboot/vmlinuz /tftpboot/</div><div class=\"line\"> /bin/cp /data/sys/images/pxeboot/initrd.img /tftpboot/</div><div class=\"line\"> </div><div class=\"line\"> mkdir /tftpboot/pxelinux.cfg -p</div><div class=\"line\"> /bin/cp /data/sys/isolinux/isolinux.cfg /tftpboot/pxelinux.cfg/default</div><div class=\"line\"> chmod a+r /tftpboot/pxelinux.cfg/default</div><div class=\"line\"> sed -i <span class=\"string\">\"s#default linux#default text#\"</span> /tftpboot/pxelinux.cfg/default</div><div class=\"line\"> sed -i <span class=\"string\">\"s#append initrd=initrd.img text#append ks=nfs:<span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span>:/data/kickstart/ks.cfg ksdevice=eth0 initrd=initrd.img text#\"</span> /tftpboot/pxelinux.cfg/default</div><div class=\"line\"> </div><div class=\"line\"> <span class=\"built_in\">echo</span> <span class=\"string\">\"----- 3.配置DHCP --------------\"</span></div><div class=\"line\"> yum -y install dhcp*</div><div class=\"line\"> <span class=\"comment\">#/bin/cp /usr/share/doc/dhcp-3.0.5/dhcpd.conf.sample /etc/dhcpd.conf</span></div><div class=\"line\"> </div><div class=\"line\"> cat &gt; /etc/dhcpd.conf &lt;&lt; EOF</div><div class=\"line\"> ddns-update-style none;</div><div class=\"line\"> ignore client-updates;</div><div class=\"line\"> allow booting;</div><div class=\"line\"> allow bootp;</div><div class=\"line\"> default-lease-time 21600;</div><div class=\"line\"> max-lease-time 43200;</div><div class=\"line\"> option routers <span class=\"variable\">$&#123;KICKSTART_SERVER_ROUTE&#125;</span>;</div><div class=\"line\"> </div><div class=\"line\"> subnet <span class=\"variable\">$&#123;KICKSTART_SERVER_SUBNET&#125;</span> netmask <span class=\"variable\">$&#123;KICKSTART_SERVER_NETMASK&#125;</span> &#123;</div><div class=\"line\"> range dynamic-bootp <span class=\"variable\">$&#123;KICKSTART_SERVER_DHCP_IP_START&#125;</span> <span class=\"variable\">$&#123;KICKSTART_SERVER_DHCP_IP_END&#125;</span>;</div><div class=\"line\"> next-server <span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span>;</div><div class=\"line\"> filename <span class=\"string\">\"/data/kickstart/ks.cfg\"</span>;</div><div class=\"line\"> next-server <span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span>;</div><div class=\"line\"> filename <span class=\"string\">\"pxelinux.0\"</span>;</div><div class=\"line\"> &#125;</div><div class=\"line\"> EOF</div><div class=\"line\"> </div><div class=\"line\"> /etc/init.d/dhcpd restart</div><div class=\"line\"> <span class=\"comment\">#出错的话，cat /var/log/message</span></div><div class=\"line\"> </div><div class=\"line\"> chkconfig dhcpd on</div><div class=\"line\"> chkconfig --list dhcpd</div><div class=\"line\"> </div><div class=\"line\"> <span class=\"built_in\">echo</span> <span class=\"string\">\"----- 4.配置kickstart --------------\"</span></div><div class=\"line\"> mkdir -p /data/kickstart/</div><div class=\"line\"> <span class=\"comment\">#/bin/cp /root/anaconda-ks.cfg /data/kickstart/ks.cfg</span></div><div class=\"line\"> <span class=\"comment\">#chmod 644 /data/kickstart/ks.cfg</span></div><div class=\"line\"> </div><div class=\"line\"> cat &gt; /data/kickstart/ks.cfg &lt;&lt; EOF </div><div class=\"line\"> install</div><div class=\"line\"> nfs --server=<span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span> --dir=/data/sys</div><div class=\"line\"> lang en_US.UTF-8</div><div class=\"line\"> keyboard us</div><div class=\"line\"> network --device=eth0 --bootproto=dhcp --onboot=on --hostname stu412</div><div class=\"line\"> <span class=\"comment\">#network --device=eth1 --bootproto=dhcp --onboot=on</span></div><div class=\"line\"> </div><div class=\"line\"> <span class=\"comment\">#root password</span></div><div class=\"line\"> rootpw 123456</div><div class=\"line\"> <span class=\"comment\">#rootpw --iscrypted \\$1\\$dQVhf2.F\\$wUhtrf7gHDN8Q6EtlrWSF.</span></div><div class=\"line\"> </div><div class=\"line\"> </div><div class=\"line\"> authconfig --enableshadow --enablemd5</div><div class=\"line\"> selinux --disabled</div><div class=\"line\"> firewall --disabled</div><div class=\"line\"> timezone --utc Asia/Shanghai</div><div class=\"line\"> bootloader --location=mbr --driveorder=sda</div><div class=\"line\"> firstboot --disabled</div><div class=\"line\"> logging --level=info</div><div class=\"line\"> zerombr</div><div class=\"line\"> </div><div class=\"line\"> </div><div class=\"line\"> <span class=\"comment\">#clearpart --linux</span></div><div class=\"line\"> clearpart --all</div><div class=\"line\"> part /boot --fstype ext3 --size=200 --asprimary</div><div class=\"line\"> part swap --size=512 --asprimary</div><div class=\"line\"> part / --fstype ext3 --size=1 --grow --asprimary</div><div class=\"line\"> reboot</div><div class=\"line\"> </div><div class=\"line\"> %packages</div><div class=\"line\"> @base</div><div class=\"line\"> @core</div><div class=\"line\"> @development-libs</div><div class=\"line\"> @development-tools</div><div class=\"line\"> @editors</div><div class=\"line\"> @system-tools</div><div class=\"line\"> @x-software-development</div><div class=\"line\"> </div><div class=\"line\"> %post</div><div class=\"line\"> <span class=\"comment\">#!/bin/bash</span></div><div class=\"line\"> mkdir -p /application/tools</div><div class=\"line\"> mkdir -p /server/scripts</div><div class=\"line\"> </div><div class=\"line\"> EOF</div><div class=\"line\"> </div><div class=\"line\"> <span class=\"built_in\">echo</span> <span class=\"string\">\"-----done-----\"</span></div></pre></td></tr></table></figure>\n<p>#4. 安装说明</p>\n<p>##4.1.    挂载系统安装盘</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">#创建共享目录</div><div class=\"line\">mkdir -p /data/sys</div><div class=\"line\">mount -o loop /root/CentOS-5.8-x86_64-bin-DVD-1of2.iso /data/sys</div><div class=\"line\">echo &quot;mount -o loop /root/CentOS-5.8-x86_64-bin-DVD-1of2.iso /data/sys&quot; &gt;&gt;/etc/rc.local</div><div class=\"line\"> </div><div class=\"line\">#如果是用光盘就用下面的命令</div><div class=\"line\">#mount /dev/cdrom /data/sys</div><div class=\"line\">#echo &quot;mount /dev/cdrom /data/sys&quot; &gt;&gt;/etc/rc.local</div><div class=\"line\">ls -l /data/sys</div></pre></td></tr></table></figure>\n<p>##4.2. 设置nfs </p>\n<p>操作过程：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#安装nfs,分发共享目录</span></div><div class=\"line\">cat &gt; /etc/exports &lt;&lt; EOF</div><div class=\"line\">/data/sys <span class=\"variable\">$&#123;KICKSTART_SERVER_SUBNET&#125;</span>/24(ro,sync)</div><div class=\"line\">/data/kickstart <span class=\"variable\">$&#123;KICKSTART_SERVER_SUBNET&#125;</span>/24(ro,sync)</div><div class=\"line\">EOF</div></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# cat /etc/exports </div><div class=\"line\">/data/sys 10.0.0.0/24(ro,sync)</div><div class=\"line\">/data/kickstart 10.0.0.0/24(ro,sync)</div><div class=\"line\"></div><div class=\"line\">[root@lie-pc ~]# showmount -e localhost </div><div class=\"line\">Export list for localhost: </div><div class=\"line\">/data/sys 10.0.0.0/24 </div><div class=\"line\">/data/kickstart 10.0.0.0/24</div></pre></td></tr></table></figure>\n<p>##4.3. 设置tftp<br>操作命令：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum -y install tftp-server* -y</div><div class=\"line\">sed -i &apos;/disable.*=/ s#yes#no#&apos; /etc/xinetd.d/tftp</div><div class=\"line\">/etc/init.d/xinetd restart</div><div class=\"line\">chkconfig xinetd on</div><div class=\"line\"></div><div class=\"line\">/bin/cp /usr/lib/syslinux/pxelinux.0 /tftpboot/</div><div class=\"line\">/bin/cp /data/sys/images/pxeboot/vmlinuz /tftpboot/</div><div class=\"line\">/bin/cp /data/sys/images/pxeboot/initrd.img /tftpboot/</div><div class=\"line\"></div><div class=\"line\">mkdir /tftpboot/pxelinux.cfg -p</div><div class=\"line\">/bin/cp /data/sys/isolinux/isolinux.cfg /tftpboot/pxelinux.cfg/default</div><div class=\"line\">chmod a+r /tftpboot/pxelinux.cfg/default</div><div class=\"line\">sed -i &quot;s#default linux#default text#&quot; /tftpboot/pxelinux.cfg/default</div><div class=\"line\">sed -i &quot;s#append initrd=initrd.img text#append ks=nfs:$&#123;KICKSTART_SERVER_IP&#125;:/data/kickstart/ks.cfg ksdevice=eth0 initrd=initrd.img text#&quot; /tftpboot/pxelinux.cfg/default</div></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# cat /etc/xinetd.d/tftp </div><div class=\"line\"># default: off</div><div class=\"line\"># description: The tftp server serves files using the trivial file transfer \\</div><div class=\"line\">#\tprotocol. The tftp protocol is often used to boot diskless \\</div><div class=\"line\">#\tworkstations, download configuration files to network-aware printers, \\</div><div class=\"line\">#\tand to start the installation process for some operating systems.</div><div class=\"line\">service tftp</div><div class=\"line\">&#123;</div><div class=\"line\">  　　socket_type\t = dgram</div><div class=\"line\">  　　protocol\t = udp</div><div class=\"line\">  　　wait\t = yes</div><div class=\"line\">  　　user\t = root</div><div class=\"line\">  　　server\t = /usr/sbin/in.tftpd</div><div class=\"line\">  　　server_args\t = -s /tftpboot</div><div class=\"line\">  　　disable\t = no #将yes改为no</div><div class=\"line\">  　　per_source\t = 11</div><div class=\"line\">  　　cps\t = 100 2</div><div class=\"line\">     　flags\t = IPv4</div><div class=\"line\">&#125;</div><div class=\"line\">[root@lie-pc ~]# cat /tftpboot/pxelinux.cfg/default</div><div class=\"line\">default text</div><div class=\"line\">prompt 1</div><div class=\"line\">timeout 600</div><div class=\"line\">display boot.msg</div><div class=\"line\">F1 boot.msg</div><div class=\"line\">F2 options.msg</div><div class=\"line\">F3 general.msg</div><div class=\"line\">F4 param.msg</div><div class=\"line\">F5 rescue.msg</div><div class=\"line\">label linux</div><div class=\"line\">　　kernel vmlinuz</div><div class=\"line\">　　append initrd=initrd.img</div><div class=\"line\">label text</div><div class=\"line\">　　kernel vmlinuz</div><div class=\"line\">　　append ks=nfs:10.0.0.34:/data/kickstart/ks.cfg ksdevice=eth0 initrd=initrd.img text</div><div class=\"line\">label ks</div><div class=\"line\">　　kernel vmlinuz</div><div class=\"line\">　　append ks initrd=initrd.img</div><div class=\"line\">label local</div><div class=\"line\">　　localboot 1</div><div class=\"line\">label memtest86</div><div class=\"line\">　　kernel memtest　　</div><div class=\"line\">　　append -</div></pre></td></tr></table></figure>\n<p>##4.4. 配置DHCP<br>操作命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum -y install dhcp*</div><div class=\"line\">cat &gt; /etc/dhcpd.conf &lt;&lt; EOF</div><div class=\"line\">ddns-update-style none;</div><div class=\"line\">ignore client-updates;</div><div class=\"line\">allow booting;</div><div class=\"line\">allow bootp;</div><div class=\"line\">default-lease-time 21600;</div><div class=\"line\">max-lease-time 43200;</div><div class=\"line\">option routers <span class=\"variable\">$&#123;KICKSTART_SERVER_ROUTE&#125;</span>;</div><div class=\"line\"></div><div class=\"line\">subnet <span class=\"variable\">$&#123;KICKSTART_SERVER_SUBNET&#125;</span> netmask <span class=\"variable\">$&#123;KICKSTART_SERVER_NETMASK&#125;</span> &#123;</div><div class=\"line\">　　range dynamic-bootp <span class=\"variable\">$&#123;KICKSTART_SERVER_DHCP_IP_START&#125;</span> <span class=\"variable\">$&#123;KICKSTART_SERVER_DHCP_IP_END&#125;</span>;</div><div class=\"line\">　　next-server <span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span>;</div><div class=\"line\">　　filename <span class=\"string\">\"/data/kickstart/ks.cfg\"</span>;</div><div class=\"line\">　　next-server <span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span>;</div><div class=\"line\">　　filename <span class=\"string\">\"pxelinux.0\"</span>;</div><div class=\"line\">&#125;</div><div class=\"line\">EOF</div></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# cat /etc/dhcpd.conf</div><div class=\"line\">ddns-update-style none;</div><div class=\"line\">ignore client-updates;</div><div class=\"line\">allow booting;</div><div class=\"line\">allow bootp;</div><div class=\"line\">default-lease-time 21600;</div><div class=\"line\">max-lease-time 43200;</div><div class=\"line\">option routers 10.0.0.2;</div><div class=\"line\"></div><div class=\"line\">subnet 10.0.0.0 netmask 255.255.255.0 &#123;</div><div class=\"line\">　　range dynamic-bootp 10.0.0.128 10.0.0.254;</div><div class=\"line\">　　next-server 10.0.0.34;</div><div class=\"line\">　　filename &quot;/data/kickstart/ks.cfg&quot;;</div><div class=\"line\">　　next-server 10.0.0.34;</div><div class=\"line\">　　filename &quot;pxelinux.0&quot;;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>##4.5. 配置ks.cfg文件</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# cat /data/kickstart/ks.cfg </div><div class=\"line\">install\t #安装系统而不是升级</div><div class=\"line\">nfs --server=10.0.0.34 --dir=/data/sys\t#nfs安装</div><div class=\"line\">lang en_US.UTF-8\t #字符集</div><div class=\"line\">keyboard us\t</div><div class=\"line\">network --device=eth0 --bootproto=dhcp --onboot=on --hostname lie-pc</div><div class=\"line\">#network --device=eth1 --bootproto=dhcp --onboot=on</div><div class=\"line\">#网络配置</div><div class=\"line\"></div><div class=\"line\">#root password</div><div class=\"line\">rootpw 123456\t #root用户密码，也可以使用下面加密方式</div><div class=\"line\">#rootpw --iscrypted $1$dQVhf2.F$wUhtrf7gHDN8Q6EtlrWSF.</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">authconfig --enableshadow --enablemd5\t #系统认证信息</div><div class=\"line\">selinux --disabled\t #关闭selinux</div><div class=\"line\">firewall --disabled #关闭iptables</div><div class=\"line\">timezone --utc Asia/Shanghai #时区</div><div class=\"line\">bootloader --location=mbr --driveorder=sda</div><div class=\"line\">firstboot --disabled #禁止安装后的Agent设置</div><div class=\"line\">logging --level=info #日志级别</div><div class=\"line\">zerombr\t #清除mbr引导信息</div><div class=\"line\"></div><div class=\"line\">##### 系统分区设置 #####</div><div class=\"line\">#clearpart --linux</div><div class=\"line\">clearpart --all</div><div class=\"line\">part /boot --fstype ext3 --size=200 --asprimary</div><div class=\"line\">part swap --size=512 --asprimary</div><div class=\"line\">part / --fstype ext3 --size=1 --grow --asprimary</div><div class=\"line\">reboot\t #安装后重启</div><div class=\"line\"></div><div class=\"line\">##### 安装包的选择 #####</div><div class=\"line\">%packages</div><div class=\"line\">@base</div><div class=\"line\">@core</div><div class=\"line\">@development-libs</div><div class=\"line\">@development-tools</div><div class=\"line\">@editors</div><div class=\"line\">@system-tools</div><div class=\"line\">@x-software-development</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">##### 安装后的操作 #####</div><div class=\"line\"></div><div class=\"line\">%post</div><div class=\"line\">#!/bin/bash</div><div class=\"line\">mkdir -p /application/tools</div><div class=\"line\">mkdir -p /server/scripts</div></pre></td></tr></table></figure>\n<p>#5. OS安装过程</p>\n<p>在服务器上执行上面一键安装脚本(auto_install_centos.sh)之后， 新建一个VM虚拟机,直接启动！<br><img src=\"/images/2013/pxe-dhcp-nfs-kickstart/02.png\" alt=\"alt txt\"></p>\n<p><img src=\"/images/2013/pxe-dhcp-nfs-kickstart/03.png\" alt=\"alt txt\"></p>\n","excerpt":"<p>上文进到，如果我们要安装几十上百台服务器，如何做呢？总不能一台一台人工安装吧！<br>本文就来解决这个问题，看一下如何实现批量无人值守安装centos5.8 x64。</p>","more":"<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\">目录 </div><div class=\"line\">1.\t原理介绍\t</div><div class=\"line\">1.1.\t什么是PXE\t</div><div class=\"line\">1.2.\t什么是KickStart\t</div><div class=\"line\">1.3.\t无人值守安装原理\t</div><div class=\"line\">1.4.\t无人值守安装过程详细说明\t</div><div class=\"line\">1.5.\tPXE+kickStart安装条件\t</div><div class=\"line\">2.\t安装环境\t</div><div class=\"line\">2.1.\tKickstart服务器环境说明\t</div><div class=\"line\">3.\t一键安装脚本\t</div><div class=\"line\">4.\t安装说明\t</div><div class=\"line\">4.1.\t挂载系统安装盘\t</div><div class=\"line\">4.2.\t设置nfs\t8</div><div class=\"line\">4.3.\t设置tftp\t</div><div class=\"line\">4.4.\t配置DHCP\t</div><div class=\"line\">4.5.\t配置ks.cfg文件\t</div><div class=\"line\">5. OS安装过程</div></pre></td></tr></table></figure>\n<p>#1. 原理介绍</p>\n<p>##1.1.    什么是PXE<br>严格来说，PXE并不是一种安装方式，而是一种引导方式。进行PXE安装的必要条件是在要安装的计算机中必须包含一个PXE支持的网卡(NIC)，即网卡中必须要有PXE Client。PXE(Pre-boot Execution Environment)协议可以使计算机通过网络启动。此协议分为Client端和Server端，而PXE Client则在网卡的ROM中。当计算机引导时，BIOS把PXE Client调入内存中执行，然后由PXE Client将放置在远端的文件通过网络下载到本地运行。运行PXE协议需要设置DHCP服务器和TFTP服务器。DHCP服务器会给PXE Client(将要安装系统的主机)分配一个IP地址，由于是给PXE Client分配IP地址，所以在配置DHCP服务器时需要增加相应的PXE设置。此外，在PXE Client的ROM中，已经存在了TFTP Client，那么它就可以通过TFTP协议到TFTP Server上下载所需的文件了。</p>\n<p>##1.2.    什么是KickStart<br>KickStart是一种无人值守的安装方式。它的工作原理是在安装过程中记录典型的需要人工干预填写的各种参数，并生成一个名为ks.cfg的文件。如果在安装过程中(不只局限于生成KickStart安装文件的机器)出现要填写参数的情况，安装程序首先会去查找KickStart生成的文件，如果找到合适的参数，就采用所找到的参数；如果没有找到合适的参数，便需要安装者手工干预了。所以，如果KickStart文件涵盖了安装过程中可能出现的所有需要填写的参数，那么安装者完全可以只告诉安装程序从何处取ks.cfg文件，然后就去忙自己的事情。等安装完毕，安装程序会根据ks.cfg中的设置重启系统，并结束安装。</p>\n<p>1.1、1.2资料来源：<br>《构建高可用Linux服务器（第2版）》<br>book.51cto.com/art/201208/354168.htm</p>\n<p>##1.3. 无人值守安装原理<br>客户机通过支持pxe的网卡向网络中发送请求DHCP信息的广播，请求获取ip地址等信息，网络中的DHCP服务器收到请求验证通过后，给客户机返回ip地址和相关信息(TFTP服务器地址、启动文件等),之后，客户机向网络中的TFTP服务器请求并下载操作系统安装所需要的文件。在这个过程中需要一台服务器来提供启动文件、安装文件、安装过程中的自动应答文件。</p>\n<p>##1.4.    无人值守安装过程详细说明<br><img src=\"/images/2013/pxe-dhcp-nfs-kickstart/01.jpg\" alt=\"alt txt\"></p>\n<p>(1)    PXE client向DHCP server发送请求<br>将支持PXE网络接口卡(NIC)的计算机的BIOS设置为以PXE方式启动，此时，PXE Client通过PXE Boot ROM会以UDP(简单用户数据协议)的形式在网络中发送一个广播请求，请求DHCP服务器分配IP地址等相关信息。</p>\n<p>(2)    DHCP server应答PXE client<br>DHCP Server收到客户端请求，验证是否来自合法的PXE Client请求，验证通过后，它会回应PXE Client，回应中包含了为PXE Client分配的IP地址、pxelinux启动程序(TFTP)的位置，以及配置文件所在位置。</p>\n<p>(3)    PXE client请求下载启动文件<br>客户端收到服务器的回应后，会向TFTP服务器请求传送启动系统安装所需文件。这些启动文件包括：pxelinux.0、pxelinux.cfg/default、vmlinuz、initrd.img等文件。</p>\n<p>(4)    TFTP服务器响应客户端请求并传送文件<br>当TFTP服务器收到客户端请求后，它们之间会有更多的信息在客户端和服务器之间做应答，用以决定启动参数。BootROM由TFTP通讯协议从Boot Server下载启动安装程序所必须的文件（pxelinux.0、pxelinux.cfg/default）。default文件下载完成后，会根据该文件中定义的引导顺序，启动linux安装程序的引导内核。</p>\n<p>(5)    请求下载自动应答文件<br>pxe client通过pxelinux.cfg/default文件成功引导linux安装内核后，安装程序首先确定你通过什么安装来安装linux,如果是通过网络安装（NFS,FTP,HTTP）,则会在这个时候初始化网络，并定位安装系统所需的二进制包以及配置文件的位置。接着会读取该文件中指定的自动应答文件ks.cfg,然后根据ks.cfg中文件位置请求下载相关文件。  </p>\n<p>(6)    客户端安装操作系统<br>将ks.cfg文件下载回来后，通过该文件找到os server(可以是http,NFS,FTP等)，并按照该文件的配置请求下载安装过程中需要的软件包。<br>OS server和客户端建立连接后，将开始传输软件包。客户端开始安装操作系统，安装完成后，提示重新引导计算机。  </p>\n<p>PXE client是需要安装linux的客户机，TFTP Server、DHCP Server和NFS Server运行在另外一台或多台Linux Server上。Bootstrap文件、配置文件、Linux内核都放置在Linux Server上的TFTP服务器的根目录下。而linux的系统安装相关文件则存在NFS Server的共享目录中。<br>PXE client工作过程中，需要三个二进制文件：Bootstrap、Linux内核和Linux根文件系统。Bootstrap文件是可执行程序，它向用户提供简单的控制界面，并根据用户的选择，下载合适的Linux内核及根文件系统。   </p>\n<p>1.3,1.4资料感谢老男孩老师#</p>\n<p>##1.5. PXE+kickStart安装条件<br>(1)    DHCP 服务器<br>(2)    TFTP 服务器<br>(3)    KickStart所生成的ks.cfg配置文件<br>(4)    一台存放系统安装文件的服务器，如 NFS、HTTP 或 FTP 服务器<br>(5)    带有 PXE 支持网卡的待安装主机  </p>\n<p>#2. 安装环境</p>\n<p>##2.1.    Kickstart服务器环境说明</p>\n<p>###操作系统：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]<span class=\"comment\"># cat /etc/redhat-release </span></div><div class=\"line\">CentOS release 5.8 (Final) </div><div class=\"line\">[root@lie-pc ~]<span class=\"comment\"># uname -mi</span></div><div class=\"line\">x86_64 x86_64</div><div class=\"line\"><span class=\"comment\">#内核版本：</span></div><div class=\"line\">[root@lie-pc ~]<span class=\"comment\"># uname -r</span></div><div class=\"line\">2.6.18-308.el5</div></pre></td></tr></table></figure>\n<p>####主机网络参数设置：<br>主机名:        lie-pc<br>网卡eth0:    10.0.0.34<br>默认网关:        10.0.0.2<br>子网掩码:        255.255.255.0  </p>\n<p>#3. 一键安装脚本<br>auto_install_centos.sh</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">#!/bin/bash</span></div><div class=\"line\"> <span class=\"comment\"># auto install kickstart server</span></div><div class=\"line\"> <span class=\"comment\"># the os root's passwd is 123456</span></div><div class=\"line\"> <span class=\"comment\">#</span></div><div class=\"line\"> <span class=\"comment\"># Filename: auto_install_centos.sh</span></div><div class=\"line\"> <span class=\"comment\"># Author: alex</span></div><div class=\"line\"> <span class=\"comment\"># Date:   2012-10-17  </span></div><div class=\"line\"> <span class=\"comment\"># Email:  xionglie.qu@gmail.com  </span></div><div class=\"line\"> <span class=\"comment\">#------------Environment------------  </span></div><div class=\"line\"> <span class=\"comment\">#   Linux 2.6.18-308.el5  i686 or x86_64</span></div><div class=\"line\"> <span class=\"comment\">#   CentOS release 5.8 (Final)</span></div><div class=\"line\"> <span class=\"comment\">#-----------------------------------  </span></div><div class=\"line\"> </div><div class=\"line\"> KICKSTART_SERVER_IP=`/sbin/ifconfig eth0 | grep <span class=\"string\">'inet addr'</span> | awk <span class=\"string\">'&#123;print $2&#125;'</span> | awk -F: <span class=\"string\">'&#123;print $2&#125;'</span>`</div><div class=\"line\"> KICKSTART_SERVER_NET_ID=`<span class=\"built_in\">echo</span> <span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span> | cut <span class=\"_\">-d</span> <span class=\"string\">'.'</span> <span class=\"_\">-f</span>1-3 `</div><div class=\"line\"> KICKSTART_SERVER_SUBNET=<span class=\"variable\">$&#123;KICKSTART_SERVER_NET_ID&#125;</span>.0</div><div class=\"line\"> KICKSTART_SERVER_NETMASK=255.255.255.0</div><div class=\"line\"> KICKSTART_SERVER_ROUTE=<span class=\"variable\">$&#123;KICKSTART_SERVER_NET_ID&#125;</span>.2</div><div class=\"line\"> KICKSTART_SERVER_DHCP_IP_START=<span class=\"variable\">$&#123;KICKSTART_SERVER_NET_ID&#125;</span>.128</div><div class=\"line\"> KICKSTART_SERVER_DHCP_IP_END=<span class=\"variable\">$&#123;KICKSTART_SERVER_NET_ID&#125;</span>.254</div><div class=\"line\"> </div><div class=\"line\"> </div><div class=\"line\"> <span class=\"built_in\">echo</span> <span class=\"string\">\"----- 1.配置nfs服务器 --------------\"</span></div><div class=\"line\"> <span class=\"comment\">#创建共享目录</span></div><div class=\"line\"> mkdir -p /data/sys</div><div class=\"line\"> mount -o loop /root/CentOS-5.8-x86_64-bin-DVD-1of2.iso /data/sys</div><div class=\"line\"> <span class=\"built_in\">echo</span> <span class=\"string\">\"mount -o loop /root/CentOS-5.8-x86_64-bin-DVD-1of2.iso /data/sys\"</span> &gt;&gt;/etc/rc.local</div><div class=\"line\"> </div><div class=\"line\"> <span class=\"comment\">#如果是用光盘就用下面的命令</span></div><div class=\"line\"> <span class=\"comment\">#mount /dev/cdrom /data/sys</span></div><div class=\"line\"> <span class=\"comment\">#echo \"mount /dev/cdrom /data/sys\" &gt;&gt;/etc/rc.local</span></div><div class=\"line\"> ls <span class=\"_\">-l</span> /data/sys</div><div class=\"line\"> </div><div class=\"line\"> <span class=\"comment\">#安装nfs,分发共享目录</span></div><div class=\"line\"> rpm -qa | grep nfs</div><div class=\"line\"> cat &gt; /etc/exports &lt;&lt; EOF</div><div class=\"line\"> /data/sys <span class=\"variable\">$&#123;KICKSTART_SERVER_SUBNET&#125;</span>/24(ro,sync)</div><div class=\"line\"> /data/kickstart <span class=\"variable\">$&#123;KICKSTART_SERVER_SUBNET&#125;</span>/24(ro,sync)</div><div class=\"line\"> EOF</div><div class=\"line\"> cat /etc/exports</div><div class=\"line\"> </div><div class=\"line\"> <span class=\"comment\">#启动nfs,设置开机启动</span></div><div class=\"line\"> /etc/init.d/portmap restart</div><div class=\"line\"> /etc/init.d/nfs restart</div><div class=\"line\"> showmount <span class=\"_\">-e</span> 127.0.0.1</div><div class=\"line\"> </div><div class=\"line\"> chkconfig portmap on</div><div class=\"line\"> chkconfig nfs on</div><div class=\"line\"> chkconfig --list | egrep <span class=\"string\">\"nfs|portmap\"</span></div><div class=\"line\"> </div><div class=\"line\"> <span class=\"built_in\">echo</span> <span class=\"string\">\"----- 2.配置TFTP服务器 --------------\"</span></div><div class=\"line\"> yum -y install tftp-server* -y</div><div class=\"line\"> sed -i <span class=\"string\">'/disable.*=/ s#yes#no#'</span> /etc/xinetd.d/tftp</div><div class=\"line\"> /etc/init.d/xinetd restart</div><div class=\"line\"> chkconfig xinetd on</div><div class=\"line\"> </div><div class=\"line\"> /bin/cp /usr/lib/syslinux/pxelinux.0 /tftpboot/</div><div class=\"line\"> /bin/cp /data/sys/images/pxeboot/vmlinuz /tftpboot/</div><div class=\"line\"> /bin/cp /data/sys/images/pxeboot/initrd.img /tftpboot/</div><div class=\"line\"> </div><div class=\"line\"> mkdir /tftpboot/pxelinux.cfg -p</div><div class=\"line\"> /bin/cp /data/sys/isolinux/isolinux.cfg /tftpboot/pxelinux.cfg/default</div><div class=\"line\"> chmod a+r /tftpboot/pxelinux.cfg/default</div><div class=\"line\"> sed -i <span class=\"string\">\"s#default linux#default text#\"</span> /tftpboot/pxelinux.cfg/default</div><div class=\"line\"> sed -i <span class=\"string\">\"s#append initrd=initrd.img text#append ks=nfs:<span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span>:/data/kickstart/ks.cfg ksdevice=eth0 initrd=initrd.img text#\"</span> /tftpboot/pxelinux.cfg/default</div><div class=\"line\"> </div><div class=\"line\"> <span class=\"built_in\">echo</span> <span class=\"string\">\"----- 3.配置DHCP --------------\"</span></div><div class=\"line\"> yum -y install dhcp*</div><div class=\"line\"> <span class=\"comment\">#/bin/cp /usr/share/doc/dhcp-3.0.5/dhcpd.conf.sample /etc/dhcpd.conf</span></div><div class=\"line\"> </div><div class=\"line\"> cat &gt; /etc/dhcpd.conf &lt;&lt; EOF</div><div class=\"line\"> ddns-update-style none;</div><div class=\"line\"> ignore client-updates;</div><div class=\"line\"> allow booting;</div><div class=\"line\"> allow bootp;</div><div class=\"line\"> default-lease-time 21600;</div><div class=\"line\"> max-lease-time 43200;</div><div class=\"line\"> option routers <span class=\"variable\">$&#123;KICKSTART_SERVER_ROUTE&#125;</span>;</div><div class=\"line\"> </div><div class=\"line\"> subnet <span class=\"variable\">$&#123;KICKSTART_SERVER_SUBNET&#125;</span> netmask <span class=\"variable\">$&#123;KICKSTART_SERVER_NETMASK&#125;</span> &#123;</div><div class=\"line\"> range dynamic-bootp <span class=\"variable\">$&#123;KICKSTART_SERVER_DHCP_IP_START&#125;</span> <span class=\"variable\">$&#123;KICKSTART_SERVER_DHCP_IP_END&#125;</span>;</div><div class=\"line\"> next-server <span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span>;</div><div class=\"line\"> filename <span class=\"string\">\"/data/kickstart/ks.cfg\"</span>;</div><div class=\"line\"> next-server <span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span>;</div><div class=\"line\"> filename <span class=\"string\">\"pxelinux.0\"</span>;</div><div class=\"line\"> &#125;</div><div class=\"line\"> EOF</div><div class=\"line\"> </div><div class=\"line\"> /etc/init.d/dhcpd restart</div><div class=\"line\"> <span class=\"comment\">#出错的话，cat /var/log/message</span></div><div class=\"line\"> </div><div class=\"line\"> chkconfig dhcpd on</div><div class=\"line\"> chkconfig --list dhcpd</div><div class=\"line\"> </div><div class=\"line\"> <span class=\"built_in\">echo</span> <span class=\"string\">\"----- 4.配置kickstart --------------\"</span></div><div class=\"line\"> mkdir -p /data/kickstart/</div><div class=\"line\"> <span class=\"comment\">#/bin/cp /root/anaconda-ks.cfg /data/kickstart/ks.cfg</span></div><div class=\"line\"> <span class=\"comment\">#chmod 644 /data/kickstart/ks.cfg</span></div><div class=\"line\"> </div><div class=\"line\"> cat &gt; /data/kickstart/ks.cfg &lt;&lt; EOF </div><div class=\"line\"> install</div><div class=\"line\"> nfs --server=<span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span> --dir=/data/sys</div><div class=\"line\"> lang en_US.UTF-8</div><div class=\"line\"> keyboard us</div><div class=\"line\"> network --device=eth0 --bootproto=dhcp --onboot=on --hostname stu412</div><div class=\"line\"> <span class=\"comment\">#network --device=eth1 --bootproto=dhcp --onboot=on</span></div><div class=\"line\"> </div><div class=\"line\"> <span class=\"comment\">#root password</span></div><div class=\"line\"> rootpw 123456</div><div class=\"line\"> <span class=\"comment\">#rootpw --iscrypted \\$1\\$dQVhf2.F\\$wUhtrf7gHDN8Q6EtlrWSF.</span></div><div class=\"line\"> </div><div class=\"line\"> </div><div class=\"line\"> authconfig --enableshadow --enablemd5</div><div class=\"line\"> selinux --disabled</div><div class=\"line\"> firewall --disabled</div><div class=\"line\"> timezone --utc Asia/Shanghai</div><div class=\"line\"> bootloader --location=mbr --driveorder=sda</div><div class=\"line\"> firstboot --disabled</div><div class=\"line\"> logging --level=info</div><div class=\"line\"> zerombr</div><div class=\"line\"> </div><div class=\"line\"> </div><div class=\"line\"> <span class=\"comment\">#clearpart --linux</span></div><div class=\"line\"> clearpart --all</div><div class=\"line\"> part /boot --fstype ext3 --size=200 --asprimary</div><div class=\"line\"> part swap --size=512 --asprimary</div><div class=\"line\"> part / --fstype ext3 --size=1 --grow --asprimary</div><div class=\"line\"> reboot</div><div class=\"line\"> </div><div class=\"line\"> %packages</div><div class=\"line\"> @base</div><div class=\"line\"> @core</div><div class=\"line\"> @development-libs</div><div class=\"line\"> @development-tools</div><div class=\"line\"> @editors</div><div class=\"line\"> @system-tools</div><div class=\"line\"> @x-software-development</div><div class=\"line\"> </div><div class=\"line\"> %post</div><div class=\"line\"> <span class=\"comment\">#!/bin/bash</span></div><div class=\"line\"> mkdir -p /application/tools</div><div class=\"line\"> mkdir -p /server/scripts</div><div class=\"line\"> </div><div class=\"line\"> EOF</div><div class=\"line\"> </div><div class=\"line\"> <span class=\"built_in\">echo</span> <span class=\"string\">\"-----done-----\"</span></div></pre></td></tr></table></figure>\n<p>#4. 安装说明</p>\n<p>##4.1.    挂载系统安装盘</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">#创建共享目录</div><div class=\"line\">mkdir -p /data/sys</div><div class=\"line\">mount -o loop /root/CentOS-5.8-x86_64-bin-DVD-1of2.iso /data/sys</div><div class=\"line\">echo &quot;mount -o loop /root/CentOS-5.8-x86_64-bin-DVD-1of2.iso /data/sys&quot; &gt;&gt;/etc/rc.local</div><div class=\"line\"> </div><div class=\"line\">#如果是用光盘就用下面的命令</div><div class=\"line\">#mount /dev/cdrom /data/sys</div><div class=\"line\">#echo &quot;mount /dev/cdrom /data/sys&quot; &gt;&gt;/etc/rc.local</div><div class=\"line\">ls -l /data/sys</div></pre></td></tr></table></figure>\n<p>##4.2. 设置nfs </p>\n<p>操作过程：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#安装nfs,分发共享目录</span></div><div class=\"line\">cat &gt; /etc/exports &lt;&lt; EOF</div><div class=\"line\">/data/sys <span class=\"variable\">$&#123;KICKSTART_SERVER_SUBNET&#125;</span>/24(ro,sync)</div><div class=\"line\">/data/kickstart <span class=\"variable\">$&#123;KICKSTART_SERVER_SUBNET&#125;</span>/24(ro,sync)</div><div class=\"line\">EOF</div></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# cat /etc/exports </div><div class=\"line\">/data/sys 10.0.0.0/24(ro,sync)</div><div class=\"line\">/data/kickstart 10.0.0.0/24(ro,sync)</div><div class=\"line\"></div><div class=\"line\">[root@lie-pc ~]# showmount -e localhost </div><div class=\"line\">Export list for localhost: </div><div class=\"line\">/data/sys 10.0.0.0/24 </div><div class=\"line\">/data/kickstart 10.0.0.0/24</div></pre></td></tr></table></figure>\n<p>##4.3. 设置tftp<br>操作命令：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum -y install tftp-server* -y</div><div class=\"line\">sed -i &apos;/disable.*=/ s#yes#no#&apos; /etc/xinetd.d/tftp</div><div class=\"line\">/etc/init.d/xinetd restart</div><div class=\"line\">chkconfig xinetd on</div><div class=\"line\"></div><div class=\"line\">/bin/cp /usr/lib/syslinux/pxelinux.0 /tftpboot/</div><div class=\"line\">/bin/cp /data/sys/images/pxeboot/vmlinuz /tftpboot/</div><div class=\"line\">/bin/cp /data/sys/images/pxeboot/initrd.img /tftpboot/</div><div class=\"line\"></div><div class=\"line\">mkdir /tftpboot/pxelinux.cfg -p</div><div class=\"line\">/bin/cp /data/sys/isolinux/isolinux.cfg /tftpboot/pxelinux.cfg/default</div><div class=\"line\">chmod a+r /tftpboot/pxelinux.cfg/default</div><div class=\"line\">sed -i &quot;s#default linux#default text#&quot; /tftpboot/pxelinux.cfg/default</div><div class=\"line\">sed -i &quot;s#append initrd=initrd.img text#append ks=nfs:$&#123;KICKSTART_SERVER_IP&#125;:/data/kickstart/ks.cfg ksdevice=eth0 initrd=initrd.img text#&quot; /tftpboot/pxelinux.cfg/default</div></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# cat /etc/xinetd.d/tftp </div><div class=\"line\"># default: off</div><div class=\"line\"># description: The tftp server serves files using the trivial file transfer \\</div><div class=\"line\">#\tprotocol. The tftp protocol is often used to boot diskless \\</div><div class=\"line\">#\tworkstations, download configuration files to network-aware printers, \\</div><div class=\"line\">#\tand to start the installation process for some operating systems.</div><div class=\"line\">service tftp</div><div class=\"line\">&#123;</div><div class=\"line\">  　　socket_type\t = dgram</div><div class=\"line\">  　　protocol\t = udp</div><div class=\"line\">  　　wait\t = yes</div><div class=\"line\">  　　user\t = root</div><div class=\"line\">  　　server\t = /usr/sbin/in.tftpd</div><div class=\"line\">  　　server_args\t = -s /tftpboot</div><div class=\"line\">  　　disable\t = no #将yes改为no</div><div class=\"line\">  　　per_source\t = 11</div><div class=\"line\">  　　cps\t = 100 2</div><div class=\"line\">     　flags\t = IPv4</div><div class=\"line\">&#125;</div><div class=\"line\">[root@lie-pc ~]# cat /tftpboot/pxelinux.cfg/default</div><div class=\"line\">default text</div><div class=\"line\">prompt 1</div><div class=\"line\">timeout 600</div><div class=\"line\">display boot.msg</div><div class=\"line\">F1 boot.msg</div><div class=\"line\">F2 options.msg</div><div class=\"line\">F3 general.msg</div><div class=\"line\">F4 param.msg</div><div class=\"line\">F5 rescue.msg</div><div class=\"line\">label linux</div><div class=\"line\">　　kernel vmlinuz</div><div class=\"line\">　　append initrd=initrd.img</div><div class=\"line\">label text</div><div class=\"line\">　　kernel vmlinuz</div><div class=\"line\">　　append ks=nfs:10.0.0.34:/data/kickstart/ks.cfg ksdevice=eth0 initrd=initrd.img text</div><div class=\"line\">label ks</div><div class=\"line\">　　kernel vmlinuz</div><div class=\"line\">　　append ks initrd=initrd.img</div><div class=\"line\">label local</div><div class=\"line\">　　localboot 1</div><div class=\"line\">label memtest86</div><div class=\"line\">　　kernel memtest　　</div><div class=\"line\">　　append -</div></pre></td></tr></table></figure>\n<p>##4.4. 配置DHCP<br>操作命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum -y install dhcp*</div><div class=\"line\">cat &gt; /etc/dhcpd.conf &lt;&lt; EOF</div><div class=\"line\">ddns-update-style none;</div><div class=\"line\">ignore client-updates;</div><div class=\"line\">allow booting;</div><div class=\"line\">allow bootp;</div><div class=\"line\">default-lease-time 21600;</div><div class=\"line\">max-lease-time 43200;</div><div class=\"line\">option routers <span class=\"variable\">$&#123;KICKSTART_SERVER_ROUTE&#125;</span>;</div><div class=\"line\"></div><div class=\"line\">subnet <span class=\"variable\">$&#123;KICKSTART_SERVER_SUBNET&#125;</span> netmask <span class=\"variable\">$&#123;KICKSTART_SERVER_NETMASK&#125;</span> &#123;</div><div class=\"line\">　　range dynamic-bootp <span class=\"variable\">$&#123;KICKSTART_SERVER_DHCP_IP_START&#125;</span> <span class=\"variable\">$&#123;KICKSTART_SERVER_DHCP_IP_END&#125;</span>;</div><div class=\"line\">　　next-server <span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span>;</div><div class=\"line\">　　filename <span class=\"string\">\"/data/kickstart/ks.cfg\"</span>;</div><div class=\"line\">　　next-server <span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span>;</div><div class=\"line\">　　filename <span class=\"string\">\"pxelinux.0\"</span>;</div><div class=\"line\">&#125;</div><div class=\"line\">EOF</div></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# cat /etc/dhcpd.conf</div><div class=\"line\">ddns-update-style none;</div><div class=\"line\">ignore client-updates;</div><div class=\"line\">allow booting;</div><div class=\"line\">allow bootp;</div><div class=\"line\">default-lease-time 21600;</div><div class=\"line\">max-lease-time 43200;</div><div class=\"line\">option routers 10.0.0.2;</div><div class=\"line\"></div><div class=\"line\">subnet 10.0.0.0 netmask 255.255.255.0 &#123;</div><div class=\"line\">　　range dynamic-bootp 10.0.0.128 10.0.0.254;</div><div class=\"line\">　　next-server 10.0.0.34;</div><div class=\"line\">　　filename &quot;/data/kickstart/ks.cfg&quot;;</div><div class=\"line\">　　next-server 10.0.0.34;</div><div class=\"line\">　　filename &quot;pxelinux.0&quot;;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>##4.5. 配置ks.cfg文件</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# cat /data/kickstart/ks.cfg </div><div class=\"line\">install\t #安装系统而不是升级</div><div class=\"line\">nfs --server=10.0.0.34 --dir=/data/sys\t#nfs安装</div><div class=\"line\">lang en_US.UTF-8\t #字符集</div><div class=\"line\">keyboard us\t</div><div class=\"line\">network --device=eth0 --bootproto=dhcp --onboot=on --hostname lie-pc</div><div class=\"line\">#network --device=eth1 --bootproto=dhcp --onboot=on</div><div class=\"line\">#网络配置</div><div class=\"line\"></div><div class=\"line\">#root password</div><div class=\"line\">rootpw 123456\t #root用户密码，也可以使用下面加密方式</div><div class=\"line\">#rootpw --iscrypted $1$dQVhf2.F$wUhtrf7gHDN8Q6EtlrWSF.</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">authconfig --enableshadow --enablemd5\t #系统认证信息</div><div class=\"line\">selinux --disabled\t #关闭selinux</div><div class=\"line\">firewall --disabled #关闭iptables</div><div class=\"line\">timezone --utc Asia/Shanghai #时区</div><div class=\"line\">bootloader --location=mbr --driveorder=sda</div><div class=\"line\">firstboot --disabled #禁止安装后的Agent设置</div><div class=\"line\">logging --level=info #日志级别</div><div class=\"line\">zerombr\t #清除mbr引导信息</div><div class=\"line\"></div><div class=\"line\">##### 系统分区设置 #####</div><div class=\"line\">#clearpart --linux</div><div class=\"line\">clearpart --all</div><div class=\"line\">part /boot --fstype ext3 --size=200 --asprimary</div><div class=\"line\">part swap --size=512 --asprimary</div><div class=\"line\">part / --fstype ext3 --size=1 --grow --asprimary</div><div class=\"line\">reboot\t #安装后重启</div><div class=\"line\"></div><div class=\"line\">##### 安装包的选择 #####</div><div class=\"line\">%packages</div><div class=\"line\">@base</div><div class=\"line\">@core</div><div class=\"line\">@development-libs</div><div class=\"line\">@development-tools</div><div class=\"line\">@editors</div><div class=\"line\">@system-tools</div><div class=\"line\">@x-software-development</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">##### 安装后的操作 #####</div><div class=\"line\"></div><div class=\"line\">%post</div><div class=\"line\">#!/bin/bash</div><div class=\"line\">mkdir -p /application/tools</div><div class=\"line\">mkdir -p /server/scripts</div></pre></td></tr></table></figure>\n<p>#5. OS安装过程</p>\n<p>在服务器上执行上面一键安装脚本(auto_install_centos.sh)之后， 新建一个VM虚拟机,直接启动！<br><img src=\"/images/2013/pxe-dhcp-nfs-kickstart/02.png\" alt=\"alt txt\"></p>\n<p><img src=\"/images/2013/pxe-dhcp-nfs-kickstart/03.png\" alt=\"alt txt\"></p>"},{"layout":"post","title":"linux系列1-centos5.8 x64安装过程","date":"2013-01-22T09:05:00.000Z","comments":1,"_content":"\n对于linux初学者来说，鸟哥的linux私房菜是很好的学习教材了。  \n我也是从linux初学者这条路走过来的,目前正在研究linux运维的技术。对于自已学过的东西，总希望留点脚印(但愿不是坑)，让大家少走点弯路。于是想写下这一系列的教程。  \n\n<!-- more -->\n\n建议在文本模式下安装linux，并通过命令行学习linux。   \n本文的系统安装只针对Centos5.x系统，  \nCentos6.x的文本安装不能自定义分区及大小，不能自定义软件包。\n  \n```\n目录\n1.\t安装Centos5.8 x64  \n1.1.\t下载Centos,新建虚拟机\t\n1.2.\t输入linux text ,文本模式安装\t\n1.3.\t安装盘检验，选择skip\t\n1.4.\tWelcome CentOS(默认OK)\t\n1.5.\t选择语言为English\t\t\n1.6.\t选择键盘布局类型为us\t\n1.7.\t选择\"自定义分区\"\t\n1.8.\t分区\t\n1.8.1.\t设置/boot分区\t\n1.8.2.\t设置swap分区\t\n1.8.3.\t设置根分区\t\n1.8.4.\t点OK确认分区\t\n1.9.\t选择grub引导,默认OK\n1.10.\tboot加载参数, 默认OK\n1.11.\t设置GRUB密码，根据需求情况设置，这里跳过，默认OK\n1.12.\t确认安装位置, 默认 OK\n1.13.\t确认MBR安装位置, 默认 OK\n1.14.\t配置网络参数\n1.15.\t配置GATEWAY、DNS(按需求设置),我这里默认用DHCP\n1.16.\t设置主机名\n1.17.\t设置时区 Asia/Shanghai\n1.18.\t设置ROOT密码\n1.19.\t选择自定义软件包\n1.20.\t自定义软件包(重要)\n1.21.\t生成安装日志/root/install.log\n1.22.\t开始安装程序\n1.23.\t安装完成, Reboot重启\n2.\t配置Centos5.8\n2.1.\t关闭防火墙,SELinux\n2.2.\t设置完成,退出setup agent\n3.\t生产环境的分区建议\n4. 问题\n5. 更多资料\n```\n\n#1. 安装Centos5.8 x64\n##1.1.\t下载Centos,新建虚拟机\n我使用的是VMware Workstation，注意选择的是64bit版本。\n虚拟硬盘大小为20G。\n![Alt text](/images/2013/install-centos/1_1.JPG)\n\n##1.2. 输入linux text ,文本模式安装\n![Alt text](/images/2013/install-centos/1_2.JPG)\n\n\n##1.3.\t安装盘检验，选择skip\n##1.4.\tWelcome CentOS(默认OK)\n##1.5.\t选择语言为English\n##1.6.\t选择键盘布局类型为us\n##1.7. 选择\"自定义分区\"\n![Alt text](/images/2013/install-centos/1_7.JPG)\n\n##1.8.\t分区\n规划：\t\n/boot : 128M\t\n/swap : 物理内存大小*1.5,这里暂设为:512M\t\n/ : 剩余所有空间\t\n![Alt text](/images/2013/install-centos/1_8.JPG)\n\n\n###1.8.1. 设置/boot分区\n挂载点/boot \t\n文件系统：ext3 \t\nsize：200M 强制为主分区\t\n![Alt text](/images/2013/install-centos/1_8_1.JPG)\n\n\n###1.8.2.\t设置swap分区\n文件系统：swap \t\nsize：512M （一般为物理内存的1.5倍）\t\n![Alt text](/images/2013/install-centos/1_8_2.JPG)\n\n\n###1.8.3.\t设置根分区\n挂载点/ \t\n文件系统：ext3 \t\nsize：剩余空间\t\n强制为主分区  \n![Alt text](/images/2013/install-centos/1_8_3.JPG)\n\n\n###1.8.4.\t点OK确认分区\n![Alt text](/images/2013/install-centos/1_8_4.JPG)\n\n##1.9. 选择grub引导,默认OK\n##1.10.\tboot加载参数, 默认OK\n##1.11.\t设置GRUB密码，根据需求情况设置，这里跳过，默认OK\n\n##1.12. 确认安装位置, 默认 OK\n![Alt text](/images/2013/install-centos/1_12.JPG)\n\n\n##1.13.\t确认MBR安装位置, 默认 OK\n\n##1.14.配置网络参数\n![Alt text](/images/2013/install-centos/1_14_0.JPG)\n\n![Alt text](/images/2013/install-centos/1_14.JPG)\n\n\n\n\n##1.15. 配置GATEWAY、DNS(按需求设置),我这里默认用DHCP\n![Alt text](/images/2013/install-centos/1_15.JPG)\n\n\n##1.16.\t设置主机名\n![Alt text](/images/2013/install-centos/1_16.JPG)\n\n\n##1.17.\t设置时区 Asia/Shanghai\n##1.18.\t设置ROOT密码\n![Alt text](/images/2013/install-centos/1_18.JPG)\n\n\n##1.19.\t选择自定义软件包\n\n![Alt text](/images/2013/install-centos/1_19.JPG)\n\n\n##1.20. 自定义软件包\n\n只安装以下软件包\n\n```\nbase \neditors \ndevelopment librarys \ndevelopment tools \nx software development \nsystem tools\n```\n\n##1.21.\t生成安装日志/root/install.log\n##1.22.\t开始安装程序\n![Alt text](/images/2013/install-centos/1_22.JPG)\n\n\n##1.23.\t安装完成, Reboot重启\n\n#2. 配置Centos5.8\n\n可以在命令行输入：setup,进行下面参数的设置\n##2.1.\t关闭防火墙,SELinux\n![Alt text](/images/2013/install-centos/2_1_0.JPG)\n\n![Alt text](/images/2013/install-centos/2_1_1.JPG)\n\n\n##2.2.\t设置完成,退出setup agent\n\n\n#3. 生产环境的分区建议\n<table style=\"width: 100%;\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\">\n    <tbody>\n        <tr>\n            <td style=\"width: 20%;\">\n                服务器角色\n            </td>\n            <td style=\"width: 25%;\">\n                分区建议\n            </td>\n            <td style=\"width: 30%;\">\n                优点\n            </td>\n            <td style=\"width: 35%;\">\n                RAID 方案\n            </td>\n        </tr>\n        <tr>\n            <td>\n                单机服务器 lamp/lnmp。如8G内存，300G硬盘\n            </td>\n            <td>\n      /boot 100-200M swap&nbsp;16G，内存大小8G*2 /&nbsp;80G /data 180G（web及db数据）\n            </td>\n            <td>\n                数据盘和系统盘分开，有利于出问题时维护。\n            </td>\n            <td>\n                视数据及性能要求，可采用单盘或3块盘raid5折中。双盘raid1也可。\n            </td>\n        </tr>\n        <tr>\n            <td>\n                最前端L4负载均衡器（如LVS等）\n            </td>\n            <td>\n                /boot 100-200M swap&nbsp;内存的1-2倍 /&nbsp;\n            </td>\n            <td>\n                简单方便，只做转发，本地数据量很少。\n            </td>\n            <td>\n                数据量小，重要性高，可采用双盘RAID1,多一块盘降低宕机维护成本。\n            </td>\n        </tr>\n        <tr>\n            <td>\n                负载均衡下的RS server,即普通节点服务器\n            </td>\n            <td>\n                /boot 100-200M swap&nbsp;内存的1-2倍 /&nbsp;\n            </td>\n            <td>\n                简单方便，因为有多机，对数据要求低。\n            </td>\n            <td>\n                数据量大，重要性不高，有性能要求，数据要求低，可采用双盘RAID0\n            </td>\n        </tr>\n        <tr>\n            <td>\n                数据库服务器 mysql及oracle 如16/32G内存 &nbsp; &nbsp;\n            </td>\n            <td>\n                /boot 100-200M swap&nbsp;16G，内存的1倍 /&nbsp;100G /data&nbsp;剩余（存放db数据）\n            </td>\n            <td>\n                数据盘和系统盘分开，有利于出问题时维护,及保持数据完整。\n            </td>\n            <td>\n                视数据及性能要求主库可采取raid10/raid5，从库可采用raid0或raid5提高性能（读写分离的情况下。）\n            </td>\n        </tr>\n        <tr>\n            <td>\n                线下备份存储服务器\n            </td>\n            <td>\n                /boot 100-200M swap&nbsp;内存的1-2倍 /&nbsp;100G /data(存放数据)\n            </td>\n            <td>\n                此服务器不要分区太多。只做备份，性能要求低。容量要大。\n            </td>\n            <td>\n                可采取sata盘，raid5(多组),容量大，性能要求不高。数据有要求。\n            </td>\n        </tr>\n        <tr>\n            <td>\n                在线共享存储服务器（如NFS）\n            </td>\n            <td>\n                /boot 100-200M swap&nbsp;内存的1-2倍 /&nbsp;100G /data(存放数据)\n            </td>\n            <td>\n                此服务器不要分区太多。NFS共享比存储多的要求就是性能要求。\n            </td>\n            <td>\n                视性能及访问要求可以raid5,raid10,甚至raid0（要有高可用或双写方案）\n            </td>\n        </tr>\n        <tr>\n            <td>\n                监控服务器 cacti,nagios\n            </td>\n            <td>\n                /boot 100-200M swap&nbsp;内存的1-2倍 /&nbsp;\n            </td>\n            <td>\n                重要性一般，数据要求也一般。\n            </td>\n            <td>\n                单盘或双盘raid1即可。三盘就RAID5，看容量要求加盘即可。\n            </td>\n        </tr>\n    </tbody>\n</table>\n\n\n#4. 问题\n(1)硬盘主分区和逻辑分区的区别?  \n(2)什么是RAID?如何做RAID?\t\n(3)DELL R710新服务器多硬盘Raid5后容量大于2TB如何分区  \n(4)添加新硬盘后，如何分区和格式化?fdick parted\t\n(5)如果要安装几十上百台服务器如何实现批量无人值守安装\t\n后面我会单独写一篇博客介绍  \t\n(6)...  \n\n#5.更多资料\n(1)生产场景不同角色linux服务器分区案例分享  \nhttp://oldboy.blog.51cto.com/2561410/634725  \n\n(2)运维老鸟谈生产场景如何对linux系统进行分区？  \nhttp://oldboy.blog.51cto.com/2561410/629558","source":"_posts/2013-01-22-linux01-install-centos5-dot-8-x64-process.md","raw":"---\nlayout: post\ntitle: \"linux系列1-centos5.8 x64安装过程\"\ndate: 2013-01-22 17:05\ncomments: true\ncategories: linux\n---\n\n对于linux初学者来说，鸟哥的linux私房菜是很好的学习教材了。  \n我也是从linux初学者这条路走过来的,目前正在研究linux运维的技术。对于自已学过的东西，总希望留点脚印(但愿不是坑)，让大家少走点弯路。于是想写下这一系列的教程。  \n\n<!-- more -->\n\n建议在文本模式下安装linux，并通过命令行学习linux。   \n本文的系统安装只针对Centos5.x系统，  \nCentos6.x的文本安装不能自定义分区及大小，不能自定义软件包。\n  \n```\n目录\n1.\t安装Centos5.8 x64  \n1.1.\t下载Centos,新建虚拟机\t\n1.2.\t输入linux text ,文本模式安装\t\n1.3.\t安装盘检验，选择skip\t\n1.4.\tWelcome CentOS(默认OK)\t\n1.5.\t选择语言为English\t\t\n1.6.\t选择键盘布局类型为us\t\n1.7.\t选择\"自定义分区\"\t\n1.8.\t分区\t\n1.8.1.\t设置/boot分区\t\n1.8.2.\t设置swap分区\t\n1.8.3.\t设置根分区\t\n1.8.4.\t点OK确认分区\t\n1.9.\t选择grub引导,默认OK\n1.10.\tboot加载参数, 默认OK\n1.11.\t设置GRUB密码，根据需求情况设置，这里跳过，默认OK\n1.12.\t确认安装位置, 默认 OK\n1.13.\t确认MBR安装位置, 默认 OK\n1.14.\t配置网络参数\n1.15.\t配置GATEWAY、DNS(按需求设置),我这里默认用DHCP\n1.16.\t设置主机名\n1.17.\t设置时区 Asia/Shanghai\n1.18.\t设置ROOT密码\n1.19.\t选择自定义软件包\n1.20.\t自定义软件包(重要)\n1.21.\t生成安装日志/root/install.log\n1.22.\t开始安装程序\n1.23.\t安装完成, Reboot重启\n2.\t配置Centos5.8\n2.1.\t关闭防火墙,SELinux\n2.2.\t设置完成,退出setup agent\n3.\t生产环境的分区建议\n4. 问题\n5. 更多资料\n```\n\n#1. 安装Centos5.8 x64\n##1.1.\t下载Centos,新建虚拟机\n我使用的是VMware Workstation，注意选择的是64bit版本。\n虚拟硬盘大小为20G。\n![Alt text](/images/2013/install-centos/1_1.JPG)\n\n##1.2. 输入linux text ,文本模式安装\n![Alt text](/images/2013/install-centos/1_2.JPG)\n\n\n##1.3.\t安装盘检验，选择skip\n##1.4.\tWelcome CentOS(默认OK)\n##1.5.\t选择语言为English\n##1.6.\t选择键盘布局类型为us\n##1.7. 选择\"自定义分区\"\n![Alt text](/images/2013/install-centos/1_7.JPG)\n\n##1.8.\t分区\n规划：\t\n/boot : 128M\t\n/swap : 物理内存大小*1.5,这里暂设为:512M\t\n/ : 剩余所有空间\t\n![Alt text](/images/2013/install-centos/1_8.JPG)\n\n\n###1.8.1. 设置/boot分区\n挂载点/boot \t\n文件系统：ext3 \t\nsize：200M 强制为主分区\t\n![Alt text](/images/2013/install-centos/1_8_1.JPG)\n\n\n###1.8.2.\t设置swap分区\n文件系统：swap \t\nsize：512M （一般为物理内存的1.5倍）\t\n![Alt text](/images/2013/install-centos/1_8_2.JPG)\n\n\n###1.8.3.\t设置根分区\n挂载点/ \t\n文件系统：ext3 \t\nsize：剩余空间\t\n强制为主分区  \n![Alt text](/images/2013/install-centos/1_8_3.JPG)\n\n\n###1.8.4.\t点OK确认分区\n![Alt text](/images/2013/install-centos/1_8_4.JPG)\n\n##1.9. 选择grub引导,默认OK\n##1.10.\tboot加载参数, 默认OK\n##1.11.\t设置GRUB密码，根据需求情况设置，这里跳过，默认OK\n\n##1.12. 确认安装位置, 默认 OK\n![Alt text](/images/2013/install-centos/1_12.JPG)\n\n\n##1.13.\t确认MBR安装位置, 默认 OK\n\n##1.14.配置网络参数\n![Alt text](/images/2013/install-centos/1_14_0.JPG)\n\n![Alt text](/images/2013/install-centos/1_14.JPG)\n\n\n\n\n##1.15. 配置GATEWAY、DNS(按需求设置),我这里默认用DHCP\n![Alt text](/images/2013/install-centos/1_15.JPG)\n\n\n##1.16.\t设置主机名\n![Alt text](/images/2013/install-centos/1_16.JPG)\n\n\n##1.17.\t设置时区 Asia/Shanghai\n##1.18.\t设置ROOT密码\n![Alt text](/images/2013/install-centos/1_18.JPG)\n\n\n##1.19.\t选择自定义软件包\n\n![Alt text](/images/2013/install-centos/1_19.JPG)\n\n\n##1.20. 自定义软件包\n\n只安装以下软件包\n\n```\nbase \neditors \ndevelopment librarys \ndevelopment tools \nx software development \nsystem tools\n```\n\n##1.21.\t生成安装日志/root/install.log\n##1.22.\t开始安装程序\n![Alt text](/images/2013/install-centos/1_22.JPG)\n\n\n##1.23.\t安装完成, Reboot重启\n\n#2. 配置Centos5.8\n\n可以在命令行输入：setup,进行下面参数的设置\n##2.1.\t关闭防火墙,SELinux\n![Alt text](/images/2013/install-centos/2_1_0.JPG)\n\n![Alt text](/images/2013/install-centos/2_1_1.JPG)\n\n\n##2.2.\t设置完成,退出setup agent\n\n\n#3. 生产环境的分区建议\n<table style=\"width: 100%;\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\">\n    <tbody>\n        <tr>\n            <td style=\"width: 20%;\">\n                服务器角色\n            </td>\n            <td style=\"width: 25%;\">\n                分区建议\n            </td>\n            <td style=\"width: 30%;\">\n                优点\n            </td>\n            <td style=\"width: 35%;\">\n                RAID 方案\n            </td>\n        </tr>\n        <tr>\n            <td>\n                单机服务器 lamp/lnmp。如8G内存，300G硬盘\n            </td>\n            <td>\n      /boot 100-200M swap&nbsp;16G，内存大小8G*2 /&nbsp;80G /data 180G（web及db数据）\n            </td>\n            <td>\n                数据盘和系统盘分开，有利于出问题时维护。\n            </td>\n            <td>\n                视数据及性能要求，可采用单盘或3块盘raid5折中。双盘raid1也可。\n            </td>\n        </tr>\n        <tr>\n            <td>\n                最前端L4负载均衡器（如LVS等）\n            </td>\n            <td>\n                /boot 100-200M swap&nbsp;内存的1-2倍 /&nbsp;\n            </td>\n            <td>\n                简单方便，只做转发，本地数据量很少。\n            </td>\n            <td>\n                数据量小，重要性高，可采用双盘RAID1,多一块盘降低宕机维护成本。\n            </td>\n        </tr>\n        <tr>\n            <td>\n                负载均衡下的RS server,即普通节点服务器\n            </td>\n            <td>\n                /boot 100-200M swap&nbsp;内存的1-2倍 /&nbsp;\n            </td>\n            <td>\n                简单方便，因为有多机，对数据要求低。\n            </td>\n            <td>\n                数据量大，重要性不高，有性能要求，数据要求低，可采用双盘RAID0\n            </td>\n        </tr>\n        <tr>\n            <td>\n                数据库服务器 mysql及oracle 如16/32G内存 &nbsp; &nbsp;\n            </td>\n            <td>\n                /boot 100-200M swap&nbsp;16G，内存的1倍 /&nbsp;100G /data&nbsp;剩余（存放db数据）\n            </td>\n            <td>\n                数据盘和系统盘分开，有利于出问题时维护,及保持数据完整。\n            </td>\n            <td>\n                视数据及性能要求主库可采取raid10/raid5，从库可采用raid0或raid5提高性能（读写分离的情况下。）\n            </td>\n        </tr>\n        <tr>\n            <td>\n                线下备份存储服务器\n            </td>\n            <td>\n                /boot 100-200M swap&nbsp;内存的1-2倍 /&nbsp;100G /data(存放数据)\n            </td>\n            <td>\n                此服务器不要分区太多。只做备份，性能要求低。容量要大。\n            </td>\n            <td>\n                可采取sata盘，raid5(多组),容量大，性能要求不高。数据有要求。\n            </td>\n        </tr>\n        <tr>\n            <td>\n                在线共享存储服务器（如NFS）\n            </td>\n            <td>\n                /boot 100-200M swap&nbsp;内存的1-2倍 /&nbsp;100G /data(存放数据)\n            </td>\n            <td>\n                此服务器不要分区太多。NFS共享比存储多的要求就是性能要求。\n            </td>\n            <td>\n                视性能及访问要求可以raid5,raid10,甚至raid0（要有高可用或双写方案）\n            </td>\n        </tr>\n        <tr>\n            <td>\n                监控服务器 cacti,nagios\n            </td>\n            <td>\n                /boot 100-200M swap&nbsp;内存的1-2倍 /&nbsp;\n            </td>\n            <td>\n                重要性一般，数据要求也一般。\n            </td>\n            <td>\n                单盘或双盘raid1即可。三盘就RAID5，看容量要求加盘即可。\n            </td>\n        </tr>\n    </tbody>\n</table>\n\n\n#4. 问题\n(1)硬盘主分区和逻辑分区的区别?  \n(2)什么是RAID?如何做RAID?\t\n(3)DELL R710新服务器多硬盘Raid5后容量大于2TB如何分区  \n(4)添加新硬盘后，如何分区和格式化?fdick parted\t\n(5)如果要安装几十上百台服务器如何实现批量无人值守安装\t\n后面我会单独写一篇博客介绍  \t\n(6)...  \n\n#5.更多资料\n(1)生产场景不同角色linux服务器分区案例分享  \nhttp://oldboy.blog.51cto.com/2561410/634725  \n\n(2)运维老鸟谈生产场景如何对linux系统进行分区？  \nhttp://oldboy.blog.51cto.com/2561410/629558","slug":"linux01-install-centos5-dot-8-x64-process","published":1,"updated":"2017-01-27T01:34:43.000Z","photos":[],"link":"","_id":"ciyf7fkay000of2jympg6o04k","content":"<p>对于linux初学者来说，鸟哥的linux私房菜是很好的学习教材了。<br>我也是从linux初学者这条路走过来的,目前正在研究linux运维的技术。对于自已学过的东西，总希望留点脚印(但愿不是坑)，让大家少走点弯路。于是想写下这一系列的教程。  </p>\n<a id=\"more\"></a>\n<p>建议在文本模式下安装linux，并通过命令行学习linux。<br>本文的系统安装只针对Centos5.x系统，<br>Centos6.x的文本安装不能自定义分区及大小，不能自定义软件包。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div></pre></td><td class=\"code\"><pre><div class=\"line\">目录</div><div class=\"line\">1.\t安装Centos5.8 x64  </div><div class=\"line\">1.1.\t下载Centos,新建虚拟机\t</div><div class=\"line\">1.2.\t输入linux text ,文本模式安装\t</div><div class=\"line\">1.3.\t安装盘检验，选择skip\t</div><div class=\"line\">1.4.\tWelcome CentOS(默认OK)\t</div><div class=\"line\">1.5.\t选择语言为English\t\t</div><div class=\"line\">1.6.\t选择键盘布局类型为us\t</div><div class=\"line\">1.7.\t选择&quot;自定义分区&quot;\t</div><div class=\"line\">1.8.\t分区\t</div><div class=\"line\">1.8.1.\t设置/boot分区\t</div><div class=\"line\">1.8.2.\t设置swap分区\t</div><div class=\"line\">1.8.3.\t设置根分区\t</div><div class=\"line\">1.8.4.\t点OK确认分区\t</div><div class=\"line\">1.9.\t选择grub引导,默认OK</div><div class=\"line\">1.10.\tboot加载参数, 默认OK</div><div class=\"line\">1.11.\t设置GRUB密码，根据需求情况设置，这里跳过，默认OK</div><div class=\"line\">1.12.\t确认安装位置, 默认 OK</div><div class=\"line\">1.13.\t确认MBR安装位置, 默认 OK</div><div class=\"line\">1.14.\t配置网络参数</div><div class=\"line\">1.15.\t配置GATEWAY、DNS(按需求设置),我这里默认用DHCP</div><div class=\"line\">1.16.\t设置主机名</div><div class=\"line\">1.17.\t设置时区 Asia/Shanghai</div><div class=\"line\">1.18.\t设置ROOT密码</div><div class=\"line\">1.19.\t选择自定义软件包</div><div class=\"line\">1.20.\t自定义软件包(重要)</div><div class=\"line\">1.21.\t生成安装日志/root/install.log</div><div class=\"line\">1.22.\t开始安装程序</div><div class=\"line\">1.23.\t安装完成, Reboot重启</div><div class=\"line\">2.\t配置Centos5.8</div><div class=\"line\">2.1.\t关闭防火墙,SELinux</div><div class=\"line\">2.2.\t设置完成,退出setup agent</div><div class=\"line\">3.\t生产环境的分区建议</div><div class=\"line\">4. 问题</div><div class=\"line\">5. 更多资料</div></pre></td></tr></table></figure>\n<p>#1. 安装Centos5.8 x64</p>\n<p>##1.1.    下载Centos,新建虚拟机<br>我使用的是VMware Workstation，注意选择的是64bit版本。<br>虚拟硬盘大小为20G。<br><img src=\"/images/2013/install-centos/1_1.JPG\" alt=\"Alt text\"></p>\n<p>##1.2. 输入linux text ,文本模式安装<br><img src=\"/images/2013/install-centos/1_2.JPG\" alt=\"Alt text\"></p>\n<p>##1.3.    安装盘检验，选择skip</p>\n<p>##1.4.    Welcome CentOS(默认OK)</p>\n<p>##1.5.    选择语言为English</p>\n<p>##1.6.    选择键盘布局类型为us</p>\n<p>##1.7. 选择”自定义分区”<br><img src=\"/images/2013/install-centos/1_7.JPG\" alt=\"Alt text\"></p>\n<p>##1.8.    分区<br>规划：<br>/boot : 128M<br>/swap : 物理内存大小*1.5,这里暂设为:512M<br>/ : 剩余所有空间<br><img src=\"/images/2013/install-centos/1_8.JPG\" alt=\"Alt text\"></p>\n<p>###1.8.1. 设置/boot分区<br>挂载点/boot<br>文件系统：ext3<br>size：200M 强制为主分区<br><img src=\"/images/2013/install-centos/1_8_1.JPG\" alt=\"Alt text\"></p>\n<p>###1.8.2.    设置swap分区<br>文件系统：swap<br>size：512M （一般为物理内存的1.5倍）<br><img src=\"/images/2013/install-centos/1_8_2.JPG\" alt=\"Alt text\"></p>\n<p>###1.8.3.    设置根分区<br>挂载点/<br>文件系统：ext3<br>size：剩余空间<br>强制为主分区<br><img src=\"/images/2013/install-centos/1_8_3.JPG\" alt=\"Alt text\"></p>\n<p>###1.8.4.    点OK确认分区<br><img src=\"/images/2013/install-centos/1_8_4.JPG\" alt=\"Alt text\"></p>\n<p>##1.9. 选择grub引导,默认OK</p>\n<p>##1.10.    boot加载参数, 默认OK</p>\n<p>##1.11.    设置GRUB密码，根据需求情况设置，这里跳过，默认OK</p>\n<p>##1.12. 确认安装位置, 默认 OK<br><img src=\"/images/2013/install-centos/1_12.JPG\" alt=\"Alt text\"></p>\n<p>##1.13.    确认MBR安装位置, 默认 OK</p>\n<p>##1.14.配置网络参数<br><img src=\"/images/2013/install-centos/1_14_0.JPG\" alt=\"Alt text\"></p>\n<p><img src=\"/images/2013/install-centos/1_14.JPG\" alt=\"Alt text\"></p>\n<p>##1.15. 配置GATEWAY、DNS(按需求设置),我这里默认用DHCP<br><img src=\"/images/2013/install-centos/1_15.JPG\" alt=\"Alt text\"></p>\n<p>##1.16.    设置主机名<br><img src=\"/images/2013/install-centos/1_16.JPG\" alt=\"Alt text\"></p>\n<p>##1.17.    设置时区 Asia/Shanghai</p>\n<p>##1.18.    设置ROOT密码<br><img src=\"/images/2013/install-centos/1_18.JPG\" alt=\"Alt text\"></p>\n<p>##1.19.    选择自定义软件包</p>\n<p><img src=\"/images/2013/install-centos/1_19.JPG\" alt=\"Alt text\"></p>\n<p>##1.20. 自定义软件包</p>\n<p>只安装以下软件包</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">base </div><div class=\"line\">editors </div><div class=\"line\">development librarys </div><div class=\"line\">development tools </div><div class=\"line\">x software development </div><div class=\"line\">system tools</div></pre></td></tr></table></figure>\n<p>##1.21.    生成安装日志/root/install.log</p>\n<p>##1.22.    开始安装程序<br><img src=\"/images/2013/install-centos/1_22.JPG\" alt=\"Alt text\"></p>\n<p>##1.23.    安装完成, Reboot重启</p>\n<p>#2. 配置Centos5.8</p>\n<p>可以在命令行输入：setup,进行下面参数的设置</p>\n<p>##2.1.    关闭防火墙,SELinux<br><img src=\"/images/2013/install-centos/2_1_0.JPG\" alt=\"Alt text\"></p>\n<p><img src=\"/images/2013/install-centos/2_1_1.JPG\" alt=\"Alt text\"></p>\n<p>##2.2.    设置完成,退出setup agent</p>\n<p>#3. 生产环境的分区建议</p>\n<table style=\"width: 100%;\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\"><br>    <tbody><br>        <tr><br>            <td style=\"width: 20%;\"><br>                服务器角色<br>            </td><br>            <td style=\"width: 25%;\"><br>                分区建议<br>            </td><br>            <td style=\"width: 30%;\"><br>                优点<br>            </td><br>            <td style=\"width: 35%;\"><br>                RAID 方案<br>            </td><br>        </tr><br>        <tr><br>            <td><br>                单机服务器 lamp/lnmp。如8G内存，300G硬盘<br>            </td><br>            <td><br>      /boot 100-200M swap&nbsp;16G，内存大小8G*2 /&nbsp;80G /data 180G（web及db数据）<br>            </td><br>            <td><br>                数据盘和系统盘分开，有利于出问题时维护。<br>            </td><br>            <td><br>                视数据及性能要求，可采用单盘或3块盘raid5折中。双盘raid1也可。<br>            </td><br>        </tr><br>        <tr><br>            <td><br>                最前端L4负载均衡器（如LVS等）<br>            </td><br>            <td><br>                /boot 100-200M swap&nbsp;内存的1-2倍 /&nbsp;<br>            </td><br>            <td><br>                简单方便，只做转发，本地数据量很少。<br>            </td><br>            <td><br>                数据量小，重要性高，可采用双盘RAID1,多一块盘降低宕机维护成本。<br>            </td><br>        </tr><br>        <tr><br>            <td><br>                负载均衡下的RS server,即普通节点服务器<br>            </td><br>            <td><br>                /boot 100-200M swap&nbsp;内存的1-2倍 /&nbsp;<br>            </td><br>            <td><br>                简单方便，因为有多机，对数据要求低。<br>            </td><br>            <td><br>                数据量大，重要性不高，有性能要求，数据要求低，可采用双盘RAID0<br>            </td><br>        </tr><br>        <tr><br>            <td><br>                数据库服务器 mysql及oracle 如16/32G内存 &nbsp; &nbsp;<br>            </td><br>            <td><br>                /boot 100-200M swap&nbsp;16G，内存的1倍 /&nbsp;100G /data&nbsp;剩余（存放db数据）<br>            </td><br>            <td><br>                数据盘和系统盘分开，有利于出问题时维护,及保持数据完整。<br>            </td><br>            <td><br>                视数据及性能要求主库可采取raid10/raid5，从库可采用raid0或raid5提高性能（读写分离的情况下。）<br>            </td><br>        </tr><br>        <tr><br>            <td><br>                线下备份存储服务器<br>            </td><br>            <td><br>                /boot 100-200M swap&nbsp;内存的1-2倍 /&nbsp;100G /data(存放数据)<br>            </td><br>            <td><br>                此服务器不要分区太多。只做备份，性能要求低。容量要大。<br>            </td><br>            <td><br>                可采取sata盘，raid5(多组),容量大，性能要求不高。数据有要求。<br>            </td><br>        </tr><br>        <tr><br>            <td><br>                在线共享存储服务器（如NFS）<br>            </td><br>            <td><br>                /boot 100-200M swap&nbsp;内存的1-2倍 /&nbsp;100G /data(存放数据)<br>            </td><br>            <td><br>                此服务器不要分区太多。NFS共享比存储多的要求就是性能要求。<br>            </td><br>            <td><br>                视性能及访问要求可以raid5,raid10,甚至raid0（要有高可用或双写方案）<br>            </td><br>        </tr><br>        <tr><br>            <td><br>                监控服务器 cacti,nagios<br>            </td><br>            <td><br>                /boot 100-200M swap&nbsp;内存的1-2倍 /&nbsp;<br>            </td><br>            <td><br>                重要性一般，数据要求也一般。<br>            </td><br>            <td><br>                单盘或双盘raid1即可。三盘就RAID5，看容量要求加盘即可。<br>            </td><br>        </tr><br>    </tbody><br></table>\n\n\n<p>#4. 问题<br>(1)硬盘主分区和逻辑分区的区别?<br>(2)什么是RAID?如何做RAID?<br>(3)DELL R710新服务器多硬盘Raid5后容量大于2TB如何分区<br>(4)添加新硬盘后，如何分区和格式化?fdick parted<br>(5)如果要安装几十上百台服务器如何实现批量无人值守安装<br>后面我会单独写一篇博客介绍<br>(6)…  </p>\n<p>#5.更多资料<br>(1)生产场景不同角色linux服务器分区案例分享<br><a href=\"http://oldboy.blog.51cto.com/2561410/634725\" target=\"_blank\" rel=\"external\">http://oldboy.blog.51cto.com/2561410/634725</a>  </p>\n<p>(2)运维老鸟谈生产场景如何对linux系统进行分区？<br><a href=\"http://oldboy.blog.51cto.com/2561410/629558\" target=\"_blank\" rel=\"external\">http://oldboy.blog.51cto.com/2561410/629558</a></p>\n","excerpt":"<p>对于linux初学者来说，鸟哥的linux私房菜是很好的学习教材了。<br>我也是从linux初学者这条路走过来的,目前正在研究linux运维的技术。对于自已学过的东西，总希望留点脚印(但愿不是坑)，让大家少走点弯路。于是想写下这一系列的教程。  </p>","more":"<p>建议在文本模式下安装linux，并通过命令行学习linux。<br>本文的系统安装只针对Centos5.x系统，<br>Centos6.x的文本安装不能自定义分区及大小，不能自定义软件包。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div></pre></td><td class=\"code\"><pre><div class=\"line\">目录</div><div class=\"line\">1.\t安装Centos5.8 x64  </div><div class=\"line\">1.1.\t下载Centos,新建虚拟机\t</div><div class=\"line\">1.2.\t输入linux text ,文本模式安装\t</div><div class=\"line\">1.3.\t安装盘检验，选择skip\t</div><div class=\"line\">1.4.\tWelcome CentOS(默认OK)\t</div><div class=\"line\">1.5.\t选择语言为English\t\t</div><div class=\"line\">1.6.\t选择键盘布局类型为us\t</div><div class=\"line\">1.7.\t选择&quot;自定义分区&quot;\t</div><div class=\"line\">1.8.\t分区\t</div><div class=\"line\">1.8.1.\t设置/boot分区\t</div><div class=\"line\">1.8.2.\t设置swap分区\t</div><div class=\"line\">1.8.3.\t设置根分区\t</div><div class=\"line\">1.8.4.\t点OK确认分区\t</div><div class=\"line\">1.9.\t选择grub引导,默认OK</div><div class=\"line\">1.10.\tboot加载参数, 默认OK</div><div class=\"line\">1.11.\t设置GRUB密码，根据需求情况设置，这里跳过，默认OK</div><div class=\"line\">1.12.\t确认安装位置, 默认 OK</div><div class=\"line\">1.13.\t确认MBR安装位置, 默认 OK</div><div class=\"line\">1.14.\t配置网络参数</div><div class=\"line\">1.15.\t配置GATEWAY、DNS(按需求设置),我这里默认用DHCP</div><div class=\"line\">1.16.\t设置主机名</div><div class=\"line\">1.17.\t设置时区 Asia/Shanghai</div><div class=\"line\">1.18.\t设置ROOT密码</div><div class=\"line\">1.19.\t选择自定义软件包</div><div class=\"line\">1.20.\t自定义软件包(重要)</div><div class=\"line\">1.21.\t生成安装日志/root/install.log</div><div class=\"line\">1.22.\t开始安装程序</div><div class=\"line\">1.23.\t安装完成, Reboot重启</div><div class=\"line\">2.\t配置Centos5.8</div><div class=\"line\">2.1.\t关闭防火墙,SELinux</div><div class=\"line\">2.2.\t设置完成,退出setup agent</div><div class=\"line\">3.\t生产环境的分区建议</div><div class=\"line\">4. 问题</div><div class=\"line\">5. 更多资料</div></pre></td></tr></table></figure>\n<p>#1. 安装Centos5.8 x64</p>\n<p>##1.1.    下载Centos,新建虚拟机<br>我使用的是VMware Workstation，注意选择的是64bit版本。<br>虚拟硬盘大小为20G。<br><img src=\"/images/2013/install-centos/1_1.JPG\" alt=\"Alt text\"></p>\n<p>##1.2. 输入linux text ,文本模式安装<br><img src=\"/images/2013/install-centos/1_2.JPG\" alt=\"Alt text\"></p>\n<p>##1.3.    安装盘检验，选择skip</p>\n<p>##1.4.    Welcome CentOS(默认OK)</p>\n<p>##1.5.    选择语言为English</p>\n<p>##1.6.    选择键盘布局类型为us</p>\n<p>##1.7. 选择”自定义分区”<br><img src=\"/images/2013/install-centos/1_7.JPG\" alt=\"Alt text\"></p>\n<p>##1.8.    分区<br>规划：<br>/boot : 128M<br>/swap : 物理内存大小*1.5,这里暂设为:512M<br>/ : 剩余所有空间<br><img src=\"/images/2013/install-centos/1_8.JPG\" alt=\"Alt text\"></p>\n<p>###1.8.1. 设置/boot分区<br>挂载点/boot<br>文件系统：ext3<br>size：200M 强制为主分区<br><img src=\"/images/2013/install-centos/1_8_1.JPG\" alt=\"Alt text\"></p>\n<p>###1.8.2.    设置swap分区<br>文件系统：swap<br>size：512M （一般为物理内存的1.5倍）<br><img src=\"/images/2013/install-centos/1_8_2.JPG\" alt=\"Alt text\"></p>\n<p>###1.8.3.    设置根分区<br>挂载点/<br>文件系统：ext3<br>size：剩余空间<br>强制为主分区<br><img src=\"/images/2013/install-centos/1_8_3.JPG\" alt=\"Alt text\"></p>\n<p>###1.8.4.    点OK确认分区<br><img src=\"/images/2013/install-centos/1_8_4.JPG\" alt=\"Alt text\"></p>\n<p>##1.9. 选择grub引导,默认OK</p>\n<p>##1.10.    boot加载参数, 默认OK</p>\n<p>##1.11.    设置GRUB密码，根据需求情况设置，这里跳过，默认OK</p>\n<p>##1.12. 确认安装位置, 默认 OK<br><img src=\"/images/2013/install-centos/1_12.JPG\" alt=\"Alt text\"></p>\n<p>##1.13.    确认MBR安装位置, 默认 OK</p>\n<p>##1.14.配置网络参数<br><img src=\"/images/2013/install-centos/1_14_0.JPG\" alt=\"Alt text\"></p>\n<p><img src=\"/images/2013/install-centos/1_14.JPG\" alt=\"Alt text\"></p>\n<p>##1.15. 配置GATEWAY、DNS(按需求设置),我这里默认用DHCP<br><img src=\"/images/2013/install-centos/1_15.JPG\" alt=\"Alt text\"></p>\n<p>##1.16.    设置主机名<br><img src=\"/images/2013/install-centos/1_16.JPG\" alt=\"Alt text\"></p>\n<p>##1.17.    设置时区 Asia/Shanghai</p>\n<p>##1.18.    设置ROOT密码<br><img src=\"/images/2013/install-centos/1_18.JPG\" alt=\"Alt text\"></p>\n<p>##1.19.    选择自定义软件包</p>\n<p><img src=\"/images/2013/install-centos/1_19.JPG\" alt=\"Alt text\"></p>\n<p>##1.20. 自定义软件包</p>\n<p>只安装以下软件包</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">base </div><div class=\"line\">editors </div><div class=\"line\">development librarys </div><div class=\"line\">development tools </div><div class=\"line\">x software development </div><div class=\"line\">system tools</div></pre></td></tr></table></figure>\n<p>##1.21.    生成安装日志/root/install.log</p>\n<p>##1.22.    开始安装程序<br><img src=\"/images/2013/install-centos/1_22.JPG\" alt=\"Alt text\"></p>\n<p>##1.23.    安装完成, Reboot重启</p>\n<p>#2. 配置Centos5.8</p>\n<p>可以在命令行输入：setup,进行下面参数的设置</p>\n<p>##2.1.    关闭防火墙,SELinux<br><img src=\"/images/2013/install-centos/2_1_0.JPG\" alt=\"Alt text\"></p>\n<p><img src=\"/images/2013/install-centos/2_1_1.JPG\" alt=\"Alt text\"></p>\n<p>##2.2.    设置完成,退出setup agent</p>\n<p>#3. 生产环境的分区建议</p>\n<table style=\"width: 100%;\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\"><br>    <tbody><br>        <tr><br>            <td style=\"width: 20%;\"><br>                服务器角色<br>            </td><br>            <td style=\"width: 25%;\"><br>                分区建议<br>            </td><br>            <td style=\"width: 30%;\"><br>                优点<br>            </td><br>            <td style=\"width: 35%;\"><br>                RAID 方案<br>            </td><br>        </tr><br>        <tr><br>            <td><br>                单机服务器 lamp/lnmp。如8G内存，300G硬盘<br>            </td><br>            <td><br>      /boot 100-200M swap&nbsp;16G，内存大小8G*2 /&nbsp;80G /data 180G（web及db数据）<br>            </td><br>            <td><br>                数据盘和系统盘分开，有利于出问题时维护。<br>            </td><br>            <td><br>                视数据及性能要求，可采用单盘或3块盘raid5折中。双盘raid1也可。<br>            </td><br>        </tr><br>        <tr><br>            <td><br>                最前端L4负载均衡器（如LVS等）<br>            </td><br>            <td><br>                /boot 100-200M swap&nbsp;内存的1-2倍 /&nbsp;<br>            </td><br>            <td><br>                简单方便，只做转发，本地数据量很少。<br>            </td><br>            <td><br>                数据量小，重要性高，可采用双盘RAID1,多一块盘降低宕机维护成本。<br>            </td><br>        </tr><br>        <tr><br>            <td><br>                负载均衡下的RS server,即普通节点服务器<br>            </td><br>            <td><br>                /boot 100-200M swap&nbsp;内存的1-2倍 /&nbsp;<br>            </td><br>            <td><br>                简单方便，因为有多机，对数据要求低。<br>            </td><br>            <td><br>                数据量大，重要性不高，有性能要求，数据要求低，可采用双盘RAID0<br>            </td><br>        </tr><br>        <tr><br>            <td><br>                数据库服务器 mysql及oracle 如16/32G内存 &nbsp; &nbsp;<br>            </td><br>            <td><br>                /boot 100-200M swap&nbsp;16G，内存的1倍 /&nbsp;100G /data&nbsp;剩余（存放db数据）<br>            </td><br>            <td><br>                数据盘和系统盘分开，有利于出问题时维护,及保持数据完整。<br>            </td><br>            <td><br>                视数据及性能要求主库可采取raid10/raid5，从库可采用raid0或raid5提高性能（读写分离的情况下。）<br>            </td><br>        </tr><br>        <tr><br>            <td><br>                线下备份存储服务器<br>            </td><br>            <td><br>                /boot 100-200M swap&nbsp;内存的1-2倍 /&nbsp;100G /data(存放数据)<br>            </td><br>            <td><br>                此服务器不要分区太多。只做备份，性能要求低。容量要大。<br>            </td><br>            <td><br>                可采取sata盘，raid5(多组),容量大，性能要求不高。数据有要求。<br>            </td><br>        </tr><br>        <tr><br>            <td><br>                在线共享存储服务器（如NFS）<br>            </td><br>            <td><br>                /boot 100-200M swap&nbsp;内存的1-2倍 /&nbsp;100G /data(存放数据)<br>            </td><br>            <td><br>                此服务器不要分区太多。NFS共享比存储多的要求就是性能要求。<br>            </td><br>            <td><br>                视性能及访问要求可以raid5,raid10,甚至raid0（要有高可用或双写方案）<br>            </td><br>        </tr><br>        <tr><br>            <td><br>                监控服务器 cacti,nagios<br>            </td><br>            <td><br>                /boot 100-200M swap&nbsp;内存的1-2倍 /&nbsp;<br>            </td><br>            <td><br>                重要性一般，数据要求也一般。<br>            </td><br>            <td><br>                单盘或双盘raid1即可。三盘就RAID5，看容量要求加盘即可。<br>            </td><br>        </tr><br>    </tbody><br></table>\n\n\n<p>#4. 问题<br>(1)硬盘主分区和逻辑分区的区别?<br>(2)什么是RAID?如何做RAID?<br>(3)DELL R710新服务器多硬盘Raid5后容量大于2TB如何分区<br>(4)添加新硬盘后，如何分区和格式化?fdick parted<br>(5)如果要安装几十上百台服务器如何实现批量无人值守安装<br>后面我会单独写一篇博客介绍<br>(6)…  </p>\n<p>#5.更多资料<br>(1)生产场景不同角色linux服务器分区案例分享<br><a href=\"http://oldboy.blog.51cto.com/2561410/634725\">http://oldboy.blog.51cto.com/2561410/634725</a>  </p>\n<p>(2)运维老鸟谈生产场景如何对linux系统进行分区？<br><a href=\"http://oldboy.blog.51cto.com/2561410/629558\">http://oldboy.blog.51cto.com/2561410/629558</a></p>"},{"layout":"post","title":"Mac下Android开发环境搭建","date":"2013-03-03T03:33:00.000Z","comments":1,"_content":"基本步骤：   \n1. 下载Eclipse IDE   \n2. 下载安装配置Android SDK    \n3. 安装Android ADT Plugin  \n4. Eclipse中配置Android套件  \n\n<!--more-->\n\n# 下载Eclipse IDE \n从这里下载相应的版本： [http://www.eclipse.org/downloads/](http://www.eclipse.org/downloads/)\n \n我已经下载好的版本是：eclipse-SDK-4.2.1-macosx-cocoa-x86_64.tar.gz\n\n# 下载安装配置Android SDK  \n## 下载配置Android SDK   \n地址：http://developer.android.com/sdk/index.html\n\n我当前最新版的下载地址为：  \nhttps://dl.google.com/android/android-sdk_r21.1-macosx.zip\n\n\n![android](/images/2013/03/android.jpeg)\n\n\n## 安装配置Android SDK  \n上面的sdk包解压到   \n/Users/xionglie/tools/android-sdk-macosx\n\n然后运行tools/android,在弹出的Android SDK Manager对话框中选择左边的Installed packages，右边就会列出当前已经安装了的SDK，选择相应组件进行安装，然后一步一步来就会下载所有的Android SDK的版本并进行安装。\n\n![android](/images/2013/03/android1.png)\n\ntools/adb_has_moved.txt内容说明：  \n基本意思就是adb已经移到platform-tools,如果在目录中找不到platform-tools，就要执行android工具安装\"Android SDK Platform-tools\"，并要使PATH环境变量中包含platform-tools/目录，这样就可以在任何目录中执行adb命令了。\n\n```\nThe adb tool has moved to platform-tools/\n\nIf you don't see this directory in your SDK,\nlaunch the SDK and AVD Manager (execute the android tool)\nand install \"Android SDK Platform-tools\"\n\nPlease also update your PATH environment variable to\ninclude the platform-tools/ directory, so you can\nexecute adb from any location.\n```\n\n### 配置PATH环境变量\n在～/.bash_profile最后一行添加\n\n\texport PATH=$PATH:/Users/xionglie/tools/android-sdk-macosx/platform-tools\n\n在控制台输入adb,不出现命令找不到的错误，就算成功\n\n# 安装Android ADT Plugin\n启动Eclipse\nHelp -> Install New Software ->   \nsite： https://dl-ssl.google.com/android/eclipse/ \n\n按照提示进行安装\n\n\n# Eclipse中配置Android套件\n重启Eclipse后，Eclipse ->Preferences->Android    \n\nSDK Location : /Users/xionglie/tools/android-sdk-macosx\n\n![android](/images/2013/03/android2.png)\n\n（完）","source":"_posts/2013-03-03-install-android-development-environment-in-mac.md","raw":"---\nlayout: post\ntitle: \"Mac下Android开发环境搭建\"\ndate: 2013-03-03 11:33\ncomments: true\ncategories: android \n---\n基本步骤：   \n1. 下载Eclipse IDE   \n2. 下载安装配置Android SDK    \n3. 安装Android ADT Plugin  \n4. Eclipse中配置Android套件  \n\n<!--more-->\n\n# 下载Eclipse IDE \n从这里下载相应的版本： [http://www.eclipse.org/downloads/](http://www.eclipse.org/downloads/)\n \n我已经下载好的版本是：eclipse-SDK-4.2.1-macosx-cocoa-x86_64.tar.gz\n\n# 下载安装配置Android SDK  \n## 下载配置Android SDK   \n地址：http://developer.android.com/sdk/index.html\n\n我当前最新版的下载地址为：  \nhttps://dl.google.com/android/android-sdk_r21.1-macosx.zip\n\n\n![android](/images/2013/03/android.jpeg)\n\n\n## 安装配置Android SDK  \n上面的sdk包解压到   \n/Users/xionglie/tools/android-sdk-macosx\n\n然后运行tools/android,在弹出的Android SDK Manager对话框中选择左边的Installed packages，右边就会列出当前已经安装了的SDK，选择相应组件进行安装，然后一步一步来就会下载所有的Android SDK的版本并进行安装。\n\n![android](/images/2013/03/android1.png)\n\ntools/adb_has_moved.txt内容说明：  \n基本意思就是adb已经移到platform-tools,如果在目录中找不到platform-tools，就要执行android工具安装\"Android SDK Platform-tools\"，并要使PATH环境变量中包含platform-tools/目录，这样就可以在任何目录中执行adb命令了。\n\n```\nThe adb tool has moved to platform-tools/\n\nIf you don't see this directory in your SDK,\nlaunch the SDK and AVD Manager (execute the android tool)\nand install \"Android SDK Platform-tools\"\n\nPlease also update your PATH environment variable to\ninclude the platform-tools/ directory, so you can\nexecute adb from any location.\n```\n\n### 配置PATH环境变量\n在～/.bash_profile最后一行添加\n\n\texport PATH=$PATH:/Users/xionglie/tools/android-sdk-macosx/platform-tools\n\n在控制台输入adb,不出现命令找不到的错误，就算成功\n\n# 安装Android ADT Plugin\n启动Eclipse\nHelp -> Install New Software ->   \nsite： https://dl-ssl.google.com/android/eclipse/ \n\n按照提示进行安装\n\n\n# Eclipse中配置Android套件\n重启Eclipse后，Eclipse ->Preferences->Android    \n\nSDK Location : /Users/xionglie/tools/android-sdk-macosx\n\n![android](/images/2013/03/android2.png)\n\n（完）","slug":"install-android-development-environment-in-mac","published":1,"updated":"2017-01-27T01:34:43.000Z","photos":[],"link":"","_id":"ciyf7fkb2000pf2jy1hr73h1j","content":"<p>基本步骤：   </p>\n<ol>\n<li>下载Eclipse IDE   </li>\n<li>下载安装配置Android SDK    </li>\n<li>安装Android ADT Plugin  </li>\n<li>Eclipse中配置Android套件  </li>\n</ol>\n<a id=\"more\"></a>\n<h1 id=\"下载Eclipse-IDE\"><a href=\"#下载Eclipse-IDE\" class=\"headerlink\" title=\"下载Eclipse IDE\"></a>下载Eclipse IDE</h1><p>从这里下载相应的版本： <a href=\"http://www.eclipse.org/downloads/\" target=\"_blank\" rel=\"external\">http://www.eclipse.org/downloads/</a></p>\n<p>我已经下载好的版本是：eclipse-SDK-4.2.1-macosx-cocoa-x86_64.tar.gz</p>\n<h1 id=\"下载安装配置Android-SDK\"><a href=\"#下载安装配置Android-SDK\" class=\"headerlink\" title=\"下载安装配置Android SDK\"></a>下载安装配置Android SDK</h1><h2 id=\"下载配置Android-SDK\"><a href=\"#下载配置Android-SDK\" class=\"headerlink\" title=\"下载配置Android SDK\"></a>下载配置Android SDK</h2><p>地址：<a href=\"http://developer.android.com/sdk/index.html\" target=\"_blank\" rel=\"external\">http://developer.android.com/sdk/index.html</a></p>\n<p>我当前最新版的下载地址为：<br><a href=\"https://dl.google.com/android/android-sdk_r21.1-macosx.zip\" target=\"_blank\" rel=\"external\">https://dl.google.com/android/android-sdk_r21.1-macosx.zip</a></p>\n<p><img src=\"/images/2013/03/android.jpeg\" alt=\"android\"></p>\n<h2 id=\"安装配置Android-SDK\"><a href=\"#安装配置Android-SDK\" class=\"headerlink\" title=\"安装配置Android SDK\"></a>安装配置Android SDK</h2><p>上面的sdk包解压到<br>/Users/xionglie/tools/android-sdk-macosx</p>\n<p>然后运行tools/android,在弹出的Android SDK Manager对话框中选择左边的Installed packages，右边就会列出当前已经安装了的SDK，选择相应组件进行安装，然后一步一步来就会下载所有的Android SDK的版本并进行安装。</p>\n<p><img src=\"/images/2013/03/android1.png\" alt=\"android\"></p>\n<p>tools/adb_has_moved.txt内容说明：<br>基本意思就是adb已经移到platform-tools,如果在目录中找不到platform-tools，就要执行android工具安装”Android SDK Platform-tools”，并要使PATH环境变量中包含platform-tools/目录，这样就可以在任何目录中执行adb命令了。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">The adb tool has moved to platform-tools/</div><div class=\"line\"></div><div class=\"line\">If you don&apos;t see this directory in your SDK,</div><div class=\"line\">launch the SDK and AVD Manager (execute the android tool)</div><div class=\"line\">and install &quot;Android SDK Platform-tools&quot;</div><div class=\"line\"></div><div class=\"line\">Please also update your PATH environment variable to</div><div class=\"line\">include the platform-tools/ directory, so you can</div><div class=\"line\">execute adb from any location.</div></pre></td></tr></table></figure>\n<h3 id=\"配置PATH环境变量\"><a href=\"#配置PATH环境变量\" class=\"headerlink\" title=\"配置PATH环境变量\"></a>配置PATH环境变量</h3><p>在～/.bash_profile最后一行添加</p>\n<pre><code>export PATH=$PATH:/Users/xionglie/tools/android-sdk-macosx/platform-tools\n</code></pre><p>在控制台输入adb,不出现命令找不到的错误，就算成功</p>\n<h1 id=\"安装Android-ADT-Plugin\"><a href=\"#安装Android-ADT-Plugin\" class=\"headerlink\" title=\"安装Android ADT Plugin\"></a>安装Android ADT Plugin</h1><p>启动Eclipse<br>Help -&gt; Install New Software -&gt;<br>site： <a href=\"https://dl-ssl.google.com/android/eclipse/\" target=\"_blank\" rel=\"external\">https://dl-ssl.google.com/android/eclipse/</a> </p>\n<p>按照提示进行安装</p>\n<h1 id=\"Eclipse中配置Android套件\"><a href=\"#Eclipse中配置Android套件\" class=\"headerlink\" title=\"Eclipse中配置Android套件\"></a>Eclipse中配置Android套件</h1><p>重启Eclipse后，Eclipse -&gt;Preferences-&gt;Android    </p>\n<p>SDK Location : /Users/xionglie/tools/android-sdk-macosx</p>\n<p><img src=\"/images/2013/03/android2.png\" alt=\"android\"></p>\n<p>（完）</p>\n","excerpt":"<p>基本步骤：   </p>\n<ol>\n<li>下载Eclipse IDE   </li>\n<li>下载安装配置Android SDK    </li>\n<li>安装Android ADT Plugin  </li>\n<li>Eclipse中配置Android套件  </li>\n</ol>","more":"<h1 id=\"下载Eclipse-IDE\"><a href=\"#下载Eclipse-IDE\" class=\"headerlink\" title=\"下载Eclipse IDE\"></a>下载Eclipse IDE</h1><p>从这里下载相应的版本： <a href=\"http://www.eclipse.org/downloads/\">http://www.eclipse.org/downloads/</a></p>\n<p>我已经下载好的版本是：eclipse-SDK-4.2.1-macosx-cocoa-x86_64.tar.gz</p>\n<h1 id=\"下载安装配置Android-SDK\"><a href=\"#下载安装配置Android-SDK\" class=\"headerlink\" title=\"下载安装配置Android SDK\"></a>下载安装配置Android SDK</h1><h2 id=\"下载配置Android-SDK\"><a href=\"#下载配置Android-SDK\" class=\"headerlink\" title=\"下载配置Android SDK\"></a>下载配置Android SDK</h2><p>地址：<a href=\"http://developer.android.com/sdk/index.html\">http://developer.android.com/sdk/index.html</a></p>\n<p>我当前最新版的下载地址为：<br><a href=\"https://dl.google.com/android/android-sdk_r21.1-macosx.zip\">https://dl.google.com/android/android-sdk_r21.1-macosx.zip</a></p>\n<p><img src=\"/images/2013/03/android.jpeg\" alt=\"android\"></p>\n<h2 id=\"安装配置Android-SDK\"><a href=\"#安装配置Android-SDK\" class=\"headerlink\" title=\"安装配置Android SDK\"></a>安装配置Android SDK</h2><p>上面的sdk包解压到<br>/Users/xionglie/tools/android-sdk-macosx</p>\n<p>然后运行tools/android,在弹出的Android SDK Manager对话框中选择左边的Installed packages，右边就会列出当前已经安装了的SDK，选择相应组件进行安装，然后一步一步来就会下载所有的Android SDK的版本并进行安装。</p>\n<p><img src=\"/images/2013/03/android1.png\" alt=\"android\"></p>\n<p>tools/adb_has_moved.txt内容说明：<br>基本意思就是adb已经移到platform-tools,如果在目录中找不到platform-tools，就要执行android工具安装”Android SDK Platform-tools”，并要使PATH环境变量中包含platform-tools/目录，这样就可以在任何目录中执行adb命令了。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">The adb tool has moved to platform-tools/</div><div class=\"line\"></div><div class=\"line\">If you don&apos;t see this directory in your SDK,</div><div class=\"line\">launch the SDK and AVD Manager (execute the android tool)</div><div class=\"line\">and install &quot;Android SDK Platform-tools&quot;</div><div class=\"line\"></div><div class=\"line\">Please also update your PATH environment variable to</div><div class=\"line\">include the platform-tools/ directory, so you can</div><div class=\"line\">execute adb from any location.</div></pre></td></tr></table></figure>\n<h3 id=\"配置PATH环境变量\"><a href=\"#配置PATH环境变量\" class=\"headerlink\" title=\"配置PATH环境变量\"></a>配置PATH环境变量</h3><p>在～/.bash_profile最后一行添加</p>\n<pre><code>export PATH=$PATH:/Users/xionglie/tools/android-sdk-macosx/platform-tools\n</code></pre><p>在控制台输入adb,不出现命令找不到的错误，就算成功</p>\n<h1 id=\"安装Android-ADT-Plugin\"><a href=\"#安装Android-ADT-Plugin\" class=\"headerlink\" title=\"安装Android ADT Plugin\"></a>安装Android ADT Plugin</h1><p>启动Eclipse<br>Help -&gt; Install New Software -&gt;<br>site： <a href=\"https://dl-ssl.google.com/android/eclipse/\">https://dl-ssl.google.com/android/eclipse/</a> </p>\n<p>按照提示进行安装</p>\n<h1 id=\"Eclipse中配置Android套件\"><a href=\"#Eclipse中配置Android套件\" class=\"headerlink\" title=\"Eclipse中配置Android套件\"></a>Eclipse中配置Android套件</h1><p>重启Eclipse后，Eclipse -&gt;Preferences-&gt;Android    </p>\n<p>SDK Location : /Users/xionglie/tools/android-sdk-macosx</p>\n<p><img src=\"/images/2013/03/android2.png\" alt=\"android\"></p>\n<p>（完）</p>"},{"layout":"post","title":"centos6.2 64bit上安装pptp与客户端设置","date":"2013-04-14T02:53:00.000Z","comments":1,"_content":"\n主要内容\n\n```\n#1.安装软件包\n#2.vi /etc/pptpd.conf 文件\n#3.vi /etc/ppp/options.pptpd\n#4.设置使用 pptpd 的用户名和密码\n#5.修改内核设置/etc/sysctl.conf\n#6.添加 iptables 转发规则\n#7.启动pptpd 服务\n#8.一键安装shell脚本\n#9.pptp客户端连接\n#10.客户端vpn翻墙设置\n```\n<!-- more -->\n\npptp安装可以参考这篇文章\n\n\t在 Linode VPS 下搭建 pptp 服务器\t\t\n\thttp://www.chenjunlu.com/2012/04/how-to-setup-a-pptp-vpn-server-under-linode-vps/\n\n\n#1.安装软件包\n\n```\nyum install -y ppp iptables\n#wget http://poptop.sourceforge.net/yum/stable/packages/pptpd-1.3.4-2.el6.x86_64.rpm\nwget http://poptop.sourceforge.net/yum/beta/rhel6/x86_64/pptpd-1.4.0-1.el6.x86_64.rpm\n\nrpm -ivh pptpd-1.4.0-1.el6.x86_64.rpm\n```\n\n\n#2. vi /etc/pptpd.conf 文件\n\n\t#localip 192.168.0.1\n\t#remoteip 192.168.0.234-238,192.168.0.245\n\n修改成\n\n\tlocalip 192.168.0.1\n\tremoteip 192.168.0.234-238,192.168.0.245\n\n注意：此处的  remoteip 指定的 IP 范围是用来给远程连接使用的。\n\n\n#3. vi /etc/ppp/options.pptpd\n\n\t#ms-dns 10.0.0.1\n\t#ms-dns 10.0.0.2\n\t\n改成\n\n\tms-dns 8.8.8.8\n\tms-dns 8.8.4.4\n\n#4.设置使用 pptpd 的用户名和密码\n\tvi /etc/ppp/chap-secrets\n打开后只有两行，而且一个账号都没有\n\n\t# Secrets for authentication using CHAP\n\t# client        server  secret                  IP addresses\n\n根据您的需要添加账号，每行一个。\n按照：“用户名 pptpd 密码 ip地址”的格式输入，每一项之间用空格分开，例如：\n\t\n\tvpnuser pptpd password *\t\n\t\n#5.修改内核设置/etc/sysctl.conf\n\n编辑 /etc/sysctl.conf 文件：\n\n\tsed -i 's/net.ipv4.ip_forward = 0/net.ipv4.ip_forward = 1/' /etc/sysctl.conf\n\tsed -i 's/net.ipv4.tcp_syncookies = 1/#net.ipv4.tcp_syncookies = 1/' /etc/sysctl.conf\n\tsysctl -p\t\n\t\n#6.添加 iptables 转发规则\n```\niptables -t nat -A POSTROUTING -s 192.168.0.0/24 -o eth0 -j MASQUERADE\n/etc/init.d/iptables save\n/etc/init.d/iptables restart\n```\n\n启动iptables 时，可能会遇到如下报错：\n/etc/init.d/iptables restart\nSetting chains to policy ACCEPT: security raw nat mangle fi[FAILED]\n\n解决：\nvi /etc/init.d/iptables\n加入145到151行的内容,然后保存退出并重起\n/etc/init.d/iptables restart\n\n```\n    security)\n    $IPTABLES -t filter -P INPUT $policy \\\n        && $IPTABLES -t filter -P OUTPUT $policy \\\n        && $IPTABLES -t filter -P FORWARD $policy \\\n        || let ret+=1\n\n    ;;\n```\n\n```\n   142\t    for i in $tables; do\n   143\t\techo -n \"$i \"\n   144\t\tcase \"$i\" in\n   145\t  security)\n   146\t    $IPTABLES -t filter -P INPUT $policy \\\n   147\t        && $IPTABLES -t filter -P OUTPUT $policy \\\n   148\t        && $IPTABLES -t filter -P FORWARD $policy \\\n   149\t        || let ret+=1\n   150\t\n   151\t    ;;\n   152\t\t    raw)\n   153\t\t\t$IPTABLES -t raw -P PREROUTING $policy \\\n   154\t\t\t    && $IPTABLES -t raw -P OUTPUT $policy \\\n   155\t\t\t    || let ret+=1\n   156\t\t\t;;\n```\n\n\n#7.启动pptpd 服务\n重启 pptpd 服务\n\n\t/etc/init.d/pptpd restart\n\n配置 pptpd 随系统启动\n\n\tchkconfig pptpd on\n\n确认1723端口开启\n\n```\n# netstat -lnt\nActive Internet connections (only servers)\nProto Recv-Q Send-Q Local Address               Foreign Address             State\ntcp        0      0 0.0.0.0:1723                0.0.0.0:*                   LISTEN\n...\n```\n\n至此 pptp 服务端安装全部结束\n\n\n#8.一键安装shell脚本\n\n```bash\n\n#!/bin/bash\n# install pptp vpn\n######################\n# Date : 2014-08-10\n# Author: xionglie.qu\n######################\n\necho \"# 1. 安装基础包 \"\nyum install -y ppp iptables\nwget http://poptop.sourceforge.net/yum/beta/rhel6/x86_64/pptpd-1.4.0-1.el6.x86_64.rpm\nrpm -ivh pptpd-1.4.0-1.el6.x86_64.rpm\n\necho \"# 2. vi /etc/pptpd.conf \"\n/bin/cp /etc/pptpd.conf /etc/pptpd.conf.`date +\"%Y-%m-%d_%H-%M-%S\"`\nsed -i 's/#localip 192.168.0.1/localip 192.168.0.1/g' /etc/pptpd.conf\nsed -i 's/#remoteip 192.168.0.234-238,192.168.0.245/remoteip 192.168.0.234-238,192.168.0.245/g' /etc/pptpd.conf\n\necho \"# 3. vi /etc/ppp/options.pptpd \"\n/bin/cp /etc/ppp/options.pptpd /etc/ppp/options.pptpd.`date +\"%Y-%m-%d_%H-%M-%S\"`\nsed -i 's/#ms-dns 10.0.0.1/ms-dns 8.8.8.8/g' /etc/ppp/options.pptpd\nsed -i 's/#ms-dns 10.0.0.2/ms-dns 8.8.4.4/g' /etc/ppp/options.pptpd\n\necho \"# 4.设置使用 pptpd 的用户名和密码 \"\n/bin/cp /etc/ppp/chap-secrets /etc/ppp/chap-secrets.`date +\"%Y-%m-%d_%H-%M-%S\"`\necho \"###  /etc/ppp/chap-secrets \"\necho \"#vpnuser pptpd password *\">> /etc/ppp/chap-secrets\necho \"user001 pptpd pwd001 *    \" >> /etc/ppp/chap-secrets\n\necho \"# 5.修改内核设置/etc/sysctl.conf \"\nsed -i 's/net.ipv4.ip_forward = 0/net.ipv4.ip_forward = 1/' /etc/sysctl.conf\nsed -i 's/net.ipv4.tcp_syncookies = 1/#net.ipv4.tcp_syncookies = 1/' /etc/sysctl.conf\nsysctl -p\t\n\n\necho \"# 6. 添加 iptables 转发规则\"\niptables -t nat -A POSTROUTING -s 192.168.0.0/24 -o eth0 -j MASQUERADE\n/etc/init.d/iptables save\n/etc/init.d/iptables restart\n\necho \"# 7.启动pptpd 服务\"\n/etc/init.d/pptpd restart\nchkconfig pptpd on\nchkconfig --list | grep pptpd\n\necho \"# end #\"\n\n``` \n#9.pptp客户端连接\n##mac\n设置非常简单，不懂的话google一下\"Mac PPTP VPN设置教程\"即可有答案。\n\n\n##windows \n可以看这篇文章\n\n\t怎么创建 VPN 连接（ Windows XP，pptp ）\t\t\n\thttp://lihua.me/zh/pptp-vpn-windows-xp/\n\t\n#10.客户端vpn翻墙设置\npptp连接上去，必须将pptp设为默认连接，这样所有数据都会从vpn出去。\n\n##mac下设置：\n![pptp](/images/2013/04/pptp-mac-01.png)\n\n![pptp](/images/2013/04/pptp-mac-02.png)\n\n##windows xp下设置：\n![pptp](/images/2013/04/pptp-xp.jpg)\n\n \n####实现在使用vpn访问国外资源的同时, 能用非vpn线路高速访问本国资源.\n\n\thttps://code.google.com/p/chnroutes/\n\t使用说明 \n\thttps://code.google.com/p/chnroutes/wiki/Usage\n\n(完)\n\n\n","source":"_posts/2013-04-14-install-pptp-in-centos6-dot-2-64bit-at-linode.md","raw":"---\nlayout: post\ntitle: \"centos6.2 64bit上安装pptp与客户端设置\"\ndate: 2013-04-14 10:53\ncomments: true\ncategories: vpn\n---\n\n主要内容\n\n```\n#1.安装软件包\n#2.vi /etc/pptpd.conf 文件\n#3.vi /etc/ppp/options.pptpd\n#4.设置使用 pptpd 的用户名和密码\n#5.修改内核设置/etc/sysctl.conf\n#6.添加 iptables 转发规则\n#7.启动pptpd 服务\n#8.一键安装shell脚本\n#9.pptp客户端连接\n#10.客户端vpn翻墙设置\n```\n<!-- more -->\n\npptp安装可以参考这篇文章\n\n\t在 Linode VPS 下搭建 pptp 服务器\t\t\n\thttp://www.chenjunlu.com/2012/04/how-to-setup-a-pptp-vpn-server-under-linode-vps/\n\n\n#1.安装软件包\n\n```\nyum install -y ppp iptables\n#wget http://poptop.sourceforge.net/yum/stable/packages/pptpd-1.3.4-2.el6.x86_64.rpm\nwget http://poptop.sourceforge.net/yum/beta/rhel6/x86_64/pptpd-1.4.0-1.el6.x86_64.rpm\n\nrpm -ivh pptpd-1.4.0-1.el6.x86_64.rpm\n```\n\n\n#2. vi /etc/pptpd.conf 文件\n\n\t#localip 192.168.0.1\n\t#remoteip 192.168.0.234-238,192.168.0.245\n\n修改成\n\n\tlocalip 192.168.0.1\n\tremoteip 192.168.0.234-238,192.168.0.245\n\n注意：此处的  remoteip 指定的 IP 范围是用来给远程连接使用的。\n\n\n#3. vi /etc/ppp/options.pptpd\n\n\t#ms-dns 10.0.0.1\n\t#ms-dns 10.0.0.2\n\t\n改成\n\n\tms-dns 8.8.8.8\n\tms-dns 8.8.4.4\n\n#4.设置使用 pptpd 的用户名和密码\n\tvi /etc/ppp/chap-secrets\n打开后只有两行，而且一个账号都没有\n\n\t# Secrets for authentication using CHAP\n\t# client        server  secret                  IP addresses\n\n根据您的需要添加账号，每行一个。\n按照：“用户名 pptpd 密码 ip地址”的格式输入，每一项之间用空格分开，例如：\n\t\n\tvpnuser pptpd password *\t\n\t\n#5.修改内核设置/etc/sysctl.conf\n\n编辑 /etc/sysctl.conf 文件：\n\n\tsed -i 's/net.ipv4.ip_forward = 0/net.ipv4.ip_forward = 1/' /etc/sysctl.conf\n\tsed -i 's/net.ipv4.tcp_syncookies = 1/#net.ipv4.tcp_syncookies = 1/' /etc/sysctl.conf\n\tsysctl -p\t\n\t\n#6.添加 iptables 转发规则\n```\niptables -t nat -A POSTROUTING -s 192.168.0.0/24 -o eth0 -j MASQUERADE\n/etc/init.d/iptables save\n/etc/init.d/iptables restart\n```\n\n启动iptables 时，可能会遇到如下报错：\n/etc/init.d/iptables restart\nSetting chains to policy ACCEPT: security raw nat mangle fi[FAILED]\n\n解决：\nvi /etc/init.d/iptables\n加入145到151行的内容,然后保存退出并重起\n/etc/init.d/iptables restart\n\n```\n    security)\n    $IPTABLES -t filter -P INPUT $policy \\\n        && $IPTABLES -t filter -P OUTPUT $policy \\\n        && $IPTABLES -t filter -P FORWARD $policy \\\n        || let ret+=1\n\n    ;;\n```\n\n```\n   142\t    for i in $tables; do\n   143\t\techo -n \"$i \"\n   144\t\tcase \"$i\" in\n   145\t  security)\n   146\t    $IPTABLES -t filter -P INPUT $policy \\\n   147\t        && $IPTABLES -t filter -P OUTPUT $policy \\\n   148\t        && $IPTABLES -t filter -P FORWARD $policy \\\n   149\t        || let ret+=1\n   150\t\n   151\t    ;;\n   152\t\t    raw)\n   153\t\t\t$IPTABLES -t raw -P PREROUTING $policy \\\n   154\t\t\t    && $IPTABLES -t raw -P OUTPUT $policy \\\n   155\t\t\t    || let ret+=1\n   156\t\t\t;;\n```\n\n\n#7.启动pptpd 服务\n重启 pptpd 服务\n\n\t/etc/init.d/pptpd restart\n\n配置 pptpd 随系统启动\n\n\tchkconfig pptpd on\n\n确认1723端口开启\n\n```\n# netstat -lnt\nActive Internet connections (only servers)\nProto Recv-Q Send-Q Local Address               Foreign Address             State\ntcp        0      0 0.0.0.0:1723                0.0.0.0:*                   LISTEN\n...\n```\n\n至此 pptp 服务端安装全部结束\n\n\n#8.一键安装shell脚本\n\n```bash\n\n#!/bin/bash\n# install pptp vpn\n######################\n# Date : 2014-08-10\n# Author: xionglie.qu\n######################\n\necho \"# 1. 安装基础包 \"\nyum install -y ppp iptables\nwget http://poptop.sourceforge.net/yum/beta/rhel6/x86_64/pptpd-1.4.0-1.el6.x86_64.rpm\nrpm -ivh pptpd-1.4.0-1.el6.x86_64.rpm\n\necho \"# 2. vi /etc/pptpd.conf \"\n/bin/cp /etc/pptpd.conf /etc/pptpd.conf.`date +\"%Y-%m-%d_%H-%M-%S\"`\nsed -i 's/#localip 192.168.0.1/localip 192.168.0.1/g' /etc/pptpd.conf\nsed -i 's/#remoteip 192.168.0.234-238,192.168.0.245/remoteip 192.168.0.234-238,192.168.0.245/g' /etc/pptpd.conf\n\necho \"# 3. vi /etc/ppp/options.pptpd \"\n/bin/cp /etc/ppp/options.pptpd /etc/ppp/options.pptpd.`date +\"%Y-%m-%d_%H-%M-%S\"`\nsed -i 's/#ms-dns 10.0.0.1/ms-dns 8.8.8.8/g' /etc/ppp/options.pptpd\nsed -i 's/#ms-dns 10.0.0.2/ms-dns 8.8.4.4/g' /etc/ppp/options.pptpd\n\necho \"# 4.设置使用 pptpd 的用户名和密码 \"\n/bin/cp /etc/ppp/chap-secrets /etc/ppp/chap-secrets.`date +\"%Y-%m-%d_%H-%M-%S\"`\necho \"###  /etc/ppp/chap-secrets \"\necho \"#vpnuser pptpd password *\">> /etc/ppp/chap-secrets\necho \"user001 pptpd pwd001 *    \" >> /etc/ppp/chap-secrets\n\necho \"# 5.修改内核设置/etc/sysctl.conf \"\nsed -i 's/net.ipv4.ip_forward = 0/net.ipv4.ip_forward = 1/' /etc/sysctl.conf\nsed -i 's/net.ipv4.tcp_syncookies = 1/#net.ipv4.tcp_syncookies = 1/' /etc/sysctl.conf\nsysctl -p\t\n\n\necho \"# 6. 添加 iptables 转发规则\"\niptables -t nat -A POSTROUTING -s 192.168.0.0/24 -o eth0 -j MASQUERADE\n/etc/init.d/iptables save\n/etc/init.d/iptables restart\n\necho \"# 7.启动pptpd 服务\"\n/etc/init.d/pptpd restart\nchkconfig pptpd on\nchkconfig --list | grep pptpd\n\necho \"# end #\"\n\n``` \n#9.pptp客户端连接\n##mac\n设置非常简单，不懂的话google一下\"Mac PPTP VPN设置教程\"即可有答案。\n\n\n##windows \n可以看这篇文章\n\n\t怎么创建 VPN 连接（ Windows XP，pptp ）\t\t\n\thttp://lihua.me/zh/pptp-vpn-windows-xp/\n\t\n#10.客户端vpn翻墙设置\npptp连接上去，必须将pptp设为默认连接，这样所有数据都会从vpn出去。\n\n##mac下设置：\n![pptp](/images/2013/04/pptp-mac-01.png)\n\n![pptp](/images/2013/04/pptp-mac-02.png)\n\n##windows xp下设置：\n![pptp](/images/2013/04/pptp-xp.jpg)\n\n \n####实现在使用vpn访问国外资源的同时, 能用非vpn线路高速访问本国资源.\n\n\thttps://code.google.com/p/chnroutes/\n\t使用说明 \n\thttps://code.google.com/p/chnroutes/wiki/Usage\n\n(完)\n\n\n","slug":"install-pptp-in-centos6-dot-2-64bit-at-linode","published":1,"updated":"2017-01-27T02:05:49.000Z","photos":[],"link":"","_id":"ciyf7fkb5000sf2jy5eomhp7u","content":"<p>主要内容</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">#1.安装软件包</div><div class=\"line\">#2.vi /etc/pptpd.conf 文件</div><div class=\"line\">#3.vi /etc/ppp/options.pptpd</div><div class=\"line\">#4.设置使用 pptpd 的用户名和密码</div><div class=\"line\">#5.修改内核设置/etc/sysctl.conf</div><div class=\"line\">#6.添加 iptables 转发规则</div><div class=\"line\">#7.启动pptpd 服务</div><div class=\"line\">#8.一键安装shell脚本</div><div class=\"line\">#9.pptp客户端连接</div><div class=\"line\">#10.客户端vpn翻墙设置</div></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<p>pptp安装可以参考这篇文章</p>\n<pre><code>在 Linode VPS 下搭建 pptp 服务器        \nhttp://www.chenjunlu.com/2012/04/how-to-setup-a-pptp-vpn-server-under-linode-vps/\n</code></pre><p>#1.安装软件包</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install -y ppp iptables</div><div class=\"line\">#wget http://poptop.sourceforge.net/yum/stable/packages/pptpd-1.3.4-2.el6.x86_64.rpm</div><div class=\"line\">wget http://poptop.sourceforge.net/yum/beta/rhel6/x86_64/pptpd-1.4.0-1.el6.x86_64.rpm</div><div class=\"line\"></div><div class=\"line\">rpm -ivh pptpd-1.4.0-1.el6.x86_64.rpm</div></pre></td></tr></table></figure>\n<p>#2. vi /etc/pptpd.conf 文件</p>\n<pre><code>#localip 192.168.0.1\n#remoteip 192.168.0.234-238,192.168.0.245\n</code></pre><p>修改成</p>\n<pre><code>localip 192.168.0.1\nremoteip 192.168.0.234-238,192.168.0.245\n</code></pre><p>注意：此处的  remoteip 指定的 IP 范围是用来给远程连接使用的。</p>\n<p>#3. vi /etc/ppp/options.pptpd</p>\n<pre><code>#ms-dns 10.0.0.1\n#ms-dns 10.0.0.2\n</code></pre><p>改成</p>\n<pre><code>ms-dns 8.8.8.8\nms-dns 8.8.4.4\n</code></pre><p>#4.设置使用 pptpd 的用户名和密码<br>    vi /etc/ppp/chap-secrets<br>打开后只有两行，而且一个账号都没有</p>\n<pre><code># Secrets for authentication using CHAP\n# client        server  secret                  IP addresses\n</code></pre><p>根据您的需要添加账号，每行一个。<br>按照：“用户名 pptpd 密码 ip地址”的格式输入，每一项之间用空格分开，例如：</p>\n<pre><code>vpnuser pptpd password *    \n</code></pre><p>#5.修改内核设置/etc/sysctl.conf</p>\n<p>编辑 /etc/sysctl.conf 文件：</p>\n<pre><code>sed -i &apos;s/net.ipv4.ip_forward = 0/net.ipv4.ip_forward = 1/&apos; /etc/sysctl.conf\nsed -i &apos;s/net.ipv4.tcp_syncookies = 1/#net.ipv4.tcp_syncookies = 1/&apos; /etc/sysctl.conf\nsysctl -p    \n</code></pre><p>#6.添加 iptables 转发规则<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">iptables -t nat -A POSTROUTING -s 192.168.0.0/24 -o eth0 -j MASQUERADE</div><div class=\"line\">/etc/init.d/iptables save</div><div class=\"line\">/etc/init.d/iptables restart</div></pre></td></tr></table></figure></p>\n<p>启动iptables 时，可能会遇到如下报错：<br>/etc/init.d/iptables restart<br>Setting chains to policy ACCEPT: security raw nat mangle fi[FAILED]</p>\n<p>解决：<br>vi /etc/init.d/iptables<br>加入145到151行的内容,然后保存退出并重起<br>/etc/init.d/iptables restart</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">security)</div><div class=\"line\">$IPTABLES -t filter -P INPUT $policy \\</div><div class=\"line\">    &amp;&amp; $IPTABLES -t filter -P OUTPUT $policy \\</div><div class=\"line\">    &amp;&amp; $IPTABLES -t filter -P FORWARD $policy \\</div><div class=\"line\">    || let ret+=1</div><div class=\"line\"></div><div class=\"line\">;;</div></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\">142\t    for i in $tables; do</div><div class=\"line\">143\t\techo -n &quot;$i &quot;</div><div class=\"line\">144\t\tcase &quot;$i&quot; in</div><div class=\"line\">145\t  security)</div><div class=\"line\">146\t    $IPTABLES -t filter -P INPUT $policy \\</div><div class=\"line\">147\t        &amp;&amp; $IPTABLES -t filter -P OUTPUT $policy \\</div><div class=\"line\">148\t        &amp;&amp; $IPTABLES -t filter -P FORWARD $policy \\</div><div class=\"line\">149\t        || let ret+=1</div><div class=\"line\">150\t</div><div class=\"line\">151\t    ;;</div><div class=\"line\">152\t\t    raw)</div><div class=\"line\">153\t\t\t$IPTABLES -t raw -P PREROUTING $policy \\</div><div class=\"line\">154\t\t\t    &amp;&amp; $IPTABLES -t raw -P OUTPUT $policy \\</div><div class=\"line\">155\t\t\t    || let ret+=1</div><div class=\"line\">156\t\t\t;;</div></pre></td></tr></table></figure>\n<p>#7.启动pptpd 服务<br>重启 pptpd 服务</p>\n<pre><code>/etc/init.d/pptpd restart\n</code></pre><p>配置 pptpd 随系统启动</p>\n<pre><code>chkconfig pptpd on\n</code></pre><p>确认1723端口开启</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># netstat -lnt</div><div class=\"line\">Active Internet connections (only servers)</div><div class=\"line\">Proto Recv-Q Send-Q Local Address               Foreign Address             State</div><div class=\"line\">tcp        0      0 0.0.0.0:1723                0.0.0.0:*                   LISTEN</div><div class=\"line\">...</div></pre></td></tr></table></figure>\n<p>至此 pptp 服务端安装全部结束</p>\n<p>#8.一键安装shell脚本</p>\n<pre><code class=\"bash\">\n<span class=\"meta\">#!/bin/bash</span>\n<span class=\"comment\"># install pptp vpn</span>\n<span class=\"comment\">######################</span>\n<span class=\"comment\"># Date : 2014-08-10</span>\n<span class=\"comment\"># Author: xionglie.qu</span>\n<span class=\"comment\">######################</span>\n\n<span class=\"built_in\">echo</span> <span class=\"string\">\"# 1. 安装基础包 \"</span>\nyum install -y ppp iptables\nwget http://poptop.sourceforge.net/yum/beta/rhel6/x86_64/pptpd-1.4.0-1.el6.x86_64.rpm\nrpm -ivh pptpd-1.4.0-1.el6.x86_64.rpm\n\n<span class=\"built_in\">echo</span> <span class=\"string\">\"# 2. vi /etc/pptpd.conf \"</span>\n/bin/cp /etc/pptpd.conf /etc/pptpd.conf.`date +<span class=\"string\">\"%Y-%m-%d_%H-%M-%S\"</span>`\nsed -i <span class=\"string\">'s/#localip 192.168.0.1/localip 192.168.0.1/g'</span> /etc/pptpd.conf\nsed -i <span class=\"string\">'s/#remoteip 192.168.0.234-238,192.168.0.245/remoteip 192.168.0.234-238,192.168.0.245/g'</span> /etc/pptpd.conf\n\n<span class=\"built_in\">echo</span> <span class=\"string\">\"# 3. vi /etc/ppp/options.pptpd \"</span>\n/bin/cp /etc/ppp/options.pptpd /etc/ppp/options.pptpd.`date +<span class=\"string\">\"%Y-%m-%d_%H-%M-%S\"</span>`\nsed -i <span class=\"string\">'s/#ms-dns 10.0.0.1/ms-dns 8.8.8.8/g'</span> /etc/ppp/options.pptpd\nsed -i <span class=\"string\">'s/#ms-dns 10.0.0.2/ms-dns 8.8.4.4/g'</span> /etc/ppp/options.pptpd\n\n<span class=\"built_in\">echo</span> <span class=\"string\">\"# 4.设置使用 pptpd 的用户名和密码 \"</span>\n/bin/cp /etc/ppp/chap-secrets /etc/ppp/chap-secrets.`date +<span class=\"string\">\"%Y-%m-%d_%H-%M-%S\"</span>`\n<span class=\"built_in\">echo</span> <span class=\"string\">\"###  /etc/ppp/chap-secrets \"</span>\n<span class=\"built_in\">echo</span> <span class=\"string\">\"#vpnuser pptpd password *\"</span>&gt;&gt; /etc/ppp/chap-secrets\n<span class=\"built_in\">echo</span> <span class=\"string\">\"user001 pptpd pwd001 *    \"</span> &gt;&gt; /etc/ppp/chap-secrets\n\n<span class=\"built_in\">echo</span> <span class=\"string\">\"# 5.修改内核设置/etc/sysctl.conf \"</span>\nsed -i <span class=\"string\">'s/net.ipv4.ip_forward = 0/net.ipv4.ip_forward = 1/'</span> /etc/sysctl.conf\nsed -i <span class=\"string\">'s/net.ipv4.tcp_syncookies = 1/#net.ipv4.tcp_syncookies = 1/'</span> /etc/sysctl.conf\nsysctl -p    \n\n\n<span class=\"built_in\">echo</span> <span class=\"string\">\"# 6. 添加 iptables 转发规则\"</span>\niptables -t nat -A POSTROUTING <span class=\"_\">-s</span> 192.168.0.0/24 -o eth0 -j MASQUERADE\n/etc/init.d/iptables save\n/etc/init.d/iptables restart\n\n<span class=\"built_in\">echo</span> <span class=\"string\">\"# 7.启动pptpd 服务\"</span>\n/etc/init.d/pptpd restart\nchkconfig pptpd on\nchkconfig --list | grep pptpd\n\n<span class=\"built_in\">echo</span> <span class=\"string\">\"# end #\"</span>\n</code></pre>\n<p>#9.pptp客户端连接</p>\n<p>##mac<br>设置非常简单，不懂的话google一下”Mac PPTP VPN设置教程”即可有答案。</p>\n<p>##windows<br>可以看这篇文章</p>\n<pre><code>怎么创建 VPN 连接（ Windows XP，pptp ）        \nhttp://lihua.me/zh/pptp-vpn-windows-xp/\n</code></pre><p>#10.客户端vpn翻墙设置<br>pptp连接上去，必须将pptp设为默认连接，这样所有数据都会从vpn出去。</p>\n<p>##mac下设置：<br><img src=\"/images/2013/04/pptp-mac-01.png\" alt=\"pptp\"></p>\n<p><img src=\"/images/2013/04/pptp-mac-02.png\" alt=\"pptp\"></p>\n<p>##windows xp下设置：<br><img src=\"/images/2013/04/pptp-xp.jpg\" alt=\"pptp\"></p>\n<p>####实现在使用vpn访问国外资源的同时, 能用非vpn线路高速访问本国资源.</p>\n<pre><code>https://code.google.com/p/chnroutes/\n使用说明 \nhttps://code.google.com/p/chnroutes/wiki/Usage\n</code></pre><p>(完)</p>\n","excerpt":"<p>主要内容</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">#1.安装软件包</div><div class=\"line\">#2.vi /etc/pptpd.conf 文件</div><div class=\"line\">#3.vi /etc/ppp/options.pptpd</div><div class=\"line\">#4.设置使用 pptpd 的用户名和密码</div><div class=\"line\">#5.修改内核设置/etc/sysctl.conf</div><div class=\"line\">#6.添加 iptables 转发规则</div><div class=\"line\">#7.启动pptpd 服务</div><div class=\"line\">#8.一键安装shell脚本</div><div class=\"line\">#9.pptp客户端连接</div><div class=\"line\">#10.客户端vpn翻墙设置</div></pre></td></tr></table></figure>","more":"<p>pptp安装可以参考这篇文章</p>\n<pre><code>在 Linode VPS 下搭建 pptp 服务器        \nhttp://www.chenjunlu.com/2012/04/how-to-setup-a-pptp-vpn-server-under-linode-vps/\n</code></pre><p>#1.安装软件包</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install -y ppp iptables</div><div class=\"line\">#wget http://poptop.sourceforge.net/yum/stable/packages/pptpd-1.3.4-2.el6.x86_64.rpm</div><div class=\"line\">wget http://poptop.sourceforge.net/yum/beta/rhel6/x86_64/pptpd-1.4.0-1.el6.x86_64.rpm</div><div class=\"line\"></div><div class=\"line\">rpm -ivh pptpd-1.4.0-1.el6.x86_64.rpm</div></pre></td></tr></table></figure>\n<p>#2. vi /etc/pptpd.conf 文件</p>\n<pre><code>#localip 192.168.0.1\n#remoteip 192.168.0.234-238,192.168.0.245\n</code></pre><p>修改成</p>\n<pre><code>localip 192.168.0.1\nremoteip 192.168.0.234-238,192.168.0.245\n</code></pre><p>注意：此处的  remoteip 指定的 IP 范围是用来给远程连接使用的。</p>\n<p>#3. vi /etc/ppp/options.pptpd</p>\n<pre><code>#ms-dns 10.0.0.1\n#ms-dns 10.0.0.2\n</code></pre><p>改成</p>\n<pre><code>ms-dns 8.8.8.8\nms-dns 8.8.4.4\n</code></pre><p>#4.设置使用 pptpd 的用户名和密码<br>    vi /etc/ppp/chap-secrets<br>打开后只有两行，而且一个账号都没有</p>\n<pre><code># Secrets for authentication using CHAP\n# client        server  secret                  IP addresses\n</code></pre><p>根据您的需要添加账号，每行一个。<br>按照：“用户名 pptpd 密码 ip地址”的格式输入，每一项之间用空格分开，例如：</p>\n<pre><code>vpnuser pptpd password *    \n</code></pre><p>#5.修改内核设置/etc/sysctl.conf</p>\n<p>编辑 /etc/sysctl.conf 文件：</p>\n<pre><code>sed -i &apos;s/net.ipv4.ip_forward = 0/net.ipv4.ip_forward = 1/&apos; /etc/sysctl.conf\nsed -i &apos;s/net.ipv4.tcp_syncookies = 1/#net.ipv4.tcp_syncookies = 1/&apos; /etc/sysctl.conf\nsysctl -p    \n</code></pre><p>#6.添加 iptables 转发规则<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">iptables -t nat -A POSTROUTING -s 192.168.0.0/24 -o eth0 -j MASQUERADE</div><div class=\"line\">/etc/init.d/iptables save</div><div class=\"line\">/etc/init.d/iptables restart</div></pre></td></tr></table></figure></p>\n<p>启动iptables 时，可能会遇到如下报错：<br>/etc/init.d/iptables restart<br>Setting chains to policy ACCEPT: security raw nat mangle fi[FAILED]</p>\n<p>解决：<br>vi /etc/init.d/iptables<br>加入145到151行的内容,然后保存退出并重起<br>/etc/init.d/iptables restart</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">security)</div><div class=\"line\">$IPTABLES -t filter -P INPUT $policy \\</div><div class=\"line\">    &amp;&amp; $IPTABLES -t filter -P OUTPUT $policy \\</div><div class=\"line\">    &amp;&amp; $IPTABLES -t filter -P FORWARD $policy \\</div><div class=\"line\">    || let ret+=1</div><div class=\"line\"></div><div class=\"line\">;;</div></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\">142\t    for i in $tables; do</div><div class=\"line\">143\t\techo -n &quot;$i &quot;</div><div class=\"line\">144\t\tcase &quot;$i&quot; in</div><div class=\"line\">145\t  security)</div><div class=\"line\">146\t    $IPTABLES -t filter -P INPUT $policy \\</div><div class=\"line\">147\t        &amp;&amp; $IPTABLES -t filter -P OUTPUT $policy \\</div><div class=\"line\">148\t        &amp;&amp; $IPTABLES -t filter -P FORWARD $policy \\</div><div class=\"line\">149\t        || let ret+=1</div><div class=\"line\">150\t</div><div class=\"line\">151\t    ;;</div><div class=\"line\">152\t\t    raw)</div><div class=\"line\">153\t\t\t$IPTABLES -t raw -P PREROUTING $policy \\</div><div class=\"line\">154\t\t\t    &amp;&amp; $IPTABLES -t raw -P OUTPUT $policy \\</div><div class=\"line\">155\t\t\t    || let ret+=1</div><div class=\"line\">156\t\t\t;;</div></pre></td></tr></table></figure>\n<p>#7.启动pptpd 服务<br>重启 pptpd 服务</p>\n<pre><code>/etc/init.d/pptpd restart\n</code></pre><p>配置 pptpd 随系统启动</p>\n<pre><code>chkconfig pptpd on\n</code></pre><p>确认1723端口开启</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># netstat -lnt</div><div class=\"line\">Active Internet connections (only servers)</div><div class=\"line\">Proto Recv-Q Send-Q Local Address               Foreign Address             State</div><div class=\"line\">tcp        0      0 0.0.0.0:1723                0.0.0.0:*                   LISTEN</div><div class=\"line\">...</div></pre></td></tr></table></figure>\n<p>至此 pptp 服务端安装全部结束</p>\n<p>#8.一键安装shell脚本</p>\n<pre><code class=\"bash\">\n<span class=\"meta\">#!/bin/bash</span>\n<span class=\"comment\"># install pptp vpn</span>\n<span class=\"comment\">######################</span>\n<span class=\"comment\"># Date : 2014-08-10</span>\n<span class=\"comment\"># Author: xionglie.qu</span>\n<span class=\"comment\">######################</span>\n\n<span class=\"built_in\">echo</span> <span class=\"string\">\"# 1. 安装基础包 \"</span>\nyum install -y ppp iptables\nwget http://poptop.sourceforge.net/yum/beta/rhel6/x86_64/pptpd-1.4.0-1.el6.x86_64.rpm\nrpm -ivh pptpd-1.4.0-1.el6.x86_64.rpm\n\n<span class=\"built_in\">echo</span> <span class=\"string\">\"# 2. vi /etc/pptpd.conf \"</span>\n/bin/cp /etc/pptpd.conf /etc/pptpd.conf.`date +<span class=\"string\">\"%Y-%m-%d_%H-%M-%S\"</span>`\nsed -i <span class=\"string\">'s/#localip 192.168.0.1/localip 192.168.0.1/g'</span> /etc/pptpd.conf\nsed -i <span class=\"string\">'s/#remoteip 192.168.0.234-238,192.168.0.245/remoteip 192.168.0.234-238,192.168.0.245/g'</span> /etc/pptpd.conf\n\n<span class=\"built_in\">echo</span> <span class=\"string\">\"# 3. vi /etc/ppp/options.pptpd \"</span>\n/bin/cp /etc/ppp/options.pptpd /etc/ppp/options.pptpd.`date +<span class=\"string\">\"%Y-%m-%d_%H-%M-%S\"</span>`\nsed -i <span class=\"string\">'s/#ms-dns 10.0.0.1/ms-dns 8.8.8.8/g'</span> /etc/ppp/options.pptpd\nsed -i <span class=\"string\">'s/#ms-dns 10.0.0.2/ms-dns 8.8.4.4/g'</span> /etc/ppp/options.pptpd\n\n<span class=\"built_in\">echo</span> <span class=\"string\">\"# 4.设置使用 pptpd 的用户名和密码 \"</span>\n/bin/cp /etc/ppp/chap-secrets /etc/ppp/chap-secrets.`date +<span class=\"string\">\"%Y-%m-%d_%H-%M-%S\"</span>`\n<span class=\"built_in\">echo</span> <span class=\"string\">\"###  /etc/ppp/chap-secrets \"</span>\n<span class=\"built_in\">echo</span> <span class=\"string\">\"#vpnuser pptpd password *\"</span>&gt;&gt; /etc/ppp/chap-secrets\n<span class=\"built_in\">echo</span> <span class=\"string\">\"user001 pptpd pwd001 *    \"</span> &gt;&gt; /etc/ppp/chap-secrets\n\n<span class=\"built_in\">echo</span> <span class=\"string\">\"# 5.修改内核设置/etc/sysctl.conf \"</span>\nsed -i <span class=\"string\">'s/net.ipv4.ip_forward = 0/net.ipv4.ip_forward = 1/'</span> /etc/sysctl.conf\nsed -i <span class=\"string\">'s/net.ipv4.tcp_syncookies = 1/#net.ipv4.tcp_syncookies = 1/'</span> /etc/sysctl.conf\nsysctl -p    \n\n\n<span class=\"built_in\">echo</span> <span class=\"string\">\"# 6. 添加 iptables 转发规则\"</span>\niptables -t nat -A POSTROUTING <span class=\"_\">-s</span> 192.168.0.0/24 -o eth0 -j MASQUERADE\n/etc/init.d/iptables save\n/etc/init.d/iptables restart\n\n<span class=\"built_in\">echo</span> <span class=\"string\">\"# 7.启动pptpd 服务\"</span>\n/etc/init.d/pptpd restart\nchkconfig pptpd on\nchkconfig --list | grep pptpd\n\n<span class=\"built_in\">echo</span> <span class=\"string\">\"# end #\"</span>\n</code></pre>\n<p>#9.pptp客户端连接</p>\n<p>##mac<br>设置非常简单，不懂的话google一下”Mac PPTP VPN设置教程”即可有答案。</p>\n<p>##windows<br>可以看这篇文章</p>\n<pre><code>怎么创建 VPN 连接（ Windows XP，pptp ）        \nhttp://lihua.me/zh/pptp-vpn-windows-xp/\n</code></pre><p>#10.客户端vpn翻墙设置<br>pptp连接上去，必须将pptp设为默认连接，这样所有数据都会从vpn出去。</p>\n<p>##mac下设置：<br><img src=\"/images/2013/04/pptp-mac-01.png\" alt=\"pptp\"></p>\n<p><img src=\"/images/2013/04/pptp-mac-02.png\" alt=\"pptp\"></p>\n<p>##windows xp下设置：<br><img src=\"/images/2013/04/pptp-xp.jpg\" alt=\"pptp\"></p>\n<p>####实现在使用vpn访问国外资源的同时, 能用非vpn线路高速访问本国资源.</p>\n<pre><code>https://code.google.com/p/chnroutes/\n使用说明 \nhttps://code.google.com/p/chnroutes/wiki/Usage\n</code></pre><p>(完)</p>"},{"layout":"post","title":"Centos6.3上编译OpenJDK7源码","date":"2013-02-16T07:56:00.000Z","comments":1,"_content":"\n本文包括4部分内容：   \n1.基本流程（阅读README和README-builds.html）  \n2.安装基础软件包  \n3.配置变量  \n4.检查环境是否配置ok与编译jdk源码  \n\n<!-- more -->\n\n下载源码openjdk-7u6-fcs-src-b24-28_aug_2012.zip，解压\n\n## 基本流程（阅读README和README-builds.html）\nREADME-builds.html中包含有详细的安装信息，最好能完整的阅读一下。  \n---------README--------  \nSimple Build Instructions:\n\n0.Get the necessary system software/packages installed on your system, see\nhttp://hg.openjdk.java.net/jdk7/build/raw-file/tip/README-builds.html  \n\n1.If you don't have a jdk6 installed, download and install a JDK 6 from\nhttp://java.sun.com/javase/downloads/index.jsp\nSet the environment variable ALT_BOOTDIR to the location of JDK 6.\n\n2.Check the sanity of doing a build with your current system:\nmake sanity\nSee README-builds.html if you run into problems.\n\n3.Do a complete build of the OpenJDK:\nmake all\nThe resulting JDK image should be found in build/*/j2sdk-image\n\n----------README-builds.html---------  \nBasic Linux Check List\n\nInstall the Bootstrap JDK, set ALT_BOOTDIR.  \nOptional Import JDK, set ALT_JDK_IMPORT_PATH.\t\nInstall or upgrade the FreeType development package.  \nInstall Ant 1.7.1 or newer, make sure it is in your PATH.  \n\n### CentOS 5.5\n\nAfter installing CentOS 5.5 you need to make sure you have the following   Development bundles installed:  \n\tDevelopment Libraries  \n \tDevelopment Tools  \n \tJava Development  \n \tX Software Development (Including XFree86-devel)  \nPlus the following packages:   \n\n cups devel: Cups Development Package  \n alsa devel: Alsa Development Package  \n ant: Ant Package  \n Xi devel: libXi.so Development Package  \nThe freetype 2.3 packages don't seem to be available, but the freetype 2.3 sources can be downloaded, built, and installed easily enough from the freetype site. Build and install with something like:  \n\n``` bash\n./configure && make && sudo -u root make install \n```\n\n(注意：Version 2.3 or newer of FreeType is required for building the OpenJDK.) =》freetype的版本至少为2.3或更新  \n\nMercurial packages could not be found easily, but a Google search should find ones, and they usually include Python if it's needed.  \n\n注意：    \n(1).All OpenJDK builds require access to least Ant 1.7.1.（ant的版本至少为1.7.1）  \n(2).Linux only: Version 0.9.1 or newer of the ALSA files are required for building the OpenJDK on Linux. \n\n## 安装基础软件包\n我的centos6安装在vmware Fusion上，安装时使用最小化(Minimal)安装\n\n```bash\n[root@vm-pc ~]# cat /etc/redhat-release \nCentOS release 6.3 (Final)\n[root@vm-pc ~]# uname -m\nx86_64\n[root@vm-pc ~]# uname -r\n2.6.32-279.el6.x86_64\n```\n\n执行下面命令\n\n```bash\n#!/bin/bash\n\n#配置更新源\ncd /etc/yum.repos.d/\ncurl http://mirrors.163.com/.help/CentOS6-Base-163.repo > CentOS6-Base-163.repo \n#当前wget还不能用\n#wget http://mirrors.163.com/.help/CentOS6-Base-163.repo\nmv CentOS-Base.repo CentOS-Base.repo.bak\nmv CentOS6-Base-163.repo CentOS-Base.repo\nyum makecache\n\nyum -y groupinstall 'base'\nyum -y install make\n\n\n#安装jdk必备软件包\nyum -y install alsa-lib-devel\nyum -y install cups-devel\nyum -y install libXi-devel\nyum -y install gcc gcc-c++\nyum -y install libX*\n\nmkdir -p /application/tools\ncd /application/tools\n\n#上传或下载相关文件到/application/tools\n#freetype-2.3.12.tar.gz \n#openjdk-7u6-fcs-src-b24-28_aug_2012.zip\n#apache-ant-1.7.1-bin.zip \n#jdk-6u26-linux-i586.bin\n\n#编译安装freetype\ntar -xzf freetype-2.3.12.tar.gz\ncd freetype-2.3.12\n./configure \nmake\nmake install\n\n```\n\n如果安装时出现如下错误，则执行\n\nmkdir -p /usr/local/include/freetype2/freetype/internal  \nmake install  \n\nrmdir /usr/local/include/freetype2/freetype/internal  \nrmdir: failed to remove `/usr/local/include/freetype2/freetype/internal': No such file or directory\nmake: [install] Error 1 (ignored)\n/usr/bin/install -c -m 644 ./builds/unix/ft2unix.h \\\n/usr/local/include/ft2build.h\n/usr/bin/install -c -m 644 ./builds/unix/ftconfig.h \\\n/usr/local/include/freetype2/freetype/config/ftconfig.h\n\n```bash\n#!/bin/bash\n\n#安装jdk\nyum -y install ld-linux.so.2\nsh install_jdk.sh\nsource /etc/profile\n\n#安装ant\ncd /application/tools/\nunzip apache-ant-1.7.1-bin.zip\nln -s /application/tools/apache-ant-1.7.1/bin/ant /usr/bin/ant\n```\n\n检查java与ant  \n\n```bash\n[root@vm-pc ~]# java -version\njava version \"1.6.0_26\"\nJava(TM) SE Runtime Environment (build 1.6.0_26-b03)\nJava HotSpot(TM) Client VM (build 20.1-b02, mixed mode, sharing)\n[root@vm-pc ~]# ant\nBuildfile: build.xml does not exist!\nBuild failed\n```\n\n## 配置变量\n\n```bash\nunset CLASSPATH\nunset JAVA_HOME\nexport LANG=C\nexport ALT_BOOTDIR=/application/java/jdk\nexport ANT_HOME=/application/tools/apache-ant-1.7.1/\nexport ALT_FREETYPE_LIB_PATH=/usr/local/lib\nexport SKIP_DEBUG_BUILD=false \nexport SKIP_FASTDEBUG_BUILD=true \nexport DEBUG_NAME=debug \nexport ALT_FREETYPE_HEADERS_PATH=/usr/local/include/freetype2\n```\n\n## 检查环境是否配置OK与编译jdk源码\n\n```bash\n[root@vm-pc openjdk]# pwd\n/application/tools/openjdk\n[root@vm-pc openjdk]# make sanity\n\n.......\nOpenJDK-specific settings:\nFREETYPE_HEADERS_PATH = /usr/local/include/freetype2\nALT_FREETYPE_HEADERS_PATH = /usr/local/include/freetype2\nFREETYPE_LIB_PATH = /usr/local/lib\nALT_FREETYPE_LIB_PATH = /usr/local/lib\n\nPrevious JDK Settings:\nPREVIOUS_RELEASE_PATH = USING-PREVIOUS_RELEASE_IMAGE\nALT_PREVIOUS_RELEASE_PATH = \nPREVIOUS_JDK_VERSION = 1.6.0\nALT_PREVIOUS_JDK_VERSION = \nPREVIOUS_JDK_FILE = \nALT_PREVIOUS_JDK_FILE = \nPREVIOUS_JRE_FILE = \nALT_PREVIOUS_JRE_FILE = \nPREVIOUS_RELEASE_IMAGE = /application/java/jdk\nALT_PREVIOUS_RELEASE_IMAGE =\n```\n\nSanity check passed.  #表示ok了\n\n```bash\n[root@vm-pc openjdk]# make all ARCH_DATA_MODEL=64 ALLOW_DOWNLOADS=true\n…\n#-- Build times ----------\nTarget debug_build\nStart 2013-01-07 14:41:38\nEnd 2013-01-07 15:09:46\n00:01:23 corba\n00:09:56 hotspot\n00:00:18 jaxp\n00:00:25 jaxws\n00:15:33 jdk\n00:00:33 langtools\n00:28:08 TOTAL\n-------------------------\nmake[1]: Leaving directory `/application/tools/openjdk'\n```\n\n查看劳动成果\n\n```bash\n[root@vm-pc openjdk]# ./build/linux-amd64/bin/java -version\nopenjdk version \"1.7.0-internal-debug\"\nOpenJDK Runtime Environment (build 1.7.0-internal-debug-root_2013_01_07_14_31-b00)\nOpenJDK 64-Bit Server VM (build 23.2-b09-jvmg, mixed mode)\n```\n\n附：安装install_jdk.sh脚本\n\n```bash\n#!bin/bash\n# auto install jdk\n# Filename: install_jdk.sh\n# Author: quxl\n# Email: xionglie.qu@gmail.com\n# \n\nif [ \"$UID\" -ne \"0\" ]; then\n    echo \"You must be root to run this script! \"\n    exit 1\nfi\n\nTOOL_DIR=/application/tools\nJAVA_DIR=/application/java\nJAVA_HOME_DIR=${JAVA_DIR}/jdk\nSETUP_FILE=jdk-6u26-linux-i586.bin\n\nmkdir -p ${JAVA_DIR}\n/bin/cp -f  ${TOOL_DIR}/${SETUP_FILE} ${JAVA_DIR}/${SETUP_FILE}\ncd ${JAVA_DIR}\necho -e \"\\r\\n\" > yes\nchmod u+x ${SETUP_FILE}\n./${SETUP_FILE}<yes\nrm -f ${JAVA_DIR}/${SETUP_FILE}\nrm -f yes\n\nln -s ${JAVA_DIR}/jdk1.6.0_26 ${JAVA_HOME_DIR}\n\ncat >> /etc/profile <<EOF\n#set java environment\nJAVA_HOME=${JAVA_HOME_DIR}\nexport JRE_HOME=${JAVA_HOME_DIR}/jre\nexport CLASSPATH=.:\\$JAVA_HOME/lib:\\$JRE_HOME/lib:\\$CLASSPATH\nexport PATH=\\$JAVA_HOME/bin:\\$JRE_HOME/bin:\\$PATH\nEOF\n\nsource /etc/profile\necho \"install Ok...\"\n\n```","source":"_posts/2013-02-16-build-openjdk7-in-centos6-dot-3.md","raw":"---\nlayout: post\ntitle: \"Centos6.3上编译OpenJDK7源码\"\ndate: 2013-02-16 15:56\ncomments: true\ncategories: java\n---\n\n本文包括4部分内容：   \n1.基本流程（阅读README和README-builds.html）  \n2.安装基础软件包  \n3.配置变量  \n4.检查环境是否配置ok与编译jdk源码  \n\n<!-- more -->\n\n下载源码openjdk-7u6-fcs-src-b24-28_aug_2012.zip，解压\n\n## 基本流程（阅读README和README-builds.html）\nREADME-builds.html中包含有详细的安装信息，最好能完整的阅读一下。  \n---------README--------  \nSimple Build Instructions:\n\n0.Get the necessary system software/packages installed on your system, see\nhttp://hg.openjdk.java.net/jdk7/build/raw-file/tip/README-builds.html  \n\n1.If you don't have a jdk6 installed, download and install a JDK 6 from\nhttp://java.sun.com/javase/downloads/index.jsp\nSet the environment variable ALT_BOOTDIR to the location of JDK 6.\n\n2.Check the sanity of doing a build with your current system:\nmake sanity\nSee README-builds.html if you run into problems.\n\n3.Do a complete build of the OpenJDK:\nmake all\nThe resulting JDK image should be found in build/*/j2sdk-image\n\n----------README-builds.html---------  \nBasic Linux Check List\n\nInstall the Bootstrap JDK, set ALT_BOOTDIR.  \nOptional Import JDK, set ALT_JDK_IMPORT_PATH.\t\nInstall or upgrade the FreeType development package.  \nInstall Ant 1.7.1 or newer, make sure it is in your PATH.  \n\n### CentOS 5.5\n\nAfter installing CentOS 5.5 you need to make sure you have the following   Development bundles installed:  \n\tDevelopment Libraries  \n \tDevelopment Tools  \n \tJava Development  \n \tX Software Development (Including XFree86-devel)  \nPlus the following packages:   \n\n cups devel: Cups Development Package  \n alsa devel: Alsa Development Package  \n ant: Ant Package  \n Xi devel: libXi.so Development Package  \nThe freetype 2.3 packages don't seem to be available, but the freetype 2.3 sources can be downloaded, built, and installed easily enough from the freetype site. Build and install with something like:  \n\n``` bash\n./configure && make && sudo -u root make install \n```\n\n(注意：Version 2.3 or newer of FreeType is required for building the OpenJDK.) =》freetype的版本至少为2.3或更新  \n\nMercurial packages could not be found easily, but a Google search should find ones, and they usually include Python if it's needed.  \n\n注意：    \n(1).All OpenJDK builds require access to least Ant 1.7.1.（ant的版本至少为1.7.1）  \n(2).Linux only: Version 0.9.1 or newer of the ALSA files are required for building the OpenJDK on Linux. \n\n## 安装基础软件包\n我的centos6安装在vmware Fusion上，安装时使用最小化(Minimal)安装\n\n```bash\n[root@vm-pc ~]# cat /etc/redhat-release \nCentOS release 6.3 (Final)\n[root@vm-pc ~]# uname -m\nx86_64\n[root@vm-pc ~]# uname -r\n2.6.32-279.el6.x86_64\n```\n\n执行下面命令\n\n```bash\n#!/bin/bash\n\n#配置更新源\ncd /etc/yum.repos.d/\ncurl http://mirrors.163.com/.help/CentOS6-Base-163.repo > CentOS6-Base-163.repo \n#当前wget还不能用\n#wget http://mirrors.163.com/.help/CentOS6-Base-163.repo\nmv CentOS-Base.repo CentOS-Base.repo.bak\nmv CentOS6-Base-163.repo CentOS-Base.repo\nyum makecache\n\nyum -y groupinstall 'base'\nyum -y install make\n\n\n#安装jdk必备软件包\nyum -y install alsa-lib-devel\nyum -y install cups-devel\nyum -y install libXi-devel\nyum -y install gcc gcc-c++\nyum -y install libX*\n\nmkdir -p /application/tools\ncd /application/tools\n\n#上传或下载相关文件到/application/tools\n#freetype-2.3.12.tar.gz \n#openjdk-7u6-fcs-src-b24-28_aug_2012.zip\n#apache-ant-1.7.1-bin.zip \n#jdk-6u26-linux-i586.bin\n\n#编译安装freetype\ntar -xzf freetype-2.3.12.tar.gz\ncd freetype-2.3.12\n./configure \nmake\nmake install\n\n```\n\n如果安装时出现如下错误，则执行\n\nmkdir -p /usr/local/include/freetype2/freetype/internal  \nmake install  \n\nrmdir /usr/local/include/freetype2/freetype/internal  \nrmdir: failed to remove `/usr/local/include/freetype2/freetype/internal': No such file or directory\nmake: [install] Error 1 (ignored)\n/usr/bin/install -c -m 644 ./builds/unix/ft2unix.h \\\n/usr/local/include/ft2build.h\n/usr/bin/install -c -m 644 ./builds/unix/ftconfig.h \\\n/usr/local/include/freetype2/freetype/config/ftconfig.h\n\n```bash\n#!/bin/bash\n\n#安装jdk\nyum -y install ld-linux.so.2\nsh install_jdk.sh\nsource /etc/profile\n\n#安装ant\ncd /application/tools/\nunzip apache-ant-1.7.1-bin.zip\nln -s /application/tools/apache-ant-1.7.1/bin/ant /usr/bin/ant\n```\n\n检查java与ant  \n\n```bash\n[root@vm-pc ~]# java -version\njava version \"1.6.0_26\"\nJava(TM) SE Runtime Environment (build 1.6.0_26-b03)\nJava HotSpot(TM) Client VM (build 20.1-b02, mixed mode, sharing)\n[root@vm-pc ~]# ant\nBuildfile: build.xml does not exist!\nBuild failed\n```\n\n## 配置变量\n\n```bash\nunset CLASSPATH\nunset JAVA_HOME\nexport LANG=C\nexport ALT_BOOTDIR=/application/java/jdk\nexport ANT_HOME=/application/tools/apache-ant-1.7.1/\nexport ALT_FREETYPE_LIB_PATH=/usr/local/lib\nexport SKIP_DEBUG_BUILD=false \nexport SKIP_FASTDEBUG_BUILD=true \nexport DEBUG_NAME=debug \nexport ALT_FREETYPE_HEADERS_PATH=/usr/local/include/freetype2\n```\n\n## 检查环境是否配置OK与编译jdk源码\n\n```bash\n[root@vm-pc openjdk]# pwd\n/application/tools/openjdk\n[root@vm-pc openjdk]# make sanity\n\n.......\nOpenJDK-specific settings:\nFREETYPE_HEADERS_PATH = /usr/local/include/freetype2\nALT_FREETYPE_HEADERS_PATH = /usr/local/include/freetype2\nFREETYPE_LIB_PATH = /usr/local/lib\nALT_FREETYPE_LIB_PATH = /usr/local/lib\n\nPrevious JDK Settings:\nPREVIOUS_RELEASE_PATH = USING-PREVIOUS_RELEASE_IMAGE\nALT_PREVIOUS_RELEASE_PATH = \nPREVIOUS_JDK_VERSION = 1.6.0\nALT_PREVIOUS_JDK_VERSION = \nPREVIOUS_JDK_FILE = \nALT_PREVIOUS_JDK_FILE = \nPREVIOUS_JRE_FILE = \nALT_PREVIOUS_JRE_FILE = \nPREVIOUS_RELEASE_IMAGE = /application/java/jdk\nALT_PREVIOUS_RELEASE_IMAGE =\n```\n\nSanity check passed.  #表示ok了\n\n```bash\n[root@vm-pc openjdk]# make all ARCH_DATA_MODEL=64 ALLOW_DOWNLOADS=true\n…\n#-- Build times ----------\nTarget debug_build\nStart 2013-01-07 14:41:38\nEnd 2013-01-07 15:09:46\n00:01:23 corba\n00:09:56 hotspot\n00:00:18 jaxp\n00:00:25 jaxws\n00:15:33 jdk\n00:00:33 langtools\n00:28:08 TOTAL\n-------------------------\nmake[1]: Leaving directory `/application/tools/openjdk'\n```\n\n查看劳动成果\n\n```bash\n[root@vm-pc openjdk]# ./build/linux-amd64/bin/java -version\nopenjdk version \"1.7.0-internal-debug\"\nOpenJDK Runtime Environment (build 1.7.0-internal-debug-root_2013_01_07_14_31-b00)\nOpenJDK 64-Bit Server VM (build 23.2-b09-jvmg, mixed mode)\n```\n\n附：安装install_jdk.sh脚本\n\n```bash\n#!bin/bash\n# auto install jdk\n# Filename: install_jdk.sh\n# Author: quxl\n# Email: xionglie.qu@gmail.com\n# \n\nif [ \"$UID\" -ne \"0\" ]; then\n    echo \"You must be root to run this script! \"\n    exit 1\nfi\n\nTOOL_DIR=/application/tools\nJAVA_DIR=/application/java\nJAVA_HOME_DIR=${JAVA_DIR}/jdk\nSETUP_FILE=jdk-6u26-linux-i586.bin\n\nmkdir -p ${JAVA_DIR}\n/bin/cp -f  ${TOOL_DIR}/${SETUP_FILE} ${JAVA_DIR}/${SETUP_FILE}\ncd ${JAVA_DIR}\necho -e \"\\r\\n\" > yes\nchmod u+x ${SETUP_FILE}\n./${SETUP_FILE}<yes\nrm -f ${JAVA_DIR}/${SETUP_FILE}\nrm -f yes\n\nln -s ${JAVA_DIR}/jdk1.6.0_26 ${JAVA_HOME_DIR}\n\ncat >> /etc/profile <<EOF\n#set java environment\nJAVA_HOME=${JAVA_HOME_DIR}\nexport JRE_HOME=${JAVA_HOME_DIR}/jre\nexport CLASSPATH=.:\\$JAVA_HOME/lib:\\$JRE_HOME/lib:\\$CLASSPATH\nexport PATH=\\$JAVA_HOME/bin:\\$JRE_HOME/bin:\\$PATH\nEOF\n\nsource /etc/profile\necho \"install Ok...\"\n\n```","slug":"build-openjdk7-in-centos6-dot-3","published":1,"updated":"2017-01-26T15:40:25.000Z","photos":[],"link":"","_id":"ciyf7fkb7000tf2jyferktnjh","content":"<p>本文包括4部分内容：<br>1.基本流程（阅读README和README-builds.html）<br>2.安装基础软件包<br>3.配置变量<br>4.检查环境是否配置ok与编译jdk源码  </p>\n<a id=\"more\"></a>\n<p>下载源码openjdk-7u6-fcs-src-b24-28_aug_2012.zip，解压</p>\n<h2 id=\"基本流程（阅读README和README-builds-html）\"><a href=\"#基本流程（阅读README和README-builds-html）\" class=\"headerlink\" title=\"基本流程（阅读README和README-builds.html）\"></a>基本流程（阅读README和README-builds.html）</h2><p>README-builds.html中包含有详细的安装信息，最好能完整的阅读一下。<br>———README——–<br>Simple Build Instructions:</p>\n<p>0.Get the necessary system software/packages installed on your system, see<br><a href=\"http://hg.openjdk.java.net/jdk7/build/raw-file/tip/README-builds.html\" target=\"_blank\" rel=\"external\">http://hg.openjdk.java.net/jdk7/build/raw-file/tip/README-builds.html</a>  </p>\n<p>1.If you don’t have a jdk6 installed, download and install a JDK 6 from<br><a href=\"http://java.sun.com/javase/downloads/index.jsp\" target=\"_blank\" rel=\"external\">http://java.sun.com/javase/downloads/index.jsp</a><br>Set the environment variable ALT_BOOTDIR to the location of JDK 6.</p>\n<p>2.Check the sanity of doing a build with your current system:<br>make sanity<br>See README-builds.html if you run into problems.</p>\n<p>3.Do a complete build of the OpenJDK:<br>make all<br>The resulting JDK image should be found in build/*/j2sdk-image</p>\n<p>———-README-builds.html———<br>Basic Linux Check List</p>\n<p>Install the Bootstrap JDK, set ALT_BOOTDIR.<br>Optional Import JDK, set ALT_JDK_IMPORT_PATH.<br>Install or upgrade the FreeType development package.<br>Install Ant 1.7.1 or newer, make sure it is in your PATH.  </p>\n<h3 id=\"CentOS-5-5\"><a href=\"#CentOS-5-5\" class=\"headerlink\" title=\"CentOS 5.5\"></a>CentOS 5.5</h3><p>After installing CentOS 5.5 you need to make sure you have the following   Development bundles installed:<br>    Development Libraries<br>     Development Tools<br>     Java Development<br>     X Software Development (Including XFree86-devel)<br>Plus the following packages:   </p>\n<p> cups devel: Cups Development Package<br> alsa devel: Alsa Development Package<br> ant: Ant Package<br> Xi devel: libXi.so Development Package<br>The freetype 2.3 packages don’t seem to be available, but the freetype 2.3 sources can be downloaded, built, and installed easily enough from the freetype site. Build and install with something like:  </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">./configure &amp;&amp; make &amp;&amp; sudo -u root make install</div></pre></td></tr></table></figure>\n<p>(注意：Version 2.3 or newer of FreeType is required for building the OpenJDK.) =》freetype的版本至少为2.3或更新  </p>\n<p>Mercurial packages could not be found easily, but a Google search should find ones, and they usually include Python if it’s needed.  </p>\n<p>注意：<br>(1).All OpenJDK builds require access to least Ant 1.7.1.（ant的版本至少为1.7.1）<br>(2).Linux only: Version 0.9.1 or newer of the ALSA files are required for building the OpenJDK on Linux. </p>\n<h2 id=\"安装基础软件包\"><a href=\"#安装基础软件包\" class=\"headerlink\" title=\"安装基础软件包\"></a>安装基础软件包</h2><p>我的centos6安装在vmware Fusion上，安装时使用最小化(Minimal)安装</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm-pc ~]<span class=\"comment\"># cat /etc/redhat-release </span></div><div class=\"line\">CentOS release 6.3 (Final)</div><div class=\"line\">[root@vm-pc ~]<span class=\"comment\"># uname -m</span></div><div class=\"line\">x86_64</div><div class=\"line\">[root@vm-pc ~]<span class=\"comment\"># uname -r</span></div><div class=\"line\">2.6.32-279.el6.x86_64</div></pre></td></tr></table></figure>\n<p>执行下面命令</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">#!/bin/bash</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#配置更新源</span></div><div class=\"line\"><span class=\"built_in\">cd</span> /etc/yum.repos.d/</div><div class=\"line\">curl http://mirrors.163.com/.help/CentOS6-Base-163.repo &gt; CentOS6-Base-163.repo </div><div class=\"line\"><span class=\"comment\">#当前wget还不能用</span></div><div class=\"line\"><span class=\"comment\">#wget http://mirrors.163.com/.help/CentOS6-Base-163.repo</span></div><div class=\"line\">mv CentOS-Base.repo CentOS-Base.repo.bak</div><div class=\"line\">mv CentOS6-Base-163.repo CentOS-Base.repo</div><div class=\"line\">yum makecache</div><div class=\"line\"></div><div class=\"line\">yum -y groupinstall <span class=\"string\">'base'</span></div><div class=\"line\">yum -y install make</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#安装jdk必备软件包</span></div><div class=\"line\">yum -y install alsa-lib-devel</div><div class=\"line\">yum -y install cups-devel</div><div class=\"line\">yum -y install libXi-devel</div><div class=\"line\">yum -y install gcc gcc-c++</div><div class=\"line\">yum -y install libX*</div><div class=\"line\"></div><div class=\"line\">mkdir -p /application/tools</div><div class=\"line\"><span class=\"built_in\">cd</span> /application/tools</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#上传或下载相关文件到/application/tools</span></div><div class=\"line\"><span class=\"comment\">#freetype-2.3.12.tar.gz </span></div><div class=\"line\"><span class=\"comment\">#openjdk-7u6-fcs-src-b24-28_aug_2012.zip</span></div><div class=\"line\"><span class=\"comment\">#apache-ant-1.7.1-bin.zip </span></div><div class=\"line\"><span class=\"comment\">#jdk-6u26-linux-i586.bin</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#编译安装freetype</span></div><div class=\"line\">tar -xzf freetype-2.3.12.tar.gz</div><div class=\"line\"><span class=\"built_in\">cd</span> freetype-2.3.12</div><div class=\"line\">./configure </div><div class=\"line\">make</div><div class=\"line\">make install</div></pre></td></tr></table></figure>\n<p>如果安装时出现如下错误，则执行</p>\n<p>mkdir -p /usr/local/include/freetype2/freetype/internal<br>make install  </p>\n<p>rmdir /usr/local/include/freetype2/freetype/internal<br>rmdir: failed to remove `/usr/local/include/freetype2/freetype/internal’: No such file or directory<br>make: [install] Error 1 (ignored)<br>/usr/bin/install -c -m 644 ./builds/unix/ft2unix.h \\<br>/usr/local/include/ft2build.h<br>/usr/bin/install -c -m 644 ./builds/unix/ftconfig.h \\<br>/usr/local/include/freetype2/freetype/config/ftconfig.h</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">#!/bin/bash</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#安装jdk</span></div><div class=\"line\">yum -y install ld-linux.so.2</div><div class=\"line\">sh install_jdk.sh</div><div class=\"line\"><span class=\"built_in\">source</span> /etc/profile</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#安装ant</span></div><div class=\"line\"><span class=\"built_in\">cd</span> /application/tools/</div><div class=\"line\">unzip apache-ant-1.7.1-bin.zip</div><div class=\"line\">ln <span class=\"_\">-s</span> /application/tools/apache-ant-1.7.1/bin/ant /usr/bin/ant</div></pre></td></tr></table></figure>\n<p>检查java与ant  </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm-pc ~]<span class=\"comment\"># java -version</span></div><div class=\"line\">java version <span class=\"string\">\"1.6.0_26\"</span></div><div class=\"line\">Java(TM) SE Runtime Environment (build 1.6.0_26-b03)</div><div class=\"line\">Java HotSpot(TM) Client VM (build 20.1-b02, mixed mode, sharing)</div><div class=\"line\">[root@vm-pc ~]<span class=\"comment\"># ant</span></div><div class=\"line\">Buildfile: build.xml does not exist!</div><div class=\"line\">Build failed</div></pre></td></tr></table></figure>\n<h2 id=\"配置变量\"><a href=\"#配置变量\" class=\"headerlink\" title=\"配置变量\"></a>配置变量</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">unset</span> CLASSPATH</div><div class=\"line\"><span class=\"built_in\">unset</span> JAVA_HOME</div><div class=\"line\"><span class=\"built_in\">export</span> LANG=C</div><div class=\"line\"><span class=\"built_in\">export</span> ALT_BOOTDIR=/application/java/jdk</div><div class=\"line\"><span class=\"built_in\">export</span> ANT_HOME=/application/tools/apache-ant-1.7.1/</div><div class=\"line\"><span class=\"built_in\">export</span> ALT_FREETYPE_LIB_PATH=/usr/<span class=\"built_in\">local</span>/lib</div><div class=\"line\"><span class=\"built_in\">export</span> SKIP_DEBUG_BUILD=<span class=\"literal\">false</span> </div><div class=\"line\"><span class=\"built_in\">export</span> SKIP_FASTDEBUG_BUILD=<span class=\"literal\">true</span> </div><div class=\"line\"><span class=\"built_in\">export</span> DEBUG_NAME=debug </div><div class=\"line\"><span class=\"built_in\">export</span> ALT_FREETYPE_HEADERS_PATH=/usr/<span class=\"built_in\">local</span>/include/freetype2</div></pre></td></tr></table></figure>\n<h2 id=\"检查环境是否配置OK与编译jdk源码\"><a href=\"#检查环境是否配置OK与编译jdk源码\" class=\"headerlink\" title=\"检查环境是否配置OK与编译jdk源码\"></a>检查环境是否配置OK与编译jdk源码</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm-pc openjdk]<span class=\"comment\"># pwd</span></div><div class=\"line\">/application/tools/openjdk</div><div class=\"line\">[root@vm-pc openjdk]<span class=\"comment\"># make sanity</span></div><div class=\"line\"></div><div class=\"line\">.......</div><div class=\"line\">OpenJDK-specific settings:</div><div class=\"line\">FREETYPE_HEADERS_PATH = /usr/<span class=\"built_in\">local</span>/include/freetype2</div><div class=\"line\">ALT_FREETYPE_HEADERS_PATH = /usr/<span class=\"built_in\">local</span>/include/freetype2</div><div class=\"line\">FREETYPE_LIB_PATH = /usr/<span class=\"built_in\">local</span>/lib</div><div class=\"line\">ALT_FREETYPE_LIB_PATH = /usr/<span class=\"built_in\">local</span>/lib</div><div class=\"line\"></div><div class=\"line\">Previous JDK Settings:</div><div class=\"line\">PREVIOUS_RELEASE_PATH = USING-PREVIOUS_RELEASE_IMAGE</div><div class=\"line\">ALT_PREVIOUS_RELEASE_PATH = </div><div class=\"line\">PREVIOUS_JDK_VERSION = 1.6.0</div><div class=\"line\">ALT_PREVIOUS_JDK_VERSION = </div><div class=\"line\">PREVIOUS_JDK_FILE = </div><div class=\"line\">ALT_PREVIOUS_JDK_FILE = </div><div class=\"line\">PREVIOUS_JRE_FILE = </div><div class=\"line\">ALT_PREVIOUS_JRE_FILE = </div><div class=\"line\">PREVIOUS_RELEASE_IMAGE = /application/java/jdk</div><div class=\"line\">ALT_PREVIOUS_RELEASE_IMAGE =</div></pre></td></tr></table></figure>\n<p>Sanity check passed.  #表示ok了</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm-pc openjdk]<span class=\"comment\"># make all ARCH_DATA_MODEL=64 ALLOW_DOWNLOADS=true</span></div><div class=\"line\">…</div><div class=\"line\"><span class=\"comment\">#-- Build times ----------</span></div><div class=\"line\">Target debug_build</div><div class=\"line\">Start 2013-01-07 14:41:38</div><div class=\"line\">End 2013-01-07 15:09:46</div><div class=\"line\">00:01:23 corba</div><div class=\"line\">00:09:56 hotspot</div><div class=\"line\">00:00:18 jaxp</div><div class=\"line\">00:00:25 jaxws</div><div class=\"line\">00:15:33 jdk</div><div class=\"line\">00:00:33 langtools</div><div class=\"line\">00:28:08 TOTAL</div><div class=\"line\">-------------------------</div><div class=\"line\">make[1]: Leaving directory `/application/tools/openjdk<span class=\"string\">'</span></div></pre></td></tr></table></figure>\n<p>查看劳动成果</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm-pc openjdk]<span class=\"comment\"># ./build/linux-amd64/bin/java -version</span></div><div class=\"line\">openjdk version <span class=\"string\">\"1.7.0-internal-debug\"</span></div><div class=\"line\">OpenJDK Runtime Environment (build 1.7.0-internal-debug-root_2013_01_07_14_31-b00)</div><div class=\"line\">OpenJDK 64-Bit Server VM (build 23.2-b09-jvmg, mixed mode)</div></pre></td></tr></table></figure>\n<p>附：安装install_jdk.sh脚本</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">#!bin/bash</span></div><div class=\"line\"><span class=\"comment\"># auto install jdk</span></div><div class=\"line\"><span class=\"comment\"># Filename: install_jdk.sh</span></div><div class=\"line\"><span class=\"comment\"># Author: quxl</span></div><div class=\"line\"><span class=\"comment\"># Email: xionglie.qu@gmail.com</span></div><div class=\"line\"><span class=\"comment\"># </span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> [ <span class=\"string\">\"<span class=\"variable\">$UID</span>\"</span> <span class=\"_\">-ne</span> <span class=\"string\">\"0\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"You must be root to run this script! \"</span></div><div class=\"line\">    <span class=\"built_in\">exit</span> 1</div><div class=\"line\"><span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\">TOOL_DIR=/application/tools</div><div class=\"line\">JAVA_DIR=/application/java</div><div class=\"line\">JAVA_HOME_DIR=<span class=\"variable\">$&#123;JAVA_DIR&#125;</span>/jdk</div><div class=\"line\">SETUP_FILE=jdk-6u26-linux-i586.bin</div><div class=\"line\"></div><div class=\"line\">mkdir -p <span class=\"variable\">$&#123;JAVA_DIR&#125;</span></div><div class=\"line\">/bin/cp <span class=\"_\">-f</span>  <span class=\"variable\">$&#123;TOOL_DIR&#125;</span>/<span class=\"variable\">$&#123;SETUP_FILE&#125;</span> <span class=\"variable\">$&#123;JAVA_DIR&#125;</span>/<span class=\"variable\">$&#123;SETUP_FILE&#125;</span></div><div class=\"line\"><span class=\"built_in\">cd</span> <span class=\"variable\">$&#123;JAVA_DIR&#125;</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">\"\\r\\n\"</span> &gt; yes</div><div class=\"line\">chmod u+x <span class=\"variable\">$&#123;SETUP_FILE&#125;</span></div><div class=\"line\">./<span class=\"variable\">$&#123;SETUP_FILE&#125;</span>&lt;yes</div><div class=\"line\">rm <span class=\"_\">-f</span> <span class=\"variable\">$&#123;JAVA_DIR&#125;</span>/<span class=\"variable\">$&#123;SETUP_FILE&#125;</span></div><div class=\"line\">rm <span class=\"_\">-f</span> yes</div><div class=\"line\"></div><div class=\"line\">ln <span class=\"_\">-s</span> <span class=\"variable\">$&#123;JAVA_DIR&#125;</span>/jdk1.6.0_26 <span class=\"variable\">$&#123;JAVA_HOME_DIR&#125;</span></div><div class=\"line\"></div><div class=\"line\">cat &gt;&gt; /etc/profile &lt;&lt;EOF</div><div class=\"line\"><span class=\"comment\">#set java environment</span></div><div class=\"line\">JAVA_HOME=<span class=\"variable\">$&#123;JAVA_HOME_DIR&#125;</span></div><div class=\"line\"><span class=\"built_in\">export</span> JRE_HOME=<span class=\"variable\">$&#123;JAVA_HOME_DIR&#125;</span>/jre</div><div class=\"line\"><span class=\"built_in\">export</span> CLASSPATH=.:\\<span class=\"variable\">$JAVA_HOME</span>/lib:\\<span class=\"variable\">$JRE_HOME</span>/lib:\\<span class=\"variable\">$CLASSPATH</span></div><div class=\"line\"><span class=\"built_in\">export</span> PATH=\\<span class=\"variable\">$JAVA_HOME</span>/bin:\\<span class=\"variable\">$JRE_HOME</span>/bin:\\<span class=\"variable\">$PATH</span></div><div class=\"line\">EOF</div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">source</span> /etc/profile</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"install Ok...\"</span></div></pre></td></tr></table></figure>","excerpt":"<p>本文包括4部分内容：<br>1.基本流程（阅读README和README-builds.html）<br>2.安装基础软件包<br>3.配置变量<br>4.检查环境是否配置ok与编译jdk源码  </p>","more":"<p>下载源码openjdk-7u6-fcs-src-b24-28_aug_2012.zip，解压</p>\n<h2 id=\"基本流程（阅读README和README-builds-html）\"><a href=\"#基本流程（阅读README和README-builds-html）\" class=\"headerlink\" title=\"基本流程（阅读README和README-builds.html）\"></a>基本流程（阅读README和README-builds.html）</h2><p>README-builds.html中包含有详细的安装信息，最好能完整的阅读一下。<br>———README——–<br>Simple Build Instructions:</p>\n<p>0.Get the necessary system software/packages installed on your system, see<br><a href=\"http://hg.openjdk.java.net/jdk7/build/raw-file/tip/README-builds.html\">http://hg.openjdk.java.net/jdk7/build/raw-file/tip/README-builds.html</a>  </p>\n<p>1.If you don’t have a jdk6 installed, download and install a JDK 6 from<br><a href=\"http://java.sun.com/javase/downloads/index.jsp\">http://java.sun.com/javase/downloads/index.jsp</a><br>Set the environment variable ALT_BOOTDIR to the location of JDK 6.</p>\n<p>2.Check the sanity of doing a build with your current system:<br>make sanity<br>See README-builds.html if you run into problems.</p>\n<p>3.Do a complete build of the OpenJDK:<br>make all<br>The resulting JDK image should be found in build/*/j2sdk-image</p>\n<p>———-README-builds.html———<br>Basic Linux Check List</p>\n<p>Install the Bootstrap JDK, set ALT_BOOTDIR.<br>Optional Import JDK, set ALT_JDK_IMPORT_PATH.<br>Install or upgrade the FreeType development package.<br>Install Ant 1.7.1 or newer, make sure it is in your PATH.  </p>\n<h3 id=\"CentOS-5-5\"><a href=\"#CentOS-5-5\" class=\"headerlink\" title=\"CentOS 5.5\"></a>CentOS 5.5</h3><p>After installing CentOS 5.5 you need to make sure you have the following   Development bundles installed:<br>    Development Libraries<br>     Development Tools<br>     Java Development<br>     X Software Development (Including XFree86-devel)<br>Plus the following packages:   </p>\n<p> cups devel: Cups Development Package<br> alsa devel: Alsa Development Package<br> ant: Ant Package<br> Xi devel: libXi.so Development Package<br>The freetype 2.3 packages don’t seem to be available, but the freetype 2.3 sources can be downloaded, built, and installed easily enough from the freetype site. Build and install with something like:  </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">./configure &amp;&amp; make &amp;&amp; sudo -u root make install</div></pre></td></tr></table></figure>\n<p>(注意：Version 2.3 or newer of FreeType is required for building the OpenJDK.) =》freetype的版本至少为2.3或更新  </p>\n<p>Mercurial packages could not be found easily, but a Google search should find ones, and they usually include Python if it’s needed.  </p>\n<p>注意：<br>(1).All OpenJDK builds require access to least Ant 1.7.1.（ant的版本至少为1.7.1）<br>(2).Linux only: Version 0.9.1 or newer of the ALSA files are required for building the OpenJDK on Linux. </p>\n<h2 id=\"安装基础软件包\"><a href=\"#安装基础软件包\" class=\"headerlink\" title=\"安装基础软件包\"></a>安装基础软件包</h2><p>我的centos6安装在vmware Fusion上，安装时使用最小化(Minimal)安装</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm-pc ~]<span class=\"comment\"># cat /etc/redhat-release </span></div><div class=\"line\">CentOS release 6.3 (Final)</div><div class=\"line\">[root@vm-pc ~]<span class=\"comment\"># uname -m</span></div><div class=\"line\">x86_64</div><div class=\"line\">[root@vm-pc ~]<span class=\"comment\"># uname -r</span></div><div class=\"line\">2.6.32-279.el6.x86_64</div></pre></td></tr></table></figure>\n<p>执行下面命令</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">#!/bin/bash</div><div class=\"line\"></span></div><div class=\"line\"><span class=\"comment\">#配置更新源</span></div><div class=\"line\"><span class=\"built_in\">cd</span> /etc/yum.repos.d/</div><div class=\"line\">curl http://mirrors.163.com/.help/CentOS6-Base-163.repo &gt; CentOS6-Base-163.repo </div><div class=\"line\"><span class=\"comment\">#当前wget还不能用</span></div><div class=\"line\"><span class=\"comment\">#wget http://mirrors.163.com/.help/CentOS6-Base-163.repo</span></div><div class=\"line\">mv CentOS-Base.repo CentOS-Base.repo.bak</div><div class=\"line\">mv CentOS6-Base-163.repo CentOS-Base.repo</div><div class=\"line\">yum makecache</div><div class=\"line\"></div><div class=\"line\">yum -y groupinstall <span class=\"string\">'base'</span></div><div class=\"line\">yum -y install make</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#安装jdk必备软件包</span></div><div class=\"line\">yum -y install alsa-lib-devel</div><div class=\"line\">yum -y install cups-devel</div><div class=\"line\">yum -y install libXi-devel</div><div class=\"line\">yum -y install gcc gcc-c++</div><div class=\"line\">yum -y install libX*</div><div class=\"line\"></div><div class=\"line\">mkdir -p /application/tools</div><div class=\"line\"><span class=\"built_in\">cd</span> /application/tools</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#上传或下载相关文件到/application/tools</span></div><div class=\"line\"><span class=\"comment\">#freetype-2.3.12.tar.gz </span></div><div class=\"line\"><span class=\"comment\">#openjdk-7u6-fcs-src-b24-28_aug_2012.zip</span></div><div class=\"line\"><span class=\"comment\">#apache-ant-1.7.1-bin.zip </span></div><div class=\"line\"><span class=\"comment\">#jdk-6u26-linux-i586.bin</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#编译安装freetype</span></div><div class=\"line\">tar -xzf freetype-2.3.12.tar.gz</div><div class=\"line\"><span class=\"built_in\">cd</span> freetype-2.3.12</div><div class=\"line\">./configure </div><div class=\"line\">make</div><div class=\"line\">make install</div></pre></td></tr></table></figure>\n<p>如果安装时出现如下错误，则执行</p>\n<p>mkdir -p /usr/local/include/freetype2/freetype/internal<br>make install  </p>\n<p>rmdir /usr/local/include/freetype2/freetype/internal<br>rmdir: failed to remove `/usr/local/include/freetype2/freetype/internal’: No such file or directory<br>make: [install] Error 1 (ignored)<br>/usr/bin/install -c -m 644 ./builds/unix/ft2unix.h \\<br>/usr/local/include/ft2build.h<br>/usr/bin/install -c -m 644 ./builds/unix/ftconfig.h \\<br>/usr/local/include/freetype2/freetype/config/ftconfig.h</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">#!/bin/bash</div><div class=\"line\"></span></div><div class=\"line\"><span class=\"comment\">#安装jdk</span></div><div class=\"line\">yum -y install ld-linux.so.2</div><div class=\"line\">sh install_jdk.sh</div><div class=\"line\"><span class=\"built_in\">source</span> /etc/profile</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#安装ant</span></div><div class=\"line\"><span class=\"built_in\">cd</span> /application/tools/</div><div class=\"line\">unzip apache-ant-1.7.1-bin.zip</div><div class=\"line\">ln <span class=\"_\">-s</span> /application/tools/apache-ant-1.7.1/bin/ant /usr/bin/ant</div></pre></td></tr></table></figure>\n<p>检查java与ant  </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm-pc ~]<span class=\"comment\"># java -version</span></div><div class=\"line\">java version <span class=\"string\">\"1.6.0_26\"</span></div><div class=\"line\">Java(TM) SE Runtime Environment (build 1.6.0_26-b03)</div><div class=\"line\">Java HotSpot(TM) Client VM (build 20.1-b02, mixed mode, sharing)</div><div class=\"line\">[root@vm-pc ~]<span class=\"comment\"># ant</span></div><div class=\"line\">Buildfile: build.xml does not exist!</div><div class=\"line\">Build failed</div></pre></td></tr></table></figure>\n<h2 id=\"配置变量\"><a href=\"#配置变量\" class=\"headerlink\" title=\"配置变量\"></a>配置变量</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">unset</span> CLASSPATH</div><div class=\"line\"><span class=\"built_in\">unset</span> JAVA_HOME</div><div class=\"line\"><span class=\"built_in\">export</span> LANG=C</div><div class=\"line\"><span class=\"built_in\">export</span> ALT_BOOTDIR=/application/java/jdk</div><div class=\"line\"><span class=\"built_in\">export</span> ANT_HOME=/application/tools/apache-ant-1.7.1/</div><div class=\"line\"><span class=\"built_in\">export</span> ALT_FREETYPE_LIB_PATH=/usr/<span class=\"built_in\">local</span>/lib</div><div class=\"line\"><span class=\"built_in\">export</span> SKIP_DEBUG_BUILD=<span class=\"literal\">false</span> </div><div class=\"line\"><span class=\"built_in\">export</span> SKIP_FASTDEBUG_BUILD=<span class=\"literal\">true</span> </div><div class=\"line\"><span class=\"built_in\">export</span> DEBUG_NAME=debug </div><div class=\"line\"><span class=\"built_in\">export</span> ALT_FREETYPE_HEADERS_PATH=/usr/<span class=\"built_in\">local</span>/include/freetype2</div></pre></td></tr></table></figure>\n<h2 id=\"检查环境是否配置OK与编译jdk源码\"><a href=\"#检查环境是否配置OK与编译jdk源码\" class=\"headerlink\" title=\"检查环境是否配置OK与编译jdk源码\"></a>检查环境是否配置OK与编译jdk源码</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm-pc openjdk]<span class=\"comment\"># pwd</span></div><div class=\"line\">/application/tools/openjdk</div><div class=\"line\">[root@vm-pc openjdk]<span class=\"comment\"># make sanity</span></div><div class=\"line\"></div><div class=\"line\">.......</div><div class=\"line\">OpenJDK-specific settings:</div><div class=\"line\">FREETYPE_HEADERS_PATH = /usr/<span class=\"built_in\">local</span>/include/freetype2</div><div class=\"line\">ALT_FREETYPE_HEADERS_PATH = /usr/<span class=\"built_in\">local</span>/include/freetype2</div><div class=\"line\">FREETYPE_LIB_PATH = /usr/<span class=\"built_in\">local</span>/lib</div><div class=\"line\">ALT_FREETYPE_LIB_PATH = /usr/<span class=\"built_in\">local</span>/lib</div><div class=\"line\"></div><div class=\"line\">Previous JDK Settings:</div><div class=\"line\">PREVIOUS_RELEASE_PATH = USING-PREVIOUS_RELEASE_IMAGE</div><div class=\"line\">ALT_PREVIOUS_RELEASE_PATH = </div><div class=\"line\">PREVIOUS_JDK_VERSION = 1.6.0</div><div class=\"line\">ALT_PREVIOUS_JDK_VERSION = </div><div class=\"line\">PREVIOUS_JDK_FILE = </div><div class=\"line\">ALT_PREVIOUS_JDK_FILE = </div><div class=\"line\">PREVIOUS_JRE_FILE = </div><div class=\"line\">ALT_PREVIOUS_JRE_FILE = </div><div class=\"line\">PREVIOUS_RELEASE_IMAGE = /application/java/jdk</div><div class=\"line\">ALT_PREVIOUS_RELEASE_IMAGE =</div></pre></td></tr></table></figure>\n<p>Sanity check passed.  #表示ok了</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm-pc openjdk]<span class=\"comment\"># make all ARCH_DATA_MODEL=64 ALLOW_DOWNLOADS=true</span></div><div class=\"line\">…</div><div class=\"line\"><span class=\"comment\">#-- Build times ----------</span></div><div class=\"line\">Target debug_build</div><div class=\"line\">Start 2013-01-07 14:41:38</div><div class=\"line\">End 2013-01-07 15:09:46</div><div class=\"line\">00:01:23 corba</div><div class=\"line\">00:09:56 hotspot</div><div class=\"line\">00:00:18 jaxp</div><div class=\"line\">00:00:25 jaxws</div><div class=\"line\">00:15:33 jdk</div><div class=\"line\">00:00:33 langtools</div><div class=\"line\">00:28:08 TOTAL</div><div class=\"line\">-------------------------</div><div class=\"line\">make[1]: Leaving directory `/application/tools/openjdk<span class=\"string\">'</span></div></pre></td></tr></table></figure>\n<p>查看劳动成果</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@vm-pc openjdk]<span class=\"comment\"># ./build/linux-amd64/bin/java -version</span></div><div class=\"line\">openjdk version <span class=\"string\">\"1.7.0-internal-debug\"</span></div><div class=\"line\">OpenJDK Runtime Environment (build 1.7.0-internal-debug-root_2013_01_07_14_31-b00)</div><div class=\"line\">OpenJDK 64-Bit Server VM (build 23.2-b09-jvmg, mixed mode)</div></pre></td></tr></table></figure>\n<p>附：安装install_jdk.sh脚本</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">#!bin/bash</span></div><div class=\"line\"><span class=\"comment\"># auto install jdk</span></div><div class=\"line\"><span class=\"comment\"># Filename: install_jdk.sh</span></div><div class=\"line\"><span class=\"comment\"># Author: quxl</span></div><div class=\"line\"><span class=\"comment\"># Email: xionglie.qu@gmail.com</span></div><div class=\"line\"><span class=\"comment\"># </span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> [ <span class=\"string\">\"<span class=\"variable\">$UID</span>\"</span> <span class=\"_\">-ne</span> <span class=\"string\">\"0\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"You must be root to run this script! \"</span></div><div class=\"line\">    <span class=\"built_in\">exit</span> 1</div><div class=\"line\"><span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\">TOOL_DIR=/application/tools</div><div class=\"line\">JAVA_DIR=/application/java</div><div class=\"line\">JAVA_HOME_DIR=<span class=\"variable\">$&#123;JAVA_DIR&#125;</span>/jdk</div><div class=\"line\">SETUP_FILE=jdk-6u26-linux-i586.bin</div><div class=\"line\"></div><div class=\"line\">mkdir -p <span class=\"variable\">$&#123;JAVA_DIR&#125;</span></div><div class=\"line\">/bin/cp <span class=\"_\">-f</span>  <span class=\"variable\">$&#123;TOOL_DIR&#125;</span>/<span class=\"variable\">$&#123;SETUP_FILE&#125;</span> <span class=\"variable\">$&#123;JAVA_DIR&#125;</span>/<span class=\"variable\">$&#123;SETUP_FILE&#125;</span></div><div class=\"line\"><span class=\"built_in\">cd</span> <span class=\"variable\">$&#123;JAVA_DIR&#125;</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">\"\\r\\n\"</span> &gt; yes</div><div class=\"line\">chmod u+x <span class=\"variable\">$&#123;SETUP_FILE&#125;</span></div><div class=\"line\">./<span class=\"variable\">$&#123;SETUP_FILE&#125;</span>&lt;yes</div><div class=\"line\">rm <span class=\"_\">-f</span> <span class=\"variable\">$&#123;JAVA_DIR&#125;</span>/<span class=\"variable\">$&#123;SETUP_FILE&#125;</span></div><div class=\"line\">rm <span class=\"_\">-f</span> yes</div><div class=\"line\"></div><div class=\"line\">ln <span class=\"_\">-s</span> <span class=\"variable\">$&#123;JAVA_DIR&#125;</span>/jdk1.6.0_26 <span class=\"variable\">$&#123;JAVA_HOME_DIR&#125;</span></div><div class=\"line\"></div><div class=\"line\">cat &gt;&gt; /etc/profile &lt;&lt;EOF</div><div class=\"line\"><span class=\"comment\">#set java environment</span></div><div class=\"line\">JAVA_HOME=<span class=\"variable\">$&#123;JAVA_HOME_DIR&#125;</span></div><div class=\"line\"><span class=\"built_in\">export</span> JRE_HOME=<span class=\"variable\">$&#123;JAVA_HOME_DIR&#125;</span>/jre</div><div class=\"line\"><span class=\"built_in\">export</span> CLASSPATH=.:\\<span class=\"variable\">$JAVA_HOME</span>/lib:\\<span class=\"variable\">$JRE_HOME</span>/lib:\\<span class=\"variable\">$CLASSPATH</span></div><div class=\"line\"><span class=\"built_in\">export</span> PATH=\\<span class=\"variable\">$JAVA_HOME</span>/bin:\\<span class=\"variable\">$JRE_HOME</span>/bin:\\<span class=\"variable\">$PATH</span></div><div class=\"line\">EOF</div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">source</span> /etc/profile</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"install Ok...\"</span></div></pre></td></tr></table></figure>"},{"layout":"post","title":"在MacOS上安装lua","date":"2013-02-18T06:32:00.000Z","comments":1,"_content":"下午心血来潮，想在MacOS上安装lua，但使用brew install lua安装lua报错，于是使用源码安装。\n \n<!-- more -->\n\nlua官网：[http://www.lua.org/](http://www.lua.org/)\n\n# 使用命令brew install lua安装\n\n\n```bash\nxionglie@lie-mac:~ $ brew install lua\n==> Downloading http://www.lua.org/ftp/lua-5.1.4.tar.gz\nAlready downloaded: /Library/Caches/Homebrew/lua-5.1.4.tar.gz\n==> Patching\npatching file Makefile\npatching file src/Makefile\n######################################################################## 100.0%\npatching file lcode.c\npatching file ldblib.c\npatching file liolib.c\npatching file llex.c\npatching file loadlib.c\npatching file lstrlib.c\npatching file lvm.c\nError: Permission denied - /usr/local/lib/lua\nxionglie@lie-mac:~ $ sudo brew install lua\nPassword:\nError: Cowardly refusing to `sudo brew install'\nYou can use brew with sudo, but only if the brew executable is owned by root.\nHowever, this is both not recommended and completely unsupported so do so at\nyour own risk.\n\nxionglie@lie-mac:~ $ ls -ld /usr/local/lib\ndrwxr-xr-x  5 24561  wheel  170 Feb 18 17:27 /usr/local/lib\n#用户是24561，难道用户已经删除？\n#后面一查确实是权限问题，使用下面两条命令可以解决\n#sudo chown -R xionglie /usr/local/include\n#sudo chown -R xionglie /usr/local/lib/\nxionglie@lie-mac:~ $ ls -ld /usr/local/lib/lua\nls: /usr/local/lib/lua: No such file or directory\n```\n\n# 使用源码安装命令\n\n```bash\nwget http://www.lua.org/ftp/lua-5.2.1.tar.gz\ntar zxf lua-5.2.1.tar.gz \ncd lua-5.2.1/src\nmake macosx\nsudo cp lua /usr/bin/lua\n```\n\n# 测试：\n\n```bash\nxionglie@lie-mac:~ $ lua -v\nLua 5.2.1  Copyright (C) 1994-2012 Lua.org, PUC-Rio\n\nxionglie@lie-mac:/tmp $ cat test.lua \n-- just test\nprint(\"Hello World\")\n\nxionglie@lie-mac:/tmp $ lua test.lua \nHello World\n\n```\n\n\\-----------------------------------------------\n### 参考：How Do I Install Lua on MacOS?  \n来源：http://stackoverflow.com/questions/5496003/how-do-i-install-lua-on-macos \n  \nCompiling from source code is not that painful.  \nLua 5.1.4 here: http://www.lua.org/ftp/lua-5.1.4.tar.gz Lua 5.2 alpha here: http://www.lua.org/work/lua-5.2.0-alpha.tar.gz\n\nTake Lua 5.2 as example:\n\n```bash\n#Open your Terminal.app \nwget http://www.lua.org/work/lua-5.2.0-alpha.tar.gz    \ntar xvzf lua-5.2.0-alpha.tar.gz     \ncd lua-5.2.0-alpha/src    \nmake macosx(I believe you have Xcode installed)      \n#After that, you can see 'lua' binary under current dir.    \nsudo cp lua /usr/bin/lua     \n```\n\nNow you can enter lua to have a try. :)   \n\n","source":"_posts/2013-02-18-install-lua-in-mac-os.md","raw":"---\nlayout: post\ntitle: \"在MacOS上安装lua\"\ndate: 2013-02-18 14:32\ncomments: true\ncategories: lua\n---\n下午心血来潮，想在MacOS上安装lua，但使用brew install lua安装lua报错，于是使用源码安装。\n \n<!-- more -->\n\nlua官网：[http://www.lua.org/](http://www.lua.org/)\n\n# 使用命令brew install lua安装\n\n\n```bash\nxionglie@lie-mac:~ $ brew install lua\n==> Downloading http://www.lua.org/ftp/lua-5.1.4.tar.gz\nAlready downloaded: /Library/Caches/Homebrew/lua-5.1.4.tar.gz\n==> Patching\npatching file Makefile\npatching file src/Makefile\n######################################################################## 100.0%\npatching file lcode.c\npatching file ldblib.c\npatching file liolib.c\npatching file llex.c\npatching file loadlib.c\npatching file lstrlib.c\npatching file lvm.c\nError: Permission denied - /usr/local/lib/lua\nxionglie@lie-mac:~ $ sudo brew install lua\nPassword:\nError: Cowardly refusing to `sudo brew install'\nYou can use brew with sudo, but only if the brew executable is owned by root.\nHowever, this is both not recommended and completely unsupported so do so at\nyour own risk.\n\nxionglie@lie-mac:~ $ ls -ld /usr/local/lib\ndrwxr-xr-x  5 24561  wheel  170 Feb 18 17:27 /usr/local/lib\n#用户是24561，难道用户已经删除？\n#后面一查确实是权限问题，使用下面两条命令可以解决\n#sudo chown -R xionglie /usr/local/include\n#sudo chown -R xionglie /usr/local/lib/\nxionglie@lie-mac:~ $ ls -ld /usr/local/lib/lua\nls: /usr/local/lib/lua: No such file or directory\n```\n\n# 使用源码安装命令\n\n```bash\nwget http://www.lua.org/ftp/lua-5.2.1.tar.gz\ntar zxf lua-5.2.1.tar.gz \ncd lua-5.2.1/src\nmake macosx\nsudo cp lua /usr/bin/lua\n```\n\n# 测试：\n\n```bash\nxionglie@lie-mac:~ $ lua -v\nLua 5.2.1  Copyright (C) 1994-2012 Lua.org, PUC-Rio\n\nxionglie@lie-mac:/tmp $ cat test.lua \n-- just test\nprint(\"Hello World\")\n\nxionglie@lie-mac:/tmp $ lua test.lua \nHello World\n\n```\n\n\\-----------------------------------------------\n### 参考：How Do I Install Lua on MacOS?  \n来源：http://stackoverflow.com/questions/5496003/how-do-i-install-lua-on-macos \n  \nCompiling from source code is not that painful.  \nLua 5.1.4 here: http://www.lua.org/ftp/lua-5.1.4.tar.gz Lua 5.2 alpha here: http://www.lua.org/work/lua-5.2.0-alpha.tar.gz\n\nTake Lua 5.2 as example:\n\n```bash\n#Open your Terminal.app \nwget http://www.lua.org/work/lua-5.2.0-alpha.tar.gz    \ntar xvzf lua-5.2.0-alpha.tar.gz     \ncd lua-5.2.0-alpha/src    \nmake macosx(I believe you have Xcode installed)      \n#After that, you can see 'lua' binary under current dir.    \nsudo cp lua /usr/bin/lua     \n```\n\nNow you can enter lua to have a try. :)   \n\n","slug":"install-lua-in-mac-os","published":1,"updated":"2017-01-26T15:50:59.000Z","photos":[],"link":"","_id":"ciyf7fkb8000vf2jyy55ghrhd","content":"<p>下午心血来潮，想在MacOS上安装lua，但使用brew install lua安装lua报错，于是使用源码安装。</p>\n<a id=\"more\"></a>\n<p>lua官网：<a href=\"http://www.lua.org/\" target=\"_blank\" rel=\"external\">http://www.lua.org/</a></p>\n<h1 id=\"使用命令brew-install-lua安装\"><a href=\"#使用命令brew-install-lua安装\" class=\"headerlink\" title=\"使用命令brew install lua安装\"></a>使用命令brew install lua安装</h1><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div></pre></td><td class=\"code\"><pre><div class=\"line\">xionglie@lie-mac:~ $ brew install lua</div><div class=\"line\">==&gt; Downloading http://www.lua.org/ftp/lua-5.1.4.tar.gz</div><div class=\"line\">Already downloaded: /Library/Caches/Homebrew/lua-5.1.4.tar.gz</div><div class=\"line\">==&gt; Patching</div><div class=\"line\">patching file Makefile</div><div class=\"line\">patching file src/Makefile</div><div class=\"line\"><span class=\"comment\">######################################################################## 100.0%</span></div><div class=\"line\">patching file lcode.c</div><div class=\"line\">patching file ldblib.c</div><div class=\"line\">patching file liolib.c</div><div class=\"line\">patching file llex.c</div><div class=\"line\">patching file loadlib.c</div><div class=\"line\">patching file lstrlib.c</div><div class=\"line\">patching file lvm.c</div><div class=\"line\">Error: Permission denied - /usr/<span class=\"built_in\">local</span>/lib/lua</div><div class=\"line\">xionglie@lie-mac:~ $ sudo brew install lua</div><div class=\"line\">Password:</div><div class=\"line\">Error: Cowardly refusing to `sudo brew install<span class=\"string\">'</span></div><div class=\"line\">You can use brew with sudo, but only if the brew executable is owned by root.</div><div class=\"line\">However, this is both not recommended and completely unsupported so do so at</div><div class=\"line\">your own risk.</div><div class=\"line\"></div><div class=\"line\">xionglie@lie-mac:~ $ ls -ld /usr/local/lib</div><div class=\"line\">drwxr-xr-x  5 24561  wheel  170 Feb 18 17:27 /usr/local/lib</div><div class=\"line\">#用户是24561，难道用户已经删除？</div><div class=\"line\">#后面一查确实是权限问题，使用下面两条命令可以解决</div><div class=\"line\">#sudo chown -R xionglie /usr/local/include</div><div class=\"line\">#sudo chown -R xionglie /usr/local/lib/</div><div class=\"line\">xionglie@lie-mac:~ $ ls -ld /usr/local/lib/lua</div><div class=\"line\">ls: /usr/local/lib/lua: No such file or directory</div></pre></td></tr></table></figure>\n<h1 id=\"使用源码安装命令\"><a href=\"#使用源码安装命令\" class=\"headerlink\" title=\"使用源码安装命令\"></a>使用源码安装命令</h1><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">wget http://www.lua.org/ftp/lua-5.2.1.tar.gz</div><div class=\"line\">tar zxf lua-5.2.1.tar.gz </div><div class=\"line\"><span class=\"built_in\">cd</span> lua-5.2.1/src</div><div class=\"line\">make macosx</div><div class=\"line\">sudo cp lua /usr/bin/lua</div></pre></td></tr></table></figure>\n<h1 id=\"测试：\"><a href=\"#测试：\" class=\"headerlink\" title=\"测试：\"></a>测试：</h1><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">xionglie@lie-mac:~ $ lua -v</div><div class=\"line\">Lua 5.2.1  Copyright (C) 1994-2012 Lua.org, PUC-Rio</div><div class=\"line\"></div><div class=\"line\">xionglie@lie-mac:/tmp $ cat test.lua </div><div class=\"line\">-- just <span class=\"built_in\">test</span></div><div class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">\"Hello World\"</span>)</div><div class=\"line\"></div><div class=\"line\">xionglie@lie-mac:/tmp $ lua test.lua </div><div class=\"line\">Hello World</div></pre></td></tr></table></figure>\n<p>-———————————————-</p>\n<h3 id=\"参考：How-Do-I-Install-Lua-on-MacOS\"><a href=\"#参考：How-Do-I-Install-Lua-on-MacOS\" class=\"headerlink\" title=\"参考：How Do I Install Lua on MacOS?\"></a>参考：How Do I Install Lua on MacOS?</h3><p>来源：<a href=\"http://stackoverflow.com/questions/5496003/how-do-i-install-lua-on-macos\" target=\"_blank\" rel=\"external\">http://stackoverflow.com/questions/5496003/how-do-i-install-lua-on-macos</a> </p>\n<p>Compiling from source code is not that painful.<br>Lua 5.1.4 here: <a href=\"http://www.lua.org/ftp/lua-5.1.4.tar.gz\" target=\"_blank\" rel=\"external\">http://www.lua.org/ftp/lua-5.1.4.tar.gz</a> Lua 5.2 alpha here: <a href=\"http://www.lua.org/work/lua-5.2.0-alpha.tar.gz\" target=\"_blank\" rel=\"external\">http://www.lua.org/work/lua-5.2.0-alpha.tar.gz</a></p>\n<p>Take Lua 5.2 as example:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#Open your Terminal.app </span></div><div class=\"line\">wget http://www.lua.org/work/lua-5.2.0-alpha.tar.gz    </div><div class=\"line\">tar xvzf lua-5.2.0-alpha.tar.gz     </div><div class=\"line\"><span class=\"built_in\">cd</span> lua-5.2.0-alpha/src    </div><div class=\"line\">make macosx(I believe you have Xcode installed)      </div><div class=\"line\"><span class=\"comment\">#After that, you can see 'lua' binary under current dir.    </span></div><div class=\"line\">sudo cp lua /usr/bin/lua</div></pre></td></tr></table></figure>\n<p>Now you can enter lua to have a try. :)   </p>\n","excerpt":"<p>下午心血来潮，想在MacOS上安装lua，但使用brew install lua安装lua报错，于是使用源码安装。</p>","more":"<p>lua官网：<a href=\"http://www.lua.org/\">http://www.lua.org/</a></p>\n<h1 id=\"使用命令brew-install-lua安装\"><a href=\"#使用命令brew-install-lua安装\" class=\"headerlink\" title=\"使用命令brew install lua安装\"></a>使用命令brew install lua安装</h1><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div></pre></td><td class=\"code\"><pre><div class=\"line\">xionglie@lie-mac:~ $ brew install lua</div><div class=\"line\">==&gt; Downloading http://www.lua.org/ftp/lua-5.1.4.tar.gz</div><div class=\"line\">Already downloaded: /Library/Caches/Homebrew/lua-5.1.4.tar.gz</div><div class=\"line\">==&gt; Patching</div><div class=\"line\">patching file Makefile</div><div class=\"line\">patching file src/Makefile</div><div class=\"line\"><span class=\"comment\">######################################################################## 100.0%</span></div><div class=\"line\">patching file lcode.c</div><div class=\"line\">patching file ldblib.c</div><div class=\"line\">patching file liolib.c</div><div class=\"line\">patching file llex.c</div><div class=\"line\">patching file loadlib.c</div><div class=\"line\">patching file lstrlib.c</div><div class=\"line\">patching file lvm.c</div><div class=\"line\">Error: Permission denied - /usr/<span class=\"built_in\">local</span>/lib/lua</div><div class=\"line\">xionglie@lie-mac:~ $ sudo brew install lua</div><div class=\"line\">Password:</div><div class=\"line\">Error: Cowardly refusing to `sudo brew install<span class=\"string\">'</div><div class=\"line\">You can use brew with sudo, but only if the brew executable is owned by root.</div><div class=\"line\">However, this is both not recommended and completely unsupported so do so at</div><div class=\"line\">your own risk.</div><div class=\"line\"></div><div class=\"line\">xionglie@lie-mac:~ $ ls -ld /usr/local/lib</div><div class=\"line\">drwxr-xr-x  5 24561  wheel  170 Feb 18 17:27 /usr/local/lib</div><div class=\"line\">#用户是24561，难道用户已经删除？</div><div class=\"line\">#后面一查确实是权限问题，使用下面两条命令可以解决</div><div class=\"line\">#sudo chown -R xionglie /usr/local/include</div><div class=\"line\">#sudo chown -R xionglie /usr/local/lib/</div><div class=\"line\">xionglie@lie-mac:~ $ ls -ld /usr/local/lib/lua</div><div class=\"line\">ls: /usr/local/lib/lua: No such file or directory</span></div></pre></td></tr></table></figure>\n<h1 id=\"使用源码安装命令\"><a href=\"#使用源码安装命令\" class=\"headerlink\" title=\"使用源码安装命令\"></a>使用源码安装命令</h1><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">wget http://www.lua.org/ftp/lua-5.2.1.tar.gz</div><div class=\"line\">tar zxf lua-5.2.1.tar.gz </div><div class=\"line\"><span class=\"built_in\">cd</span> lua-5.2.1/src</div><div class=\"line\">make macosx</div><div class=\"line\">sudo cp lua /usr/bin/lua</div></pre></td></tr></table></figure>\n<h1 id=\"测试：\"><a href=\"#测试：\" class=\"headerlink\" title=\"测试：\"></a>测试：</h1><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">xionglie@lie-mac:~ $ lua -v</div><div class=\"line\">Lua 5.2.1  Copyright (C) 1994-2012 Lua.org, PUC-Rio</div><div class=\"line\"></div><div class=\"line\">xionglie@lie-mac:/tmp $ cat test.lua </div><div class=\"line\">-- just <span class=\"built_in\">test</span></div><div class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">\"Hello World\"</span>)</div><div class=\"line\"></div><div class=\"line\">xionglie@lie-mac:/tmp $ lua test.lua </div><div class=\"line\">Hello World</div></pre></td></tr></table></figure>\n<p>-———————————————-</p>\n<h3 id=\"参考：How-Do-I-Install-Lua-on-MacOS\"><a href=\"#参考：How-Do-I-Install-Lua-on-MacOS\" class=\"headerlink\" title=\"参考：How Do I Install Lua on MacOS?\"></a>参考：How Do I Install Lua on MacOS?</h3><p>来源：<a href=\"http://stackoverflow.com/questions/5496003/how-do-i-install-lua-on-macos\">http://stackoverflow.com/questions/5496003/how-do-i-install-lua-on-macos</a> </p>\n<p>Compiling from source code is not that painful.<br>Lua 5.1.4 here: <a href=\"http://www.lua.org/ftp/lua-5.1.4.tar.gz\">http://www.lua.org/ftp/lua-5.1.4.tar.gz</a> Lua 5.2 alpha here: <a href=\"http://www.lua.org/work/lua-5.2.0-alpha.tar.gz\">http://www.lua.org/work/lua-5.2.0-alpha.tar.gz</a></p>\n<p>Take Lua 5.2 as example:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#Open your Terminal.app </span></div><div class=\"line\">wget http://www.lua.org/work/lua-5.2.0-alpha.tar.gz    </div><div class=\"line\">tar xvzf lua-5.2.0-alpha.tar.gz     </div><div class=\"line\"><span class=\"built_in\">cd</span> lua-5.2.0-alpha/src    </div><div class=\"line\">make macosx(I believe you have Xcode installed)      </div><div class=\"line\"><span class=\"comment\">#After that, you can see 'lua' binary under current dir.    </span></div><div class=\"line\">sudo cp lua /usr/bin/lua</div></pre></td></tr></table></figure>\n<p>Now you can enter lua to have a try. :)   </p>"},{"layout":"post","title":"linux系列3 - 文件与目录权限","date":"2013-07-17T04:45:00.000Z","comments":1,"_content":"\n本文的内容如下： \n\n```  \n1.linux权限表示   \n1.1 数字表示法  \n1.2 字符表示化  \n\n2. linux权限相关命令  \n\t2.1.改变权限属性命令chmod\n\t2.2.改变文件所属关系命令chown  \n\n3.linux文件及目录权限总结   \n4.权限测试前期准备   \n5.测试user1用户浏览非自己拥有的目录/user2的权限  \n```\n\n<!-- more -->\n\n# linux权限表示\n```\n[root@lie-pc ~]# ll \ntotal 60\n-rw------- 1 root root   847 Jul 17 20:43 anaconda-ks.cfg\ndrwxr-xr-x 2 root root  4096 Jul 19 13:51 dir\n-rw-r--r-- 1 root root 36494 Jul 17 20:43 install.log\n-rw-r--r-- 1 root root  3849 Jul 17 20:43 install.log.syslog\n```\n上面第一列的第2个字符开始就是权限位，如anaconda-ks.cfg的rw-------或dir的rwxr-xr-x。 \n\n文件权限概述\t\t\t\t\n9个权限位,每三位分为一组。分别表示owner,group,other用户的权限   \nrwxr--r--\t     \nr读\t  \nw写\t  \nx执行\t  \n- 不可读，不可写，不可执行   \t\n权限位有下面两种表示方法.  \t\n\n## 数字表示法\nchmod [数字组合] 文件名\t\nr\t4\t\nw\t2\t\t\nx\t1\t\n-\t0\t\n\n如：rwxr-xr-x => rwx=4+2+1=7 , r-x=4+0+1=5,故rwxr-xr-x=755。   \n每个三位的权限代码组合：  \n0\t---  \n1\t--x  \n2\t–w-  \n3\t-wx    \n4\tr--\t   \n5\tr-x\t\t\t\n6\trw-\t\t\n7\trwx\t\n\n## 字符表示化\nchmod [用户类型] [+][-][=] 权限字符 文件名\t\t\n用户或用户组定义：u 属主，g 所属用户组, o其它用户，a 全部，包括（ugo）。  \t\t\n权限定义： r 读，w 写，x 执行。\t\t\n权限增减字符：+ 添加某个权限; - 取消某个权限; = 赋予给定权限并取消其它权限。 \n \n\n# linux权限相关命令\n## 改变权限属性命令chmod\n\nchmod改变文件或目录权限的命令，但只有文件属主和超级用户root才有这种权限。 \n \nchmod修改权限两种方式：     \n(1)\t通过字母或操作符表达式  \n(2)\t通过数字  \n\n对于目录权限的设置，要用到-R参数；        \n和数字权限方法一样，如果我们为一个目录及其下的子目录或文件设置相同的属性，就可以用-R参数。 \n\n```\n[root@lie-pc ~]# touch file1\n[root@lie-pc ~]# touch file2\n[root@lie-pc ~]# ll file1 file2 \n-rw-r--r-- 1 root root 0 Jul 20 21:38 file1\n-rw-r--r-- 1 root root 0 Jul 20 21:38 file2\n[root@lie-pc ~]# chmod 755 file1 \n[root@lie-pc ~]# chmod u+x,og+x file2 \n[root@lie-pc ~]# ls -lh file1 file2 \n-rwxr-xr-x 1 root root 0 Jul 20 21:38 file1\n-rwxr-xr-x 1 root root 0 Jul 20 21:38 file2\n#两种方法都能达到相同的目的。\n```\n \n## 改变文件所属关系命令chown\n\n当我们要改变一个文件的属组，我们所使用的用户必须是该文件的属主而且同时是目标属组成员或超级用户。只有超级用户才能改变文件的属主。\n\n-R参数：改变目录下所有文件和目录的所有者和组。\n说明：chown所接的新的属主和新的属组之间应该以.或:连接，属主和属组任意之一可以为空。如果属主为空，应该是 :属组 ,如果属组为空，就不必要.或:了。\n\n\n```\n#chown [选项]… [所有者][:[组]] 文件\n[root@lie-pc ~]# ls -ld /user1\ndrwxr-xr-x 2 user1 user1 4096 Jul 18 12:53 /user1\n[root@lie-pc ~]# chown user1:root /user1  \t#:也可以为.号\n[root@lie-pc ~]# ls -ld /user1\ndrwxr-xr-x 2 user1 root 4096 Jul 18 12:53 /user1\n[root@lie-pc ~]# chown user1 /user1\t\t#只修改用户\n[root@lie-pc ~]# chown .root /user1/file \t#只修改用户组\n注：要修改的用户和组必须是系统中已经存在的。\n```\n\n# linux文件及目录权限总结\n## 普通文件rwx说明\nr 可阅读文件内容的权限;      \nw 新增、修改文件内容的权限；（特别提示：删除、修改、移动目录内文件的权限受父目录的权限控制）；        \nx 文件可被执行的权限    \n## 目录rwx权限说明\nx 进入该目录成为工作目录的权限;\t   \nr 读取目录结构列表的权限;\t   \nw 更改目录结构的权限，也就是有下面一些权限：\t   \n(1)\t新建新的文件与目录;\t   \n(2)\t删除已存在的文件与目录（不论该文件的权限为何）;\t \n(3)\t将已存在的文件或目录进行重命名；\t\n(4)\t转移该目录内的文件、目录位置;\t\n总之目录的w权限与该目录下面的文件名变动有关。\t\n## 文件和目录rwx权限对比\n\nr 读\t\n文件：有阅读文件内容权限\t\n目录：浏览目录的权限(注意：与进入目录权限不同)\t\n\nw 写\t\n文件：新增修改文件内容（注意：删除、修改、移动目录内文件和文件本身属性无关）  \n目录：表示具有删除、移动、修改目录内文件的权限。如果要在目录中创建、移动、删除文件或目录必须有x权限。  \n\nx 执行\t\n文件：执行文件的权限\t\n目录：进入目录的权限。\t\n- 无任何权限\t\n\n特别注意：当删除或移动一个文件或目录时，仅与该文件与目录的上一层目录有关,与该文件本身的属性无关。对文件来说，写文件是修改文件，而不是删除文件，因此写文件与该文件的本身属性有关。\n\n# 权限测试前期准备\n\n\n## 添加两个普通用户：user1, user2\n\n\n```\n[root@lie-pc ~]# useradd user1\n[root@lie-pc ~]# useradd user2\n```\n\n\n## 建立两个目录，并设置归属用户和组\n```\n[root@lie-pc ~]# mkdir /user1\n[root@lie-pc ~]# mkdir /user2\n[root@lie-pc ~]# chown user1.user1 /user1\n[root@lie-pc ~]# chown user2.user2 /user2\n```\n## /user1, /user2目录下分别建file文件\n\n```\n[root@lie-pc ~]# touch /user1/file\n[root@lie-pc ~]# touch /user2/file\n\n #查看新建目录和文件的权限 \n[root@lie-pc ~]# ls -ld /user1 /user2\t\t\t\ndrwxr-xr-x 2 user1 user1 4096 Jul 18 12:53 /user1\ndrwxr-xr-x 2 user2 user2 4096 Jul 18 12:53 /user2\n#目录默认的权限是755\n\n[root@lie-pc ~]# ls -l /user1/file /user2/file    \n-rw-r--r-- 1 root root 0 Jul 18 12:53 /user1/file\n-rw-r--r-- 1 root root 0 Jul 18 12:53 /user2/file\n#文件默认的权限是644\n```\n\n# 测试user1用户浏览非自己拥有的目录/user2的权限\n\n## 用户user1对目录/user2来说属于其它组，所以只看后三位的权限r-x。所以user1对目录/user2有读(浏览目录)和执行(进入目录)的权限。\n\n```\n[root@lie-pc ~]# su - user1\n[user1@lie-pc ~]$ ls -ld /user2\ndrwxr-xr-x 2 user2 user2 4096 Jul 18 12:53 /user2\n\n#用户user1，可以浏览/user2的文件\n[user1@lie-pc ~]$ ls -l /user2\ntotal 0\n-rw-r--r-- 1 root root 0 Jul 18 12:53 file\n\n[user1@lie-pc ~]$ cd /user2/\n[user1@lie-pc user2]$\t\t\t#用户user1，可以进入目录/user2\n\n #user1删除非自身属主的文件权限\n[user1@lie-pc user2]$ rm -f file \nrm: cannot remove `file': Permission denied\n\n#权限修改为777看\n[root@lie-pc ~]# chmod 777 /user2/file \n[root@lie-pc ~]# ls -l /user2\ntotal 0\n-rwxrwxrwx 1 root root 0 Jul 18 12:53 file\n\n[user1@lie-pc user2]$ ll\ntotal 0\n-rwxrwxrwx 1 root root 0 Jul 18 12:53 file\n[user1@lie-pc user2]$ rm -f file\nrm: cannot remove `file': Permission denied\n#还是权限不够\n```\n总结:  \n删除或移动一个文件时，与该文件的上层目录有关，与文件本身的属性无关。即使文件的权限是777也不可以。\n\n```\n[root@lie-pc ~]# chmod 755 /user2\n[root@lie-pc ~]# chmod o+w  /user2\n[root@lie-pc ~]# ls -ld /user2 \ndrwxr-xrwx 2 user2 user2 4096 Jul 18 12:53 /user2\n[root@lie-pc ~]# chmod 644 /user2/file \n[root@lie-pc ~]# ls -l /user2\ntotal 0\n-rw-r--r-- 1 root root 0 Jul 18 12:53 file\n\n[user1@lie-pc ~]$ ls -ld /user2\ndrwxr-xrwx 2 user2 user2 4096 Jul 18 12:53 /user2\n[user1@lie-pc ~]$ ls -l /user2\ntotal 0\n-rw-r--r-- 1 root root 0 Jul 18 12:53 file\n[user1@lie-pc ~]$ cd /user2/\n[user1@lie-pc user2]$ ll\ntotal 0\n-rw-r--r-- 1 root root 0 Jul 18 12:53 file\n[user1@lie-pc user2]$ rm -f file \t\t#删除成功\n\n[root@lie-pc ~]# cd /user2\n[root@lie-pc user2]# touch file2\n[root@lie-pc user2]# chmod 000 file2 \t\t#设置file2无任何权限\n[root@lie-pc user2]# ls -l file2 \n---------- 1 root root 0 Jul 19 12:38 file2\n\n#user1操作\n[user1@lie-pc user2]$ ls -l /user2\ntotal 0\n---------- 1 root root 0 Jul 19 12:38 file2\n[user1@lie-pc user2]$ rm -f file2 \n[user1@lie-pc user2]$ ls -l /user2\t\t#也能删除成功\ntotal 0\n```\n\n## 测试user1仅有w权限是否能删除/user2内的文件\n```\n[root@lie-pc ~]# chmod o=w /user2\t\t#其它用户仅有w权限\n[root@lie-pc ~]# ls -ld /user2\ndrwxr-x-w- 2 user2 user2 4096 Jul 19 12:39 /user2\n[root@lie-pc ~]# touch /user2/file\n[root@lie-pc ~]# ls -l /user2\ntotal 0\n-rw-r--r-- 1 root root 0 Jul 19 12:43 file\n\n#user1操作\n[user1@lie-pc ~]$ ls -l /user2\nls: /user2: Permission denied\n[user1@lie-pc ~]$ cd  /user2 \n-bash: cd: /user2: Permission denied\n[user1@lie-pc ~]$ rm -f /user2/file\nrm: cannot remove `/user2/file': Permission denied\n```\n总结：仅有w权限，user1是无法删除/user2/file的\n\n## user1有rw权限看是否能删除/user2内的文件\n```\n[root@lie-pc ~]# chmod 756 /user2\n[root@lie-pc ~]# ls -ld /user2\ndrwxr-xrw- 2 user2 user2 4096 Jul 19 12:43 /user2\n\n#user1操作\n[user1@lie-pc ~]$ ls -ld /user2/ \ndrwxr-xrw- 2 user2 user2 4096 Jul 19 12:43 /user2/\n[user1@lie-pc ~]$ ls -l /user2/\ntotal 0\n?--------- ? ? ? ?            ? file\n[user1@lie-pc ~]$ rm -f /user2/file \nrm: cannot remove `/user2/file': Permission denied\n```\t\n总结：仅有rw权限，user1依然无法删除/user2/file\n\n```\n\n##测试user1仅有wx权限看是否能删除/user2内的文件\n```\n[root@lie-pc ~]# chmod 753 /user2\n[root@lie-pc ~]# ls -ld /user2\ndrwxr-x-wx 2 user2 user2 4096 Jul 19 12:43 /user2\n[root@lie-pc ~]# ls -l /user2\ntotal 0\n-rw-r--r-- 1 root root 0 Jul 19 12:43 file\n\n#user1操作\n[user1@lie-pc ~]$ ls -ld /user2/\ndrwxr-x-wx 2 user2 user2 4096 Jul 19 12:43 /user2/\n[user1@lie-pc ~]$ ls -l /user2/ \nls: /user2/: Permission denied\n[user1@lie-pc ~]$ cd /user2\n[user1@lie-pc user2]$ rm -f file\t#删除成功\n[user1@lie-pc user2]$ \n```\n\n结论：    \n1）\t删除或移动一个文件，与该文件的上层目录的权限有关，与该文件本身的属性无关，即使是777也不可能删除或移动!     \n2）\t对于目录，可写w表示具有修改或删除目录内文件的权限，但必须同时有x权限才可以。  \n\n\n\n","source":"_posts/2013-07-17-linux-03-permission.md","raw":"---\nlayout: post\ntitle: \"linux系列3 - 文件与目录权限\"\ndate: 2013-07-17 12:45\ncomments: true\ncategories: linux\n---\n\n本文的内容如下： \n\n```  \n1.linux权限表示   \n1.1 数字表示法  \n1.2 字符表示化  \n\n2. linux权限相关命令  \n\t2.1.改变权限属性命令chmod\n\t2.2.改变文件所属关系命令chown  \n\n3.linux文件及目录权限总结   \n4.权限测试前期准备   \n5.测试user1用户浏览非自己拥有的目录/user2的权限  \n```\n\n<!-- more -->\n\n# linux权限表示\n```\n[root@lie-pc ~]# ll \ntotal 60\n-rw------- 1 root root   847 Jul 17 20:43 anaconda-ks.cfg\ndrwxr-xr-x 2 root root  4096 Jul 19 13:51 dir\n-rw-r--r-- 1 root root 36494 Jul 17 20:43 install.log\n-rw-r--r-- 1 root root  3849 Jul 17 20:43 install.log.syslog\n```\n上面第一列的第2个字符开始就是权限位，如anaconda-ks.cfg的rw-------或dir的rwxr-xr-x。 \n\n文件权限概述\t\t\t\t\n9个权限位,每三位分为一组。分别表示owner,group,other用户的权限   \nrwxr--r--\t     \nr读\t  \nw写\t  \nx执行\t  \n- 不可读，不可写，不可执行   \t\n权限位有下面两种表示方法.  \t\n\n## 数字表示法\nchmod [数字组合] 文件名\t\nr\t4\t\nw\t2\t\t\nx\t1\t\n-\t0\t\n\n如：rwxr-xr-x => rwx=4+2+1=7 , r-x=4+0+1=5,故rwxr-xr-x=755。   \n每个三位的权限代码组合：  \n0\t---  \n1\t--x  \n2\t–w-  \n3\t-wx    \n4\tr--\t   \n5\tr-x\t\t\t\n6\trw-\t\t\n7\trwx\t\n\n## 字符表示化\nchmod [用户类型] [+][-][=] 权限字符 文件名\t\t\n用户或用户组定义：u 属主，g 所属用户组, o其它用户，a 全部，包括（ugo）。  \t\t\n权限定义： r 读，w 写，x 执行。\t\t\n权限增减字符：+ 添加某个权限; - 取消某个权限; = 赋予给定权限并取消其它权限。 \n \n\n# linux权限相关命令\n## 改变权限属性命令chmod\n\nchmod改变文件或目录权限的命令，但只有文件属主和超级用户root才有这种权限。 \n \nchmod修改权限两种方式：     \n(1)\t通过字母或操作符表达式  \n(2)\t通过数字  \n\n对于目录权限的设置，要用到-R参数；        \n和数字权限方法一样，如果我们为一个目录及其下的子目录或文件设置相同的属性，就可以用-R参数。 \n\n```\n[root@lie-pc ~]# touch file1\n[root@lie-pc ~]# touch file2\n[root@lie-pc ~]# ll file1 file2 \n-rw-r--r-- 1 root root 0 Jul 20 21:38 file1\n-rw-r--r-- 1 root root 0 Jul 20 21:38 file2\n[root@lie-pc ~]# chmod 755 file1 \n[root@lie-pc ~]# chmod u+x,og+x file2 \n[root@lie-pc ~]# ls -lh file1 file2 \n-rwxr-xr-x 1 root root 0 Jul 20 21:38 file1\n-rwxr-xr-x 1 root root 0 Jul 20 21:38 file2\n#两种方法都能达到相同的目的。\n```\n \n## 改变文件所属关系命令chown\n\n当我们要改变一个文件的属组，我们所使用的用户必须是该文件的属主而且同时是目标属组成员或超级用户。只有超级用户才能改变文件的属主。\n\n-R参数：改变目录下所有文件和目录的所有者和组。\n说明：chown所接的新的属主和新的属组之间应该以.或:连接，属主和属组任意之一可以为空。如果属主为空，应该是 :属组 ,如果属组为空，就不必要.或:了。\n\n\n```\n#chown [选项]… [所有者][:[组]] 文件\n[root@lie-pc ~]# ls -ld /user1\ndrwxr-xr-x 2 user1 user1 4096 Jul 18 12:53 /user1\n[root@lie-pc ~]# chown user1:root /user1  \t#:也可以为.号\n[root@lie-pc ~]# ls -ld /user1\ndrwxr-xr-x 2 user1 root 4096 Jul 18 12:53 /user1\n[root@lie-pc ~]# chown user1 /user1\t\t#只修改用户\n[root@lie-pc ~]# chown .root /user1/file \t#只修改用户组\n注：要修改的用户和组必须是系统中已经存在的。\n```\n\n# linux文件及目录权限总结\n## 普通文件rwx说明\nr 可阅读文件内容的权限;      \nw 新增、修改文件内容的权限；（特别提示：删除、修改、移动目录内文件的权限受父目录的权限控制）；        \nx 文件可被执行的权限    \n## 目录rwx权限说明\nx 进入该目录成为工作目录的权限;\t   \nr 读取目录结构列表的权限;\t   \nw 更改目录结构的权限，也就是有下面一些权限：\t   \n(1)\t新建新的文件与目录;\t   \n(2)\t删除已存在的文件与目录（不论该文件的权限为何）;\t \n(3)\t将已存在的文件或目录进行重命名；\t\n(4)\t转移该目录内的文件、目录位置;\t\n总之目录的w权限与该目录下面的文件名变动有关。\t\n## 文件和目录rwx权限对比\n\nr 读\t\n文件：有阅读文件内容权限\t\n目录：浏览目录的权限(注意：与进入目录权限不同)\t\n\nw 写\t\n文件：新增修改文件内容（注意：删除、修改、移动目录内文件和文件本身属性无关）  \n目录：表示具有删除、移动、修改目录内文件的权限。如果要在目录中创建、移动、删除文件或目录必须有x权限。  \n\nx 执行\t\n文件：执行文件的权限\t\n目录：进入目录的权限。\t\n- 无任何权限\t\n\n特别注意：当删除或移动一个文件或目录时，仅与该文件与目录的上一层目录有关,与该文件本身的属性无关。对文件来说，写文件是修改文件，而不是删除文件，因此写文件与该文件的本身属性有关。\n\n# 权限测试前期准备\n\n\n## 添加两个普通用户：user1, user2\n\n\n```\n[root@lie-pc ~]# useradd user1\n[root@lie-pc ~]# useradd user2\n```\n\n\n## 建立两个目录，并设置归属用户和组\n```\n[root@lie-pc ~]# mkdir /user1\n[root@lie-pc ~]# mkdir /user2\n[root@lie-pc ~]# chown user1.user1 /user1\n[root@lie-pc ~]# chown user2.user2 /user2\n```\n## /user1, /user2目录下分别建file文件\n\n```\n[root@lie-pc ~]# touch /user1/file\n[root@lie-pc ~]# touch /user2/file\n\n #查看新建目录和文件的权限 \n[root@lie-pc ~]# ls -ld /user1 /user2\t\t\t\ndrwxr-xr-x 2 user1 user1 4096 Jul 18 12:53 /user1\ndrwxr-xr-x 2 user2 user2 4096 Jul 18 12:53 /user2\n#目录默认的权限是755\n\n[root@lie-pc ~]# ls -l /user1/file /user2/file    \n-rw-r--r-- 1 root root 0 Jul 18 12:53 /user1/file\n-rw-r--r-- 1 root root 0 Jul 18 12:53 /user2/file\n#文件默认的权限是644\n```\n\n# 测试user1用户浏览非自己拥有的目录/user2的权限\n\n## 用户user1对目录/user2来说属于其它组，所以只看后三位的权限r-x。所以user1对目录/user2有读(浏览目录)和执行(进入目录)的权限。\n\n```\n[root@lie-pc ~]# su - user1\n[user1@lie-pc ~]$ ls -ld /user2\ndrwxr-xr-x 2 user2 user2 4096 Jul 18 12:53 /user2\n\n#用户user1，可以浏览/user2的文件\n[user1@lie-pc ~]$ ls -l /user2\ntotal 0\n-rw-r--r-- 1 root root 0 Jul 18 12:53 file\n\n[user1@lie-pc ~]$ cd /user2/\n[user1@lie-pc user2]$\t\t\t#用户user1，可以进入目录/user2\n\n #user1删除非自身属主的文件权限\n[user1@lie-pc user2]$ rm -f file \nrm: cannot remove `file': Permission denied\n\n#权限修改为777看\n[root@lie-pc ~]# chmod 777 /user2/file \n[root@lie-pc ~]# ls -l /user2\ntotal 0\n-rwxrwxrwx 1 root root 0 Jul 18 12:53 file\n\n[user1@lie-pc user2]$ ll\ntotal 0\n-rwxrwxrwx 1 root root 0 Jul 18 12:53 file\n[user1@lie-pc user2]$ rm -f file\nrm: cannot remove `file': Permission denied\n#还是权限不够\n```\n总结:  \n删除或移动一个文件时，与该文件的上层目录有关，与文件本身的属性无关。即使文件的权限是777也不可以。\n\n```\n[root@lie-pc ~]# chmod 755 /user2\n[root@lie-pc ~]# chmod o+w  /user2\n[root@lie-pc ~]# ls -ld /user2 \ndrwxr-xrwx 2 user2 user2 4096 Jul 18 12:53 /user2\n[root@lie-pc ~]# chmod 644 /user2/file \n[root@lie-pc ~]# ls -l /user2\ntotal 0\n-rw-r--r-- 1 root root 0 Jul 18 12:53 file\n\n[user1@lie-pc ~]$ ls -ld /user2\ndrwxr-xrwx 2 user2 user2 4096 Jul 18 12:53 /user2\n[user1@lie-pc ~]$ ls -l /user2\ntotal 0\n-rw-r--r-- 1 root root 0 Jul 18 12:53 file\n[user1@lie-pc ~]$ cd /user2/\n[user1@lie-pc user2]$ ll\ntotal 0\n-rw-r--r-- 1 root root 0 Jul 18 12:53 file\n[user1@lie-pc user2]$ rm -f file \t\t#删除成功\n\n[root@lie-pc ~]# cd /user2\n[root@lie-pc user2]# touch file2\n[root@lie-pc user2]# chmod 000 file2 \t\t#设置file2无任何权限\n[root@lie-pc user2]# ls -l file2 \n---------- 1 root root 0 Jul 19 12:38 file2\n\n#user1操作\n[user1@lie-pc user2]$ ls -l /user2\ntotal 0\n---------- 1 root root 0 Jul 19 12:38 file2\n[user1@lie-pc user2]$ rm -f file2 \n[user1@lie-pc user2]$ ls -l /user2\t\t#也能删除成功\ntotal 0\n```\n\n## 测试user1仅有w权限是否能删除/user2内的文件\n```\n[root@lie-pc ~]# chmod o=w /user2\t\t#其它用户仅有w权限\n[root@lie-pc ~]# ls -ld /user2\ndrwxr-x-w- 2 user2 user2 4096 Jul 19 12:39 /user2\n[root@lie-pc ~]# touch /user2/file\n[root@lie-pc ~]# ls -l /user2\ntotal 0\n-rw-r--r-- 1 root root 0 Jul 19 12:43 file\n\n#user1操作\n[user1@lie-pc ~]$ ls -l /user2\nls: /user2: Permission denied\n[user1@lie-pc ~]$ cd  /user2 \n-bash: cd: /user2: Permission denied\n[user1@lie-pc ~]$ rm -f /user2/file\nrm: cannot remove `/user2/file': Permission denied\n```\n总结：仅有w权限，user1是无法删除/user2/file的\n\n## user1有rw权限看是否能删除/user2内的文件\n```\n[root@lie-pc ~]# chmod 756 /user2\n[root@lie-pc ~]# ls -ld /user2\ndrwxr-xrw- 2 user2 user2 4096 Jul 19 12:43 /user2\n\n#user1操作\n[user1@lie-pc ~]$ ls -ld /user2/ \ndrwxr-xrw- 2 user2 user2 4096 Jul 19 12:43 /user2/\n[user1@lie-pc ~]$ ls -l /user2/\ntotal 0\n?--------- ? ? ? ?            ? file\n[user1@lie-pc ~]$ rm -f /user2/file \nrm: cannot remove `/user2/file': Permission denied\n```\t\n总结：仅有rw权限，user1依然无法删除/user2/file\n\n```\n\n##测试user1仅有wx权限看是否能删除/user2内的文件\n```\n[root@lie-pc ~]# chmod 753 /user2\n[root@lie-pc ~]# ls -ld /user2\ndrwxr-x-wx 2 user2 user2 4096 Jul 19 12:43 /user2\n[root@lie-pc ~]# ls -l /user2\ntotal 0\n-rw-r--r-- 1 root root 0 Jul 19 12:43 file\n\n#user1操作\n[user1@lie-pc ~]$ ls -ld /user2/\ndrwxr-x-wx 2 user2 user2 4096 Jul 19 12:43 /user2/\n[user1@lie-pc ~]$ ls -l /user2/ \nls: /user2/: Permission denied\n[user1@lie-pc ~]$ cd /user2\n[user1@lie-pc user2]$ rm -f file\t#删除成功\n[user1@lie-pc user2]$ \n```\n\n结论：    \n1）\t删除或移动一个文件，与该文件的上层目录的权限有关，与该文件本身的属性无关，即使是777也不可能删除或移动!     \n2）\t对于目录，可写w表示具有修改或删除目录内文件的权限，但必须同时有x权限才可以。  \n\n\n\n","slug":"linux-03-permission","published":1,"updated":"2017-01-26T15:54:46.000Z","photos":[],"link":"","_id":"ciyf7fkbg000xf2jylf0dylj8","content":"<p>本文的内容如下： </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">1.linux权限表示   </div><div class=\"line\">1.1 数字表示法  </div><div class=\"line\">1.2 字符表示化  </div><div class=\"line\"></div><div class=\"line\">2. linux权限相关命令  </div><div class=\"line\">\t2.1.改变权限属性命令chmod</div><div class=\"line\">\t2.2.改变文件所属关系命令chown  </div><div class=\"line\"></div><div class=\"line\">3.linux文件及目录权限总结   </div><div class=\"line\">4.权限测试前期准备   </div><div class=\"line\">5.测试user1用户浏览非自己拥有的目录/user2的权限</div></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<h1 id=\"linux权限表示\"><a href=\"#linux权限表示\" class=\"headerlink\" title=\"linux权限表示\"></a>linux权限表示</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# ll </div><div class=\"line\">total 60</div><div class=\"line\">-rw------- 1 root root   847 Jul 17 20:43 anaconda-ks.cfg</div><div class=\"line\">drwxr-xr-x 2 root root  4096 Jul 19 13:51 dir</div><div class=\"line\">-rw-r--r-- 1 root root 36494 Jul 17 20:43 install.log</div><div class=\"line\">-rw-r--r-- 1 root root  3849 Jul 17 20:43 install.log.syslog</div></pre></td></tr></table></figure>\n<p>上面第一列的第2个字符开始就是权限位，如anaconda-ks.cfg的rw——-或dir的rwxr-xr-x。 </p>\n<p>文件权限概述<br>9个权限位,每三位分为一组。分别表示owner,group,other用户的权限<br>rwxr–r–<br>r读<br>w写<br>x执行      </p>\n<ul>\n<li>不可读，不可写，不可执行<br>权限位有下面两种表示方法.      </li>\n</ul>\n<h2 id=\"数字表示法\"><a href=\"#数字表示法\" class=\"headerlink\" title=\"数字表示法\"></a>数字表示法</h2><p>chmod [数字组合] 文件名<br>r    4<br>w    2<br>x    1    </p>\n<ul>\n<li>0    </li>\n</ul>\n<p>如：rwxr-xr-x =&gt; rwx=4+2+1=7 , r-x=4+0+1=5,故rwxr-xr-x=755。<br>每个三位的权限代码组合：<br>0    —<br>1    –x<br>2    –w-<br>3    -wx<br>4    r–<br>5    r-x<br>6    rw-<br>7    rwx    </p>\n<h2 id=\"字符表示化\"><a href=\"#字符表示化\" class=\"headerlink\" title=\"字符表示化\"></a>字符表示化</h2><p>chmod [用户类型] [+][-][=] 权限字符 文件名<br>用户或用户组定义：u 属主，g 所属用户组, o其它用户，a 全部，包括（ugo）。<br>权限定义： r 读，w 写，x 执行。<br>权限增减字符：+ 添加某个权限; - 取消某个权限; = 赋予给定权限并取消其它权限。 </p>\n<h1 id=\"linux权限相关命令\"><a href=\"#linux权限相关命令\" class=\"headerlink\" title=\"linux权限相关命令\"></a>linux权限相关命令</h1><h2 id=\"改变权限属性命令chmod\"><a href=\"#改变权限属性命令chmod\" class=\"headerlink\" title=\"改变权限属性命令chmod\"></a>改变权限属性命令chmod</h2><p>chmod改变文件或目录权限的命令，但只有文件属主和超级用户root才有这种权限。 </p>\n<p>chmod修改权限两种方式：<br>(1)    通过字母或操作符表达式<br>(2)    通过数字  </p>\n<p>对于目录权限的设置，要用到-R参数；<br>和数字权限方法一样，如果我们为一个目录及其下的子目录或文件设置相同的属性，就可以用-R参数。 </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# touch file1</div><div class=\"line\">[root@lie-pc ~]# touch file2</div><div class=\"line\">[root@lie-pc ~]# ll file1 file2 </div><div class=\"line\">-rw-r--r-- 1 root root 0 Jul 20 21:38 file1</div><div class=\"line\">-rw-r--r-- 1 root root 0 Jul 20 21:38 file2</div><div class=\"line\">[root@lie-pc ~]# chmod 755 file1 </div><div class=\"line\">[root@lie-pc ~]# chmod u+x,og+x file2 </div><div class=\"line\">[root@lie-pc ~]# ls -lh file1 file2 </div><div class=\"line\">-rwxr-xr-x 1 root root 0 Jul 20 21:38 file1</div><div class=\"line\">-rwxr-xr-x 1 root root 0 Jul 20 21:38 file2</div><div class=\"line\">#两种方法都能达到相同的目的。</div></pre></td></tr></table></figure>\n<h2 id=\"改变文件所属关系命令chown\"><a href=\"#改变文件所属关系命令chown\" class=\"headerlink\" title=\"改变文件所属关系命令chown\"></a>改变文件所属关系命令chown</h2><p>当我们要改变一个文件的属组，我们所使用的用户必须是该文件的属主而且同时是目标属组成员或超级用户。只有超级用户才能改变文件的属主。</p>\n<p>-R参数：改变目录下所有文件和目录的所有者和组。<br>说明：chown所接的新的属主和新的属组之间应该以.或:连接，属主和属组任意之一可以为空。如果属主为空，应该是 :属组 ,如果属组为空，就不必要.或:了。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">#chown [选项]… [所有者][:[组]] 文件</div><div class=\"line\">[root@lie-pc ~]# ls -ld /user1</div><div class=\"line\">drwxr-xr-x 2 user1 user1 4096 Jul 18 12:53 /user1</div><div class=\"line\">[root@lie-pc ~]# chown user1:root /user1  \t#:也可以为.号</div><div class=\"line\">[root@lie-pc ~]# ls -ld /user1</div><div class=\"line\">drwxr-xr-x 2 user1 root 4096 Jul 18 12:53 /user1</div><div class=\"line\">[root@lie-pc ~]# chown user1 /user1\t\t#只修改用户</div><div class=\"line\">[root@lie-pc ~]# chown .root /user1/file \t#只修改用户组</div><div class=\"line\">注：要修改的用户和组必须是系统中已经存在的。</div></pre></td></tr></table></figure>\n<h1 id=\"linux文件及目录权限总结\"><a href=\"#linux文件及目录权限总结\" class=\"headerlink\" title=\"linux文件及目录权限总结\"></a>linux文件及目录权限总结</h1><h2 id=\"普通文件rwx说明\"><a href=\"#普通文件rwx说明\" class=\"headerlink\" title=\"普通文件rwx说明\"></a>普通文件rwx说明</h2><p>r 可阅读文件内容的权限;<br>w 新增、修改文件内容的权限；（特别提示：删除、修改、移动目录内文件的权限受父目录的权限控制）；<br>x 文件可被执行的权限    </p>\n<h2 id=\"目录rwx权限说明\"><a href=\"#目录rwx权限说明\" class=\"headerlink\" title=\"目录rwx权限说明\"></a>目录rwx权限说明</h2><p>x 进入该目录成为工作目录的权限;<br>r 读取目录结构列表的权限;<br>w 更改目录结构的权限，也就是有下面一些权限：<br>(1)    新建新的文件与目录;<br>(2)    删除已存在的文件与目录（不论该文件的权限为何）;<br>(3)    将已存在的文件或目录进行重命名；<br>(4)    转移该目录内的文件、目录位置;<br>总之目录的w权限与该目录下面的文件名变动有关。    </p>\n<h2 id=\"文件和目录rwx权限对比\"><a href=\"#文件和目录rwx权限对比\" class=\"headerlink\" title=\"文件和目录rwx权限对比\"></a>文件和目录rwx权限对比</h2><p>r 读<br>文件：有阅读文件内容权限<br>目录：浏览目录的权限(注意：与进入目录权限不同)    </p>\n<p>w 写<br>文件：新增修改文件内容（注意：删除、修改、移动目录内文件和文件本身属性无关）<br>目录：表示具有删除、移动、修改目录内文件的权限。如果要在目录中创建、移动、删除文件或目录必须有x权限。  </p>\n<p>x 执行<br>文件：执行文件的权限<br>目录：进入目录的权限。    </p>\n<ul>\n<li>无任何权限    </li>\n</ul>\n<p>特别注意：当删除或移动一个文件或目录时，仅与该文件与目录的上一层目录有关,与该文件本身的属性无关。对文件来说，写文件是修改文件，而不是删除文件，因此写文件与该文件的本身属性有关。</p>\n<h1 id=\"权限测试前期准备\"><a href=\"#权限测试前期准备\" class=\"headerlink\" title=\"权限测试前期准备\"></a>权限测试前期准备</h1><h2 id=\"添加两个普通用户：user1-user2\"><a href=\"#添加两个普通用户：user1-user2\" class=\"headerlink\" title=\"添加两个普通用户：user1, user2\"></a>添加两个普通用户：user1, user2</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# useradd user1</div><div class=\"line\">[root@lie-pc ~]# useradd user2</div></pre></td></tr></table></figure>\n<h2 id=\"建立两个目录，并设置归属用户和组\"><a href=\"#建立两个目录，并设置归属用户和组\" class=\"headerlink\" title=\"建立两个目录，并设置归属用户和组\"></a>建立两个目录，并设置归属用户和组</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# mkdir /user1</div><div class=\"line\">[root@lie-pc ~]# mkdir /user2</div><div class=\"line\">[root@lie-pc ~]# chown user1.user1 /user1</div><div class=\"line\">[root@lie-pc ~]# chown user2.user2 /user2</div></pre></td></tr></table></figure>\n<h2 id=\"user1-user2目录下分别建file文件\"><a href=\"#user1-user2目录下分别建file文件\" class=\"headerlink\" title=\"/user1, /user2目录下分别建file文件\"></a>/user1, /user2目录下分别建file文件</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# touch /user1/file</div><div class=\"line\">[root@lie-pc ~]# touch /user2/file</div><div class=\"line\"></div><div class=\"line\"> #查看新建目录和文件的权限 </div><div class=\"line\">[root@lie-pc ~]# ls -ld /user1 /user2\t\t\t</div><div class=\"line\">drwxr-xr-x 2 user1 user1 4096 Jul 18 12:53 /user1</div><div class=\"line\">drwxr-xr-x 2 user2 user2 4096 Jul 18 12:53 /user2</div><div class=\"line\">#目录默认的权限是755</div><div class=\"line\"></div><div class=\"line\">[root@lie-pc ~]# ls -l /user1/file /user2/file    </div><div class=\"line\">-rw-r--r-- 1 root root 0 Jul 18 12:53 /user1/file</div><div class=\"line\">-rw-r--r-- 1 root root 0 Jul 18 12:53 /user2/file</div><div class=\"line\">#文件默认的权限是644</div></pre></td></tr></table></figure>\n<h1 id=\"测试user1用户浏览非自己拥有的目录-user2的权限\"><a href=\"#测试user1用户浏览非自己拥有的目录-user2的权限\" class=\"headerlink\" title=\"测试user1用户浏览非自己拥有的目录/user2的权限\"></a>测试user1用户浏览非自己拥有的目录/user2的权限</h1><h2 id=\"用户user1对目录-user2来说属于其它组，所以只看后三位的权限r-x。所以user1对目录-user2有读-浏览目录-和执行-进入目录-的权限。\"><a href=\"#用户user1对目录-user2来说属于其它组，所以只看后三位的权限r-x。所以user1对目录-user2有读-浏览目录-和执行-进入目录-的权限。\" class=\"headerlink\" title=\"用户user1对目录/user2来说属于其它组，所以只看后三位的权限r-x。所以user1对目录/user2有读(浏览目录)和执行(进入目录)的权限。\"></a>用户user1对目录/user2来说属于其它组，所以只看后三位的权限r-x。所以user1对目录/user2有读(浏览目录)和执行(进入目录)的权限。</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# su - user1</div><div class=\"line\">[user1@lie-pc ~]$ ls -ld /user2</div><div class=\"line\">drwxr-xr-x 2 user2 user2 4096 Jul 18 12:53 /user2</div><div class=\"line\"></div><div class=\"line\">#用户user1，可以浏览/user2的文件</div><div class=\"line\">[user1@lie-pc ~]$ ls -l /user2</div><div class=\"line\">total 0</div><div class=\"line\">-rw-r--r-- 1 root root 0 Jul 18 12:53 file</div><div class=\"line\"></div><div class=\"line\">[user1@lie-pc ~]$ cd /user2/</div><div class=\"line\">[user1@lie-pc user2]$\t\t\t#用户user1，可以进入目录/user2</div><div class=\"line\"></div><div class=\"line\"> #user1删除非自身属主的文件权限</div><div class=\"line\">[user1@lie-pc user2]$ rm -f file </div><div class=\"line\">rm: cannot remove `file&apos;: Permission denied</div><div class=\"line\"></div><div class=\"line\">#权限修改为777看</div><div class=\"line\">[root@lie-pc ~]# chmod 777 /user2/file </div><div class=\"line\">[root@lie-pc ~]# ls -l /user2</div><div class=\"line\">total 0</div><div class=\"line\">-rwxrwxrwx 1 root root 0 Jul 18 12:53 file</div><div class=\"line\"></div><div class=\"line\">[user1@lie-pc user2]$ ll</div><div class=\"line\">total 0</div><div class=\"line\">-rwxrwxrwx 1 root root 0 Jul 18 12:53 file</div><div class=\"line\">[user1@lie-pc user2]$ rm -f file</div><div class=\"line\">rm: cannot remove `file&apos;: Permission denied</div><div class=\"line\">#还是权限不够</div></pre></td></tr></table></figure>\n<p>总结:<br>删除或移动一个文件时，与该文件的上层目录有关，与文件本身的属性无关。即使文件的权限是777也不可以。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# chmod 755 /user2</div><div class=\"line\">[root@lie-pc ~]# chmod o+w  /user2</div><div class=\"line\">[root@lie-pc ~]# ls -ld /user2 </div><div class=\"line\">drwxr-xrwx 2 user2 user2 4096 Jul 18 12:53 /user2</div><div class=\"line\">[root@lie-pc ~]# chmod 644 /user2/file </div><div class=\"line\">[root@lie-pc ~]# ls -l /user2</div><div class=\"line\">total 0</div><div class=\"line\">-rw-r--r-- 1 root root 0 Jul 18 12:53 file</div><div class=\"line\"></div><div class=\"line\">[user1@lie-pc ~]$ ls -ld /user2</div><div class=\"line\">drwxr-xrwx 2 user2 user2 4096 Jul 18 12:53 /user2</div><div class=\"line\">[user1@lie-pc ~]$ ls -l /user2</div><div class=\"line\">total 0</div><div class=\"line\">-rw-r--r-- 1 root root 0 Jul 18 12:53 file</div><div class=\"line\">[user1@lie-pc ~]$ cd /user2/</div><div class=\"line\">[user1@lie-pc user2]$ ll</div><div class=\"line\">total 0</div><div class=\"line\">-rw-r--r-- 1 root root 0 Jul 18 12:53 file</div><div class=\"line\">[user1@lie-pc user2]$ rm -f file \t\t#删除成功</div><div class=\"line\"></div><div class=\"line\">[root@lie-pc ~]# cd /user2</div><div class=\"line\">[root@lie-pc user2]# touch file2</div><div class=\"line\">[root@lie-pc user2]# chmod 000 file2 \t\t#设置file2无任何权限</div><div class=\"line\">[root@lie-pc user2]# ls -l file2 </div><div class=\"line\">---------- 1 root root 0 Jul 19 12:38 file2</div><div class=\"line\"></div><div class=\"line\">#user1操作</div><div class=\"line\">[user1@lie-pc user2]$ ls -l /user2</div><div class=\"line\">total 0</div><div class=\"line\">---------- 1 root root 0 Jul 19 12:38 file2</div><div class=\"line\">[user1@lie-pc user2]$ rm -f file2 </div><div class=\"line\">[user1@lie-pc user2]$ ls -l /user2\t\t#也能删除成功</div><div class=\"line\">total 0</div></pre></td></tr></table></figure>\n<h2 id=\"测试user1仅有w权限是否能删除-user2内的文件\"><a href=\"#测试user1仅有w权限是否能删除-user2内的文件\" class=\"headerlink\" title=\"测试user1仅有w权限是否能删除/user2内的文件\"></a>测试user1仅有w权限是否能删除/user2内的文件</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# chmod o=w /user2\t\t#其它用户仅有w权限</div><div class=\"line\">[root@lie-pc ~]# ls -ld /user2</div><div class=\"line\">drwxr-x-w- 2 user2 user2 4096 Jul 19 12:39 /user2</div><div class=\"line\">[root@lie-pc ~]# touch /user2/file</div><div class=\"line\">[root@lie-pc ~]# ls -l /user2</div><div class=\"line\">total 0</div><div class=\"line\">-rw-r--r-- 1 root root 0 Jul 19 12:43 file</div><div class=\"line\"></div><div class=\"line\">#user1操作</div><div class=\"line\">[user1@lie-pc ~]$ ls -l /user2</div><div class=\"line\">ls: /user2: Permission denied</div><div class=\"line\">[user1@lie-pc ~]$ cd  /user2 </div><div class=\"line\">-bash: cd: /user2: Permission denied</div><div class=\"line\">[user1@lie-pc ~]$ rm -f /user2/file</div><div class=\"line\">rm: cannot remove `/user2/file&apos;: Permission denied</div></pre></td></tr></table></figure>\n<p>总结：仅有w权限，user1是无法删除/user2/file的</p>\n<h2 id=\"user1有rw权限看是否能删除-user2内的文件\"><a href=\"#user1有rw权限看是否能删除-user2内的文件\" class=\"headerlink\" title=\"user1有rw权限看是否能删除/user2内的文件\"></a>user1有rw权限看是否能删除/user2内的文件</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# chmod 756 /user2</div><div class=\"line\">[root@lie-pc ~]# ls -ld /user2</div><div class=\"line\">drwxr-xrw- 2 user2 user2 4096 Jul 19 12:43 /user2</div><div class=\"line\"></div><div class=\"line\">#user1操作</div><div class=\"line\">[user1@lie-pc ~]$ ls -ld /user2/ </div><div class=\"line\">drwxr-xrw- 2 user2 user2 4096 Jul 19 12:43 /user2/</div><div class=\"line\">[user1@lie-pc ~]$ ls -l /user2/</div><div class=\"line\">total 0</div><div class=\"line\">?--------- ? ? ? ?            ? file</div><div class=\"line\">[user1@lie-pc ~]$ rm -f /user2/file </div><div class=\"line\">rm: cannot remove `/user2/file&apos;: Permission denied</div><div class=\"line\">```\t</div><div class=\"line\">总结：仅有rw权限，user1依然无法删除/user2/file</div></pre></td></tr></table></figure>\n<p>##测试user1仅有wx权限看是否能删除/user2内的文件<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# chmod 753 /user2</div><div class=\"line\">[root@lie-pc ~]# ls -ld /user2</div><div class=\"line\">drwxr-x-wx 2 user2 user2 4096 Jul 19 12:43 /user2</div><div class=\"line\">[root@lie-pc ~]# ls -l /user2</div><div class=\"line\">total 0</div><div class=\"line\">-rw-r--r-- 1 root root 0 Jul 19 12:43 file</div><div class=\"line\"></div><div class=\"line\">#user1操作</div><div class=\"line\">[user1@lie-pc ~]$ ls -ld /user2/</div><div class=\"line\">drwxr-x-wx 2 user2 user2 4096 Jul 19 12:43 /user2/</div><div class=\"line\">[user1@lie-pc ~]$ ls -l /user2/ </div><div class=\"line\">ls: /user2/: Permission denied</div><div class=\"line\">[user1@lie-pc ~]$ cd /user2</div><div class=\"line\">[user1@lie-pc user2]$ rm -f file\t#删除成功</div><div class=\"line\">[user1@lie-pc user2]$</div></pre></td></tr></table></figure></p>\n<p>结论：<br>1）    删除或移动一个文件，与该文件的上层目录的权限有关，与该文件本身的属性无关，即使是777也不可能删除或移动!<br>2）    对于目录，可写w表示具有修改或删除目录内文件的权限，但必须同时有x权限才可以。  </p>\n","excerpt":"<p>本文的内容如下： </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">1.linux权限表示   </div><div class=\"line\">1.1 数字表示法  </div><div class=\"line\">1.2 字符表示化  </div><div class=\"line\"></div><div class=\"line\">2. linux权限相关命令  </div><div class=\"line\">\t2.1.改变权限属性命令chmod</div><div class=\"line\">\t2.2.改变文件所属关系命令chown  </div><div class=\"line\"></div><div class=\"line\">3.linux文件及目录权限总结   </div><div class=\"line\">4.权限测试前期准备   </div><div class=\"line\">5.测试user1用户浏览非自己拥有的目录/user2的权限</div></pre></td></tr></table></figure>","more":"<h1 id=\"linux权限表示\"><a href=\"#linux权限表示\" class=\"headerlink\" title=\"linux权限表示\"></a>linux权限表示</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# ll </div><div class=\"line\">total 60</div><div class=\"line\">-rw------- 1 root root   847 Jul 17 20:43 anaconda-ks.cfg</div><div class=\"line\">drwxr-xr-x 2 root root  4096 Jul 19 13:51 dir</div><div class=\"line\">-rw-r--r-- 1 root root 36494 Jul 17 20:43 install.log</div><div class=\"line\">-rw-r--r-- 1 root root  3849 Jul 17 20:43 install.log.syslog</div></pre></td></tr></table></figure>\n<p>上面第一列的第2个字符开始就是权限位，如anaconda-ks.cfg的rw——-或dir的rwxr-xr-x。 </p>\n<p>文件权限概述<br>9个权限位,每三位分为一组。分别表示owner,group,other用户的权限<br>rwxr–r–<br>r读<br>w写<br>x执行      </p>\n<ul>\n<li>不可读，不可写，不可执行<br>权限位有下面两种表示方法.      </li>\n</ul>\n<h2 id=\"数字表示法\"><a href=\"#数字表示法\" class=\"headerlink\" title=\"数字表示法\"></a>数字表示法</h2><p>chmod [数字组合] 文件名<br>r    4<br>w    2<br>x    1    </p>\n<ul>\n<li>0    </li>\n</ul>\n<p>如：rwxr-xr-x =&gt; rwx=4+2+1=7 , r-x=4+0+1=5,故rwxr-xr-x=755。<br>每个三位的权限代码组合：<br>0    —<br>1    –x<br>2    –w-<br>3    -wx<br>4    r–<br>5    r-x<br>6    rw-<br>7    rwx    </p>\n<h2 id=\"字符表示化\"><a href=\"#字符表示化\" class=\"headerlink\" title=\"字符表示化\"></a>字符表示化</h2><p>chmod [用户类型] [+][-][=] 权限字符 文件名<br>用户或用户组定义：u 属主，g 所属用户组, o其它用户，a 全部，包括（ugo）。<br>权限定义： r 读，w 写，x 执行。<br>权限增减字符：+ 添加某个权限; - 取消某个权限; = 赋予给定权限并取消其它权限。 </p>\n<h1 id=\"linux权限相关命令\"><a href=\"#linux权限相关命令\" class=\"headerlink\" title=\"linux权限相关命令\"></a>linux权限相关命令</h1><h2 id=\"改变权限属性命令chmod\"><a href=\"#改变权限属性命令chmod\" class=\"headerlink\" title=\"改变权限属性命令chmod\"></a>改变权限属性命令chmod</h2><p>chmod改变文件或目录权限的命令，但只有文件属主和超级用户root才有这种权限。 </p>\n<p>chmod修改权限两种方式：<br>(1)    通过字母或操作符表达式<br>(2)    通过数字  </p>\n<p>对于目录权限的设置，要用到-R参数；<br>和数字权限方法一样，如果我们为一个目录及其下的子目录或文件设置相同的属性，就可以用-R参数。 </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# touch file1</div><div class=\"line\">[root@lie-pc ~]# touch file2</div><div class=\"line\">[root@lie-pc ~]# ll file1 file2 </div><div class=\"line\">-rw-r--r-- 1 root root 0 Jul 20 21:38 file1</div><div class=\"line\">-rw-r--r-- 1 root root 0 Jul 20 21:38 file2</div><div class=\"line\">[root@lie-pc ~]# chmod 755 file1 </div><div class=\"line\">[root@lie-pc ~]# chmod u+x,og+x file2 </div><div class=\"line\">[root@lie-pc ~]# ls -lh file1 file2 </div><div class=\"line\">-rwxr-xr-x 1 root root 0 Jul 20 21:38 file1</div><div class=\"line\">-rwxr-xr-x 1 root root 0 Jul 20 21:38 file2</div><div class=\"line\">#两种方法都能达到相同的目的。</div></pre></td></tr></table></figure>\n<h2 id=\"改变文件所属关系命令chown\"><a href=\"#改变文件所属关系命令chown\" class=\"headerlink\" title=\"改变文件所属关系命令chown\"></a>改变文件所属关系命令chown</h2><p>当我们要改变一个文件的属组，我们所使用的用户必须是该文件的属主而且同时是目标属组成员或超级用户。只有超级用户才能改变文件的属主。</p>\n<p>-R参数：改变目录下所有文件和目录的所有者和组。<br>说明：chown所接的新的属主和新的属组之间应该以.或:连接，属主和属组任意之一可以为空。如果属主为空，应该是 :属组 ,如果属组为空，就不必要.或:了。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">#chown [选项]… [所有者][:[组]] 文件</div><div class=\"line\">[root@lie-pc ~]# ls -ld /user1</div><div class=\"line\">drwxr-xr-x 2 user1 user1 4096 Jul 18 12:53 /user1</div><div class=\"line\">[root@lie-pc ~]# chown user1:root /user1  \t#:也可以为.号</div><div class=\"line\">[root@lie-pc ~]# ls -ld /user1</div><div class=\"line\">drwxr-xr-x 2 user1 root 4096 Jul 18 12:53 /user1</div><div class=\"line\">[root@lie-pc ~]# chown user1 /user1\t\t#只修改用户</div><div class=\"line\">[root@lie-pc ~]# chown .root /user1/file \t#只修改用户组</div><div class=\"line\">注：要修改的用户和组必须是系统中已经存在的。</div></pre></td></tr></table></figure>\n<h1 id=\"linux文件及目录权限总结\"><a href=\"#linux文件及目录权限总结\" class=\"headerlink\" title=\"linux文件及目录权限总结\"></a>linux文件及目录权限总结</h1><h2 id=\"普通文件rwx说明\"><a href=\"#普通文件rwx说明\" class=\"headerlink\" title=\"普通文件rwx说明\"></a>普通文件rwx说明</h2><p>r 可阅读文件内容的权限;<br>w 新增、修改文件内容的权限；（特别提示：删除、修改、移动目录内文件的权限受父目录的权限控制）；<br>x 文件可被执行的权限    </p>\n<h2 id=\"目录rwx权限说明\"><a href=\"#目录rwx权限说明\" class=\"headerlink\" title=\"目录rwx权限说明\"></a>目录rwx权限说明</h2><p>x 进入该目录成为工作目录的权限;<br>r 读取目录结构列表的权限;<br>w 更改目录结构的权限，也就是有下面一些权限：<br>(1)    新建新的文件与目录;<br>(2)    删除已存在的文件与目录（不论该文件的权限为何）;<br>(3)    将已存在的文件或目录进行重命名；<br>(4)    转移该目录内的文件、目录位置;<br>总之目录的w权限与该目录下面的文件名变动有关。    </p>\n<h2 id=\"文件和目录rwx权限对比\"><a href=\"#文件和目录rwx权限对比\" class=\"headerlink\" title=\"文件和目录rwx权限对比\"></a>文件和目录rwx权限对比</h2><p>r 读<br>文件：有阅读文件内容权限<br>目录：浏览目录的权限(注意：与进入目录权限不同)    </p>\n<p>w 写<br>文件：新增修改文件内容（注意：删除、修改、移动目录内文件和文件本身属性无关）<br>目录：表示具有删除、移动、修改目录内文件的权限。如果要在目录中创建、移动、删除文件或目录必须有x权限。  </p>\n<p>x 执行<br>文件：执行文件的权限<br>目录：进入目录的权限。    </p>\n<ul>\n<li>无任何权限    </li>\n</ul>\n<p>特别注意：当删除或移动一个文件或目录时，仅与该文件与目录的上一层目录有关,与该文件本身的属性无关。对文件来说，写文件是修改文件，而不是删除文件，因此写文件与该文件的本身属性有关。</p>\n<h1 id=\"权限测试前期准备\"><a href=\"#权限测试前期准备\" class=\"headerlink\" title=\"权限测试前期准备\"></a>权限测试前期准备</h1><h2 id=\"添加两个普通用户：user1-user2\"><a href=\"#添加两个普通用户：user1-user2\" class=\"headerlink\" title=\"添加两个普通用户：user1, user2\"></a>添加两个普通用户：user1, user2</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# useradd user1</div><div class=\"line\">[root@lie-pc ~]# useradd user2</div></pre></td></tr></table></figure>\n<h2 id=\"建立两个目录，并设置归属用户和组\"><a href=\"#建立两个目录，并设置归属用户和组\" class=\"headerlink\" title=\"建立两个目录，并设置归属用户和组\"></a>建立两个目录，并设置归属用户和组</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# mkdir /user1</div><div class=\"line\">[root@lie-pc ~]# mkdir /user2</div><div class=\"line\">[root@lie-pc ~]# chown user1.user1 /user1</div><div class=\"line\">[root@lie-pc ~]# chown user2.user2 /user2</div></pre></td></tr></table></figure>\n<h2 id=\"user1-user2目录下分别建file文件\"><a href=\"#user1-user2目录下分别建file文件\" class=\"headerlink\" title=\"/user1, /user2目录下分别建file文件\"></a>/user1, /user2目录下分别建file文件</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# touch /user1/file</div><div class=\"line\">[root@lie-pc ~]# touch /user2/file</div><div class=\"line\"></div><div class=\"line\"> #查看新建目录和文件的权限 </div><div class=\"line\">[root@lie-pc ~]# ls -ld /user1 /user2\t\t\t</div><div class=\"line\">drwxr-xr-x 2 user1 user1 4096 Jul 18 12:53 /user1</div><div class=\"line\">drwxr-xr-x 2 user2 user2 4096 Jul 18 12:53 /user2</div><div class=\"line\">#目录默认的权限是755</div><div class=\"line\"></div><div class=\"line\">[root@lie-pc ~]# ls -l /user1/file /user2/file    </div><div class=\"line\">-rw-r--r-- 1 root root 0 Jul 18 12:53 /user1/file</div><div class=\"line\">-rw-r--r-- 1 root root 0 Jul 18 12:53 /user2/file</div><div class=\"line\">#文件默认的权限是644</div></pre></td></tr></table></figure>\n<h1 id=\"测试user1用户浏览非自己拥有的目录-user2的权限\"><a href=\"#测试user1用户浏览非自己拥有的目录-user2的权限\" class=\"headerlink\" title=\"测试user1用户浏览非自己拥有的目录/user2的权限\"></a>测试user1用户浏览非自己拥有的目录/user2的权限</h1><h2 id=\"用户user1对目录-user2来说属于其它组，所以只看后三位的权限r-x。所以user1对目录-user2有读-浏览目录-和执行-进入目录-的权限。\"><a href=\"#用户user1对目录-user2来说属于其它组，所以只看后三位的权限r-x。所以user1对目录-user2有读-浏览目录-和执行-进入目录-的权限。\" class=\"headerlink\" title=\"用户user1对目录/user2来说属于其它组，所以只看后三位的权限r-x。所以user1对目录/user2有读(浏览目录)和执行(进入目录)的权限。\"></a>用户user1对目录/user2来说属于其它组，所以只看后三位的权限r-x。所以user1对目录/user2有读(浏览目录)和执行(进入目录)的权限。</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# su - user1</div><div class=\"line\">[user1@lie-pc ~]$ ls -ld /user2</div><div class=\"line\">drwxr-xr-x 2 user2 user2 4096 Jul 18 12:53 /user2</div><div class=\"line\"></div><div class=\"line\">#用户user1，可以浏览/user2的文件</div><div class=\"line\">[user1@lie-pc ~]$ ls -l /user2</div><div class=\"line\">total 0</div><div class=\"line\">-rw-r--r-- 1 root root 0 Jul 18 12:53 file</div><div class=\"line\"></div><div class=\"line\">[user1@lie-pc ~]$ cd /user2/</div><div class=\"line\">[user1@lie-pc user2]$\t\t\t#用户user1，可以进入目录/user2</div><div class=\"line\"></div><div class=\"line\"> #user1删除非自身属主的文件权限</div><div class=\"line\">[user1@lie-pc user2]$ rm -f file </div><div class=\"line\">rm: cannot remove `file&apos;: Permission denied</div><div class=\"line\"></div><div class=\"line\">#权限修改为777看</div><div class=\"line\">[root@lie-pc ~]# chmod 777 /user2/file </div><div class=\"line\">[root@lie-pc ~]# ls -l /user2</div><div class=\"line\">total 0</div><div class=\"line\">-rwxrwxrwx 1 root root 0 Jul 18 12:53 file</div><div class=\"line\"></div><div class=\"line\">[user1@lie-pc user2]$ ll</div><div class=\"line\">total 0</div><div class=\"line\">-rwxrwxrwx 1 root root 0 Jul 18 12:53 file</div><div class=\"line\">[user1@lie-pc user2]$ rm -f file</div><div class=\"line\">rm: cannot remove `file&apos;: Permission denied</div><div class=\"line\">#还是权限不够</div></pre></td></tr></table></figure>\n<p>总结:<br>删除或移动一个文件时，与该文件的上层目录有关，与文件本身的属性无关。即使文件的权限是777也不可以。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# chmod 755 /user2</div><div class=\"line\">[root@lie-pc ~]# chmod o+w  /user2</div><div class=\"line\">[root@lie-pc ~]# ls -ld /user2 </div><div class=\"line\">drwxr-xrwx 2 user2 user2 4096 Jul 18 12:53 /user2</div><div class=\"line\">[root@lie-pc ~]# chmod 644 /user2/file </div><div class=\"line\">[root@lie-pc ~]# ls -l /user2</div><div class=\"line\">total 0</div><div class=\"line\">-rw-r--r-- 1 root root 0 Jul 18 12:53 file</div><div class=\"line\"></div><div class=\"line\">[user1@lie-pc ~]$ ls -ld /user2</div><div class=\"line\">drwxr-xrwx 2 user2 user2 4096 Jul 18 12:53 /user2</div><div class=\"line\">[user1@lie-pc ~]$ ls -l /user2</div><div class=\"line\">total 0</div><div class=\"line\">-rw-r--r-- 1 root root 0 Jul 18 12:53 file</div><div class=\"line\">[user1@lie-pc ~]$ cd /user2/</div><div class=\"line\">[user1@lie-pc user2]$ ll</div><div class=\"line\">total 0</div><div class=\"line\">-rw-r--r-- 1 root root 0 Jul 18 12:53 file</div><div class=\"line\">[user1@lie-pc user2]$ rm -f file \t\t#删除成功</div><div class=\"line\"></div><div class=\"line\">[root@lie-pc ~]# cd /user2</div><div class=\"line\">[root@lie-pc user2]# touch file2</div><div class=\"line\">[root@lie-pc user2]# chmod 000 file2 \t\t#设置file2无任何权限</div><div class=\"line\">[root@lie-pc user2]# ls -l file2 </div><div class=\"line\">---------- 1 root root 0 Jul 19 12:38 file2</div><div class=\"line\"></div><div class=\"line\">#user1操作</div><div class=\"line\">[user1@lie-pc user2]$ ls -l /user2</div><div class=\"line\">total 0</div><div class=\"line\">---------- 1 root root 0 Jul 19 12:38 file2</div><div class=\"line\">[user1@lie-pc user2]$ rm -f file2 </div><div class=\"line\">[user1@lie-pc user2]$ ls -l /user2\t\t#也能删除成功</div><div class=\"line\">total 0</div></pre></td></tr></table></figure>\n<h2 id=\"测试user1仅有w权限是否能删除-user2内的文件\"><a href=\"#测试user1仅有w权限是否能删除-user2内的文件\" class=\"headerlink\" title=\"测试user1仅有w权限是否能删除/user2内的文件\"></a>测试user1仅有w权限是否能删除/user2内的文件</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# chmod o=w /user2\t\t#其它用户仅有w权限</div><div class=\"line\">[root@lie-pc ~]# ls -ld /user2</div><div class=\"line\">drwxr-x-w- 2 user2 user2 4096 Jul 19 12:39 /user2</div><div class=\"line\">[root@lie-pc ~]# touch /user2/file</div><div class=\"line\">[root@lie-pc ~]# ls -l /user2</div><div class=\"line\">total 0</div><div class=\"line\">-rw-r--r-- 1 root root 0 Jul 19 12:43 file</div><div class=\"line\"></div><div class=\"line\">#user1操作</div><div class=\"line\">[user1@lie-pc ~]$ ls -l /user2</div><div class=\"line\">ls: /user2: Permission denied</div><div class=\"line\">[user1@lie-pc ~]$ cd  /user2 </div><div class=\"line\">-bash: cd: /user2: Permission denied</div><div class=\"line\">[user1@lie-pc ~]$ rm -f /user2/file</div><div class=\"line\">rm: cannot remove `/user2/file&apos;: Permission denied</div></pre></td></tr></table></figure>\n<p>总结：仅有w权限，user1是无法删除/user2/file的</p>\n<h2 id=\"user1有rw权限看是否能删除-user2内的文件\"><a href=\"#user1有rw权限看是否能删除-user2内的文件\" class=\"headerlink\" title=\"user1有rw权限看是否能删除/user2内的文件\"></a>user1有rw权限看是否能删除/user2内的文件</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# chmod 756 /user2</div><div class=\"line\">[root@lie-pc ~]# ls -ld /user2</div><div class=\"line\">drwxr-xrw- 2 user2 user2 4096 Jul 19 12:43 /user2</div><div class=\"line\"></div><div class=\"line\">#user1操作</div><div class=\"line\">[user1@lie-pc ~]$ ls -ld /user2/ </div><div class=\"line\">drwxr-xrw- 2 user2 user2 4096 Jul 19 12:43 /user2/</div><div class=\"line\">[user1@lie-pc ~]$ ls -l /user2/</div><div class=\"line\">total 0</div><div class=\"line\">?--------- ? ? ? ?            ? file</div><div class=\"line\">[user1@lie-pc ~]$ rm -f /user2/file </div><div class=\"line\">rm: cannot remove `/user2/file&apos;: Permission denied</div><div class=\"line\">```\t</div><div class=\"line\">总结：仅有rw权限，user1依然无法删除/user2/file</div></pre></td></tr></table></figure>\n<p>##测试user1仅有wx权限看是否能删除/user2内的文件<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@lie-pc ~]# chmod 753 /user2</div><div class=\"line\">[root@lie-pc ~]# ls -ld /user2</div><div class=\"line\">drwxr-x-wx 2 user2 user2 4096 Jul 19 12:43 /user2</div><div class=\"line\">[root@lie-pc ~]# ls -l /user2</div><div class=\"line\">total 0</div><div class=\"line\">-rw-r--r-- 1 root root 0 Jul 19 12:43 file</div><div class=\"line\"></div><div class=\"line\">#user1操作</div><div class=\"line\">[user1@lie-pc ~]$ ls -ld /user2/</div><div class=\"line\">drwxr-x-wx 2 user2 user2 4096 Jul 19 12:43 /user2/</div><div class=\"line\">[user1@lie-pc ~]$ ls -l /user2/ </div><div class=\"line\">ls: /user2/: Permission denied</div><div class=\"line\">[user1@lie-pc ~]$ cd /user2</div><div class=\"line\">[user1@lie-pc user2]$ rm -f file\t#删除成功</div><div class=\"line\">[user1@lie-pc user2]$</div></pre></td></tr></table></figure></p>\n<p>结论：<br>1）    删除或移动一个文件，与该文件的上层目录的权限有关，与该文件本身的属性无关，即使是777也不可能删除或移动!<br>2）    对于目录，可写w表示具有修改或删除目录内文件的权限，但必须同时有x权限才可以。  </p>"},{"layout":"post","title":"linux系列4 - pxe+dhcp+nfs+kickstart无人值守批量安装Centos6.x x64","date":"2014-08-09T08:42:00.000Z","comments":1,"_content":"\n\n#1. 基本说明\n\n相关资料请参考: \n[linux系列2 - pxe+dhcp+nfs+kickstart无人值守批量安装Centos5.8 x64](/blog/2013/01/24/pxe-plus-dhcp-plus-nfs-plus-kickstart-centos5-dot-8-x64/)\n\n###centos5.x与centos6.x不一致的地方：\n(1)安装NFS时的RPC程序，centos5.x中叫做portmap，centos6.x叫rpcbind。\n\n(2)tftp默认目录，centos5.x时是 /tftpboot ，centos6.x在 /var/lib/tftpboot\n\n(3)dhcp配置文件位置, centos5.x时是 /etc/dhcpd.conf ，centos6.x在 /etc/dhcp/dhcpd.conf\n\n<!-- more -->\n\n#2. 一键安装脚本\n\n```bash\n#!/bin/bash\n# auto install kickstart server\n# the os root's passwd is 123456\n#\n# Filename: auto_install_centos6.x.sh\n# Author: quxl\n# Date:   2014-08-07  \n# Email:  xionglie.qu@gmail.com  \n#------------Environment------------  \n#   Linux 2.6.32-279.el6.x86_64\n#   CentOS release 6.3 (Final)\n#-----------------------------------  \n\n#192.168.3.128\nKICKSTART_SERVER_IP=`/sbin/ifconfig eth0 | grep 'inet addr' | awk '{print $2}' | awk -F: '{print $2}'`\n\n#192.168.3\nKICKSTART_IP_SUBNET=`echo ${KICKSTART_SERVER_IP}  | awk -F '.' '{print $1\".\"$2\".\"$3}'`\nKICKSTART_SERVER_SUBNET=${KICKSTART_IP_SUBNET}.0\nKICKSTART_SERVER_NETMASK=255.255.255.0\nKICKSTART_SERVER_ROUTE=${KICKSTART_IP_SUBNET}.2\nKICKSTART_SERVER_DHCP_IP_START=${KICKSTART_IP_SUBNET}.128\nKICKSTART_SERVER_DHCP_IP_END=${KICKSTART_IP_SUBNET}.254\n\n#portmap,发现CentOS 6上不叫portmap，而是改为rpcbind\nyum -y install rpcbind nfs-utils \nyum -y install syslinux\n\necho \"----- 1.配置nfs服务器 --------------\"\n#创建共享目录\nmkdir -p /data/sys\nmount /dev/cdrom /data/sys\necho \"mount /dev/cdrom /data/sys\" >>/etc/rc.local \nls -l /data/sys\n\n#安装nfs,分发共享目录\nrpm -qa | grep nfs\ncat > /etc/exports << EOF\n/data/sys ${KICKSTART_SERVER_SUBNET}/24(ro,sync)\n/data/kickstart ${KICKSTART_SERVER_SUBNET}/24(ro,sync)\nEOF\ncat /etc/exports\n\n#启动nfs,设置开机启动\n/etc/init.d/rpcbind restart\n/etc/init.d/nfs restart\nshowmount -e 127.0.0.1\n\nchkconfig rpcbind on\nchkconfig nfs on\nchkconfig --list | egrep \"nfs|rpcbind\"\n\necho \"----- 2.配置TFTP服务器 --------------\"\nyum -y install tftp-server* -y\nsed -i '/server_args.*=/ s#/var/lib/tftpboot#/tftpboot/#' /etc/xinetd.d/tftp\nsed -i '/disable.*=/ s#yes#no#' /etc/xinetd.d/tftp\n/etc/init.d/xinetd restart\nchkconfig xinetd on\n\n#与 centos5.x位置不同\nmkdir -p /tftpboot\n/bin/cp /usr/share/syslinux/pxelinux.0 /tftpboot/\n/bin/cp /data/sys/images/pxeboot/vmlinuz /tftpboot/\n/bin/cp /data/sys/images/pxeboot/initrd.img /tftpboot/\nls -l /tftpboot/\n#initrd.img  pxelinux.0  pxelinux.cfg  vmlinuz\n\nmkdir /tftpboot/pxelinux.cfg -p\n#/bin/cp /data/sys/isolinux/isolinux.cfg /tftpboot/pxelinux.cfg/default\n\ncat > /tftpboot/pxelinux.cfg/default << EOF\ndefault linux\n#prompt 1\ntimeout 600\n\ndisplay boot.msg\n\nmenu background splash.jpg\nmenu title Welcome to CentOS 6.3!\nmenu color border 0 #ffffffff #00000000\nmenu color sel 7 #ffffffff #ff000000\nmenu color title 0 #ffffffff #00000000\nmenu color tabmsg 0 #ffffffff #00000000\nmenu color unsel 0 #ffffffff #00000000\nmenu color hotsel 0 #ff000000 #ffffffff\nmenu color hotkey 7 #ffffffff #ff000000\nmenu color scrollbar 0 #ffffffff #00000000\n\nlabel linux\n  menu label Install system\n  menu default\n  kernel vmlinuz\n  append ks=nfs:${KICKSTART_SERVER_IP}:/data/kickstart/ks.cfg  initrd=initrd.img\n\nEOF\n\nchmod a+r /tftpboot/pxelinux.cfg/default\n\necho \"----- 3.配置DHCP --------------\"\nyum -y install dhcp*\n#/bin/cp /usr/share/doc/dhcp-4.1.1/dhcpd.conf.sample /etc/dhcpd.conf\n\n# centos5.x，配置文件都被配置在/etc/dhcpd.conf,\n# centos6.x, 以后放在/etc/dhcp/dhcpd.conf\ncat > /etc/dhcp/dhcpd.conf << EOF\nddns-update-style none;\nignore client-updates;\nallow booting;\nallow bootp;\ndefault-lease-time 21600;\nmax-lease-time 43200;\noption routers ${KICKSTART_SERVER_ROUTE};\n\nsubnet ${KICKSTART_SERVER_SUBNET} netmask ${KICKSTART_SERVER_NETMASK} {\nrange dynamic-bootp ${KICKSTART_SERVER_DHCP_IP_START} ${KICKSTART_SERVER_DHCP_IP_END};\nnext-server ${KICKSTART_SERVER_IP};\nfilename \"/data/kickstart/ks.cfg\";\nnext-server ${KICKSTART_SERVER_IP};\nfilename \"pxelinux.0\";\n}\nEOF\n\n/etc/init.d/dhcpd restart\n#出错的话，cat /var/log/messages\n\nchkconfig dhcpd on\nchkconfig --list dhcpd\n\necho \"----- 4.配置kickstart --------------\"\nmkdir -p /data/kickstart/\n#/bin/cp /root/anaconda-ks.cfg /data/kickstart/ks.cfg\n#chmod 644 /data/kickstart/ks.cfg\n\ncat > /data/kickstart/ks.cfg << EOF \n#platform=x86, AMD64, or Intel EM64T\n#version=DEVEL\n# Firewall configuration\nfirewall --disabled\n# Install OS instead of upgrade\ninstall\n# Use NFS installation media\nnfs --server=${KICKSTART_SERVER_IP} --dir=/data/sys\n# Root password abc123\nrootpw --iscrypted \\$1\\$A05l5MQt\\$VAf56PD915R8SwtFYJSeE/\n# System authorization information\nauth  --useshadow  --passalgo=sha512\n# Use text mode install\ntext\n# System keyboard\nkeyboard us\n# System language\nlang en_US\n# SELinux configuration\nselinux --disabled\n# Do not configure the X Window System\nskipx\n# Installation logging level\nlogging --level=info\n# Reboot after installation\nreboot\n# System timezone\ntimezone --isUtc Asia/Shanghai\n# Network information\nnetwork  --bootproto=dhcp --device=eth0 --onboot=on\n# System bootloader configuration\nbootloader --location=mbr\n# Clear the Master Boot Record\nzerombr\n# Partition clearing information\nclearpart --all --initlabel\n# Disk partitioning information\npart /boot --asprimary --fstype=\"ext4\" --size=200\npart swap --fstype=\"swap\" --size=512\npart / --asprimary --fstype=\"ext4\" --grow --size=1\n\n%post\n#!/bin/bash\necho \"nameserver 208.67.222.222\" >>/etc/resolv.conf\necho \"nameserver 208.67.220.220\" >>/etc/resolv.conf\n\nmkdir -p /application/tools\nmkdir -p /server/{scripts,backup}\n\nwget -nv -O /server/scripts/update_hostname.sh http://${KICKSTART_SERVER_IP}/update_hostname.sh\nwget -nv -O /server/scripts/update_ip.sh http://${KICKSTART_SERVER_IP}/update_ip.sh\nwget -nv -O /server/scripts/update_network.sh http://${KICKSTART_SERVER_IP}/update_network.sh\n\n%end\n\n%packages\n@base\n@development\n\n%end\nEOF\n\n#stop iptables\n#vi /etc/selinux/config\n/etc/init.d/iptables stop\nchkconfig iptables off\n\n#stop selinux\nsetenforce 0\nsed -i 's#SELINUX=enforcing#SELINUX=disabled#g' /etc/selinux/config \ncat /etc/selinux/config \n\necho \"-----done-----\"\n\n```\n\n#3. 相关文件说明\n\n### 3.1服务器环境说明\n操作系统：\n\n```\n[root@ks2 ~]# cat /etc/redhat-release\nCentOS release 6.3 (Final)\n[root@ks2 ~]# uname -mi\nx86_64 x86_64\n[root@ks2 ~]# uname -r\n2.6.32-279.el6.x86_64\n```\n\n主机网络参数设置：\n\n```\n网卡eth0: 192.168.27.134\n默认网关: 192.168.27.2\n子网掩码: 255.255.255.0\n```\n\n### 3.2 /etc/dhcp/dhcpd.conf\n\n```\n[root@ks2 ~]# cat /etc/dhcp/dhcpd.conf\nddns-update-style none;\nignore client-updates;\nallow booting;\nallow bootp;\ndefault-lease-time 21600;\nmax-lease-time 43200;\noption routers 192.168.27.2;\n\nsubnet 192.168.27.0 netmask 255.255.255.0 {\nrange dynamic-bootp 192.168.27.128 192.168.27.254;\nnext-server 192.168.27.134;\nfilename \"/data/kickstart/ks.cfg\";\nnext-server 192.168.27.134;\nfilename \"pxelinux.0\";\n}\n```\n\n#4. 可能遇到的错误\n###错误1：\n在server端已经配置好了，在clinet端用网络引导时能得到地址，但总是报错：\n\nPXE-T00 Permission deny\n\nPXE-E36 Error received from tftp server\n\n解决方法：关掉SElinux \n\n```\n1、快速关闭SElinux，使用如下命令就可以：\n　　/usr/sbin/setenforce 0 立刻关闭 SELINUX\n　　/usr/sbin/setenforce 1 立刻启用 SELINUX\n2、加到系统默认启动里面\n　　echo \"/usr/sbin/setenforce 0\" >> /etc/rc.local\n3、可以编辑配置文件达到同样的目的\nvi /etc/selinux/conf\nset SELINUX=disabled\n```","source":"_posts/2014-08-09-linuxxi-lie-4-pxe-plus-dhcp-plus-nfs-plus-kickstartwu-ren-zhi-shou-pi-liang-an-zhuang-centos6-dot-3-x64.md","raw":"---\nlayout: post\ntitle: \"linux系列4 - pxe+dhcp+nfs+kickstart无人值守批量安装Centos6.x x64\"\ndate: 2014-08-09 16:42\ncomments: true\ncategories: linux\n---\n\n\n#1. 基本说明\n\n相关资料请参考: \n[linux系列2 - pxe+dhcp+nfs+kickstart无人值守批量安装Centos5.8 x64](/blog/2013/01/24/pxe-plus-dhcp-plus-nfs-plus-kickstart-centos5-dot-8-x64/)\n\n###centos5.x与centos6.x不一致的地方：\n(1)安装NFS时的RPC程序，centos5.x中叫做portmap，centos6.x叫rpcbind。\n\n(2)tftp默认目录，centos5.x时是 /tftpboot ，centos6.x在 /var/lib/tftpboot\n\n(3)dhcp配置文件位置, centos5.x时是 /etc/dhcpd.conf ，centos6.x在 /etc/dhcp/dhcpd.conf\n\n<!-- more -->\n\n#2. 一键安装脚本\n\n```bash\n#!/bin/bash\n# auto install kickstart server\n# the os root's passwd is 123456\n#\n# Filename: auto_install_centos6.x.sh\n# Author: quxl\n# Date:   2014-08-07  \n# Email:  xionglie.qu@gmail.com  \n#------------Environment------------  \n#   Linux 2.6.32-279.el6.x86_64\n#   CentOS release 6.3 (Final)\n#-----------------------------------  \n\n#192.168.3.128\nKICKSTART_SERVER_IP=`/sbin/ifconfig eth0 | grep 'inet addr' | awk '{print $2}' | awk -F: '{print $2}'`\n\n#192.168.3\nKICKSTART_IP_SUBNET=`echo ${KICKSTART_SERVER_IP}  | awk -F '.' '{print $1\".\"$2\".\"$3}'`\nKICKSTART_SERVER_SUBNET=${KICKSTART_IP_SUBNET}.0\nKICKSTART_SERVER_NETMASK=255.255.255.0\nKICKSTART_SERVER_ROUTE=${KICKSTART_IP_SUBNET}.2\nKICKSTART_SERVER_DHCP_IP_START=${KICKSTART_IP_SUBNET}.128\nKICKSTART_SERVER_DHCP_IP_END=${KICKSTART_IP_SUBNET}.254\n\n#portmap,发现CentOS 6上不叫portmap，而是改为rpcbind\nyum -y install rpcbind nfs-utils \nyum -y install syslinux\n\necho \"----- 1.配置nfs服务器 --------------\"\n#创建共享目录\nmkdir -p /data/sys\nmount /dev/cdrom /data/sys\necho \"mount /dev/cdrom /data/sys\" >>/etc/rc.local \nls -l /data/sys\n\n#安装nfs,分发共享目录\nrpm -qa | grep nfs\ncat > /etc/exports << EOF\n/data/sys ${KICKSTART_SERVER_SUBNET}/24(ro,sync)\n/data/kickstart ${KICKSTART_SERVER_SUBNET}/24(ro,sync)\nEOF\ncat /etc/exports\n\n#启动nfs,设置开机启动\n/etc/init.d/rpcbind restart\n/etc/init.d/nfs restart\nshowmount -e 127.0.0.1\n\nchkconfig rpcbind on\nchkconfig nfs on\nchkconfig --list | egrep \"nfs|rpcbind\"\n\necho \"----- 2.配置TFTP服务器 --------------\"\nyum -y install tftp-server* -y\nsed -i '/server_args.*=/ s#/var/lib/tftpboot#/tftpboot/#' /etc/xinetd.d/tftp\nsed -i '/disable.*=/ s#yes#no#' /etc/xinetd.d/tftp\n/etc/init.d/xinetd restart\nchkconfig xinetd on\n\n#与 centos5.x位置不同\nmkdir -p /tftpboot\n/bin/cp /usr/share/syslinux/pxelinux.0 /tftpboot/\n/bin/cp /data/sys/images/pxeboot/vmlinuz /tftpboot/\n/bin/cp /data/sys/images/pxeboot/initrd.img /tftpboot/\nls -l /tftpboot/\n#initrd.img  pxelinux.0  pxelinux.cfg  vmlinuz\n\nmkdir /tftpboot/pxelinux.cfg -p\n#/bin/cp /data/sys/isolinux/isolinux.cfg /tftpboot/pxelinux.cfg/default\n\ncat > /tftpboot/pxelinux.cfg/default << EOF\ndefault linux\n#prompt 1\ntimeout 600\n\ndisplay boot.msg\n\nmenu background splash.jpg\nmenu title Welcome to CentOS 6.3!\nmenu color border 0 #ffffffff #00000000\nmenu color sel 7 #ffffffff #ff000000\nmenu color title 0 #ffffffff #00000000\nmenu color tabmsg 0 #ffffffff #00000000\nmenu color unsel 0 #ffffffff #00000000\nmenu color hotsel 0 #ff000000 #ffffffff\nmenu color hotkey 7 #ffffffff #ff000000\nmenu color scrollbar 0 #ffffffff #00000000\n\nlabel linux\n  menu label Install system\n  menu default\n  kernel vmlinuz\n  append ks=nfs:${KICKSTART_SERVER_IP}:/data/kickstart/ks.cfg  initrd=initrd.img\n\nEOF\n\nchmod a+r /tftpboot/pxelinux.cfg/default\n\necho \"----- 3.配置DHCP --------------\"\nyum -y install dhcp*\n#/bin/cp /usr/share/doc/dhcp-4.1.1/dhcpd.conf.sample /etc/dhcpd.conf\n\n# centos5.x，配置文件都被配置在/etc/dhcpd.conf,\n# centos6.x, 以后放在/etc/dhcp/dhcpd.conf\ncat > /etc/dhcp/dhcpd.conf << EOF\nddns-update-style none;\nignore client-updates;\nallow booting;\nallow bootp;\ndefault-lease-time 21600;\nmax-lease-time 43200;\noption routers ${KICKSTART_SERVER_ROUTE};\n\nsubnet ${KICKSTART_SERVER_SUBNET} netmask ${KICKSTART_SERVER_NETMASK} {\nrange dynamic-bootp ${KICKSTART_SERVER_DHCP_IP_START} ${KICKSTART_SERVER_DHCP_IP_END};\nnext-server ${KICKSTART_SERVER_IP};\nfilename \"/data/kickstart/ks.cfg\";\nnext-server ${KICKSTART_SERVER_IP};\nfilename \"pxelinux.0\";\n}\nEOF\n\n/etc/init.d/dhcpd restart\n#出错的话，cat /var/log/messages\n\nchkconfig dhcpd on\nchkconfig --list dhcpd\n\necho \"----- 4.配置kickstart --------------\"\nmkdir -p /data/kickstart/\n#/bin/cp /root/anaconda-ks.cfg /data/kickstart/ks.cfg\n#chmod 644 /data/kickstart/ks.cfg\n\ncat > /data/kickstart/ks.cfg << EOF \n#platform=x86, AMD64, or Intel EM64T\n#version=DEVEL\n# Firewall configuration\nfirewall --disabled\n# Install OS instead of upgrade\ninstall\n# Use NFS installation media\nnfs --server=${KICKSTART_SERVER_IP} --dir=/data/sys\n# Root password abc123\nrootpw --iscrypted \\$1\\$A05l5MQt\\$VAf56PD915R8SwtFYJSeE/\n# System authorization information\nauth  --useshadow  --passalgo=sha512\n# Use text mode install\ntext\n# System keyboard\nkeyboard us\n# System language\nlang en_US\n# SELinux configuration\nselinux --disabled\n# Do not configure the X Window System\nskipx\n# Installation logging level\nlogging --level=info\n# Reboot after installation\nreboot\n# System timezone\ntimezone --isUtc Asia/Shanghai\n# Network information\nnetwork  --bootproto=dhcp --device=eth0 --onboot=on\n# System bootloader configuration\nbootloader --location=mbr\n# Clear the Master Boot Record\nzerombr\n# Partition clearing information\nclearpart --all --initlabel\n# Disk partitioning information\npart /boot --asprimary --fstype=\"ext4\" --size=200\npart swap --fstype=\"swap\" --size=512\npart / --asprimary --fstype=\"ext4\" --grow --size=1\n\n%post\n#!/bin/bash\necho \"nameserver 208.67.222.222\" >>/etc/resolv.conf\necho \"nameserver 208.67.220.220\" >>/etc/resolv.conf\n\nmkdir -p /application/tools\nmkdir -p /server/{scripts,backup}\n\nwget -nv -O /server/scripts/update_hostname.sh http://${KICKSTART_SERVER_IP}/update_hostname.sh\nwget -nv -O /server/scripts/update_ip.sh http://${KICKSTART_SERVER_IP}/update_ip.sh\nwget -nv -O /server/scripts/update_network.sh http://${KICKSTART_SERVER_IP}/update_network.sh\n\n%end\n\n%packages\n@base\n@development\n\n%end\nEOF\n\n#stop iptables\n#vi /etc/selinux/config\n/etc/init.d/iptables stop\nchkconfig iptables off\n\n#stop selinux\nsetenforce 0\nsed -i 's#SELINUX=enforcing#SELINUX=disabled#g' /etc/selinux/config \ncat /etc/selinux/config \n\necho \"-----done-----\"\n\n```\n\n#3. 相关文件说明\n\n### 3.1服务器环境说明\n操作系统：\n\n```\n[root@ks2 ~]# cat /etc/redhat-release\nCentOS release 6.3 (Final)\n[root@ks2 ~]# uname -mi\nx86_64 x86_64\n[root@ks2 ~]# uname -r\n2.6.32-279.el6.x86_64\n```\n\n主机网络参数设置：\n\n```\n网卡eth0: 192.168.27.134\n默认网关: 192.168.27.2\n子网掩码: 255.255.255.0\n```\n\n### 3.2 /etc/dhcp/dhcpd.conf\n\n```\n[root@ks2 ~]# cat /etc/dhcp/dhcpd.conf\nddns-update-style none;\nignore client-updates;\nallow booting;\nallow bootp;\ndefault-lease-time 21600;\nmax-lease-time 43200;\noption routers 192.168.27.2;\n\nsubnet 192.168.27.0 netmask 255.255.255.0 {\nrange dynamic-bootp 192.168.27.128 192.168.27.254;\nnext-server 192.168.27.134;\nfilename \"/data/kickstart/ks.cfg\";\nnext-server 192.168.27.134;\nfilename \"pxelinux.0\";\n}\n```\n\n#4. 可能遇到的错误\n###错误1：\n在server端已经配置好了，在clinet端用网络引导时能得到地址，但总是报错：\n\nPXE-T00 Permission deny\n\nPXE-E36 Error received from tftp server\n\n解决方法：关掉SElinux \n\n```\n1、快速关闭SElinux，使用如下命令就可以：\n　　/usr/sbin/setenforce 0 立刻关闭 SELINUX\n　　/usr/sbin/setenforce 1 立刻启用 SELINUX\n2、加到系统默认启动里面\n　　echo \"/usr/sbin/setenforce 0\" >> /etc/rc.local\n3、可以编辑配置文件达到同样的目的\nvi /etc/selinux/conf\nset SELINUX=disabled\n```","slug":"linuxxi-lie-4-pxe-plus-dhcp-plus-nfs-plus-kickstartwu-ren-zhi-shou-pi-liang-an-zhuang-centos6-dot-3-x64","published":1,"updated":"2017-01-25T15:29:56.000Z","photos":[],"link":"","_id":"ciyf7fkbk000zf2jyaov1pnfo","content":"<p>#1. 基本说明</p>\n<p>相关资料请参考:<br><a href=\"/blog/2013/01/24/pxe-plus-dhcp-plus-nfs-plus-kickstart-centos5-dot-8-x64/\">linux系列2 - pxe+dhcp+nfs+kickstart无人值守批量安装Centos5.8 x64</a></p>\n<p>###centos5.x与centos6.x不一致的地方：<br>(1)安装NFS时的RPC程序，centos5.x中叫做portmap，centos6.x叫rpcbind。</p>\n<p>(2)tftp默认目录，centos5.x时是 /tftpboot ，centos6.x在 /var/lib/tftpboot</p>\n<p>(3)dhcp配置文件位置, centos5.x时是 /etc/dhcpd.conf ，centos6.x在 /etc/dhcp/dhcpd.conf</p>\n<a id=\"more\"></a>\n<p>#2. 一键安装脚本</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div><div class=\"line\">147</div><div class=\"line\">148</div><div class=\"line\">149</div><div class=\"line\">150</div><div class=\"line\">151</div><div class=\"line\">152</div><div class=\"line\">153</div><div class=\"line\">154</div><div class=\"line\">155</div><div class=\"line\">156</div><div class=\"line\">157</div><div class=\"line\">158</div><div class=\"line\">159</div><div class=\"line\">160</div><div class=\"line\">161</div><div class=\"line\">162</div><div class=\"line\">163</div><div class=\"line\">164</div><div class=\"line\">165</div><div class=\"line\">166</div><div class=\"line\">167</div><div class=\"line\">168</div><div class=\"line\">169</div><div class=\"line\">170</div><div class=\"line\">171</div><div class=\"line\">172</div><div class=\"line\">173</div><div class=\"line\">174</div><div class=\"line\">175</div><div class=\"line\">176</div><div class=\"line\">177</div><div class=\"line\">178</div><div class=\"line\">179</div><div class=\"line\">180</div><div class=\"line\">181</div><div class=\"line\">182</div><div class=\"line\">183</div><div class=\"line\">184</div><div class=\"line\">185</div><div class=\"line\">186</div><div class=\"line\">187</div><div class=\"line\">188</div><div class=\"line\">189</div><div class=\"line\">190</div><div class=\"line\">191</div><div class=\"line\">192</div><div class=\"line\">193</div><div class=\"line\">194</div><div class=\"line\">195</div><div class=\"line\">196</div><div class=\"line\">197</div><div class=\"line\">198</div><div class=\"line\">199</div><div class=\"line\">200</div><div class=\"line\">201</div><div class=\"line\">202</div><div class=\"line\">203</div><div class=\"line\">204</div><div class=\"line\">205</div><div class=\"line\">206</div><div class=\"line\">207</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">#!/bin/bash</span></div><div class=\"line\"><span class=\"comment\"># auto install kickstart server</span></div><div class=\"line\"><span class=\"comment\"># the os root's passwd is 123456</span></div><div class=\"line\"><span class=\"comment\">#</span></div><div class=\"line\"><span class=\"comment\"># Filename: auto_install_centos6.x.sh</span></div><div class=\"line\"><span class=\"comment\"># Author: quxl</span></div><div class=\"line\"><span class=\"comment\"># Date:   2014-08-07  </span></div><div class=\"line\"><span class=\"comment\"># Email:  xionglie.qu@gmail.com  </span></div><div class=\"line\"><span class=\"comment\">#------------Environment------------  </span></div><div class=\"line\"><span class=\"comment\">#   Linux 2.6.32-279.el6.x86_64</span></div><div class=\"line\"><span class=\"comment\">#   CentOS release 6.3 (Final)</span></div><div class=\"line\"><span class=\"comment\">#-----------------------------------  </span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#192.168.3.128</span></div><div class=\"line\">KICKSTART_SERVER_IP=`/sbin/ifconfig eth0 | grep <span class=\"string\">'inet addr'</span> | awk <span class=\"string\">'&#123;print $2&#125;'</span> | awk -F: <span class=\"string\">'&#123;print $2&#125;'</span>`</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#192.168.3</span></div><div class=\"line\">KICKSTART_IP_SUBNET=`<span class=\"built_in\">echo</span> <span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span>  | awk -F <span class=\"string\">'.'</span> <span class=\"string\">'&#123;print $1\".\"$2\".\"$3&#125;'</span>`</div><div class=\"line\">KICKSTART_SERVER_SUBNET=<span class=\"variable\">$&#123;KICKSTART_IP_SUBNET&#125;</span>.0</div><div class=\"line\">KICKSTART_SERVER_NETMASK=255.255.255.0</div><div class=\"line\">KICKSTART_SERVER_ROUTE=<span class=\"variable\">$&#123;KICKSTART_IP_SUBNET&#125;</span>.2</div><div class=\"line\">KICKSTART_SERVER_DHCP_IP_START=<span class=\"variable\">$&#123;KICKSTART_IP_SUBNET&#125;</span>.128</div><div class=\"line\">KICKSTART_SERVER_DHCP_IP_END=<span class=\"variable\">$&#123;KICKSTART_IP_SUBNET&#125;</span>.254</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#portmap,发现CentOS 6上不叫portmap，而是改为rpcbind</span></div><div class=\"line\">yum -y install rpcbind nfs-utils </div><div class=\"line\">yum -y install syslinux</div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"----- 1.配置nfs服务器 --------------\"</span></div><div class=\"line\"><span class=\"comment\">#创建共享目录</span></div><div class=\"line\">mkdir -p /data/sys</div><div class=\"line\">mount /dev/cdrom /data/sys</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"mount /dev/cdrom /data/sys\"</span> &gt;&gt;/etc/rc.local </div><div class=\"line\">ls <span class=\"_\">-l</span> /data/sys</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#安装nfs,分发共享目录</span></div><div class=\"line\">rpm -qa | grep nfs</div><div class=\"line\">cat &gt; /etc/exports &lt;&lt; EOF</div><div class=\"line\">/data/sys <span class=\"variable\">$&#123;KICKSTART_SERVER_SUBNET&#125;</span>/24(ro,sync)</div><div class=\"line\">/data/kickstart <span class=\"variable\">$&#123;KICKSTART_SERVER_SUBNET&#125;</span>/24(ro,sync)</div><div class=\"line\">EOF</div><div class=\"line\">cat /etc/exports</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#启动nfs,设置开机启动</span></div><div class=\"line\">/etc/init.d/rpcbind restart</div><div class=\"line\">/etc/init.d/nfs restart</div><div class=\"line\">showmount <span class=\"_\">-e</span> 127.0.0.1</div><div class=\"line\"></div><div class=\"line\">chkconfig rpcbind on</div><div class=\"line\">chkconfig nfs on</div><div class=\"line\">chkconfig --list | egrep <span class=\"string\">\"nfs|rpcbind\"</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"----- 2.配置TFTP服务器 --------------\"</span></div><div class=\"line\">yum -y install tftp-server* -y</div><div class=\"line\">sed -i <span class=\"string\">'/server_args.*=/ s#/var/lib/tftpboot#/tftpboot/#'</span> /etc/xinetd.d/tftp</div><div class=\"line\">sed -i <span class=\"string\">'/disable.*=/ s#yes#no#'</span> /etc/xinetd.d/tftp</div><div class=\"line\">/etc/init.d/xinetd restart</div><div class=\"line\">chkconfig xinetd on</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#与 centos5.x位置不同</span></div><div class=\"line\">mkdir -p /tftpboot</div><div class=\"line\">/bin/cp /usr/share/syslinux/pxelinux.0 /tftpboot/</div><div class=\"line\">/bin/cp /data/sys/images/pxeboot/vmlinuz /tftpboot/</div><div class=\"line\">/bin/cp /data/sys/images/pxeboot/initrd.img /tftpboot/</div><div class=\"line\">ls <span class=\"_\">-l</span> /tftpboot/</div><div class=\"line\"><span class=\"comment\">#initrd.img  pxelinux.0  pxelinux.cfg  vmlinuz</span></div><div class=\"line\"></div><div class=\"line\">mkdir /tftpboot/pxelinux.cfg -p</div><div class=\"line\"><span class=\"comment\">#/bin/cp /data/sys/isolinux/isolinux.cfg /tftpboot/pxelinux.cfg/default</span></div><div class=\"line\"></div><div class=\"line\">cat &gt; /tftpboot/pxelinux.cfg/default &lt;&lt; EOF</div><div class=\"line\">default linux</div><div class=\"line\"><span class=\"comment\">#prompt 1</span></div><div class=\"line\">timeout 600</div><div class=\"line\"></div><div class=\"line\">display boot.msg</div><div class=\"line\"></div><div class=\"line\">menu background splash.jpg</div><div class=\"line\">menu title Welcome to CentOS 6.3!</div><div class=\"line\">menu color border 0 <span class=\"comment\">#ffffffff #00000000</span></div><div class=\"line\">menu color sel 7 <span class=\"comment\">#ffffffff #ff000000</span></div><div class=\"line\">menu color title 0 <span class=\"comment\">#ffffffff #00000000</span></div><div class=\"line\">menu color tabmsg 0 <span class=\"comment\">#ffffffff #00000000</span></div><div class=\"line\">menu color unsel 0 <span class=\"comment\">#ffffffff #00000000</span></div><div class=\"line\">menu color hotsel 0 <span class=\"comment\">#ff000000 #ffffffff</span></div><div class=\"line\">menu color hotkey 7 <span class=\"comment\">#ffffffff #ff000000</span></div><div class=\"line\">menu color scrollbar 0 <span class=\"comment\">#ffffffff #00000000</span></div><div class=\"line\"></div><div class=\"line\">label linux</div><div class=\"line\">  menu label Install system</div><div class=\"line\">  menu default</div><div class=\"line\">  kernel vmlinuz</div><div class=\"line\">  append ks=nfs:<span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span>:/data/kickstart/ks.cfg  initrd=initrd.img</div><div class=\"line\"></div><div class=\"line\">EOF</div><div class=\"line\"></div><div class=\"line\">chmod a+r /tftpboot/pxelinux.cfg/default</div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"----- 3.配置DHCP --------------\"</span></div><div class=\"line\">yum -y install dhcp*</div><div class=\"line\"><span class=\"comment\">#/bin/cp /usr/share/doc/dhcp-4.1.1/dhcpd.conf.sample /etc/dhcpd.conf</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># centos5.x，配置文件都被配置在/etc/dhcpd.conf,</span></div><div class=\"line\"><span class=\"comment\"># centos6.x, 以后放在/etc/dhcp/dhcpd.conf</span></div><div class=\"line\">cat &gt; /etc/dhcp/dhcpd.conf &lt;&lt; EOF</div><div class=\"line\">ddns-update-style none;</div><div class=\"line\">ignore client-updates;</div><div class=\"line\">allow booting;</div><div class=\"line\">allow bootp;</div><div class=\"line\">default-lease-time 21600;</div><div class=\"line\">max-lease-time 43200;</div><div class=\"line\">option routers <span class=\"variable\">$&#123;KICKSTART_SERVER_ROUTE&#125;</span>;</div><div class=\"line\"></div><div class=\"line\">subnet <span class=\"variable\">$&#123;KICKSTART_SERVER_SUBNET&#125;</span> netmask <span class=\"variable\">$&#123;KICKSTART_SERVER_NETMASK&#125;</span> &#123;</div><div class=\"line\">range dynamic-bootp <span class=\"variable\">$&#123;KICKSTART_SERVER_DHCP_IP_START&#125;</span> <span class=\"variable\">$&#123;KICKSTART_SERVER_DHCP_IP_END&#125;</span>;</div><div class=\"line\">next-server <span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span>;</div><div class=\"line\">filename <span class=\"string\">\"/data/kickstart/ks.cfg\"</span>;</div><div class=\"line\">next-server <span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span>;</div><div class=\"line\">filename <span class=\"string\">\"pxelinux.0\"</span>;</div><div class=\"line\">&#125;</div><div class=\"line\">EOF</div><div class=\"line\"></div><div class=\"line\">/etc/init.d/dhcpd restart</div><div class=\"line\"><span class=\"comment\">#出错的话，cat /var/log/messages</span></div><div class=\"line\"></div><div class=\"line\">chkconfig dhcpd on</div><div class=\"line\">chkconfig --list dhcpd</div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"----- 4.配置kickstart --------------\"</span></div><div class=\"line\">mkdir -p /data/kickstart/</div><div class=\"line\"><span class=\"comment\">#/bin/cp /root/anaconda-ks.cfg /data/kickstart/ks.cfg</span></div><div class=\"line\"><span class=\"comment\">#chmod 644 /data/kickstart/ks.cfg</span></div><div class=\"line\"></div><div class=\"line\">cat &gt; /data/kickstart/ks.cfg &lt;&lt; EOF </div><div class=\"line\"><span class=\"comment\">#platform=x86, AMD64, or Intel EM64T</span></div><div class=\"line\"><span class=\"comment\">#version=DEVEL</span></div><div class=\"line\"><span class=\"comment\"># Firewall configuration</span></div><div class=\"line\">firewall --disabled</div><div class=\"line\"><span class=\"comment\"># Install OS instead of upgrade</span></div><div class=\"line\">install</div><div class=\"line\"><span class=\"comment\"># Use NFS installation media</span></div><div class=\"line\">nfs --server=<span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span> --dir=/data/sys</div><div class=\"line\"><span class=\"comment\"># Root password abc123</span></div><div class=\"line\">rootpw --iscrypted \\<span class=\"variable\">$1</span>\\<span class=\"variable\">$A05l5MQt</span>\\<span class=\"variable\">$VAf56PD915R8SwtFYJSeE</span>/</div><div class=\"line\"><span class=\"comment\"># System authorization information</span></div><div class=\"line\">auth  --useshadow  --passalgo=sha512</div><div class=\"line\"><span class=\"comment\"># Use text mode install</span></div><div class=\"line\">text</div><div class=\"line\"><span class=\"comment\"># System keyboard</span></div><div class=\"line\">keyboard us</div><div class=\"line\"><span class=\"comment\"># System language</span></div><div class=\"line\">lang en_US</div><div class=\"line\"><span class=\"comment\"># SELinux configuration</span></div><div class=\"line\">selinux --disabled</div><div class=\"line\"><span class=\"comment\"># Do not configure the X Window System</span></div><div class=\"line\">skipx</div><div class=\"line\"><span class=\"comment\"># Installation logging level</span></div><div class=\"line\">logging --level=info</div><div class=\"line\"><span class=\"comment\"># Reboot after installation</span></div><div class=\"line\">reboot</div><div class=\"line\"><span class=\"comment\"># System timezone</span></div><div class=\"line\">timezone --isUtc Asia/Shanghai</div><div class=\"line\"><span class=\"comment\"># Network information</span></div><div class=\"line\">network  --bootproto=dhcp --device=eth0 --onboot=on</div><div class=\"line\"><span class=\"comment\"># System bootloader configuration</span></div><div class=\"line\">bootloader --location=mbr</div><div class=\"line\"><span class=\"comment\"># Clear the Master Boot Record</span></div><div class=\"line\">zerombr</div><div class=\"line\"><span class=\"comment\"># Partition clearing information</span></div><div class=\"line\">clearpart --all --initlabel</div><div class=\"line\"><span class=\"comment\"># Disk partitioning information</span></div><div class=\"line\">part /boot --asprimary --fstype=<span class=\"string\">\"ext4\"</span> --size=200</div><div class=\"line\">part swap --fstype=<span class=\"string\">\"swap\"</span> --size=512</div><div class=\"line\">part / --asprimary --fstype=<span class=\"string\">\"ext4\"</span> --grow --size=1</div><div class=\"line\"></div><div class=\"line\">%post</div><div class=\"line\"><span class=\"meta\">#!/bin/bash</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"nameserver 208.67.222.222\"</span> &gt;&gt;/etc/resolv.conf</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"nameserver 208.67.220.220\"</span> &gt;&gt;/etc/resolv.conf</div><div class=\"line\"></div><div class=\"line\">mkdir -p /application/tools</div><div class=\"line\">mkdir -p /server/&#123;scripts,backup&#125;</div><div class=\"line\"></div><div class=\"line\">wget -nv -O /server/scripts/update_hostname.sh http://<span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span>/update_hostname.sh</div><div class=\"line\">wget -nv -O /server/scripts/update_ip.sh http://<span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span>/update_ip.sh</div><div class=\"line\">wget -nv -O /server/scripts/update_network.sh http://<span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span>/update_network.sh</div><div class=\"line\"></div><div class=\"line\">%end</div><div class=\"line\"></div><div class=\"line\">%packages</div><div class=\"line\">@base</div><div class=\"line\">@development</div><div class=\"line\"></div><div class=\"line\">%end</div><div class=\"line\">EOF</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#stop iptables</span></div><div class=\"line\"><span class=\"comment\">#vi /etc/selinux/config</span></div><div class=\"line\">/etc/init.d/iptables stop</div><div class=\"line\">chkconfig iptables off</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#stop selinux</span></div><div class=\"line\">setenforce 0</div><div class=\"line\">sed -i <span class=\"string\">'s#SELINUX=enforcing#SELINUX=disabled#g'</span> /etc/selinux/config </div><div class=\"line\">cat /etc/selinux/config </div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"-----done-----\"</span></div></pre></td></tr></table></figure>\n<p>#3. 相关文件说明</p>\n<h3 id=\"3-1服务器环境说明\"><a href=\"#3-1服务器环境说明\" class=\"headerlink\" title=\"3.1服务器环境说明\"></a>3.1服务器环境说明</h3><p>操作系统：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ks2 ~]# cat /etc/redhat-release</div><div class=\"line\">CentOS release 6.3 (Final)</div><div class=\"line\">[root@ks2 ~]# uname -mi</div><div class=\"line\">x86_64 x86_64</div><div class=\"line\">[root@ks2 ~]# uname -r</div><div class=\"line\">2.6.32-279.el6.x86_64</div></pre></td></tr></table></figure>\n<p>主机网络参数设置：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">网卡eth0: 192.168.27.134</div><div class=\"line\">默认网关: 192.168.27.2</div><div class=\"line\">子网掩码: 255.255.255.0</div></pre></td></tr></table></figure>\n<h3 id=\"3-2-etc-dhcp-dhcpd-conf\"><a href=\"#3-2-etc-dhcp-dhcpd-conf\" class=\"headerlink\" title=\"3.2 /etc/dhcp/dhcpd.conf\"></a>3.2 /etc/dhcp/dhcpd.conf</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ks2 ~]# cat /etc/dhcp/dhcpd.conf</div><div class=\"line\">ddns-update-style none;</div><div class=\"line\">ignore client-updates;</div><div class=\"line\">allow booting;</div><div class=\"line\">allow bootp;</div><div class=\"line\">default-lease-time 21600;</div><div class=\"line\">max-lease-time 43200;</div><div class=\"line\">option routers 192.168.27.2;</div><div class=\"line\"></div><div class=\"line\">subnet 192.168.27.0 netmask 255.255.255.0 &#123;</div><div class=\"line\">range dynamic-bootp 192.168.27.128 192.168.27.254;</div><div class=\"line\">next-server 192.168.27.134;</div><div class=\"line\">filename &quot;/data/kickstart/ks.cfg&quot;;</div><div class=\"line\">next-server 192.168.27.134;</div><div class=\"line\">filename &quot;pxelinux.0&quot;;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>#4. 可能遇到的错误</p>\n<p>###错误1：<br>在server端已经配置好了，在clinet端用网络引导时能得到地址，但总是报错：</p>\n<p>PXE-T00 Permission deny</p>\n<p>PXE-E36 Error received from tftp server</p>\n<p>解决方法：关掉SElinux </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">1、快速关闭SElinux，使用如下命令就可以：</div><div class=\"line\">　　/usr/sbin/setenforce 0 立刻关闭 SELINUX</div><div class=\"line\">　　/usr/sbin/setenforce 1 立刻启用 SELINUX</div><div class=\"line\">2、加到系统默认启动里面</div><div class=\"line\">　　echo &quot;/usr/sbin/setenforce 0&quot; &gt;&gt; /etc/rc.local</div><div class=\"line\">3、可以编辑配置文件达到同样的目的</div><div class=\"line\">vi /etc/selinux/conf</div><div class=\"line\">set SELINUX=disabled</div></pre></td></tr></table></figure>","excerpt":"<p>#1. 基本说明</p>\n<p>相关资料请参考:<br><a href=\"/blog/2013/01/24/pxe-plus-dhcp-plus-nfs-plus-kickstart-centos5-dot-8-x64/\">linux系列2 - pxe+dhcp+nfs+kickstart无人值守批量安装Centos5.8 x64</a></p>\n<p>###centos5.x与centos6.x不一致的地方：<br>(1)安装NFS时的RPC程序，centos5.x中叫做portmap，centos6.x叫rpcbind。</p>\n<p>(2)tftp默认目录，centos5.x时是 /tftpboot ，centos6.x在 /var/lib/tftpboot</p>\n<p>(3)dhcp配置文件位置, centos5.x时是 /etc/dhcpd.conf ，centos6.x在 /etc/dhcp/dhcpd.conf</p>","more":"<p>#2. 一键安装脚本</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div><div class=\"line\">147</div><div class=\"line\">148</div><div class=\"line\">149</div><div class=\"line\">150</div><div class=\"line\">151</div><div class=\"line\">152</div><div class=\"line\">153</div><div class=\"line\">154</div><div class=\"line\">155</div><div class=\"line\">156</div><div class=\"line\">157</div><div class=\"line\">158</div><div class=\"line\">159</div><div class=\"line\">160</div><div class=\"line\">161</div><div class=\"line\">162</div><div class=\"line\">163</div><div class=\"line\">164</div><div class=\"line\">165</div><div class=\"line\">166</div><div class=\"line\">167</div><div class=\"line\">168</div><div class=\"line\">169</div><div class=\"line\">170</div><div class=\"line\">171</div><div class=\"line\">172</div><div class=\"line\">173</div><div class=\"line\">174</div><div class=\"line\">175</div><div class=\"line\">176</div><div class=\"line\">177</div><div class=\"line\">178</div><div class=\"line\">179</div><div class=\"line\">180</div><div class=\"line\">181</div><div class=\"line\">182</div><div class=\"line\">183</div><div class=\"line\">184</div><div class=\"line\">185</div><div class=\"line\">186</div><div class=\"line\">187</div><div class=\"line\">188</div><div class=\"line\">189</div><div class=\"line\">190</div><div class=\"line\">191</div><div class=\"line\">192</div><div class=\"line\">193</div><div class=\"line\">194</div><div class=\"line\">195</div><div class=\"line\">196</div><div class=\"line\">197</div><div class=\"line\">198</div><div class=\"line\">199</div><div class=\"line\">200</div><div class=\"line\">201</div><div class=\"line\">202</div><div class=\"line\">203</div><div class=\"line\">204</div><div class=\"line\">205</div><div class=\"line\">206</div><div class=\"line\">207</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">#!/bin/bash</span></div><div class=\"line\"><span class=\"comment\"># auto install kickstart server</span></div><div class=\"line\"><span class=\"comment\"># the os root's passwd is 123456</span></div><div class=\"line\"><span class=\"comment\">#</span></div><div class=\"line\"><span class=\"comment\"># Filename: auto_install_centos6.x.sh</span></div><div class=\"line\"><span class=\"comment\"># Author: quxl</span></div><div class=\"line\"><span class=\"comment\"># Date:   2014-08-07  </span></div><div class=\"line\"><span class=\"comment\"># Email:  xionglie.qu@gmail.com  </span></div><div class=\"line\"><span class=\"comment\">#------------Environment------------  </span></div><div class=\"line\"><span class=\"comment\">#   Linux 2.6.32-279.el6.x86_64</span></div><div class=\"line\"><span class=\"comment\">#   CentOS release 6.3 (Final)</span></div><div class=\"line\"><span class=\"comment\">#-----------------------------------  </span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#192.168.3.128</span></div><div class=\"line\">KICKSTART_SERVER_IP=`/sbin/ifconfig eth0 | grep <span class=\"string\">'inet addr'</span> | awk <span class=\"string\">'&#123;print $2&#125;'</span> | awk -F: <span class=\"string\">'&#123;print $2&#125;'</span>`</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#192.168.3</span></div><div class=\"line\">KICKSTART_IP_SUBNET=`<span class=\"built_in\">echo</span> <span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span>  | awk -F <span class=\"string\">'.'</span> <span class=\"string\">'&#123;print $1\".\"$2\".\"$3&#125;'</span>`</div><div class=\"line\">KICKSTART_SERVER_SUBNET=<span class=\"variable\">$&#123;KICKSTART_IP_SUBNET&#125;</span>.0</div><div class=\"line\">KICKSTART_SERVER_NETMASK=255.255.255.0</div><div class=\"line\">KICKSTART_SERVER_ROUTE=<span class=\"variable\">$&#123;KICKSTART_IP_SUBNET&#125;</span>.2</div><div class=\"line\">KICKSTART_SERVER_DHCP_IP_START=<span class=\"variable\">$&#123;KICKSTART_IP_SUBNET&#125;</span>.128</div><div class=\"line\">KICKSTART_SERVER_DHCP_IP_END=<span class=\"variable\">$&#123;KICKSTART_IP_SUBNET&#125;</span>.254</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#portmap,发现CentOS 6上不叫portmap，而是改为rpcbind</span></div><div class=\"line\">yum -y install rpcbind nfs-utils </div><div class=\"line\">yum -y install syslinux</div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"----- 1.配置nfs服务器 --------------\"</span></div><div class=\"line\"><span class=\"comment\">#创建共享目录</span></div><div class=\"line\">mkdir -p /data/sys</div><div class=\"line\">mount /dev/cdrom /data/sys</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"mount /dev/cdrom /data/sys\"</span> &gt;&gt;/etc/rc.local </div><div class=\"line\">ls <span class=\"_\">-l</span> /data/sys</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#安装nfs,分发共享目录</span></div><div class=\"line\">rpm -qa | grep nfs</div><div class=\"line\">cat &gt; /etc/exports &lt;&lt; EOF</div><div class=\"line\">/data/sys <span class=\"variable\">$&#123;KICKSTART_SERVER_SUBNET&#125;</span>/24(ro,sync)</div><div class=\"line\">/data/kickstart <span class=\"variable\">$&#123;KICKSTART_SERVER_SUBNET&#125;</span>/24(ro,sync)</div><div class=\"line\">EOF</div><div class=\"line\">cat /etc/exports</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#启动nfs,设置开机启动</span></div><div class=\"line\">/etc/init.d/rpcbind restart</div><div class=\"line\">/etc/init.d/nfs restart</div><div class=\"line\">showmount <span class=\"_\">-e</span> 127.0.0.1</div><div class=\"line\"></div><div class=\"line\">chkconfig rpcbind on</div><div class=\"line\">chkconfig nfs on</div><div class=\"line\">chkconfig --list | egrep <span class=\"string\">\"nfs|rpcbind\"</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"----- 2.配置TFTP服务器 --------------\"</span></div><div class=\"line\">yum -y install tftp-server* -y</div><div class=\"line\">sed -i <span class=\"string\">'/server_args.*=/ s#/var/lib/tftpboot#/tftpboot/#'</span> /etc/xinetd.d/tftp</div><div class=\"line\">sed -i <span class=\"string\">'/disable.*=/ s#yes#no#'</span> /etc/xinetd.d/tftp</div><div class=\"line\">/etc/init.d/xinetd restart</div><div class=\"line\">chkconfig xinetd on</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#与 centos5.x位置不同</span></div><div class=\"line\">mkdir -p /tftpboot</div><div class=\"line\">/bin/cp /usr/share/syslinux/pxelinux.0 /tftpboot/</div><div class=\"line\">/bin/cp /data/sys/images/pxeboot/vmlinuz /tftpboot/</div><div class=\"line\">/bin/cp /data/sys/images/pxeboot/initrd.img /tftpboot/</div><div class=\"line\">ls <span class=\"_\">-l</span> /tftpboot/</div><div class=\"line\"><span class=\"comment\">#initrd.img  pxelinux.0  pxelinux.cfg  vmlinuz</span></div><div class=\"line\"></div><div class=\"line\">mkdir /tftpboot/pxelinux.cfg -p</div><div class=\"line\"><span class=\"comment\">#/bin/cp /data/sys/isolinux/isolinux.cfg /tftpboot/pxelinux.cfg/default</span></div><div class=\"line\"></div><div class=\"line\">cat &gt; /tftpboot/pxelinux.cfg/default &lt;&lt; EOF</div><div class=\"line\">default linux</div><div class=\"line\"><span class=\"comment\">#prompt 1</span></div><div class=\"line\">timeout 600</div><div class=\"line\"></div><div class=\"line\">display boot.msg</div><div class=\"line\"></div><div class=\"line\">menu background splash.jpg</div><div class=\"line\">menu title Welcome to CentOS 6.3!</div><div class=\"line\">menu color border 0 <span class=\"comment\">#ffffffff #00000000</span></div><div class=\"line\">menu color sel 7 <span class=\"comment\">#ffffffff #ff000000</span></div><div class=\"line\">menu color title 0 <span class=\"comment\">#ffffffff #00000000</span></div><div class=\"line\">menu color tabmsg 0 <span class=\"comment\">#ffffffff #00000000</span></div><div class=\"line\">menu color unsel 0 <span class=\"comment\">#ffffffff #00000000</span></div><div class=\"line\">menu color hotsel 0 <span class=\"comment\">#ff000000 #ffffffff</span></div><div class=\"line\">menu color hotkey 7 <span class=\"comment\">#ffffffff #ff000000</span></div><div class=\"line\">menu color scrollbar 0 <span class=\"comment\">#ffffffff #00000000</span></div><div class=\"line\"></div><div class=\"line\">label linux</div><div class=\"line\">  menu label Install system</div><div class=\"line\">  menu default</div><div class=\"line\">  kernel vmlinuz</div><div class=\"line\">  append ks=nfs:<span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span>:/data/kickstart/ks.cfg  initrd=initrd.img</div><div class=\"line\"></div><div class=\"line\">EOF</div><div class=\"line\"></div><div class=\"line\">chmod a+r /tftpboot/pxelinux.cfg/default</div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"----- 3.配置DHCP --------------\"</span></div><div class=\"line\">yum -y install dhcp*</div><div class=\"line\"><span class=\"comment\">#/bin/cp /usr/share/doc/dhcp-4.1.1/dhcpd.conf.sample /etc/dhcpd.conf</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># centos5.x，配置文件都被配置在/etc/dhcpd.conf,</span></div><div class=\"line\"><span class=\"comment\"># centos6.x, 以后放在/etc/dhcp/dhcpd.conf</span></div><div class=\"line\">cat &gt; /etc/dhcp/dhcpd.conf &lt;&lt; EOF</div><div class=\"line\">ddns-update-style none;</div><div class=\"line\">ignore client-updates;</div><div class=\"line\">allow booting;</div><div class=\"line\">allow bootp;</div><div class=\"line\">default-lease-time 21600;</div><div class=\"line\">max-lease-time 43200;</div><div class=\"line\">option routers <span class=\"variable\">$&#123;KICKSTART_SERVER_ROUTE&#125;</span>;</div><div class=\"line\"></div><div class=\"line\">subnet <span class=\"variable\">$&#123;KICKSTART_SERVER_SUBNET&#125;</span> netmask <span class=\"variable\">$&#123;KICKSTART_SERVER_NETMASK&#125;</span> &#123;</div><div class=\"line\">range dynamic-bootp <span class=\"variable\">$&#123;KICKSTART_SERVER_DHCP_IP_START&#125;</span> <span class=\"variable\">$&#123;KICKSTART_SERVER_DHCP_IP_END&#125;</span>;</div><div class=\"line\">next-server <span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span>;</div><div class=\"line\">filename <span class=\"string\">\"/data/kickstart/ks.cfg\"</span>;</div><div class=\"line\">next-server <span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span>;</div><div class=\"line\">filename <span class=\"string\">\"pxelinux.0\"</span>;</div><div class=\"line\">&#125;</div><div class=\"line\">EOF</div><div class=\"line\"></div><div class=\"line\">/etc/init.d/dhcpd restart</div><div class=\"line\"><span class=\"comment\">#出错的话，cat /var/log/messages</span></div><div class=\"line\"></div><div class=\"line\">chkconfig dhcpd on</div><div class=\"line\">chkconfig --list dhcpd</div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"----- 4.配置kickstart --------------\"</span></div><div class=\"line\">mkdir -p /data/kickstart/</div><div class=\"line\"><span class=\"comment\">#/bin/cp /root/anaconda-ks.cfg /data/kickstart/ks.cfg</span></div><div class=\"line\"><span class=\"comment\">#chmod 644 /data/kickstart/ks.cfg</span></div><div class=\"line\"></div><div class=\"line\">cat &gt; /data/kickstart/ks.cfg &lt;&lt; EOF </div><div class=\"line\"><span class=\"comment\">#platform=x86, AMD64, or Intel EM64T</span></div><div class=\"line\"><span class=\"comment\">#version=DEVEL</span></div><div class=\"line\"><span class=\"comment\"># Firewall configuration</span></div><div class=\"line\">firewall --disabled</div><div class=\"line\"><span class=\"comment\"># Install OS instead of upgrade</span></div><div class=\"line\">install</div><div class=\"line\"><span class=\"comment\"># Use NFS installation media</span></div><div class=\"line\">nfs --server=<span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span> --dir=/data/sys</div><div class=\"line\"><span class=\"comment\"># Root password abc123</span></div><div class=\"line\">rootpw --iscrypted \\<span class=\"variable\">$1</span>\\<span class=\"variable\">$A05l5MQt</span>\\<span class=\"variable\">$VAf56PD915R8SwtFYJSeE</span>/</div><div class=\"line\"><span class=\"comment\"># System authorization information</span></div><div class=\"line\">auth  --useshadow  --passalgo=sha512</div><div class=\"line\"><span class=\"comment\"># Use text mode install</span></div><div class=\"line\">text</div><div class=\"line\"><span class=\"comment\"># System keyboard</span></div><div class=\"line\">keyboard us</div><div class=\"line\"><span class=\"comment\"># System language</span></div><div class=\"line\">lang en_US</div><div class=\"line\"><span class=\"comment\"># SELinux configuration</span></div><div class=\"line\">selinux --disabled</div><div class=\"line\"><span class=\"comment\"># Do not configure the X Window System</span></div><div class=\"line\">skipx</div><div class=\"line\"><span class=\"comment\"># Installation logging level</span></div><div class=\"line\">logging --level=info</div><div class=\"line\"><span class=\"comment\"># Reboot after installation</span></div><div class=\"line\">reboot</div><div class=\"line\"><span class=\"comment\"># System timezone</span></div><div class=\"line\">timezone --isUtc Asia/Shanghai</div><div class=\"line\"><span class=\"comment\"># Network information</span></div><div class=\"line\">network  --bootproto=dhcp --device=eth0 --onboot=on</div><div class=\"line\"><span class=\"comment\"># System bootloader configuration</span></div><div class=\"line\">bootloader --location=mbr</div><div class=\"line\"><span class=\"comment\"># Clear the Master Boot Record</span></div><div class=\"line\">zerombr</div><div class=\"line\"><span class=\"comment\"># Partition clearing information</span></div><div class=\"line\">clearpart --all --initlabel</div><div class=\"line\"><span class=\"comment\"># Disk partitioning information</span></div><div class=\"line\">part /boot --asprimary --fstype=<span class=\"string\">\"ext4\"</span> --size=200</div><div class=\"line\">part swap --fstype=<span class=\"string\">\"swap\"</span> --size=512</div><div class=\"line\">part / --asprimary --fstype=<span class=\"string\">\"ext4\"</span> --grow --size=1</div><div class=\"line\"></div><div class=\"line\">%post</div><div class=\"line\"><span class=\"meta\">#!/bin/bash</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"nameserver 208.67.222.222\"</span> &gt;&gt;/etc/resolv.conf</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"nameserver 208.67.220.220\"</span> &gt;&gt;/etc/resolv.conf</div><div class=\"line\"></div><div class=\"line\">mkdir -p /application/tools</div><div class=\"line\">mkdir -p /server/&#123;scripts,backup&#125;</div><div class=\"line\"></div><div class=\"line\">wget -nv -O /server/scripts/update_hostname.sh http://<span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span>/update_hostname.sh</div><div class=\"line\">wget -nv -O /server/scripts/update_ip.sh http://<span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span>/update_ip.sh</div><div class=\"line\">wget -nv -O /server/scripts/update_network.sh http://<span class=\"variable\">$&#123;KICKSTART_SERVER_IP&#125;</span>/update_network.sh</div><div class=\"line\"></div><div class=\"line\">%end</div><div class=\"line\"></div><div class=\"line\">%packages</div><div class=\"line\">@base</div><div class=\"line\">@development</div><div class=\"line\"></div><div class=\"line\">%end</div><div class=\"line\">EOF</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#stop iptables</span></div><div class=\"line\"><span class=\"comment\">#vi /etc/selinux/config</span></div><div class=\"line\">/etc/init.d/iptables stop</div><div class=\"line\">chkconfig iptables off</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#stop selinux</span></div><div class=\"line\">setenforce 0</div><div class=\"line\">sed -i <span class=\"string\">'s#SELINUX=enforcing#SELINUX=disabled#g'</span> /etc/selinux/config </div><div class=\"line\">cat /etc/selinux/config </div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"-----done-----\"</span></div></pre></td></tr></table></figure>\n<p>#3. 相关文件说明</p>\n<h3 id=\"3-1服务器环境说明\"><a href=\"#3-1服务器环境说明\" class=\"headerlink\" title=\"3.1服务器环境说明\"></a>3.1服务器环境说明</h3><p>操作系统：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ks2 ~]# cat /etc/redhat-release</div><div class=\"line\">CentOS release 6.3 (Final)</div><div class=\"line\">[root@ks2 ~]# uname -mi</div><div class=\"line\">x86_64 x86_64</div><div class=\"line\">[root@ks2 ~]# uname -r</div><div class=\"line\">2.6.32-279.el6.x86_64</div></pre></td></tr></table></figure>\n<p>主机网络参数设置：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">网卡eth0: 192.168.27.134</div><div class=\"line\">默认网关: 192.168.27.2</div><div class=\"line\">子网掩码: 255.255.255.0</div></pre></td></tr></table></figure>\n<h3 id=\"3-2-etc-dhcp-dhcpd-conf\"><a href=\"#3-2-etc-dhcp-dhcpd-conf\" class=\"headerlink\" title=\"3.2 /etc/dhcp/dhcpd.conf\"></a>3.2 /etc/dhcp/dhcpd.conf</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@ks2 ~]# cat /etc/dhcp/dhcpd.conf</div><div class=\"line\">ddns-update-style none;</div><div class=\"line\">ignore client-updates;</div><div class=\"line\">allow booting;</div><div class=\"line\">allow bootp;</div><div class=\"line\">default-lease-time 21600;</div><div class=\"line\">max-lease-time 43200;</div><div class=\"line\">option routers 192.168.27.2;</div><div class=\"line\"></div><div class=\"line\">subnet 192.168.27.0 netmask 255.255.255.0 &#123;</div><div class=\"line\">range dynamic-bootp 192.168.27.128 192.168.27.254;</div><div class=\"line\">next-server 192.168.27.134;</div><div class=\"line\">filename &quot;/data/kickstart/ks.cfg&quot;;</div><div class=\"line\">next-server 192.168.27.134;</div><div class=\"line\">filename &quot;pxelinux.0&quot;;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>#4. 可能遇到的错误</p>\n<p>###错误1：<br>在server端已经配置好了，在clinet端用网络引导时能得到地址，但总是报错：</p>\n<p>PXE-T00 Permission deny</p>\n<p>PXE-E36 Error received from tftp server</p>\n<p>解决方法：关掉SElinux </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">1、快速关闭SElinux，使用如下命令就可以：</div><div class=\"line\">　　/usr/sbin/setenforce 0 立刻关闭 SELINUX</div><div class=\"line\">　　/usr/sbin/setenforce 1 立刻启用 SELINUX</div><div class=\"line\">2、加到系统默认启动里面</div><div class=\"line\">　　echo &quot;/usr/sbin/setenforce 0&quot; &gt;&gt; /etc/rc.local</div><div class=\"line\">3、可以编辑配置文件达到同样的目的</div><div class=\"line\">vi /etc/selinux/conf</div><div class=\"line\">set SELINUX=disabled</div></pre></td></tr></table></figure>"},{"layout":"post","title":"使用gradle构建项目02-基础使用","date":"2013-07-16T04:01:00.000Z","comments":1,"_content":"本文包括以下内容： \t\t\n(1)lib导入/导出   \n(2)代码导入eclipse或IDEA   \n(3)代码执行(java程序与web项目)   \n(4)根据项目环境(local,dev,product等)打包     \n\n建议大家遇到问题，先查看一下官方的文档，内容已经非常详细了。   \nhttp://www.gradle.org/documentation  \n\n<!-- more -->\n\n# lib依赖\n## 添加maven库    \nbuild.gradle   \n\n```\nrepositories {   \n    mavenCentral()  \n}\n``` \n\n添加依赖的jar包 \n搜索jar包的写法，可以到这个网去查 http://mvnrepository.com/\n \nbuild.gradle\n\n```\ndependencies {\n    compile group: 'commons-collections', name: 'commons-collections', version: '3.2'\n    testCompile group: 'junit', name: 'junit', version: '4.+'\n}\n```\n\n我的写法如下：\n\n```\ndependencies {\n\tprovidedCompile 'javax.servlet:jsp-api:2.0'\n\tprovidedCompile 'javax.servlet:servlet-api:2.5'\t//省略...\n\tcompile \"ch.qos.logback:logback-classic:0.9.9\"\n\tcompile \"ch.qos.logback:logback-core:0.9.9\"\n    testCompile \"junit:junit:4.8.2\"\n}\n```\n\n## 引入不在maven库的包\n在工作中，有些jar包是自己打的，或在版本库中根本找不到。怎么办呢？  \n我的简单解决方法是，让gradle自己到指定的目录去找jar包\n\n```\nrepositories {\n\tmavenCentral()\n\tflatDir dirs: \"lib\"\n}\n\ndependencies {\n   \tcompile fileTree(dir: 'lib', includes: ['*.jar'])\n   \t//省略...    \n\tcompile \"ch.qos.logback:logback-classic:0.9.9\"\n\tcompile \"ch.qos.logback:logback-core:0.9.9\"\n    testCompile \"junit:junit:4.8.2\"\n}\n```\n\n\n\n# 代码导入eclipse或IDEA\n要想让工程导入到eclipse或IDEA中，需生成一些文件，或eclipse的.project等    \nbuild.gradle\n\n```\napply plugin: 'eclipse'\napply plugin: 'idea'\n```\n执行gradle eclipse 会生成eclipse的工程文档。   \n执行gradle idea 会生成idea的工程文档。  \n具体使用请查看\n\n[http://www.gradle.org/docs/current/userguide/eclipse_plugin.html](http://www.gradle.org/docs/current/userguide/eclipse_plugin.html)\n\n[http://www.gradle.org/docs/current/userguide/idea_plugin.html](http://www.gradle.org/docs/current/userguide/idea_plugin.html)\n\n\n# 代码执行(java程序与web项目)\n## java应用\nbuild.gradle\n\n```\ntask(runMsgServer, dependsOn: 'classes', type: JavaExec) {\n\tmain = 'com.xionglie.tcserver.Main'\n\tclasspath = sourceSets.main.runtimeClasspath\n}\ndefaultTasks 'runMsgServer'\n```\n\n命令行下直接执行 gradle ，就会执行com.xionglie.tcserver.Main的main方法。\n\n## web项目\n可以引入jetty插件  \n\n```\napply plugin: 'jetty'\n```\n\n直接执行：$ gradle jettyRun \n\n详细使用可参考jetty插件说明，  \nhttp://www.gradle.org/docs/current/userguide/jetty_plugin.html\n\n\n# 环境配置,根据项目环境(local,product等)打包\n\n为了方便地将应用部署到开发、测试以及产品等不同环境上， 我们必须在不同的环境使用不同的配置文件。\n\n![Alt text](/images/2013/07/gradle02.png)\n\n```\n// gradle jar -Denv=local\ndef env = System.getProperty(\"env\")?:\"local\"\n\nsourceSets {\n     main {\n         resources {\n             exclude 'src/main/resources'\n             srcDirs = [\"src/main/resources/public\",\"src/main/resources/$env\"]\n         }\n    }\n}\n```\n\n打jar包  \n本地local环境   \n$ gradle jar -Denv=local  \n\n生产product环境  \n$ gradle jar -Denv=product  \n\n","source":"_posts/2013-07-16-gradle-02-basic-use.md","raw":"---\nlayout: post\ntitle: \"使用gradle构建项目02-基础使用\"\ndate: 2013-07-16 12:01\ncomments: true\ncategories: gradle\n---\n本文包括以下内容： \t\t\n(1)lib导入/导出   \n(2)代码导入eclipse或IDEA   \n(3)代码执行(java程序与web项目)   \n(4)根据项目环境(local,dev,product等)打包     \n\n建议大家遇到问题，先查看一下官方的文档，内容已经非常详细了。   \nhttp://www.gradle.org/documentation  \n\n<!-- more -->\n\n# lib依赖\n## 添加maven库    \nbuild.gradle   \n\n```\nrepositories {   \n    mavenCentral()  \n}\n``` \n\n添加依赖的jar包 \n搜索jar包的写法，可以到这个网去查 http://mvnrepository.com/\n \nbuild.gradle\n\n```\ndependencies {\n    compile group: 'commons-collections', name: 'commons-collections', version: '3.2'\n    testCompile group: 'junit', name: 'junit', version: '4.+'\n}\n```\n\n我的写法如下：\n\n```\ndependencies {\n\tprovidedCompile 'javax.servlet:jsp-api:2.0'\n\tprovidedCompile 'javax.servlet:servlet-api:2.5'\t//省略...\n\tcompile \"ch.qos.logback:logback-classic:0.9.9\"\n\tcompile \"ch.qos.logback:logback-core:0.9.9\"\n    testCompile \"junit:junit:4.8.2\"\n}\n```\n\n## 引入不在maven库的包\n在工作中，有些jar包是自己打的，或在版本库中根本找不到。怎么办呢？  \n我的简单解决方法是，让gradle自己到指定的目录去找jar包\n\n```\nrepositories {\n\tmavenCentral()\n\tflatDir dirs: \"lib\"\n}\n\ndependencies {\n   \tcompile fileTree(dir: 'lib', includes: ['*.jar'])\n   \t//省略...    \n\tcompile \"ch.qos.logback:logback-classic:0.9.9\"\n\tcompile \"ch.qos.logback:logback-core:0.9.9\"\n    testCompile \"junit:junit:4.8.2\"\n}\n```\n\n\n\n# 代码导入eclipse或IDEA\n要想让工程导入到eclipse或IDEA中，需生成一些文件，或eclipse的.project等    \nbuild.gradle\n\n```\napply plugin: 'eclipse'\napply plugin: 'idea'\n```\n执行gradle eclipse 会生成eclipse的工程文档。   \n执行gradle idea 会生成idea的工程文档。  \n具体使用请查看\n\n[http://www.gradle.org/docs/current/userguide/eclipse_plugin.html](http://www.gradle.org/docs/current/userguide/eclipse_plugin.html)\n\n[http://www.gradle.org/docs/current/userguide/idea_plugin.html](http://www.gradle.org/docs/current/userguide/idea_plugin.html)\n\n\n# 代码执行(java程序与web项目)\n## java应用\nbuild.gradle\n\n```\ntask(runMsgServer, dependsOn: 'classes', type: JavaExec) {\n\tmain = 'com.xionglie.tcserver.Main'\n\tclasspath = sourceSets.main.runtimeClasspath\n}\ndefaultTasks 'runMsgServer'\n```\n\n命令行下直接执行 gradle ，就会执行com.xionglie.tcserver.Main的main方法。\n\n## web项目\n可以引入jetty插件  \n\n```\napply plugin: 'jetty'\n```\n\n直接执行：$ gradle jettyRun \n\n详细使用可参考jetty插件说明，  \nhttp://www.gradle.org/docs/current/userguide/jetty_plugin.html\n\n\n# 环境配置,根据项目环境(local,product等)打包\n\n为了方便地将应用部署到开发、测试以及产品等不同环境上， 我们必须在不同的环境使用不同的配置文件。\n\n![Alt text](/images/2013/07/gradle02.png)\n\n```\n// gradle jar -Denv=local\ndef env = System.getProperty(\"env\")?:\"local\"\n\nsourceSets {\n     main {\n         resources {\n             exclude 'src/main/resources'\n             srcDirs = [\"src/main/resources/public\",\"src/main/resources/$env\"]\n         }\n    }\n}\n```\n\n打jar包  \n本地local环境   \n$ gradle jar -Denv=local  \n\n生产product环境  \n$ gradle jar -Denv=product  \n\n","slug":"gradle-02-basic-use","published":1,"updated":"2017-01-27T01:34:43.000Z","photos":[],"link":"","_id":"ciyf7fkbq0011f2jywce721j1","content":"<p>本文包括以下内容：<br>(1)lib导入/导出<br>(2)代码导入eclipse或IDEA<br>(3)代码执行(java程序与web项目)<br>(4)根据项目环境(local,dev,product等)打包     </p>\n<p>建议大家遇到问题，先查看一下官方的文档，内容已经非常详细了。<br><a href=\"http://www.gradle.org/documentation\" target=\"_blank\" rel=\"external\">http://www.gradle.org/documentation</a>  </p>\n<a id=\"more\"></a>\n<h1 id=\"lib依赖\"><a href=\"#lib依赖\" class=\"headerlink\" title=\"lib依赖\"></a>lib依赖</h1><h2 id=\"添加maven库\"><a href=\"#添加maven库\" class=\"headerlink\" title=\"添加maven库\"></a>添加maven库</h2><p>build.gradle   </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">repositories &#123;   </div><div class=\"line\">    mavenCentral()  </div><div class=\"line\">&#125;</div><div class=\"line\">``` </div><div class=\"line\"></div><div class=\"line\">添加依赖的jar包 </div><div class=\"line\">搜索jar包的写法，可以到这个网去查 http://mvnrepository.com/</div><div class=\"line\"> </div><div class=\"line\">build.gradle</div></pre></td></tr></table></figure>\n<p>dependencies {<br>    compile group: ‘commons-collections’, name: ‘commons-collections’, version: ‘3.2’<br>    testCompile group: ‘junit’, name: ‘junit’, version: ‘4.+’<br>}<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">我的写法如下：</div></pre></td></tr></table></figure></p>\n<p>dependencies {<br>    providedCompile ‘javax.servlet:jsp-api:2.0’<br>    providedCompile ‘javax.servlet:servlet-api:2.5’    //省略…<br>    compile “ch.qos.logback:logback-classic:0.9.9”<br>    compile “ch.qos.logback:logback-core:0.9.9”<br>    testCompile “junit:junit:4.8.2”<br>}<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">## 引入不在maven库的包</div><div class=\"line\">在工作中，有些jar包是自己打的，或在版本库中根本找不到。怎么办呢？  </div><div class=\"line\">我的简单解决方法是，让gradle自己到指定的目录去找jar包</div></pre></td></tr></table></figure></p>\n<p>repositories {<br>    mavenCentral()<br>    flatDir dirs: “lib”<br>}</p>\n<p>dependencies {<br>       compile fileTree(dir: ‘lib’, includes: [‘*.jar’])<br>       //省略…<br>    compile “ch.qos.logback:logback-classic:0.9.9”<br>    compile “ch.qos.logback:logback-core:0.9.9”<br>    testCompile “junit:junit:4.8.2”<br>}<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"># 代码导入eclipse或IDEA</div><div class=\"line\">要想让工程导入到eclipse或IDEA中，需生成一些文件，或eclipse的.project等    </div><div class=\"line\">build.gradle</div></pre></td></tr></table></figure></p>\n<p>apply plugin: ‘eclipse’<br>apply plugin: ‘idea’<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">执行gradle eclipse 会生成eclipse的工程文档。   </div><div class=\"line\">执行gradle idea 会生成idea的工程文档。  </div><div class=\"line\">具体使用请查看</div><div class=\"line\"></div><div class=\"line\">[http://www.gradle.org/docs/current/userguide/eclipse_plugin.html](http://www.gradle.org/docs/current/userguide/eclipse_plugin.html)</div><div class=\"line\"></div><div class=\"line\">[http://www.gradle.org/docs/current/userguide/idea_plugin.html](http://www.gradle.org/docs/current/userguide/idea_plugin.html)</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"># 代码执行(java程序与web项目)</div><div class=\"line\">## java应用</div><div class=\"line\">build.gradle</div></pre></td></tr></table></figure></p>\n<p>task(runMsgServer, dependsOn: ‘classes’, type: JavaExec) {<br>    main = ‘com.xionglie.tcserver.Main’<br>    classpath = sourceSets.main.runtimeClasspath<br>}<br>defaultTasks ‘runMsgServer’<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">命令行下直接执行 gradle ，就会执行com.xionglie.tcserver.Main的main方法。</div><div class=\"line\"></div><div class=\"line\">## web项目</div><div class=\"line\">可以引入jetty插件</div></pre></td></tr></table></figure></p>\n<p>apply plugin: ‘jetty’<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">直接执行：$ gradle jettyRun </div><div class=\"line\"></div><div class=\"line\">详细使用可参考jetty插件说明，  </div><div class=\"line\">http://www.gradle.org/docs/current/userguide/jetty_plugin.html</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"># 环境配置,根据项目环境(local,product等)打包</div><div class=\"line\"></div><div class=\"line\">为了方便地将应用部署到开发、测试以及产品等不同环境上， 我们必须在不同的环境使用不同的配置文件。</div><div class=\"line\"></div><div class=\"line\">![Alt text](/images/2013/07/gradle02.png)</div></pre></td></tr></table></figure></p>\n<p>// gradle jar -Denv=local<br>def env = System.getProperty(“env”)?:”local”</p>\n<p>sourceSets {<br>     main {<br>         resources {<br>             exclude ‘src/main/resources’<br>             srcDirs = [“src/main/resources/public”,”src/main/resources/$env”]<br>         }<br>    }<br>}<br>```</p>\n<p>打jar包<br>本地local环境<br>$ gradle jar -Denv=local  </p>\n<p>生产product环境<br>$ gradle jar -Denv=product  </p>\n","excerpt":"<p>本文包括以下内容：<br>(1)lib导入/导出<br>(2)代码导入eclipse或IDEA<br>(3)代码执行(java程序与web项目)<br>(4)根据项目环境(local,dev,product等)打包     </p>\n<p>建议大家遇到问题，先查看一下官方的文档，内容已经非常详细了。<br><a href=\"http://www.gradle.org/documentation\">http://www.gradle.org/documentation</a>  </p>","more":"<h1 id=\"lib依赖\"><a href=\"#lib依赖\" class=\"headerlink\" title=\"lib依赖\"></a>lib依赖</h1><h2 id=\"添加maven库\"><a href=\"#添加maven库\" class=\"headerlink\" title=\"添加maven库\"></a>添加maven库</h2><p>build.gradle   </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">repositories &#123;   </div><div class=\"line\">    mavenCentral()  </div><div class=\"line\">&#125;</div><div class=\"line\">``` </div><div class=\"line\"></div><div class=\"line\">添加依赖的jar包 </div><div class=\"line\">搜索jar包的写法，可以到这个网去查 http://mvnrepository.com/</div><div class=\"line\"> </div><div class=\"line\">build.gradle</div></pre></td></tr></table></figure>\n<p>dependencies {<br>    compile group: ‘commons-collections’, name: ‘commons-collections’, version: ‘3.2’<br>    testCompile group: ‘junit’, name: ‘junit’, version: ‘4.+’<br>}<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">我的写法如下：</div></pre></td></tr></table></figure></p>\n<p>dependencies {<br>    providedCompile ‘javax.servlet:jsp-api:2.0’<br>    providedCompile ‘javax.servlet:servlet-api:2.5’    //省略…<br>    compile “ch.qos.logback:logback-classic:0.9.9”<br>    compile “ch.qos.logback:logback-core:0.9.9”<br>    testCompile “junit:junit:4.8.2”<br>}<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">## 引入不在maven库的包</div><div class=\"line\">在工作中，有些jar包是自己打的，或在版本库中根本找不到。怎么办呢？  </div><div class=\"line\">我的简单解决方法是，让gradle自己到指定的目录去找jar包</div></pre></td></tr></table></figure></p>\n<p>repositories {<br>    mavenCentral()<br>    flatDir dirs: “lib”<br>}</p>\n<p>dependencies {<br>       compile fileTree(dir: ‘lib’, includes: [‘*.jar’])<br>       //省略…<br>    compile “ch.qos.logback:logback-classic:0.9.9”<br>    compile “ch.qos.logback:logback-core:0.9.9”<br>    testCompile “junit:junit:4.8.2”<br>}<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"># 代码导入eclipse或IDEA</div><div class=\"line\">要想让工程导入到eclipse或IDEA中，需生成一些文件，或eclipse的.project等    </div><div class=\"line\">build.gradle</div></pre></td></tr></table></figure></p>\n<p>apply plugin: ‘eclipse’<br>apply plugin: ‘idea’<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">执行gradle eclipse 会生成eclipse的工程文档。   </div><div class=\"line\">执行gradle idea 会生成idea的工程文档。  </div><div class=\"line\">具体使用请查看</div><div class=\"line\"></div><div class=\"line\">[http://www.gradle.org/docs/current/userguide/eclipse_plugin.html](http://www.gradle.org/docs/current/userguide/eclipse_plugin.html)</div><div class=\"line\"></div><div class=\"line\">[http://www.gradle.org/docs/current/userguide/idea_plugin.html](http://www.gradle.org/docs/current/userguide/idea_plugin.html)</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"># 代码执行(java程序与web项目)</div><div class=\"line\">## java应用</div><div class=\"line\">build.gradle</div></pre></td></tr></table></figure></p>\n<p>task(runMsgServer, dependsOn: ‘classes’, type: JavaExec) {<br>    main = ‘com.xionglie.tcserver.Main’<br>    classpath = sourceSets.main.runtimeClasspath<br>}<br>defaultTasks ‘runMsgServer’<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">命令行下直接执行 gradle ，就会执行com.xionglie.tcserver.Main的main方法。</div><div class=\"line\"></div><div class=\"line\">## web项目</div><div class=\"line\">可以引入jetty插件</div></pre></td></tr></table></figure></p>\n<p>apply plugin: ‘jetty’<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">直接执行：$ gradle jettyRun </div><div class=\"line\"></div><div class=\"line\">详细使用可参考jetty插件说明，  </div><div class=\"line\">http://www.gradle.org/docs/current/userguide/jetty_plugin.html</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"># 环境配置,根据项目环境(local,product等)打包</div><div class=\"line\"></div><div class=\"line\">为了方便地将应用部署到开发、测试以及产品等不同环境上， 我们必须在不同的环境使用不同的配置文件。</div><div class=\"line\"></div><div class=\"line\">![Alt text](/images/2013/07/gradle02.png)</div></pre></td></tr></table></figure></p>\n<p>// gradle jar -Denv=local<br>def env = System.getProperty(“env”)?:”local”</p>\n<p>sourceSets {<br>     main {<br>         resources {<br>             exclude ‘src/main/resources’<br>             srcDirs = [“src/main/resources/public”,”src/main/resources/$env”]<br>         }<br>    }<br>}<br>```</p>\n<p>打jar包<br>本地local环境<br>$ gradle jar -Denv=local  </p>\n<p>生产product环境<br>$ gradle jar -Denv=product  </p>"},{"layout":"post","title":"Fabric-03 fab命令","date":"2014-08-30T00:52:00.000Z","comments":1,"_content":"\nFabric最常用的命令行工具是fab。当Fabric安装的时候，我们都能在环境变量中找到它。\n\n官方usage说明：[fab options and arguments](http://docs.fabfile.org/en/1.9/usage/fab.html)\n\n主要内容\n\n```\n#1.基本使用方法\n#2.命令行选项\n#3.Per-task参数\n##3.1 Per-task语法定义\n##3.2 角色和主机 Roles and hosts\n```\n<!-- more -->\n\n#1.基本使用方法\n\n最常见的使用方法，使用时没有任何选项(options)\n\n\t$ fab task1 task2\n\n上面命令会在fabfile定义的主机上执行task1，接着是task2。\n\n另一种用法，估计就很少人会知道了，\n\n\t$ fab [options] -- [shell command]\n\n-- 后面的[shell command]会使用Fabric的run命令来执行。如果我们在命令行上定义了主机，[shell command]相当于作为单行的匿名task来执行。\n\n\t$ fab -H host1,host2,host3 -- uname -a\n\n与 执行下面文件\n\n```\nfrom fabric.api import run\n\ndef anonymous():\n    run(\"uname -a\")\n```\n\n的命令\n\n\t$ fab -H host1,host2,host3 anonymous\n\n是一样的效果。\t\n\n测试：\n\n```bash\n[root@fabserver fabric]# cat fabfile.py\nfrom fabric.api import run\n\ndef anonymous():\n    run(\"uname -a\")\n\n[root@fabserver fabric]# fab -H host1,host2,host3 -- uname -a\n[host1] Executing task '<remainder>'\n[host1] run: uname -a\n[host1] out: Linux host1 2.6.32-431.el6.x86_64 #1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux\n[host1] out:\n\n[host2] Executing task '<remainder>'\n[host2] run: uname -a\n[host2] out: Linux host2 2.6.32-431.el6.x86_64 #1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux\n[host2] out:\n\n[host3] Executing task '<remainder>'\n[host3] run: uname -a\n[host3] out: Linux host3 2.6.32-431.el6.x86_64 #1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux\n[host3] out:\n\n\nDone.\nDisconnecting from host2... done.\nDisconnecting from host3... done.\nDisconnecting from host1... done.\n\n[root@fabserver fabric]# fab -H host1,host2,host3 anonymous\n[host1] Executing task 'anonymous'\n[host1] run: uname -a\n[host1] out: Linux host1 2.6.32-431.el6.x86_64 #1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux\n[host1] out:\n\n[host2] Executing task 'anonymous'\n[host2] run: uname -a\n[host2] out: Linux host2 2.6.32-431.el6.x86_64 #1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux\n[host2] out:\n\n[host3] Executing task 'anonymous'\n[host3] run: uname -a\n[host3] out: Linux host3 2.6.32-431.el6.x86_64 #1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux\n[host3] out:\n\n\nDone.\nDisconnecting from host2... done.\nDisconnecting from host3... done.\nDisconnecting from host1... done.\n```\n\n#2.命令行选项\n\nfab命令的选项(options)基本上都可以对应上fabfile中的env变量。\n\n如-H HOSTS, --hosts=HOSTS 有  env.hosts \n\n```bash\n# fab --help\nUsage: fab [options] <command>[:arg1,arg2=val2,host=foo,hosts='h1;h2',...] ...\n\nOptions:\n  -h, --help            show this help message and exit\n  -d NAME, --display=NAME \t\t\t#显示命令[NAME]的细节信息\n                        print detailed info about command NAME\n  -F FORMAT, --list-format=FORMAT \t#格式\n                        formats --list, choices: short, normal, nested\n  -I, --initial-password-prompt\n                        Force password prompt up-front\n  -l, --list            #列出可以执行的命令\n  \t\t\t\t\t\tprint list of possible commands and exit \n  --set=KEY=VALUE,...   #设置env的key=value对\n  \t\t\t\t\t\tcomma separated KEY=VALUE pairs to set Fab env vars \n  --shortlist           alias for -F short --list\n  -V, --version         show program's version number and exit\n  -a, --no_agent        don't use the running SSH agent\n  -A, --forward-agent   forward local agent to remote end\n  --abort-on-prompts    abort instead of prompting (for password, host, etc)\n  -c PATH, --config=PATH\n                        specify location of config file to use\n  --colorize-errors     Color error output\n  -D, --disable-known-hosts\n                        do not load user known_hosts file\n  -e, --eagerly-disconnect\n                        disconnect from hosts as soon as possible\n  -f PATH, --fabfile=PATH #fabric python模块文件路径\n                        python module file to import, e.g. '../other.py'\n  -g HOST, --gateway=HOST #网关\n                        gateway host to connect through\n  --hide=LEVELS         comma-separated list of output levels to hide\n  -H HOSTS, --hosts=HOSTS #主机定义，多个以逗号分开\n                        comma-separated list of hosts to operate on\n  -i PATH               path to SSH private key file. May be repeated.\n  -k, --no-keys         don't load private key files from ~/.ssh/\n  --keepalive=N         enables a keepalive every N seconds\n  --linewise            print line-by-line instead of byte-by-byte\n  -n M, --connection-attempts=M \t#连接尝试次数\n                        make M attempts to connect before giving up\n  --no-pty              do not use pseudo-terminal in run/sudo\n  -p PASSWORD, --password=PASSWORD  #授权或sudo时使用的密码\n                        password for use with authentication and/or sudo\n  -P, --parallel        #并行执行\n  \t\t\t\t\t\tdefault to parallel execution method \n  --port=PORT           SSH connection port #ssh端口\n  -r, --reject-unknown-hosts #主机不存在于SSH known_hosts文件中，就会中止连接\n                        reject unknown hosts\n  --system-known-hosts=SYSTEM_KNOWN_HOSTS\n                        load system known_hosts file before reading user\n                        known_hosts\n  -R ROLES, --roles=ROLES #角色\n                        comma-separated list of roles to operate on\n  -s SHELL, --shell=SHELL #远程执行命令的shell\n                        specify a new shell, defaults to '/bin/bash -l -c'\n  --show=LEVELS         comma-separated list of output levels to show\n  --skip-bad-hosts      skip over hosts that can't be reached\n  --ssh-config-path=PATH\n                        Path to SSH config file\n  -t N, --timeout=N     \t\t\t#ssh连接超时时间\n  \t\t\t\t\t\tset connection timeout to N seconds \n\n  -T N, --command-timeout=N \t\t#ssh远程命令执行超时时间\n                        set remote command timeout to N seconds\n  -u USER, --user=USER  #远程主机的用户名\n  \t\t\t\t\t\tusername to use when connecting to remote hosts \n  -w, --warn-only       warn, instead of abort, when commands fail\n  -x HOSTS, --exclude-hosts=HOSTS \t#哪些主机不需要执行命令\n                        comma-separated list of hosts to exclude\n  -z INT, --pool-size=INT \t\t\t#并行执行时，并发线程数\n                        number of concurrent processes to use in parallel mode\n```\n\n测试：\n\n#####选项 -d \n\n```bash\n[root@fabserver fabric]# cat fabfile.py\ndef hello(name=\"world\"):\n    print(\"Hello %s!\" % name)\n[root@fabserver fabric]# fab -d hello\nDisplaying detailed information for task 'hello':\n\n    No docstring provided\n    Arguments: name='world'\n```\n\n\n\n#3.Per-task参数\n\n##3.1 Per-task语法定义\n\n上面\"2.命令行选项\"提到的命令行选项是全局有效。如果不是变量又在其它地方覆盖命令行选项值的话，这些定义对所有task都是有效的。\n\n我们可以针对每个task，定义不同的参数，这就是“per-task arguments”。\n\n“per-task arguments”语法定义：\n\n  (1) 使用:分隔任务(task)和与参数(arguments)\n\n  (2) 使用,分隔不同的参数(arguments),参数需要反斜线(\\)进行转义,如\\,\n\n  (3) 使用=进行keyword arguments的赋值，或根据位置参数进行定义。同样需要使用反斜线进行转义。\n\n例子：\n\n```bash\n[root@fabserver fabric]# cat fabfile.py\ndef new_user(username, admin='no', comment=\"No comment provided\"):\n    print(\"New User (%s): %s\" % (username, comment))\n    pass\n[root@fabserver fabric]# fab -l\nAvailable commands:\n\n    new_user\n[root@fabserver fabric]#\n\n#仅定义username\n[root@fabserver fabric]# fab new_user:myusername\nNew User (myusername): No comment provided\n\nDone.\n[root@fabserver fabric]# fab new_user:username=myusername\nNew User (myusername): No comment provided\n\nDone.\n\n#使用位置参数\n[root@fabserver fabric]# fab new_user:myusername,yes\nNew User (myusername): No comment provided\n\nDone.\n\n#混合使用\n[root@fabserver fabric]# fab new_user:myusername,admin=yes\nNew User (myusername): No comment provided\n\nDone.\n#使用转义\n[root@fabserver fabric]# fab new_user:myusername,admin=no,comment='Gary\\, new developer (starts Monday)'\nNew User (myusername): Gary, new developer (starts Monday)\n\nDone.\n```\n##3.2 角色和主机 Roles and hosts\n\n常用的参数：host, hosts, role and roles\n\n注意：hosts的主机是以;隔开。\n\n```bash\n[root@fabserver fabric]# fab new_user:myusername,hosts=\"host1;host2\"\n[host1] Executing task 'new_user'\nNew User (myusername): No comment provided\n[host2] Executing task 'new_user'\nNew User (myusername): No comment provided\n\nDone.\n```\n","source":"_posts/2014-08-30-learning-fabric3-fab.md","raw":"---\nlayout: post\ntitle: \"Fabric-03 fab命令\"\ndate: 2014-08-30 08:52\ncomments: true\ncategories: fabric\n---\n\nFabric最常用的命令行工具是fab。当Fabric安装的时候，我们都能在环境变量中找到它。\n\n官方usage说明：[fab options and arguments](http://docs.fabfile.org/en/1.9/usage/fab.html)\n\n主要内容\n\n```\n#1.基本使用方法\n#2.命令行选项\n#3.Per-task参数\n##3.1 Per-task语法定义\n##3.2 角色和主机 Roles and hosts\n```\n<!-- more -->\n\n#1.基本使用方法\n\n最常见的使用方法，使用时没有任何选项(options)\n\n\t$ fab task1 task2\n\n上面命令会在fabfile定义的主机上执行task1，接着是task2。\n\n另一种用法，估计就很少人会知道了，\n\n\t$ fab [options] -- [shell command]\n\n-- 后面的[shell command]会使用Fabric的run命令来执行。如果我们在命令行上定义了主机，[shell command]相当于作为单行的匿名task来执行。\n\n\t$ fab -H host1,host2,host3 -- uname -a\n\n与 执行下面文件\n\n```\nfrom fabric.api import run\n\ndef anonymous():\n    run(\"uname -a\")\n```\n\n的命令\n\n\t$ fab -H host1,host2,host3 anonymous\n\n是一样的效果。\t\n\n测试：\n\n```bash\n[root@fabserver fabric]# cat fabfile.py\nfrom fabric.api import run\n\ndef anonymous():\n    run(\"uname -a\")\n\n[root@fabserver fabric]# fab -H host1,host2,host3 -- uname -a\n[host1] Executing task '<remainder>'\n[host1] run: uname -a\n[host1] out: Linux host1 2.6.32-431.el6.x86_64 #1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux\n[host1] out:\n\n[host2] Executing task '<remainder>'\n[host2] run: uname -a\n[host2] out: Linux host2 2.6.32-431.el6.x86_64 #1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux\n[host2] out:\n\n[host3] Executing task '<remainder>'\n[host3] run: uname -a\n[host3] out: Linux host3 2.6.32-431.el6.x86_64 #1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux\n[host3] out:\n\n\nDone.\nDisconnecting from host2... done.\nDisconnecting from host3... done.\nDisconnecting from host1... done.\n\n[root@fabserver fabric]# fab -H host1,host2,host3 anonymous\n[host1] Executing task 'anonymous'\n[host1] run: uname -a\n[host1] out: Linux host1 2.6.32-431.el6.x86_64 #1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux\n[host1] out:\n\n[host2] Executing task 'anonymous'\n[host2] run: uname -a\n[host2] out: Linux host2 2.6.32-431.el6.x86_64 #1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux\n[host2] out:\n\n[host3] Executing task 'anonymous'\n[host3] run: uname -a\n[host3] out: Linux host3 2.6.32-431.el6.x86_64 #1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux\n[host3] out:\n\n\nDone.\nDisconnecting from host2... done.\nDisconnecting from host3... done.\nDisconnecting from host1... done.\n```\n\n#2.命令行选项\n\nfab命令的选项(options)基本上都可以对应上fabfile中的env变量。\n\n如-H HOSTS, --hosts=HOSTS 有  env.hosts \n\n```bash\n# fab --help\nUsage: fab [options] <command>[:arg1,arg2=val2,host=foo,hosts='h1;h2',...] ...\n\nOptions:\n  -h, --help            show this help message and exit\n  -d NAME, --display=NAME \t\t\t#显示命令[NAME]的细节信息\n                        print detailed info about command NAME\n  -F FORMAT, --list-format=FORMAT \t#格式\n                        formats --list, choices: short, normal, nested\n  -I, --initial-password-prompt\n                        Force password prompt up-front\n  -l, --list            #列出可以执行的命令\n  \t\t\t\t\t\tprint list of possible commands and exit \n  --set=KEY=VALUE,...   #设置env的key=value对\n  \t\t\t\t\t\tcomma separated KEY=VALUE pairs to set Fab env vars \n  --shortlist           alias for -F short --list\n  -V, --version         show program's version number and exit\n  -a, --no_agent        don't use the running SSH agent\n  -A, --forward-agent   forward local agent to remote end\n  --abort-on-prompts    abort instead of prompting (for password, host, etc)\n  -c PATH, --config=PATH\n                        specify location of config file to use\n  --colorize-errors     Color error output\n  -D, --disable-known-hosts\n                        do not load user known_hosts file\n  -e, --eagerly-disconnect\n                        disconnect from hosts as soon as possible\n  -f PATH, --fabfile=PATH #fabric python模块文件路径\n                        python module file to import, e.g. '../other.py'\n  -g HOST, --gateway=HOST #网关\n                        gateway host to connect through\n  --hide=LEVELS         comma-separated list of output levels to hide\n  -H HOSTS, --hosts=HOSTS #主机定义，多个以逗号分开\n                        comma-separated list of hosts to operate on\n  -i PATH               path to SSH private key file. May be repeated.\n  -k, --no-keys         don't load private key files from ~/.ssh/\n  --keepalive=N         enables a keepalive every N seconds\n  --linewise            print line-by-line instead of byte-by-byte\n  -n M, --connection-attempts=M \t#连接尝试次数\n                        make M attempts to connect before giving up\n  --no-pty              do not use pseudo-terminal in run/sudo\n  -p PASSWORD, --password=PASSWORD  #授权或sudo时使用的密码\n                        password for use with authentication and/or sudo\n  -P, --parallel        #并行执行\n  \t\t\t\t\t\tdefault to parallel execution method \n  --port=PORT           SSH connection port #ssh端口\n  -r, --reject-unknown-hosts #主机不存在于SSH known_hosts文件中，就会中止连接\n                        reject unknown hosts\n  --system-known-hosts=SYSTEM_KNOWN_HOSTS\n                        load system known_hosts file before reading user\n                        known_hosts\n  -R ROLES, --roles=ROLES #角色\n                        comma-separated list of roles to operate on\n  -s SHELL, --shell=SHELL #远程执行命令的shell\n                        specify a new shell, defaults to '/bin/bash -l -c'\n  --show=LEVELS         comma-separated list of output levels to show\n  --skip-bad-hosts      skip over hosts that can't be reached\n  --ssh-config-path=PATH\n                        Path to SSH config file\n  -t N, --timeout=N     \t\t\t#ssh连接超时时间\n  \t\t\t\t\t\tset connection timeout to N seconds \n\n  -T N, --command-timeout=N \t\t#ssh远程命令执行超时时间\n                        set remote command timeout to N seconds\n  -u USER, --user=USER  #远程主机的用户名\n  \t\t\t\t\t\tusername to use when connecting to remote hosts \n  -w, --warn-only       warn, instead of abort, when commands fail\n  -x HOSTS, --exclude-hosts=HOSTS \t#哪些主机不需要执行命令\n                        comma-separated list of hosts to exclude\n  -z INT, --pool-size=INT \t\t\t#并行执行时，并发线程数\n                        number of concurrent processes to use in parallel mode\n```\n\n测试：\n\n#####选项 -d \n\n```bash\n[root@fabserver fabric]# cat fabfile.py\ndef hello(name=\"world\"):\n    print(\"Hello %s!\" % name)\n[root@fabserver fabric]# fab -d hello\nDisplaying detailed information for task 'hello':\n\n    No docstring provided\n    Arguments: name='world'\n```\n\n\n\n#3.Per-task参数\n\n##3.1 Per-task语法定义\n\n上面\"2.命令行选项\"提到的命令行选项是全局有效。如果不是变量又在其它地方覆盖命令行选项值的话，这些定义对所有task都是有效的。\n\n我们可以针对每个task，定义不同的参数，这就是“per-task arguments”。\n\n“per-task arguments”语法定义：\n\n  (1) 使用:分隔任务(task)和与参数(arguments)\n\n  (2) 使用,分隔不同的参数(arguments),参数需要反斜线(\\)进行转义,如\\,\n\n  (3) 使用=进行keyword arguments的赋值，或根据位置参数进行定义。同样需要使用反斜线进行转义。\n\n例子：\n\n```bash\n[root@fabserver fabric]# cat fabfile.py\ndef new_user(username, admin='no', comment=\"No comment provided\"):\n    print(\"New User (%s): %s\" % (username, comment))\n    pass\n[root@fabserver fabric]# fab -l\nAvailable commands:\n\n    new_user\n[root@fabserver fabric]#\n\n#仅定义username\n[root@fabserver fabric]# fab new_user:myusername\nNew User (myusername): No comment provided\n\nDone.\n[root@fabserver fabric]# fab new_user:username=myusername\nNew User (myusername): No comment provided\n\nDone.\n\n#使用位置参数\n[root@fabserver fabric]# fab new_user:myusername,yes\nNew User (myusername): No comment provided\n\nDone.\n\n#混合使用\n[root@fabserver fabric]# fab new_user:myusername,admin=yes\nNew User (myusername): No comment provided\n\nDone.\n#使用转义\n[root@fabserver fabric]# fab new_user:myusername,admin=no,comment='Gary\\, new developer (starts Monday)'\nNew User (myusername): Gary, new developer (starts Monday)\n\nDone.\n```\n##3.2 角色和主机 Roles and hosts\n\n常用的参数：host, hosts, role and roles\n\n注意：hosts的主机是以;隔开。\n\n```bash\n[root@fabserver fabric]# fab new_user:myusername,hosts=\"host1;host2\"\n[host1] Executing task 'new_user'\nNew User (myusername): No comment provided\n[host2] Executing task 'new_user'\nNew User (myusername): No comment provided\n\nDone.\n```\n","slug":"learning-fabric3-fab","published":1,"updated":"2017-01-27T02:04:55.000Z","photos":[],"link":"","_id":"ciyf7fkbs0012f2jyvyayepv3","content":"<p>Fabric最常用的命令行工具是fab。当Fabric安装的时候，我们都能在环境变量中找到它。</p>\n<p>官方usage说明：<a href=\"http://docs.fabfile.org/en/1.9/usage/fab.html\" target=\"_blank\" rel=\"external\">fab options and arguments</a></p>\n<p>主要内容</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">#1.基本使用方法</div><div class=\"line\">#2.命令行选项</div><div class=\"line\">#3.Per-task参数</div><div class=\"line\">##3.1 Per-task语法定义</div><div class=\"line\">##3.2 角色和主机 Roles and hosts</div></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<p>#1.基本使用方法</p>\n<p>最常见的使用方法，使用时没有任何选项(options)</p>\n<pre><code>$ fab task1 task2\n</code></pre><p>上面命令会在fabfile定义的主机上执行task1，接着是task2。</p>\n<p>另一种用法，估计就很少人会知道了，</p>\n<pre><code>$ fab [options] -- [shell command]\n</code></pre><p>– 后面的[shell command]会使用Fabric的run命令来执行。如果我们在命令行上定义了主机，[shell command]相当于作为单行的匿名task来执行。</p>\n<pre><code>$ fab -H host1,host2,host3 -- uname -a\n</code></pre><p>与 执行下面文件</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">from fabric.api import run</div><div class=\"line\"></div><div class=\"line\">def anonymous():</div><div class=\"line\">    run(&quot;uname -a&quot;)</div></pre></td></tr></table></figure>\n<p>的命令</p>\n<pre><code>$ fab -H host1,host2,host3 anonymous\n</code></pre><p>是一样的效果。    </p>\n<p>测试：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># cat fabfile.py</span></div><div class=\"line\">from fabric.api import run</div><div class=\"line\"></div><div class=\"line\">def anonymous():</div><div class=\"line\">    run(<span class=\"string\">\"uname -a\"</span>)</div><div class=\"line\"></div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab -H host1,host2,host3 -- uname -a</span></div><div class=\"line\">[host1] Executing task <span class=\"string\">'&lt;remainder&gt;'</span></div><div class=\"line\">[host1] run: uname <span class=\"_\">-a</span></div><div class=\"line\">[host1] out: Linux host1 2.6.32-431.el6.x86_64 <span class=\"comment\">#1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux</span></div><div class=\"line\">[host1] out:</div><div class=\"line\"></div><div class=\"line\">[host2] Executing task <span class=\"string\">'&lt;remainder&gt;'</span></div><div class=\"line\">[host2] run: uname <span class=\"_\">-a</span></div><div class=\"line\">[host2] out: Linux host2 2.6.32-431.el6.x86_64 <span class=\"comment\">#1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux</span></div><div class=\"line\">[host2] out:</div><div class=\"line\"></div><div class=\"line\">[host3] Executing task <span class=\"string\">'&lt;remainder&gt;'</span></div><div class=\"line\">[host3] run: uname <span class=\"_\">-a</span></div><div class=\"line\">[host3] out: Linux host3 2.6.32-431.el6.x86_64 <span class=\"comment\">#1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux</span></div><div class=\"line\">[host3] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host2... done.</div><div class=\"line\">Disconnecting from host3... done.</div><div class=\"line\">Disconnecting from host1... done.</div><div class=\"line\"></div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab -H host1,host2,host3 anonymous</span></div><div class=\"line\">[host1] Executing task <span class=\"string\">'anonymous'</span></div><div class=\"line\">[host1] run: uname <span class=\"_\">-a</span></div><div class=\"line\">[host1] out: Linux host1 2.6.32-431.el6.x86_64 <span class=\"comment\">#1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux</span></div><div class=\"line\">[host1] out:</div><div class=\"line\"></div><div class=\"line\">[host2] Executing task <span class=\"string\">'anonymous'</span></div><div class=\"line\">[host2] run: uname <span class=\"_\">-a</span></div><div class=\"line\">[host2] out: Linux host2 2.6.32-431.el6.x86_64 <span class=\"comment\">#1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux</span></div><div class=\"line\">[host2] out:</div><div class=\"line\"></div><div class=\"line\">[host3] Executing task <span class=\"string\">'anonymous'</span></div><div class=\"line\">[host3] run: uname <span class=\"_\">-a</span></div><div class=\"line\">[host3] out: Linux host3 2.6.32-431.el6.x86_64 <span class=\"comment\">#1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux</span></div><div class=\"line\">[host3] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host2... done.</div><div class=\"line\">Disconnecting from host3... done.</div><div class=\"line\">Disconnecting from host1... done.</div></pre></td></tr></table></figure>\n<p>#2.命令行选项</p>\n<p>fab命令的选项(options)基本上都可以对应上fabfile中的env变量。</p>\n<p>如-H HOSTS, –hosts=HOSTS 有  env.hosts </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># fab --help</span></div><div class=\"line\">Usage: fab [options] &lt;<span class=\"built_in\">command</span>&gt;[:arg1,arg2=val2,host=foo,hosts=<span class=\"string\">'h1;h2'</span>,...] ...</div><div class=\"line\"></div><div class=\"line\">Options:</div><div class=\"line\">  -h, --help            show this <span class=\"built_in\">help</span> message and <span class=\"built_in\">exit</span></div><div class=\"line\">  <span class=\"_\">-d</span> NAME, --display=NAME \t\t\t<span class=\"comment\">#显示命令[NAME]的细节信息</span></div><div class=\"line\">                        <span class=\"built_in\">print</span> detailed info about <span class=\"built_in\">command</span> NAME</div><div class=\"line\">  -F FORMAT, --list-format=FORMAT \t<span class=\"comment\">#格式</span></div><div class=\"line\">                        formats --list, choices: short, normal, nested</div><div class=\"line\">  -I, --initial-password-prompt</div><div class=\"line\">                        Force password prompt up-front</div><div class=\"line\">  <span class=\"_\">-l</span>, --list            <span class=\"comment\">#列出可以执行的命令</span></div><div class=\"line\">  \t\t\t\t\t\t<span class=\"built_in\">print</span> list of possible commands and <span class=\"built_in\">exit</span> </div><div class=\"line\">  --set=KEY=VALUE,...   <span class=\"comment\">#设置env的key=value对</span></div><div class=\"line\">  \t\t\t\t\t\tcomma separated KEY=VALUE pairs to <span class=\"built_in\">set</span> Fab env vars </div><div class=\"line\">  --shortlist           <span class=\"built_in\">alias</span> <span class=\"keyword\">for</span> -F short --list</div><div class=\"line\">  -V, --version         show program<span class=\"string\">'s version number and exit</span></div><div class=\"line\">  -a, --no_agent        don't use the running SSH agent</div><div class=\"line\">  -A, --forward-agent   forward <span class=\"built_in\">local</span> agent to remote end</div><div class=\"line\">  --abort-on-prompts    abort instead of prompting (<span class=\"keyword\">for</span> password, host, etc)</div><div class=\"line\">  -c PATH, --config=PATH</div><div class=\"line\">                        specify location of config file to use</div><div class=\"line\">  --colorize-errors     Color error output</div><div class=\"line\">  -D, --disable-known-hosts</div><div class=\"line\">                        <span class=\"keyword\">do</span> not load user known_hosts file</div><div class=\"line\">  <span class=\"_\">-e</span>, --eagerly-disconnect</div><div class=\"line\">                        disconnect from hosts as soon as possible</div><div class=\"line\">  <span class=\"_\">-f</span> PATH, --fabfile=PATH <span class=\"comment\">#fabric python模块文件路径</span></div><div class=\"line\">                        python module file to import, e.g. <span class=\"string\">'../other.py'</span></div><div class=\"line\">  -g HOST, --gateway=HOST <span class=\"comment\">#网关</span></div><div class=\"line\">                        gateway host to connect through</div><div class=\"line\">  --hide=LEVELS         comma-separated list of output levels to hide</div><div class=\"line\">  -H HOSTS, --hosts=HOSTS <span class=\"comment\">#主机定义，多个以逗号分开</span></div><div class=\"line\">                        comma-separated list of hosts to operate on</div><div class=\"line\">  -i PATH               path to SSH private key file. May be repeated.</div><div class=\"line\">  -k, --no-keys         don<span class=\"string\">'t load private key files from ~/.ssh/</span></div><div class=\"line\">  --keepalive=N         enables a keepalive every N seconds</div><div class=\"line\">  --linewise            print line-by-line instead of byte-by-byte</div><div class=\"line\">  -n M, --connection-attempts=M \t#连接尝试次数</div><div class=\"line\">                        make M attempts to connect before giving up</div><div class=\"line\">  --no-pty              do not use pseudo-terminal in run/sudo</div><div class=\"line\">  -p PASSWORD, --password=PASSWORD  #授权或sudo时使用的密码</div><div class=\"line\">                        password for use with authentication and/or sudo</div><div class=\"line\">  -P, --parallel        #并行执行</div><div class=\"line\">  \t\t\t\t\t\tdefault to parallel execution method </div><div class=\"line\">  --port=PORT           SSH connection port #ssh端口</div><div class=\"line\">  -r, --reject-unknown-hosts #主机不存在于SSH known_hosts文件中，就会中止连接</div><div class=\"line\">                        reject unknown hosts</div><div class=\"line\">  --system-known-hosts=SYSTEM_KNOWN_HOSTS</div><div class=\"line\">                        load system known_hosts file before reading user</div><div class=\"line\">                        known_hosts</div><div class=\"line\">  -R ROLES, --roles=ROLES #角色</div><div class=\"line\">                        comma-separated list of roles to operate on</div><div class=\"line\">  -s SHELL, --shell=SHELL #远程执行命令的shell</div><div class=\"line\">                        specify a new shell, defaults to '/bin/bash <span class=\"_\">-l</span> -c<span class=\"string\">'</span></div><div class=\"line\">  --show=LEVELS         comma-separated list of output levels to show</div><div class=\"line\">  --skip-bad-hosts      skip over hosts that can't be reached</div><div class=\"line\">  --ssh-config-path=PATH</div><div class=\"line\">                        Path to SSH config file</div><div class=\"line\">  -t N, --timeout=N     \t\t\t<span class=\"comment\">#ssh连接超时时间</span></div><div class=\"line\">  \t\t\t\t\t\t<span class=\"built_in\">set</span> connection timeout to N seconds </div><div class=\"line\"></div><div class=\"line\">  -T N, --command-timeout=N \t\t<span class=\"comment\">#ssh远程命令执行超时时间</span></div><div class=\"line\">                        <span class=\"built_in\">set</span> remote <span class=\"built_in\">command</span> timeout to N seconds</div><div class=\"line\">  -u USER, --user=USER  <span class=\"comment\">#远程主机的用户名</span></div><div class=\"line\">  \t\t\t\t\t\tusername to use when connecting to remote hosts </div><div class=\"line\">  -w, --warn-only       warn, instead of abort, when commands fail</div><div class=\"line\">  -x HOSTS, --exclude-hosts=HOSTS \t<span class=\"comment\">#哪些主机不需要执行命令</span></div><div class=\"line\">                        comma-separated list of hosts to exclude</div><div class=\"line\">  -z INT, --pool-size=INT \t\t\t<span class=\"comment\">#并行执行时，并发线程数</span></div><div class=\"line\">                        number of concurrent processes to use <span class=\"keyword\">in</span> parallel mode</div></pre></td></tr></table></figure>\n<p>测试：</p>\n<p>#####选项 -d </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># cat fabfile.py</span></div><div class=\"line\">def hello(name=<span class=\"string\">\"world\"</span>):</div><div class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">\"Hello %s!\"</span> % name)</div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab -d hello</span></div><div class=\"line\">Displaying detailed information <span class=\"keyword\">for</span> task <span class=\"string\">'hello'</span>:</div><div class=\"line\"></div><div class=\"line\">    No docstring provided</div><div class=\"line\">    Arguments: name=<span class=\"string\">'world'</span></div></pre></td></tr></table></figure>\n<p>#3.Per-task参数</p>\n<p>##3.1 Per-task语法定义</p>\n<p>上面”2.命令行选项”提到的命令行选项是全局有效。如果不是变量又在其它地方覆盖命令行选项值的话，这些定义对所有task都是有效的。</p>\n<p>我们可以针对每个task，定义不同的参数，这就是“per-task arguments”。</p>\n<p>“per-task arguments”语法定义：</p>\n<p>  (1) 使用:分隔任务(task)和与参数(arguments)</p>\n<p>  (2) 使用,分隔不同的参数(arguments),参数需要反斜线()进行转义,如\\,</p>\n<p>  (3) 使用=进行keyword arguments的赋值，或根据位置参数进行定义。同样需要使用反斜线进行转义。</p>\n<p>例子：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># cat fabfile.py</span></div><div class=\"line\">def new_user(username, admin=<span class=\"string\">'no'</span>, comment=<span class=\"string\">\"No comment provided\"</span>):</div><div class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">\"New User (%s): %s\"</span> % (username, comment))</div><div class=\"line\">    pass</div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab -l</span></div><div class=\"line\">Available commands:</div><div class=\"line\"></div><div class=\"line\">    new_user</div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\">#</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#仅定义username</span></div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab new_user:myusername</span></div><div class=\"line\">New User (myusername): No comment provided</div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab new_user:username=myusername</span></div><div class=\"line\">New User (myusername): No comment provided</div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#使用位置参数</span></div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab new_user:myusername,yes</span></div><div class=\"line\">New User (myusername): No comment provided</div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#混合使用</span></div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab new_user:myusername,admin=yes</span></div><div class=\"line\">New User (myusername): No comment provided</div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\"><span class=\"comment\">#使用转义</span></div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab new_user:myusername,admin=no,comment='Gary\\, new developer (starts Monday)'</span></div><div class=\"line\">New User (myusername): Gary, new developer (starts Monday)</div><div class=\"line\"></div><div class=\"line\">Done.</div></pre></td></tr></table></figure>\n<p>##3.2 角色和主机 Roles and hosts</p>\n<p>常用的参数：host, hosts, role and roles</p>\n<p>注意：hosts的主机是以;隔开。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab new_user:myusername,hosts=\"host1;host2\"</span></div><div class=\"line\">[host1] Executing task <span class=\"string\">'new_user'</span></div><div class=\"line\">New User (myusername): No comment provided</div><div class=\"line\">[host2] Executing task <span class=\"string\">'new_user'</span></div><div class=\"line\">New User (myusername): No comment provided</div><div class=\"line\"></div><div class=\"line\">Done.</div></pre></td></tr></table></figure>\n","excerpt":"<p>Fabric最常用的命令行工具是fab。当Fabric安装的时候，我们都能在环境变量中找到它。</p>\n<p>官方usage说明：<a href=\"http://docs.fabfile.org/en/1.9/usage/fab.html\">fab options and arguments</a></p>\n<p>主要内容</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">#1.基本使用方法</div><div class=\"line\">#2.命令行选项</div><div class=\"line\">#3.Per-task参数</div><div class=\"line\">##3.1 Per-task语法定义</div><div class=\"line\">##3.2 角色和主机 Roles and hosts</div></pre></td></tr></table></figure>","more":"<p>#1.基本使用方法</p>\n<p>最常见的使用方法，使用时没有任何选项(options)</p>\n<pre><code>$ fab task1 task2\n</code></pre><p>上面命令会在fabfile定义的主机上执行task1，接着是task2。</p>\n<p>另一种用法，估计就很少人会知道了，</p>\n<pre><code>$ fab [options] -- [shell command]\n</code></pre><p>– 后面的[shell command]会使用Fabric的run命令来执行。如果我们在命令行上定义了主机，[shell command]相当于作为单行的匿名task来执行。</p>\n<pre><code>$ fab -H host1,host2,host3 -- uname -a\n</code></pre><p>与 执行下面文件</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">from fabric.api import run</div><div class=\"line\"></div><div class=\"line\">def anonymous():</div><div class=\"line\">    run(&quot;uname -a&quot;)</div></pre></td></tr></table></figure>\n<p>的命令</p>\n<pre><code>$ fab -H host1,host2,host3 anonymous\n</code></pre><p>是一样的效果。    </p>\n<p>测试：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># cat fabfile.py</span></div><div class=\"line\">from fabric.api import run</div><div class=\"line\"></div><div class=\"line\">def anonymous():</div><div class=\"line\">    run(<span class=\"string\">\"uname -a\"</span>)</div><div class=\"line\"></div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab -H host1,host2,host3 -- uname -a</span></div><div class=\"line\">[host1] Executing task <span class=\"string\">'&lt;remainder&gt;'</span></div><div class=\"line\">[host1] run: uname <span class=\"_\">-a</span></div><div class=\"line\">[host1] out: Linux host1 2.6.32-431.el6.x86_64 <span class=\"comment\">#1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux</span></div><div class=\"line\">[host1] out:</div><div class=\"line\"></div><div class=\"line\">[host2] Executing task <span class=\"string\">'&lt;remainder&gt;'</span></div><div class=\"line\">[host2] run: uname <span class=\"_\">-a</span></div><div class=\"line\">[host2] out: Linux host2 2.6.32-431.el6.x86_64 <span class=\"comment\">#1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux</span></div><div class=\"line\">[host2] out:</div><div class=\"line\"></div><div class=\"line\">[host3] Executing task <span class=\"string\">'&lt;remainder&gt;'</span></div><div class=\"line\">[host3] run: uname <span class=\"_\">-a</span></div><div class=\"line\">[host3] out: Linux host3 2.6.32-431.el6.x86_64 <span class=\"comment\">#1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux</span></div><div class=\"line\">[host3] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host2... done.</div><div class=\"line\">Disconnecting from host3... done.</div><div class=\"line\">Disconnecting from host1... done.</div><div class=\"line\"></div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab -H host1,host2,host3 anonymous</span></div><div class=\"line\">[host1] Executing task <span class=\"string\">'anonymous'</span></div><div class=\"line\">[host1] run: uname <span class=\"_\">-a</span></div><div class=\"line\">[host1] out: Linux host1 2.6.32-431.el6.x86_64 <span class=\"comment\">#1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux</span></div><div class=\"line\">[host1] out:</div><div class=\"line\"></div><div class=\"line\">[host2] Executing task <span class=\"string\">'anonymous'</span></div><div class=\"line\">[host2] run: uname <span class=\"_\">-a</span></div><div class=\"line\">[host2] out: Linux host2 2.6.32-431.el6.x86_64 <span class=\"comment\">#1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux</span></div><div class=\"line\">[host2] out:</div><div class=\"line\"></div><div class=\"line\">[host3] Executing task <span class=\"string\">'anonymous'</span></div><div class=\"line\">[host3] run: uname <span class=\"_\">-a</span></div><div class=\"line\">[host3] out: Linux host3 2.6.32-431.el6.x86_64 <span class=\"comment\">#1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux</span></div><div class=\"line\">[host3] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host2... done.</div><div class=\"line\">Disconnecting from host3... done.</div><div class=\"line\">Disconnecting from host1... done.</div></pre></td></tr></table></figure>\n<p>#2.命令行选项</p>\n<p>fab命令的选项(options)基本上都可以对应上fabfile中的env变量。</p>\n<p>如-H HOSTS, –hosts=HOSTS 有  env.hosts </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># fab --help</span></div><div class=\"line\">Usage: fab [options] &lt;<span class=\"built_in\">command</span>&gt;[:arg1,arg2=val2,host=foo,hosts=<span class=\"string\">'h1;h2'</span>,...] ...</div><div class=\"line\"></div><div class=\"line\">Options:</div><div class=\"line\">  -h, --help            show this <span class=\"built_in\">help</span> message and <span class=\"built_in\">exit</span></div><div class=\"line\">  <span class=\"_\">-d</span> NAME, --display=NAME \t\t\t<span class=\"comment\">#显示命令[NAME]的细节信息</span></div><div class=\"line\">                        <span class=\"built_in\">print</span> detailed info about <span class=\"built_in\">command</span> NAME</div><div class=\"line\">  -F FORMAT, --list-format=FORMAT \t<span class=\"comment\">#格式</span></div><div class=\"line\">                        formats --list, choices: short, normal, nested</div><div class=\"line\">  -I, --initial-password-prompt</div><div class=\"line\">                        Force password prompt up-front</div><div class=\"line\">  <span class=\"_\">-l</span>, --list            <span class=\"comment\">#列出可以执行的命令</span></div><div class=\"line\">  \t\t\t\t\t\t<span class=\"built_in\">print</span> list of possible commands and <span class=\"built_in\">exit</span> </div><div class=\"line\">  --set=KEY=VALUE,...   <span class=\"comment\">#设置env的key=value对</span></div><div class=\"line\">  \t\t\t\t\t\tcomma separated KEY=VALUE pairs to <span class=\"built_in\">set</span> Fab env vars </div><div class=\"line\">  --shortlist           <span class=\"built_in\">alias</span> <span class=\"keyword\">for</span> -F short --list</div><div class=\"line\">  -V, --version         show program<span class=\"string\">'s version number and exit</div><div class=\"line\">  -a, --no_agent        don'</span>t use the running SSH agent</div><div class=\"line\">  -A, --forward-agent   forward <span class=\"built_in\">local</span> agent to remote end</div><div class=\"line\">  --abort-on-prompts    abort instead of prompting (<span class=\"keyword\">for</span> password, host, etc)</div><div class=\"line\">  -c PATH, --config=PATH</div><div class=\"line\">                        specify location of config file to use</div><div class=\"line\">  --colorize-errors     Color error output</div><div class=\"line\">  -D, --disable-known-hosts</div><div class=\"line\">                        <span class=\"keyword\">do</span> not load user known_hosts file</div><div class=\"line\">  <span class=\"_\">-e</span>, --eagerly-disconnect</div><div class=\"line\">                        disconnect from hosts as soon as possible</div><div class=\"line\">  <span class=\"_\">-f</span> PATH, --fabfile=PATH <span class=\"comment\">#fabric python模块文件路径</span></div><div class=\"line\">                        python module file to import, e.g. <span class=\"string\">'../other.py'</span></div><div class=\"line\">  -g HOST, --gateway=HOST <span class=\"comment\">#网关</span></div><div class=\"line\">                        gateway host to connect through</div><div class=\"line\">  --hide=LEVELS         comma-separated list of output levels to hide</div><div class=\"line\">  -H HOSTS, --hosts=HOSTS <span class=\"comment\">#主机定义，多个以逗号分开</span></div><div class=\"line\">                        comma-separated list of hosts to operate on</div><div class=\"line\">  -i PATH               path to SSH private key file. May be repeated.</div><div class=\"line\">  -k, --no-keys         don<span class=\"string\">'t load private key files from ~/.ssh/</div><div class=\"line\">  --keepalive=N         enables a keepalive every N seconds</div><div class=\"line\">  --linewise            print line-by-line instead of byte-by-byte</div><div class=\"line\">  -n M, --connection-attempts=M \t#连接尝试次数</div><div class=\"line\">                        make M attempts to connect before giving up</div><div class=\"line\">  --no-pty              do not use pseudo-terminal in run/sudo</div><div class=\"line\">  -p PASSWORD, --password=PASSWORD  #授权或sudo时使用的密码</div><div class=\"line\">                        password for use with authentication and/or sudo</div><div class=\"line\">  -P, --parallel        #并行执行</div><div class=\"line\">  \t\t\t\t\t\tdefault to parallel execution method </div><div class=\"line\">  --port=PORT           SSH connection port #ssh端口</div><div class=\"line\">  -r, --reject-unknown-hosts #主机不存在于SSH known_hosts文件中，就会中止连接</div><div class=\"line\">                        reject unknown hosts</div><div class=\"line\">  --system-known-hosts=SYSTEM_KNOWN_HOSTS</div><div class=\"line\">                        load system known_hosts file before reading user</div><div class=\"line\">                        known_hosts</div><div class=\"line\">  -R ROLES, --roles=ROLES #角色</div><div class=\"line\">                        comma-separated list of roles to operate on</div><div class=\"line\">  -s SHELL, --shell=SHELL #远程执行命令的shell</div><div class=\"line\">                        specify a new shell, defaults to '</span>/bin/bash <span class=\"_\">-l</span> -c<span class=\"string\">'</div><div class=\"line\">  --show=LEVELS         comma-separated list of output levels to show</div><div class=\"line\">  --skip-bad-hosts      skip over hosts that can'</span>t be reached</div><div class=\"line\">  --ssh-config-path=PATH</div><div class=\"line\">                        Path to SSH config file</div><div class=\"line\">  -t N, --timeout=N     \t\t\t<span class=\"comment\">#ssh连接超时时间</span></div><div class=\"line\">  \t\t\t\t\t\t<span class=\"built_in\">set</span> connection timeout to N seconds </div><div class=\"line\"></div><div class=\"line\">  -T N, --command-timeout=N \t\t<span class=\"comment\">#ssh远程命令执行超时时间</span></div><div class=\"line\">                        <span class=\"built_in\">set</span> remote <span class=\"built_in\">command</span> timeout to N seconds</div><div class=\"line\">  -u USER, --user=USER  <span class=\"comment\">#远程主机的用户名</span></div><div class=\"line\">  \t\t\t\t\t\tusername to use when connecting to remote hosts </div><div class=\"line\">  -w, --warn-only       warn, instead of abort, when commands fail</div><div class=\"line\">  -x HOSTS, --exclude-hosts=HOSTS \t<span class=\"comment\">#哪些主机不需要执行命令</span></div><div class=\"line\">                        comma-separated list of hosts to exclude</div><div class=\"line\">  -z INT, --pool-size=INT \t\t\t<span class=\"comment\">#并行执行时，并发线程数</span></div><div class=\"line\">                        number of concurrent processes to use <span class=\"keyword\">in</span> parallel mode</div></pre></td></tr></table></figure>\n<p>测试：</p>\n<p>#####选项 -d </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># cat fabfile.py</span></div><div class=\"line\">def hello(name=<span class=\"string\">\"world\"</span>):</div><div class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">\"Hello %s!\"</span> % name)</div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab -d hello</span></div><div class=\"line\">Displaying detailed information <span class=\"keyword\">for</span> task <span class=\"string\">'hello'</span>:</div><div class=\"line\"></div><div class=\"line\">    No docstring provided</div><div class=\"line\">    Arguments: name=<span class=\"string\">'world'</span></div></pre></td></tr></table></figure>\n<p>#3.Per-task参数</p>\n<p>##3.1 Per-task语法定义</p>\n<p>上面”2.命令行选项”提到的命令行选项是全局有效。如果不是变量又在其它地方覆盖命令行选项值的话，这些定义对所有task都是有效的。</p>\n<p>我们可以针对每个task，定义不同的参数，这就是“per-task arguments”。</p>\n<p>“per-task arguments”语法定义：</p>\n<p>  (1) 使用:分隔任务(task)和与参数(arguments)</p>\n<p>  (2) 使用,分隔不同的参数(arguments),参数需要反斜线()进行转义,如\\,</p>\n<p>  (3) 使用=进行keyword arguments的赋值，或根据位置参数进行定义。同样需要使用反斜线进行转义。</p>\n<p>例子：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># cat fabfile.py</span></div><div class=\"line\">def new_user(username, admin=<span class=\"string\">'no'</span>, comment=<span class=\"string\">\"No comment provided\"</span>):</div><div class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">\"New User (%s): %s\"</span> % (username, comment))</div><div class=\"line\">    pass</div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab -l</span></div><div class=\"line\">Available commands:</div><div class=\"line\"></div><div class=\"line\">    new_user</div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\">#</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#仅定义username</span></div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab new_user:myusername</span></div><div class=\"line\">New User (myusername): No comment provided</div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab new_user:username=myusername</span></div><div class=\"line\">New User (myusername): No comment provided</div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#使用位置参数</span></div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab new_user:myusername,yes</span></div><div class=\"line\">New User (myusername): No comment provided</div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#混合使用</span></div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab new_user:myusername,admin=yes</span></div><div class=\"line\">New User (myusername): No comment provided</div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\"><span class=\"comment\">#使用转义</span></div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab new_user:myusername,admin=no,comment='Gary\\, new developer (starts Monday)'</span></div><div class=\"line\">New User (myusername): Gary, new developer (starts Monday)</div><div class=\"line\"></div><div class=\"line\">Done.</div></pre></td></tr></table></figure>\n<p>##3.2 角色和主机 Roles and hosts</p>\n<p>常用的参数：host, hosts, role and roles</p>\n<p>注意：hosts的主机是以;隔开。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab new_user:myusername,hosts=\"host1;host2\"</span></div><div class=\"line\">[host1] Executing task <span class=\"string\">'new_user'</span></div><div class=\"line\">New User (myusername): No comment provided</div><div class=\"line\">[host2] Executing task <span class=\"string\">'new_user'</span></div><div class=\"line\">New User (myusername): No comment provided</div><div class=\"line\"></div><div class=\"line\">Done.</div></pre></td></tr></table></figure>"},{"layout":"post","title":"【转】常用IDEA快捷键","date":"2013-06-29T01:00:00.000Z","comments":1,"_content":"\n\n\n最近已经从eclipse转到IntelliJ IDEA，IDEA用起来太顺手了，许多功能正合我意。  \n看到时光印记写的一篇《常用IDEA快捷键》真的不错，特转一下!  \n\n<!-- more -->\n\n说明一下：类似eclipse outline (Ctrl+o)快捷键在idea里是 Ctrl+F12  \n   ------以下便是全文------------  \n   \n原文地址：[http://www.colorfuldays.org/program/idea_keymap/](http://www.colorfuldays.org/program/idea_keymap/  ) \n\n先说明一下这篇文章的由来。前天 @旅途无疆 强烈要求我整理一下IDEA的快捷键，于是我答应了。但是昨天实在太忙，没时间整。于是哥被他羞辱了一番，为了不继续丢人下去，哥今天花了将近2小时，整理了下面这些东西，希望对各位看官有用。下面列举的是我在日常开发工作中经常用到的快捷键。    \n\n声明一下，以下快捷键都是在Mac下的，Windows下的话，会有些不同，请参照Windows版IDEA的keymap文档。   \n\n一些技巧：  \n在任何时候，按下alt键，界面上的菜单字符中有些会有下划线，这时用alt+下划线即是执行这个菜单功能的快捷键。  \n可自定义一些快捷键，避免使用鼠标。IDEA支持宏，不过我用得不多，只用过那么一两次，使用起来也很简单。 \n\n# 视图切换快捷键\n1、各视图区域的切换 cmd + 视图区域对应的数字  \n2、切换到maven的视图 alt + m   \n3、装了switchTab插件后，按下ctrl+tab后会得到可切换的区域列表  \n4、cmd+e                  列出最近查看的文件列表  \n5、shift + cmd + e   最近修改文件列表   \n上面两个键在开发过程中非常有用。  \n\n# 搜索快捷键\nIDEA的搜索非常强大，可秒杀eclipse.在project,maven等视图及出现列表的场景下，直接输入字符即开始搜索，可以说搜索无处不在。   \n1、在编辑文档中，cmd+f 开始搜索 cmd + r 搜索替换   \n2、在project中，按下ctrl + shift + f(r) 即是在当前目前下递归查找或替换\n搜索出来后，要全部替换，按下alt + a    \n3、alt + F7      搜索对象被引用的地方    \n4、cmd + F7   搜索对象在当前文件被引用的地方  \n5、cmd + n     查找类   \n6、shift + cmd + n  查找文件    \n上面两个查找都支持简单的正则表达式，还支持直接按大写字母的缩略查找如JsonTranscoder,只需要输入JT   \n\n# 编辑代码的快捷键\n```\ncmd + j                 调出IDEA的神器live template，你懂的\nctrl + n                 各种自动生成代码，创建文件，生成set get override…\nalt + enter           调出IDEA对出错点的提示处理方法，熟练使用可使你写代码的速度提升5倍\ncmd + D              复制粘贴当前行到下一行\ncmd + c|v|x        这些你都懂的\nshift + cmd + v  调出IDEA寄存器中保存的最近复制的N份内容，可选择性粘贴\ncmd + /                注释/取消注释\ncmd + w               选中当前光标所在的字\nshift + cmd + enter 神器，补全当前行，最常用的场景时补全当前行后的；号，并将光标定位到下一行\ncmd + O              overide 方法\ncmd + I                implement 方法\n其实上面两个快捷键很少用，因为有alt + enter 可完全替换掉这两个快捷键的功能\nshift + cmd + L                   格式化代码\nshift + cmd + O                   static import\nshift + cmd + up/down    将当前代码段上/下移\nshift + alt + up/down       将当前行上/下移\n重构的快捷键\nF6 移动文件到其它地方\nF5 拷贝文件到其它地方\nIDEA的移动文件功能非常强大，会将所有的使用该文件的类和XML配置中的类路径全部更新为新的路径。\nshift + F6                改名\ncmd + F6                 修改方法签名\nshift + cmd + F6    修改参数的类型\nshift + cmd + v       引入一个局部变量\nshift + cmd + p       引入一个参数\nshift + cmd + f        引入一个类变量\nshift + cmd + m      引入一个方法\nshift + cmd + c        引入一个常量\n以上都重构最常用的方法了\n```\n\n# 查看代码快捷键\n```\ncmd + p                  查询某方法的参数信息\ncmd + b                  跳到调用方法的定义处\nshift + cmd + b     跳到方法的实现处\ncmd + u                  跳到方法在父类或接口的定义处\nctrl + up/down     跳到上/下一方法\nalt + cmd + left/right 跳到上/下一次光标查看处\ncmd + g                  跳到指定行\ncmd + shift + h 显示方法的层级结构\nalt + cmd + h 调用层级结构\n```\n\n# 运行程序与Debug\n```\nshift + alt + F9             debug模式运行程序\nshift + alt + F10           运行程序\nF7                                    单步进入\nF8                                   单步跳过\nF9                                    跳过本次debug\nalt + F8                          debug时执行选中的语句\n```\n\n# 其它常用快捷键\n```\ncmd + ,                  调出setting界面\ncmd + ;                  调出项目setting界面\ncmd + f4                关闭当前界面\n另外我自己还定制了几个svn相关的快捷键\ncmd + alt + ctrl + a         svn add\ncmd + alt + ctrl + u         svn update\ncmd + alt + ctrl + m        svn commit\ncmd + alt + ctrl + h         svn history\ncmd + alt + ctrl + c          svn compare\ncmd + alt + ctrl + p         将当前编辑界面的内容垂直分屏，在比对文件时非常好用\n```\n\n(完)\n\n\n","source":"_posts/2013-06-29-IntelliJ-IDEA-keymap.md","raw":"---\nlayout: post\ntitle: \"【转】常用IDEA快捷键\"\ndate: 2013-06-29 09:00\ncomments: true\ncategories: idea\n---\n\n\n\n最近已经从eclipse转到IntelliJ IDEA，IDEA用起来太顺手了，许多功能正合我意。  \n看到时光印记写的一篇《常用IDEA快捷键》真的不错，特转一下!  \n\n<!-- more -->\n\n说明一下：类似eclipse outline (Ctrl+o)快捷键在idea里是 Ctrl+F12  \n   ------以下便是全文------------  \n   \n原文地址：[http://www.colorfuldays.org/program/idea_keymap/](http://www.colorfuldays.org/program/idea_keymap/  ) \n\n先说明一下这篇文章的由来。前天 @旅途无疆 强烈要求我整理一下IDEA的快捷键，于是我答应了。但是昨天实在太忙，没时间整。于是哥被他羞辱了一番，为了不继续丢人下去，哥今天花了将近2小时，整理了下面这些东西，希望对各位看官有用。下面列举的是我在日常开发工作中经常用到的快捷键。    \n\n声明一下，以下快捷键都是在Mac下的，Windows下的话，会有些不同，请参照Windows版IDEA的keymap文档。   \n\n一些技巧：  \n在任何时候，按下alt键，界面上的菜单字符中有些会有下划线，这时用alt+下划线即是执行这个菜单功能的快捷键。  \n可自定义一些快捷键，避免使用鼠标。IDEA支持宏，不过我用得不多，只用过那么一两次，使用起来也很简单。 \n\n# 视图切换快捷键\n1、各视图区域的切换 cmd + 视图区域对应的数字  \n2、切换到maven的视图 alt + m   \n3、装了switchTab插件后，按下ctrl+tab后会得到可切换的区域列表  \n4、cmd+e                  列出最近查看的文件列表  \n5、shift + cmd + e   最近修改文件列表   \n上面两个键在开发过程中非常有用。  \n\n# 搜索快捷键\nIDEA的搜索非常强大，可秒杀eclipse.在project,maven等视图及出现列表的场景下，直接输入字符即开始搜索，可以说搜索无处不在。   \n1、在编辑文档中，cmd+f 开始搜索 cmd + r 搜索替换   \n2、在project中，按下ctrl + shift + f(r) 即是在当前目前下递归查找或替换\n搜索出来后，要全部替换，按下alt + a    \n3、alt + F7      搜索对象被引用的地方    \n4、cmd + F7   搜索对象在当前文件被引用的地方  \n5、cmd + n     查找类   \n6、shift + cmd + n  查找文件    \n上面两个查找都支持简单的正则表达式，还支持直接按大写字母的缩略查找如JsonTranscoder,只需要输入JT   \n\n# 编辑代码的快捷键\n```\ncmd + j                 调出IDEA的神器live template，你懂的\nctrl + n                 各种自动生成代码，创建文件，生成set get override…\nalt + enter           调出IDEA对出错点的提示处理方法，熟练使用可使你写代码的速度提升5倍\ncmd + D              复制粘贴当前行到下一行\ncmd + c|v|x        这些你都懂的\nshift + cmd + v  调出IDEA寄存器中保存的最近复制的N份内容，可选择性粘贴\ncmd + /                注释/取消注释\ncmd + w               选中当前光标所在的字\nshift + cmd + enter 神器，补全当前行，最常用的场景时补全当前行后的；号，并将光标定位到下一行\ncmd + O              overide 方法\ncmd + I                implement 方法\n其实上面两个快捷键很少用，因为有alt + enter 可完全替换掉这两个快捷键的功能\nshift + cmd + L                   格式化代码\nshift + cmd + O                   static import\nshift + cmd + up/down    将当前代码段上/下移\nshift + alt + up/down       将当前行上/下移\n重构的快捷键\nF6 移动文件到其它地方\nF5 拷贝文件到其它地方\nIDEA的移动文件功能非常强大，会将所有的使用该文件的类和XML配置中的类路径全部更新为新的路径。\nshift + F6                改名\ncmd + F6                 修改方法签名\nshift + cmd + F6    修改参数的类型\nshift + cmd + v       引入一个局部变量\nshift + cmd + p       引入一个参数\nshift + cmd + f        引入一个类变量\nshift + cmd + m      引入一个方法\nshift + cmd + c        引入一个常量\n以上都重构最常用的方法了\n```\n\n# 查看代码快捷键\n```\ncmd + p                  查询某方法的参数信息\ncmd + b                  跳到调用方法的定义处\nshift + cmd + b     跳到方法的实现处\ncmd + u                  跳到方法在父类或接口的定义处\nctrl + up/down     跳到上/下一方法\nalt + cmd + left/right 跳到上/下一次光标查看处\ncmd + g                  跳到指定行\ncmd + shift + h 显示方法的层级结构\nalt + cmd + h 调用层级结构\n```\n\n# 运行程序与Debug\n```\nshift + alt + F9             debug模式运行程序\nshift + alt + F10           运行程序\nF7                                    单步进入\nF8                                   单步跳过\nF9                                    跳过本次debug\nalt + F8                          debug时执行选中的语句\n```\n\n# 其它常用快捷键\n```\ncmd + ,                  调出setting界面\ncmd + ;                  调出项目setting界面\ncmd + f4                关闭当前界面\n另外我自己还定制了几个svn相关的快捷键\ncmd + alt + ctrl + a         svn add\ncmd + alt + ctrl + u         svn update\ncmd + alt + ctrl + m        svn commit\ncmd + alt + ctrl + h         svn history\ncmd + alt + ctrl + c          svn compare\ncmd + alt + ctrl + p         将当前编辑界面的内容垂直分屏，在比对文件时非常好用\n```\n\n(完)\n\n\n","slug":"IntelliJ-IDEA-keymap","published":1,"updated":"2017-01-26T15:52:40.000Z","photos":[],"link":"","_id":"ciyf7fkbw0015f2jysel60hjd","content":"<p>最近已经从eclipse转到IntelliJ IDEA，IDEA用起来太顺手了，许多功能正合我意。<br>看到时光印记写的一篇《常用IDEA快捷键》真的不错，特转一下!  </p>\n<a id=\"more\"></a>\n<p>说明一下：类似eclipse outline (Ctrl+o)快捷键在idea里是 Ctrl+F12<br>   ——以下便是全文————  </p>\n<p>原文地址：<a href=\"http://www.colorfuldays.org/program/idea_keymap/\" target=\"_blank\" rel=\"external\">http://www.colorfuldays.org/program/idea_keymap/</a> </p>\n<p>先说明一下这篇文章的由来。前天 @旅途无疆 强烈要求我整理一下IDEA的快捷键，于是我答应了。但是昨天实在太忙，没时间整。于是哥被他羞辱了一番，为了不继续丢人下去，哥今天花了将近2小时，整理了下面这些东西，希望对各位看官有用。下面列举的是我在日常开发工作中经常用到的快捷键。    </p>\n<p>声明一下，以下快捷键都是在Mac下的，Windows下的话，会有些不同，请参照Windows版IDEA的keymap文档。   </p>\n<p>一些技巧：<br>在任何时候，按下alt键，界面上的菜单字符中有些会有下划线，这时用alt+下划线即是执行这个菜单功能的快捷键。<br>可自定义一些快捷键，避免使用鼠标。IDEA支持宏，不过我用得不多，只用过那么一两次，使用起来也很简单。 </p>\n<h1 id=\"视图切换快捷键\"><a href=\"#视图切换快捷键\" class=\"headerlink\" title=\"视图切换快捷键\"></a>视图切换快捷键</h1><p>1、各视图区域的切换 cmd + 视图区域对应的数字<br>2、切换到maven的视图 alt + m<br>3、装了switchTab插件后，按下ctrl+tab后会得到可切换的区域列表<br>4、cmd+e                  列出最近查看的文件列表<br>5、shift + cmd + e   最近修改文件列表<br>上面两个键在开发过程中非常有用。  </p>\n<h1 id=\"搜索快捷键\"><a href=\"#搜索快捷键\" class=\"headerlink\" title=\"搜索快捷键\"></a>搜索快捷键</h1><p>IDEA的搜索非常强大，可秒杀eclipse.在project,maven等视图及出现列表的场景下，直接输入字符即开始搜索，可以说搜索无处不在。<br>1、在编辑文档中，cmd+f 开始搜索 cmd + r 搜索替换<br>2、在project中，按下ctrl + shift + f(r) 即是在当前目前下递归查找或替换<br>搜索出来后，要全部替换，按下alt + a<br>3、alt + F7      搜索对象被引用的地方<br>4、cmd + F7   搜索对象在当前文件被引用的地方<br>5、cmd + n     查找类<br>6、shift + cmd + n  查找文件<br>上面两个查找都支持简单的正则表达式，还支持直接按大写字母的缩略查找如JsonTranscoder,只需要输入JT   </p>\n<h1 id=\"编辑代码的快捷键\"><a href=\"#编辑代码的快捷键\" class=\"headerlink\" title=\"编辑代码的快捷键\"></a>编辑代码的快捷键</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div></pre></td><td class=\"code\"><pre><div class=\"line\">cmd + j                 调出IDEA的神器live template，你懂的</div><div class=\"line\">ctrl + n                 各种自动生成代码，创建文件，生成set get override…</div><div class=\"line\">alt + enter           调出IDEA对出错点的提示处理方法，熟练使用可使你写代码的速度提升5倍</div><div class=\"line\">cmd + D              复制粘贴当前行到下一行</div><div class=\"line\">cmd + c|v|x        这些你都懂的</div><div class=\"line\">shift + cmd + v  调出IDEA寄存器中保存的最近复制的N份内容，可选择性粘贴</div><div class=\"line\">cmd + /                注释/取消注释</div><div class=\"line\">cmd + w               选中当前光标所在的字</div><div class=\"line\">shift + cmd + enter 神器，补全当前行，最常用的场景时补全当前行后的；号，并将光标定位到下一行</div><div class=\"line\">cmd + O              overide 方法</div><div class=\"line\">cmd + I                implement 方法</div><div class=\"line\">其实上面两个快捷键很少用，因为有alt + enter 可完全替换掉这两个快捷键的功能</div><div class=\"line\">shift + cmd + L                   格式化代码</div><div class=\"line\">shift + cmd + O                   static import</div><div class=\"line\">shift + cmd + up/down    将当前代码段上/下移</div><div class=\"line\">shift + alt + up/down       将当前行上/下移</div><div class=\"line\">重构的快捷键</div><div class=\"line\">F6 移动文件到其它地方</div><div class=\"line\">F5 拷贝文件到其它地方</div><div class=\"line\">IDEA的移动文件功能非常强大，会将所有的使用该文件的类和XML配置中的类路径全部更新为新的路径。</div><div class=\"line\">shift + F6                改名</div><div class=\"line\">cmd + F6                 修改方法签名</div><div class=\"line\">shift + cmd + F6    修改参数的类型</div><div class=\"line\">shift + cmd + v       引入一个局部变量</div><div class=\"line\">shift + cmd + p       引入一个参数</div><div class=\"line\">shift + cmd + f        引入一个类变量</div><div class=\"line\">shift + cmd + m      引入一个方法</div><div class=\"line\">shift + cmd + c        引入一个常量</div><div class=\"line\">以上都重构最常用的方法了</div></pre></td></tr></table></figure>\n<h1 id=\"查看代码快捷键\"><a href=\"#查看代码快捷键\" class=\"headerlink\" title=\"查看代码快捷键\"></a>查看代码快捷键</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">cmd + p                  查询某方法的参数信息</div><div class=\"line\">cmd + b                  跳到调用方法的定义处</div><div class=\"line\">shift + cmd + b     跳到方法的实现处</div><div class=\"line\">cmd + u                  跳到方法在父类或接口的定义处</div><div class=\"line\">ctrl + up/down     跳到上/下一方法</div><div class=\"line\">alt + cmd + left/right 跳到上/下一次光标查看处</div><div class=\"line\">cmd + g                  跳到指定行</div><div class=\"line\">cmd + shift + h 显示方法的层级结构</div><div class=\"line\">alt + cmd + h 调用层级结构</div></pre></td></tr></table></figure>\n<h1 id=\"运行程序与Debug\"><a href=\"#运行程序与Debug\" class=\"headerlink\" title=\"运行程序与Debug\"></a>运行程序与Debug</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">shift + alt + F9             debug模式运行程序</div><div class=\"line\">shift + alt + F10           运行程序</div><div class=\"line\">F7                                    单步进入</div><div class=\"line\">F8                                   单步跳过</div><div class=\"line\">F9                                    跳过本次debug</div><div class=\"line\">alt + F8                          debug时执行选中的语句</div></pre></td></tr></table></figure>\n<h1 id=\"其它常用快捷键\"><a href=\"#其它常用快捷键\" class=\"headerlink\" title=\"其它常用快捷键\"></a>其它常用快捷键</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">cmd + ,                  调出setting界面</div><div class=\"line\">cmd + ;                  调出项目setting界面</div><div class=\"line\">cmd + f4                关闭当前界面</div><div class=\"line\">另外我自己还定制了几个svn相关的快捷键</div><div class=\"line\">cmd + alt + ctrl + a         svn add</div><div class=\"line\">cmd + alt + ctrl + u         svn update</div><div class=\"line\">cmd + alt + ctrl + m        svn commit</div><div class=\"line\">cmd + alt + ctrl + h         svn history</div><div class=\"line\">cmd + alt + ctrl + c          svn compare</div><div class=\"line\">cmd + alt + ctrl + p         将当前编辑界面的内容垂直分屏，在比对文件时非常好用</div></pre></td></tr></table></figure>\n<p>(完)</p>\n","excerpt":"<p>最近已经从eclipse转到IntelliJ IDEA，IDEA用起来太顺手了，许多功能正合我意。<br>看到时光印记写的一篇《常用IDEA快捷键》真的不错，特转一下!  </p>","more":"<p>说明一下：类似eclipse outline (Ctrl+o)快捷键在idea里是 Ctrl+F12<br>   ——以下便是全文————  </p>\n<p>原文地址：<a href=\"http://www.colorfuldays.org/program/idea_keymap/\">http://www.colorfuldays.org/program/idea_keymap/</a> </p>\n<p>先说明一下这篇文章的由来。前天 @旅途无疆 强烈要求我整理一下IDEA的快捷键，于是我答应了。但是昨天实在太忙，没时间整。于是哥被他羞辱了一番，为了不继续丢人下去，哥今天花了将近2小时，整理了下面这些东西，希望对各位看官有用。下面列举的是我在日常开发工作中经常用到的快捷键。    </p>\n<p>声明一下，以下快捷键都是在Mac下的，Windows下的话，会有些不同，请参照Windows版IDEA的keymap文档。   </p>\n<p>一些技巧：<br>在任何时候，按下alt键，界面上的菜单字符中有些会有下划线，这时用alt+下划线即是执行这个菜单功能的快捷键。<br>可自定义一些快捷键，避免使用鼠标。IDEA支持宏，不过我用得不多，只用过那么一两次，使用起来也很简单。 </p>\n<h1 id=\"视图切换快捷键\"><a href=\"#视图切换快捷键\" class=\"headerlink\" title=\"视图切换快捷键\"></a>视图切换快捷键</h1><p>1、各视图区域的切换 cmd + 视图区域对应的数字<br>2、切换到maven的视图 alt + m<br>3、装了switchTab插件后，按下ctrl+tab后会得到可切换的区域列表<br>4、cmd+e                  列出最近查看的文件列表<br>5、shift + cmd + e   最近修改文件列表<br>上面两个键在开发过程中非常有用。  </p>\n<h1 id=\"搜索快捷键\"><a href=\"#搜索快捷键\" class=\"headerlink\" title=\"搜索快捷键\"></a>搜索快捷键</h1><p>IDEA的搜索非常强大，可秒杀eclipse.在project,maven等视图及出现列表的场景下，直接输入字符即开始搜索，可以说搜索无处不在。<br>1、在编辑文档中，cmd+f 开始搜索 cmd + r 搜索替换<br>2、在project中，按下ctrl + shift + f(r) 即是在当前目前下递归查找或替换<br>搜索出来后，要全部替换，按下alt + a<br>3、alt + F7      搜索对象被引用的地方<br>4、cmd + F7   搜索对象在当前文件被引用的地方<br>5、cmd + n     查找类<br>6、shift + cmd + n  查找文件<br>上面两个查找都支持简单的正则表达式，还支持直接按大写字母的缩略查找如JsonTranscoder,只需要输入JT   </p>\n<h1 id=\"编辑代码的快捷键\"><a href=\"#编辑代码的快捷键\" class=\"headerlink\" title=\"编辑代码的快捷键\"></a>编辑代码的快捷键</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div></pre></td><td class=\"code\"><pre><div class=\"line\">cmd + j                 调出IDEA的神器live template，你懂的</div><div class=\"line\">ctrl + n                 各种自动生成代码，创建文件，生成set get override…</div><div class=\"line\">alt + enter           调出IDEA对出错点的提示处理方法，熟练使用可使你写代码的速度提升5倍</div><div class=\"line\">cmd + D              复制粘贴当前行到下一行</div><div class=\"line\">cmd + c|v|x        这些你都懂的</div><div class=\"line\">shift + cmd + v  调出IDEA寄存器中保存的最近复制的N份内容，可选择性粘贴</div><div class=\"line\">cmd + /                注释/取消注释</div><div class=\"line\">cmd + w               选中当前光标所在的字</div><div class=\"line\">shift + cmd + enter 神器，补全当前行，最常用的场景时补全当前行后的；号，并将光标定位到下一行</div><div class=\"line\">cmd + O              overide 方法</div><div class=\"line\">cmd + I                implement 方法</div><div class=\"line\">其实上面两个快捷键很少用，因为有alt + enter 可完全替换掉这两个快捷键的功能</div><div class=\"line\">shift + cmd + L                   格式化代码</div><div class=\"line\">shift + cmd + O                   static import</div><div class=\"line\">shift + cmd + up/down    将当前代码段上/下移</div><div class=\"line\">shift + alt + up/down       将当前行上/下移</div><div class=\"line\">重构的快捷键</div><div class=\"line\">F6 移动文件到其它地方</div><div class=\"line\">F5 拷贝文件到其它地方</div><div class=\"line\">IDEA的移动文件功能非常强大，会将所有的使用该文件的类和XML配置中的类路径全部更新为新的路径。</div><div class=\"line\">shift + F6                改名</div><div class=\"line\">cmd + F6                 修改方法签名</div><div class=\"line\">shift + cmd + F6    修改参数的类型</div><div class=\"line\">shift + cmd + v       引入一个局部变量</div><div class=\"line\">shift + cmd + p       引入一个参数</div><div class=\"line\">shift + cmd + f        引入一个类变量</div><div class=\"line\">shift + cmd + m      引入一个方法</div><div class=\"line\">shift + cmd + c        引入一个常量</div><div class=\"line\">以上都重构最常用的方法了</div></pre></td></tr></table></figure>\n<h1 id=\"查看代码快捷键\"><a href=\"#查看代码快捷键\" class=\"headerlink\" title=\"查看代码快捷键\"></a>查看代码快捷键</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">cmd + p                  查询某方法的参数信息</div><div class=\"line\">cmd + b                  跳到调用方法的定义处</div><div class=\"line\">shift + cmd + b     跳到方法的实现处</div><div class=\"line\">cmd + u                  跳到方法在父类或接口的定义处</div><div class=\"line\">ctrl + up/down     跳到上/下一方法</div><div class=\"line\">alt + cmd + left/right 跳到上/下一次光标查看处</div><div class=\"line\">cmd + g                  跳到指定行</div><div class=\"line\">cmd + shift + h 显示方法的层级结构</div><div class=\"line\">alt + cmd + h 调用层级结构</div></pre></td></tr></table></figure>\n<h1 id=\"运行程序与Debug\"><a href=\"#运行程序与Debug\" class=\"headerlink\" title=\"运行程序与Debug\"></a>运行程序与Debug</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">shift + alt + F9             debug模式运行程序</div><div class=\"line\">shift + alt + F10           运行程序</div><div class=\"line\">F7                                    单步进入</div><div class=\"line\">F8                                   单步跳过</div><div class=\"line\">F9                                    跳过本次debug</div><div class=\"line\">alt + F8                          debug时执行选中的语句</div></pre></td></tr></table></figure>\n<h1 id=\"其它常用快捷键\"><a href=\"#其它常用快捷键\" class=\"headerlink\" title=\"其它常用快捷键\"></a>其它常用快捷键</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">cmd + ,                  调出setting界面</div><div class=\"line\">cmd + ;                  调出项目setting界面</div><div class=\"line\">cmd + f4                关闭当前界面</div><div class=\"line\">另外我自己还定制了几个svn相关的快捷键</div><div class=\"line\">cmd + alt + ctrl + a         svn add</div><div class=\"line\">cmd + alt + ctrl + u         svn update</div><div class=\"line\">cmd + alt + ctrl + m        svn commit</div><div class=\"line\">cmd + alt + ctrl + h         svn history</div><div class=\"line\">cmd + alt + ctrl + c          svn compare</div><div class=\"line\">cmd + alt + ctrl + p         将当前编辑界面的内容垂直分屏，在比对文件时非常好用</div></pre></td></tr></table></figure>\n<p>(完)</p>"},{"layout":"post","title":"Fabric-01 安装与使用","date":"2014-08-11T06:56:00.000Z","comments":1,"_content":"\n#1.Fabric是什么？\n\nFabric is a Python (2.5-2.7) library and command-line tool for streamlining the use of SSH for application deployment or systems administration tasks.\n\nFabric是一个Python(2.5-2.7)库，可以通过SSH在多个主机上批量执行任务。Fabric非常适合于应用的(自动化)部署或者执行系统管理任务。\n\n<!-- more -->\n\n#2.Fabric安装\n\nFabric强烈推荐使用pip安装:\n\t\n\t$ pip install fabric\n\t\neasy_install 虽然比较老了，但同样也可使用。\n\n\t$ easy_install fabric\n\n\n安装过程中，可能会用到的命令\n\n```bash\n#安装好编译环境\nyum -y install gcc gcc-c++ automake autoconf libtool make \n\n#会安装好easy_install\nyum -y install python-setuptools  \nyum -y install python-devel\neasy_install pip\n#pip install paramiko\npip install paramiko==1.10\npip install pycrypto\npip install fabric\n```\n\n###2.1. 可能会遇到的错误:\n\n错误(1)：\n\n```\nRunning pycrypto-2.6.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-xBCzLD/pycrypto-2.6.1/egg-dist-tmp-6Y0X6m\nwarning: GMP or MPIR library not found; Not building Crypto.PublicKey._fastmath.\nsrc/MD2.c:31:20: error: Python.h: No such file or directory\nsrc/MD2.c:131: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘*’ token\n```\n解决：\n\tyum -y install python-devel\n\n---\n\n错误(2)：\n\n```\n[root@fabric2 ~]# fab\nTraceback (most recent call last):\n  File \"/usr/bin/fab\", line 5, in <module>\n    from pkg_resources import load_entry_point\n  File \"/usr/lib/python2.6/site-packages/pkg_resources.py\", line 2655, in <module>\n    working_set.require(__requires__)\n  File \"/usr/lib/python2.6/site-packages/pkg_resources.py\", line 648, in require\n    needed = self.resolve(parse_requirements(requirements))\n  File \"/usr/lib/python2.6/site-packages/pkg_resources.py\", line 546, in resolve\n    raise DistributionNotFound(req)\npkg_resources.DistributionNotFound: paramiko>=1.10\n```\n\n解决：paramiko版本过高，paramiko>=1.10\n\n```\npip uninstall fabric paramiko\npip install paramiko==1.10\npip install fabric\n```\n\n#3.Fabric简单使用\n\n测试的虚拟机环境：\n\n```\n[root@fabric1 ~]# cat /etc/redhat-release\nCentOS release 6.3 (Final)\n[root@fabric1 ~]# uname -r\n2.6.32-279.el6.x86_64\n\n三台服务器\n192.168.27.137 host1\n192.168.27.138 host2\n192.168.27.139 host3\n```\n\n###(1)Hello, fab\n\nfabfile.py\n\n```python\ndef hello():\n    print(\"Hello world!\")\n```\n\n执行命令\n\n```\n# fab hello\nHello world!\n\nDone.\n```\n\n当前工作目录中默认的模块名称是：fabfile.py, hello函数可以使用fab工具执行。\n\n####任务参数 Task arguments\n\n调用模式： \n\n```\n<task name>:<arg>,<kwarg>=<value>,....  \n``` \n\n```\n[root@fabric1 scritps]# cat fabfile.py\ndef hello(name=\"world\"):\n    print(\"Hello %s!\" % name)\n\n[root@fabric1 scritps]# fab hello\nHello world!\n\nDone.\n[root@fabric1 scritps]# fab hello:name=Jeff\nHello Jeff!\n\nDone.\n[root@fabric1 scritps]# fab hello:Jeff\nHello Jeff!\n\nDone.\n```\n\n###(2)本地(local)命令与远程命令\n\nuname.py\n\n```python\n#!/usr/bin/env python\n# -*- coding: utf-8 -*-\nfrom fabric.api import local,run\n\ndef test():\n    local(\"uname -r\")\n    run(\"uname -r\")\n```\n\n\n执行：fab -f uname.py test\n\n\n```\n# fab -f uname.py -H root@192.168.27.138 test\n[root@192.168.27.138] Executing task 'test'\n[localhost] local: uname -r\n2.6.32-279.el6.x86_64\n[root@192.168.27.138] run: uname -r\n[root@192.168.27.138] Login password for 'root': #这里要输入密码\n[root@192.168.27.138] out: 2.6.32-279.el6.x86_64\n[root@192.168.27.138] out:\n\n\nDone.\nDisconnecting from 192.168.27.138... done.\n```\n\nlocal执行本地命令，run执行远程命令。\n\n-H 是定义主机地址。\n\n\n###(3)更加实用的例子\n\ntest.py\n\n```python\n#!/usr/bin/env python\n# -*- coding: utf-8 -*-\nfrom fabric.api import settings, run, cd, env\n\nenv.hosts = ['work@host2']\nenv.user = 'work'\nenv.password = '123456'\n\ndef deploy():\n    code_dir = '/home/work/GoFileServer'\n    with settings(warn_only=True):\n        if run(\"test -d %s\" % code_dir).failed:\n            run(\"git clone https://github.com/xionglie/GoFileServer.git %s\" % code_dir)\n    with cd(code_dir):\n        run(\"git pull\")\n```    \n\n说明：\n\n这里我将远程主机的用户名、密码写在python文件里, 生产环境是不推荐这么做的。   \n下一篇文章，我会重点讲解hosts,user,password的相关问题。\n\ndeploy是将代码发布到远程主机上，如果远程项目目录还未存在，则先执行git clone操作。\n\n最后到代码目录里执行 git pull , 更新代码到最新版本。 \n\n\n执行结果：\n\n```\n[root@fabric1 scritps]# fab -f test.py deploy\n[work@host2] Executing task 'deploy'\n[work@host2] run: test -d /home/work/GoFileServer\n\nWarning: run() received nonzero return code 1 while executing 'test -d /home/work/GoFileServer'!\n\n[work@host2] run: git clone https://github.com/xionglie/GoFileServer.git /home/work/GoFileServer\n[work@host2] out: Initialized empty Git repository in /home/work/GoFileServer/.git/\n[work@host2] out: remote: Counting objects: 5, done.\n[work@host2] out: remote: Total 5 (delta 0), reused 0 (delta 0)\n[work@host2] out: Unpacking objects:  20% (1/5)\n[work@host2] out: Unpacking objects:  40% (2/5)\n[work@host2] out: Unpacking objects:  60% (3/5)\n[work@host2] out: Unpacking objects:  80% (4/5)\n[work@host2] out: Unpacking objects: 100% (5/5)\n[work@host2] out: Unpacking objects: 100% (5/5), done.\n[work@host2] out:\n\n[work@host2] run: git pull\n[work@host2] out: Already up-to-date.\n[work@host2] out:\n\n\nDone.\nDisconnecting from host2... done.\n```\n\n\n\n","source":"_posts/2014-08-11-learning-fabric-1-overview-and-tutorial.md","raw":"---\nlayout: post\ntitle: \"Fabric-01 安装与使用\"\ndate: 2014-08-11 14:56\ncomments: true\ncategories: fabric\n---\n\n#1.Fabric是什么？\n\nFabric is a Python (2.5-2.7) library and command-line tool for streamlining the use of SSH for application deployment or systems administration tasks.\n\nFabric是一个Python(2.5-2.7)库，可以通过SSH在多个主机上批量执行任务。Fabric非常适合于应用的(自动化)部署或者执行系统管理任务。\n\n<!-- more -->\n\n#2.Fabric安装\n\nFabric强烈推荐使用pip安装:\n\t\n\t$ pip install fabric\n\t\neasy_install 虽然比较老了，但同样也可使用。\n\n\t$ easy_install fabric\n\n\n安装过程中，可能会用到的命令\n\n```bash\n#安装好编译环境\nyum -y install gcc gcc-c++ automake autoconf libtool make \n\n#会安装好easy_install\nyum -y install python-setuptools  \nyum -y install python-devel\neasy_install pip\n#pip install paramiko\npip install paramiko==1.10\npip install pycrypto\npip install fabric\n```\n\n###2.1. 可能会遇到的错误:\n\n错误(1)：\n\n```\nRunning pycrypto-2.6.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-xBCzLD/pycrypto-2.6.1/egg-dist-tmp-6Y0X6m\nwarning: GMP or MPIR library not found; Not building Crypto.PublicKey._fastmath.\nsrc/MD2.c:31:20: error: Python.h: No such file or directory\nsrc/MD2.c:131: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘*’ token\n```\n解决：\n\tyum -y install python-devel\n\n---\n\n错误(2)：\n\n```\n[root@fabric2 ~]# fab\nTraceback (most recent call last):\n  File \"/usr/bin/fab\", line 5, in <module>\n    from pkg_resources import load_entry_point\n  File \"/usr/lib/python2.6/site-packages/pkg_resources.py\", line 2655, in <module>\n    working_set.require(__requires__)\n  File \"/usr/lib/python2.6/site-packages/pkg_resources.py\", line 648, in require\n    needed = self.resolve(parse_requirements(requirements))\n  File \"/usr/lib/python2.6/site-packages/pkg_resources.py\", line 546, in resolve\n    raise DistributionNotFound(req)\npkg_resources.DistributionNotFound: paramiko>=1.10\n```\n\n解决：paramiko版本过高，paramiko>=1.10\n\n```\npip uninstall fabric paramiko\npip install paramiko==1.10\npip install fabric\n```\n\n#3.Fabric简单使用\n\n测试的虚拟机环境：\n\n```\n[root@fabric1 ~]# cat /etc/redhat-release\nCentOS release 6.3 (Final)\n[root@fabric1 ~]# uname -r\n2.6.32-279.el6.x86_64\n\n三台服务器\n192.168.27.137 host1\n192.168.27.138 host2\n192.168.27.139 host3\n```\n\n###(1)Hello, fab\n\nfabfile.py\n\n```python\ndef hello():\n    print(\"Hello world!\")\n```\n\n执行命令\n\n```\n# fab hello\nHello world!\n\nDone.\n```\n\n当前工作目录中默认的模块名称是：fabfile.py, hello函数可以使用fab工具执行。\n\n####任务参数 Task arguments\n\n调用模式： \n\n```\n<task name>:<arg>,<kwarg>=<value>,....  \n``` \n\n```\n[root@fabric1 scritps]# cat fabfile.py\ndef hello(name=\"world\"):\n    print(\"Hello %s!\" % name)\n\n[root@fabric1 scritps]# fab hello\nHello world!\n\nDone.\n[root@fabric1 scritps]# fab hello:name=Jeff\nHello Jeff!\n\nDone.\n[root@fabric1 scritps]# fab hello:Jeff\nHello Jeff!\n\nDone.\n```\n\n###(2)本地(local)命令与远程命令\n\nuname.py\n\n```python\n#!/usr/bin/env python\n# -*- coding: utf-8 -*-\nfrom fabric.api import local,run\n\ndef test():\n    local(\"uname -r\")\n    run(\"uname -r\")\n```\n\n\n执行：fab -f uname.py test\n\n\n```\n# fab -f uname.py -H root@192.168.27.138 test\n[root@192.168.27.138] Executing task 'test'\n[localhost] local: uname -r\n2.6.32-279.el6.x86_64\n[root@192.168.27.138] run: uname -r\n[root@192.168.27.138] Login password for 'root': #这里要输入密码\n[root@192.168.27.138] out: 2.6.32-279.el6.x86_64\n[root@192.168.27.138] out:\n\n\nDone.\nDisconnecting from 192.168.27.138... done.\n```\n\nlocal执行本地命令，run执行远程命令。\n\n-H 是定义主机地址。\n\n\n###(3)更加实用的例子\n\ntest.py\n\n```python\n#!/usr/bin/env python\n# -*- coding: utf-8 -*-\nfrom fabric.api import settings, run, cd, env\n\nenv.hosts = ['work@host2']\nenv.user = 'work'\nenv.password = '123456'\n\ndef deploy():\n    code_dir = '/home/work/GoFileServer'\n    with settings(warn_only=True):\n        if run(\"test -d %s\" % code_dir).failed:\n            run(\"git clone https://github.com/xionglie/GoFileServer.git %s\" % code_dir)\n    with cd(code_dir):\n        run(\"git pull\")\n```    \n\n说明：\n\n这里我将远程主机的用户名、密码写在python文件里, 生产环境是不推荐这么做的。   \n下一篇文章，我会重点讲解hosts,user,password的相关问题。\n\ndeploy是将代码发布到远程主机上，如果远程项目目录还未存在，则先执行git clone操作。\n\n最后到代码目录里执行 git pull , 更新代码到最新版本。 \n\n\n执行结果：\n\n```\n[root@fabric1 scritps]# fab -f test.py deploy\n[work@host2] Executing task 'deploy'\n[work@host2] run: test -d /home/work/GoFileServer\n\nWarning: run() received nonzero return code 1 while executing 'test -d /home/work/GoFileServer'!\n\n[work@host2] run: git clone https://github.com/xionglie/GoFileServer.git /home/work/GoFileServer\n[work@host2] out: Initialized empty Git repository in /home/work/GoFileServer/.git/\n[work@host2] out: remote: Counting objects: 5, done.\n[work@host2] out: remote: Total 5 (delta 0), reused 0 (delta 0)\n[work@host2] out: Unpacking objects:  20% (1/5)\n[work@host2] out: Unpacking objects:  40% (2/5)\n[work@host2] out: Unpacking objects:  60% (3/5)\n[work@host2] out: Unpacking objects:  80% (4/5)\n[work@host2] out: Unpacking objects: 100% (5/5)\n[work@host2] out: Unpacking objects: 100% (5/5), done.\n[work@host2] out:\n\n[work@host2] run: git pull\n[work@host2] out: Already up-to-date.\n[work@host2] out:\n\n\nDone.\nDisconnecting from host2... done.\n```\n\n\n\n","slug":"learning-fabric-1-overview-and-tutorial","published":1,"updated":"2017-01-27T02:04:45.000Z","photos":[],"link":"","_id":"ciyf7fkbx0017f2jyw11r1pvg","content":"<p>#1.Fabric是什么？</p>\n<p>Fabric is a Python (2.5-2.7) library and command-line tool for streamlining the use of SSH for application deployment or systems administration tasks.</p>\n<p>Fabric是一个Python(2.5-2.7)库，可以通过SSH在多个主机上批量执行任务。Fabric非常适合于应用的(自动化)部署或者执行系统管理任务。</p>\n<a id=\"more\"></a>\n<p>#2.Fabric安装</p>\n<p>Fabric强烈推荐使用pip安装:</p>\n<pre><code>$ pip install fabric\n</code></pre><p>easy_install 虽然比较老了，但同样也可使用。</p>\n<pre><code>$ easy_install fabric\n</code></pre><p>安装过程中，可能会用到的命令</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#安装好编译环境</span></div><div class=\"line\">yum -y install gcc gcc-c++ automake autoconf libtool make </div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#会安装好easy_install</span></div><div class=\"line\">yum -y install python-setuptools  </div><div class=\"line\">yum -y install python-devel</div><div class=\"line\">easy_install pip</div><div class=\"line\"><span class=\"comment\">#pip install paramiko</span></div><div class=\"line\">pip install paramiko==1.10</div><div class=\"line\">pip install pycrypto</div><div class=\"line\">pip install fabric</div></pre></td></tr></table></figure>\n<p>###2.1. 可能会遇到的错误:</p>\n<p>错误(1)：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">Running pycrypto-2.6.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-xBCzLD/pycrypto-2.6.1/egg-dist-tmp-6Y0X6m</div><div class=\"line\">warning: GMP or MPIR library not found; Not building Crypto.PublicKey._fastmath.</div><div class=\"line\">src/MD2.c:31:20: error: Python.h: No such file or directory</div><div class=\"line\">src/MD2.c:131: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘*’ token</div></pre></td></tr></table></figure>\n<p>解决：<br>    yum -y install python-devel</p>\n<hr>\n<p>错误(2)：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@fabric2 ~]# fab</div><div class=\"line\">Traceback (most recent call last):</div><div class=\"line\">  File &quot;/usr/bin/fab&quot;, line 5, in &lt;module&gt;</div><div class=\"line\">    from pkg_resources import load_entry_point</div><div class=\"line\">  File &quot;/usr/lib/python2.6/site-packages/pkg_resources.py&quot;, line 2655, in &lt;module&gt;</div><div class=\"line\">    working_set.require(__requires__)</div><div class=\"line\">  File &quot;/usr/lib/python2.6/site-packages/pkg_resources.py&quot;, line 648, in require</div><div class=\"line\">    needed = self.resolve(parse_requirements(requirements))</div><div class=\"line\">  File &quot;/usr/lib/python2.6/site-packages/pkg_resources.py&quot;, line 546, in resolve</div><div class=\"line\">    raise DistributionNotFound(req)</div><div class=\"line\">pkg_resources.DistributionNotFound: paramiko&gt;=1.10</div></pre></td></tr></table></figure>\n<p>解决：paramiko版本过高，paramiko&gt;=1.10</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">pip uninstall fabric paramiko</div><div class=\"line\">pip install paramiko==1.10</div><div class=\"line\">pip install fabric</div></pre></td></tr></table></figure>\n<p>#3.Fabric简单使用</p>\n<p>测试的虚拟机环境：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@fabric1 ~]# cat /etc/redhat-release</div><div class=\"line\">CentOS release 6.3 (Final)</div><div class=\"line\">[root@fabric1 ~]# uname -r</div><div class=\"line\">2.6.32-279.el6.x86_64</div><div class=\"line\"></div><div class=\"line\">三台服务器</div><div class=\"line\">192.168.27.137 host1</div><div class=\"line\">192.168.27.138 host2</div><div class=\"line\">192.168.27.139 host3</div></pre></td></tr></table></figure>\n<p>###(1)Hello, fab</p>\n<p>fabfile.py</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">hello</span><span class=\"params\">()</span>:</span></div><div class=\"line\">    print(<span class=\"string\">\"Hello world!\"</span>)</div></pre></td></tr></table></figure>\n<p>执行命令</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"># fab hello</div><div class=\"line\">Hello world!</div><div class=\"line\"></div><div class=\"line\">Done.</div></pre></td></tr></table></figure>\n<p>当前工作目录中默认的模块名称是：fabfile.py, hello函数可以使用fab工具执行。</p>\n<p>####任务参数 Task arguments</p>\n<p>调用模式： </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;task name&gt;:&lt;arg&gt;,&lt;kwarg&gt;=&lt;value&gt;,....  </div><div class=\"line\">```</div></pre></td></tr></table></figure>\n<p>[root@fabric1 scritps]# cat fabfile.py<br>def hello(name=”world”):<br>    print(“Hello %s!” % name)</p>\n<p>[root@fabric1 scritps]# fab hello<br>Hello world!</p>\n<p>Done.<br>[root@fabric1 scritps]# fab hello:name=Jeff<br>Hello Jeff!</p>\n<p>Done.<br>[root@fabric1 scritps]# fab hello:Jeff<br>Hello Jeff!</p>\n<p>Done.<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">###(2)本地(local)命令与远程命令</div><div class=\"line\"></div><div class=\"line\">uname.py</div><div class=\"line\"></div><div class=\"line\">```python</div><div class=\"line\">#!/usr/bin/env python</div><div class=\"line\"># -*- coding: utf-8 -*-</div><div class=\"line\">from fabric.api import local,run</div><div class=\"line\"></div><div class=\"line\">def test():</div><div class=\"line\">    local(&quot;uname -r&quot;)</div><div class=\"line\">    run(&quot;uname -r&quot;)</div></pre></td></tr></table></figure></p>\n<p>执行：fab -f uname.py test</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"># fab -f uname.py -H root@192.168.27.138 test</div><div class=\"line\">[root@192.168.27.138] Executing task &apos;test&apos;</div><div class=\"line\">[localhost] local: uname -r</div><div class=\"line\">2.6.32-279.el6.x86_64</div><div class=\"line\">[root@192.168.27.138] run: uname -r</div><div class=\"line\">[root@192.168.27.138] Login password for &apos;root&apos;: #这里要输入密码</div><div class=\"line\">[root@192.168.27.138] out: 2.6.32-279.el6.x86_64</div><div class=\"line\">[root@192.168.27.138] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from 192.168.27.138... done.</div></pre></td></tr></table></figure>\n<p>local执行本地命令，run执行远程命令。</p>\n<p>-H 是定义主机地址。</p>\n<p>###(3)更加实用的例子</p>\n<p>test.py</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></div><div class=\"line\"><span class=\"comment\"># -*- coding: utf-8 -*-</span></div><div class=\"line\"><span class=\"keyword\">from</span> fabric.api <span class=\"keyword\">import</span> settings, run, cd, env</div><div class=\"line\"></div><div class=\"line\">env.hosts = [<span class=\"string\">'work@host2'</span>]</div><div class=\"line\">env.user = <span class=\"string\">'work'</span></div><div class=\"line\">env.password = <span class=\"string\">'123456'</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">deploy</span><span class=\"params\">()</span>:</span></div><div class=\"line\">    code_dir = <span class=\"string\">'/home/work/GoFileServer'</span></div><div class=\"line\">    <span class=\"keyword\">with</span> settings(warn_only=<span class=\"keyword\">True</span>):</div><div class=\"line\">        <span class=\"keyword\">if</span> run(<span class=\"string\">\"test -d %s\"</span> % code_dir).failed:</div><div class=\"line\">            run(<span class=\"string\">\"git clone https://github.com/xionglie/GoFileServer.git %s\"</span> % code_dir)</div><div class=\"line\">    <span class=\"keyword\">with</span> cd(code_dir):</div><div class=\"line\">        run(<span class=\"string\">\"git pull\"</span>)</div><div class=\"line\">```    </div><div class=\"line\"></div><div class=\"line\">说明：</div><div class=\"line\"></div><div class=\"line\">这里我将远程主机的用户名、密码写在python文件里, 生产环境是不推荐这么做的。   </div><div class=\"line\">下一篇文章，我会重点讲解hosts,user,password的相关问题。</div><div class=\"line\"></div><div class=\"line\">deploy是将代码发布到远程主机上，如果远程项目目录还未存在，则先执行git clone操作。</div><div class=\"line\"></div><div class=\"line\">最后到代码目录里执行 git pull , 更新代码到最新版本。 </div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">执行结果：</div></pre></td></tr></table></figure>\n<p>[root@fabric1 scritps]# fab -f test.py deploy<br>[work@host2] Executing task ‘deploy’<br>[work@host2] run: test -d /home/work/GoFileServer</p>\n<p>Warning: run() received nonzero return code 1 while executing ‘test -d /home/work/GoFileServer’!</p>\n<p>[work@host2] run: git clone <a href=\"https://github.com/xionglie/GoFileServer.git\" target=\"_blank\" rel=\"external\">https://github.com/xionglie/GoFileServer.git</a> /home/work/GoFileServer<br>[work@host2] out: Initialized empty Git repository in /home/work/GoFileServer/.git/<br>[work@host2] out: remote: Counting objects: 5, done.<br>[work@host2] out: remote: Total 5 (delta 0), reused 0 (delta 0)<br>[work@host2] out: Unpacking objects:  20% (1/5)<br>[work@host2] out: Unpacking objects:  40% (2/5)<br>[work@host2] out: Unpacking objects:  60% (3/5)<br>[work@host2] out: Unpacking objects:  80% (4/5)<br>[work@host2] out: Unpacking objects: 100% (5/5)<br>[work@host2] out: Unpacking objects: 100% (5/5), done.<br>[work@host2] out:</p>\n<p>[work@host2] run: git pull<br>[work@host2] out: Already up-to-date.<br>[work@host2] out:</p>\n<p>Done.<br>Disconnecting from host2… done.<br>```</p>\n","excerpt":"<p>#1.Fabric是什么？</p>\n<p>Fabric is a Python (2.5-2.7) library and command-line tool for streamlining the use of SSH for application deployment or systems administration tasks.</p>\n<p>Fabric是一个Python(2.5-2.7)库，可以通过SSH在多个主机上批量执行任务。Fabric非常适合于应用的(自动化)部署或者执行系统管理任务。</p>","more":"<p>#2.Fabric安装</p>\n<p>Fabric强烈推荐使用pip安装:</p>\n<pre><code>$ pip install fabric\n</code></pre><p>easy_install 虽然比较老了，但同样也可使用。</p>\n<pre><code>$ easy_install fabric\n</code></pre><p>安装过程中，可能会用到的命令</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#安装好编译环境</span></div><div class=\"line\">yum -y install gcc gcc-c++ automake autoconf libtool make </div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#会安装好easy_install</span></div><div class=\"line\">yum -y install python-setuptools  </div><div class=\"line\">yum -y install python-devel</div><div class=\"line\">easy_install pip</div><div class=\"line\"><span class=\"comment\">#pip install paramiko</span></div><div class=\"line\">pip install paramiko==1.10</div><div class=\"line\">pip install pycrypto</div><div class=\"line\">pip install fabric</div></pre></td></tr></table></figure>\n<p>###2.1. 可能会遇到的错误:</p>\n<p>错误(1)：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">Running pycrypto-2.6.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-xBCzLD/pycrypto-2.6.1/egg-dist-tmp-6Y0X6m</div><div class=\"line\">warning: GMP or MPIR library not found; Not building Crypto.PublicKey._fastmath.</div><div class=\"line\">src/MD2.c:31:20: error: Python.h: No such file or directory</div><div class=\"line\">src/MD2.c:131: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘*’ token</div></pre></td></tr></table></figure>\n<p>解决：<br>    yum -y install python-devel</p>\n<hr>\n<p>错误(2)：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@fabric2 ~]# fab</div><div class=\"line\">Traceback (most recent call last):</div><div class=\"line\">  File &quot;/usr/bin/fab&quot;, line 5, in &lt;module&gt;</div><div class=\"line\">    from pkg_resources import load_entry_point</div><div class=\"line\">  File &quot;/usr/lib/python2.6/site-packages/pkg_resources.py&quot;, line 2655, in &lt;module&gt;</div><div class=\"line\">    working_set.require(__requires__)</div><div class=\"line\">  File &quot;/usr/lib/python2.6/site-packages/pkg_resources.py&quot;, line 648, in require</div><div class=\"line\">    needed = self.resolve(parse_requirements(requirements))</div><div class=\"line\">  File &quot;/usr/lib/python2.6/site-packages/pkg_resources.py&quot;, line 546, in resolve</div><div class=\"line\">    raise DistributionNotFound(req)</div><div class=\"line\">pkg_resources.DistributionNotFound: paramiko&gt;=1.10</div></pre></td></tr></table></figure>\n<p>解决：paramiko版本过高，paramiko&gt;=1.10</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">pip uninstall fabric paramiko</div><div class=\"line\">pip install paramiko==1.10</div><div class=\"line\">pip install fabric</div></pre></td></tr></table></figure>\n<p>#3.Fabric简单使用</p>\n<p>测试的虚拟机环境：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@fabric1 ~]# cat /etc/redhat-release</div><div class=\"line\">CentOS release 6.3 (Final)</div><div class=\"line\">[root@fabric1 ~]# uname -r</div><div class=\"line\">2.6.32-279.el6.x86_64</div><div class=\"line\"></div><div class=\"line\">三台服务器</div><div class=\"line\">192.168.27.137 host1</div><div class=\"line\">192.168.27.138 host2</div><div class=\"line\">192.168.27.139 host3</div></pre></td></tr></table></figure>\n<p>###(1)Hello, fab</p>\n<p>fabfile.py</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">hello</span><span class=\"params\">()</span>:</span></div><div class=\"line\">    print(<span class=\"string\">\"Hello world!\"</span>)</div></pre></td></tr></table></figure>\n<p>执行命令</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"># fab hello</div><div class=\"line\">Hello world!</div><div class=\"line\"></div><div class=\"line\">Done.</div></pre></td></tr></table></figure>\n<p>当前工作目录中默认的模块名称是：fabfile.py, hello函数可以使用fab工具执行。</p>\n<p>####任务参数 Task arguments</p>\n<p>调用模式： </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;task name&gt;:&lt;arg&gt;,&lt;kwarg&gt;=&lt;value&gt;,....  </div><div class=\"line\">```</div></pre></td></tr></table></figure>\n<p>[root@fabric1 scritps]# cat fabfile.py<br>def hello(name=”world”):<br>    print(“Hello %s!” % name)</p>\n<p>[root@fabric1 scritps]# fab hello<br>Hello world!</p>\n<p>Done.<br>[root@fabric1 scritps]# fab hello:name=Jeff<br>Hello Jeff!</p>\n<p>Done.<br>[root@fabric1 scritps]# fab hello:Jeff<br>Hello Jeff!</p>\n<p>Done.<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">###(2)本地(local)命令与远程命令</div><div class=\"line\"></div><div class=\"line\">uname.py</div><div class=\"line\"></div><div class=\"line\">```python</div><div class=\"line\">#!/usr/bin/env python</div><div class=\"line\"># -*- coding: utf-8 -*-</div><div class=\"line\">from fabric.api import local,run</div><div class=\"line\"></div><div class=\"line\">def test():</div><div class=\"line\">    local(&quot;uname -r&quot;)</div><div class=\"line\">    run(&quot;uname -r&quot;)</div></pre></td></tr></table></figure></p>\n<p>执行：fab -f uname.py test</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"># fab -f uname.py -H root@192.168.27.138 test</div><div class=\"line\">[root@192.168.27.138] Executing task &apos;test&apos;</div><div class=\"line\">[localhost] local: uname -r</div><div class=\"line\">2.6.32-279.el6.x86_64</div><div class=\"line\">[root@192.168.27.138] run: uname -r</div><div class=\"line\">[root@192.168.27.138] Login password for &apos;root&apos;: #这里要输入密码</div><div class=\"line\">[root@192.168.27.138] out: 2.6.32-279.el6.x86_64</div><div class=\"line\">[root@192.168.27.138] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from 192.168.27.138... done.</div></pre></td></tr></table></figure>\n<p>local执行本地命令，run执行远程命令。</p>\n<p>-H 是定义主机地址。</p>\n<p>###(3)更加实用的例子</p>\n<p>test.py</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></div><div class=\"line\"><span class=\"comment\"># -*- coding: utf-8 -*-</span></div><div class=\"line\"><span class=\"keyword\">from</span> fabric.api <span class=\"keyword\">import</span> settings, run, cd, env</div><div class=\"line\"></div><div class=\"line\">env.hosts = [<span class=\"string\">'work@host2'</span>]</div><div class=\"line\">env.user = <span class=\"string\">'work'</span></div><div class=\"line\">env.password = <span class=\"string\">'123456'</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">deploy</span><span class=\"params\">()</span>:</span></div><div class=\"line\">    code_dir = <span class=\"string\">'/home/work/GoFileServer'</span></div><div class=\"line\">    <span class=\"keyword\">with</span> settings(warn_only=<span class=\"keyword\">True</span>):</div><div class=\"line\">        <span class=\"keyword\">if</span> run(<span class=\"string\">\"test -d %s\"</span> % code_dir).failed:</div><div class=\"line\">            run(<span class=\"string\">\"git clone https://github.com/xionglie/GoFileServer.git %s\"</span> % code_dir)</div><div class=\"line\">    <span class=\"keyword\">with</span> cd(code_dir):</div><div class=\"line\">        run(<span class=\"string\">\"git pull\"</span>)</div><div class=\"line\">```    </div><div class=\"line\"></div><div class=\"line\">说明：</div><div class=\"line\"></div><div class=\"line\">这里我将远程主机的用户名、密码写在python文件里, 生产环境是不推荐这么做的。   </div><div class=\"line\">下一篇文章，我会重点讲解hosts,user,password的相关问题。</div><div class=\"line\"></div><div class=\"line\">deploy是将代码发布到远程主机上，如果远程项目目录还未存在，则先执行git clone操作。</div><div class=\"line\"></div><div class=\"line\">最后到代码目录里执行 git pull , 更新代码到最新版本。 </div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">执行结果：</div></pre></td></tr></table></figure>\n<p>[root@fabric1 scritps]# fab -f test.py deploy<br>[work@host2] Executing task ‘deploy’<br>[work@host2] run: test -d /home/work/GoFileServer</p>\n<p>Warning: run() received nonzero return code 1 while executing ‘test -d /home/work/GoFileServer’!</p>\n<p>[work@host2] run: git clone <a href=\"https://github.com/xionglie/GoFileServer.git\">https://github.com/xionglie/GoFileServer.git</a> /home/work/GoFileServer<br>[work@host2] out: Initialized empty Git repository in /home/work/GoFileServer/.git/<br>[work@host2] out: remote: Counting objects: 5, done.<br>[work@host2] out: remote: Total 5 (delta 0), reused 0 (delta 0)<br>[work@host2] out: Unpacking objects:  20% (1/5)<br>[work@host2] out: Unpacking objects:  40% (2/5)<br>[work@host2] out: Unpacking objects:  60% (3/5)<br>[work@host2] out: Unpacking objects:  80% (4/5)<br>[work@host2] out: Unpacking objects: 100% (5/5)<br>[work@host2] out: Unpacking objects: 100% (5/5), done.<br>[work@host2] out:</p>\n<p>[work@host2] run: git pull<br>[work@host2] out: Already up-to-date.<br>[work@host2] out:</p>\n<p>Done.<br>Disconnecting from host2… done.<br>```</p>"},{"layout":"post","title":"JAVA垃圾回收入门","date":"2015-03-21T13:04:00.000Z","comments":1,"_content":"\n2012年写的笔记。\n\n[点击下载pdf](http://pan.baidu.com/s/1jG03A8A)\n\n<!-- more -->\n\n\n文档目录\n\n```\n目录\t1\n1.\tjava编译执行\t3\n2.\t为什么有垃圾回收\t3\n3.\tjava内存区域\t4\n3.1.\tjava虚拟机运行时数据区\t4\n4.\tJVM内存参数\t5\n4.1.\t–server与-client\t5\n4.2.\t设置最大堆内存-Xmx<max>，最小堆内存-Xms<min>\t6\n4.3.\t设置新生代-Xmn<size>\t6\n4.4.\t设置持久代-XX:MaxPermSize=<N>, -XX:PermSize=<N>\t6\n4.5.\t设置线程栈-Xss<size>\t6\n4.6.\t设置新生代eden与survivor的比例-XX:SurvivorRatio\t7\n4.7.\t堆分配参数总结\t7\n5.\tjava程序运行时常见错误\t8\n5.1.\tjava.lang.OutOfMemoryError: Java heap space\t8\n5.2.\tjava.lang.OutOfMemoryError: PermGen space\t9\n5.3.\tjava.lang.OutOfMemoryError: unable to create new native thread\t9\n5.4.\tjava.lang.StackOverflowError\t10\n6.\ttomcat与resin中设置JVM参数\t10\n6.1.\ttomcat(tomcat-6.0.36)\t10\n6.2.\tresin(resin-3.1.12)\t10\n7.\t如何进行垃圾回收\t11\n8.\t哪些对象需要回收-发现垃圾对象\t11\n8.1.\t引用计数算法\t11\n8.2.\t根搜索算法\t12\n9.\t什么时候回收垃圾对象\t13\n9.1.\t分代\t13\n9.1.1.\t新生代(Young Generation)\t13\n9.1.2.\t旧生代（Old Generation/Tenuring Generation）\t13\n9.1.3.\t持久代（Permanent Generation）\t14\n9.2.\t分代GC的类型\t14\n9.2.1.\tMinor GC\t14\n9.2.2.\tFull GC\t14\n9.3.\tGC的步骤\t15\n10.\t如何回收垃圾对象\t15\n10.1.\t垃圾收集算法\t15\n10.1.1.\t标记-清除算法(Mark-Sweep)\t15\n10.1.2.\t复制算法(copying)\t16\n10.1.3.\t标记-压缩算法(Mark-Compact)\t17\n10.1.4.\t分代收集算法(Generation Collection)\t18\n10.2.\t垃圾收集器\t18\n10.2.1.\t串行收集器\t19\n10.2.2.\t并行收集器\t20\n10.2.3.\t并发收集器(CMS)\t22\n10.2.4.\tGarbage First(G1)收集器-略\t22\n10.2.5.\t选择收集器(Selecting a Collector)\t23\n10.2.6.\t总结\t24\n11.\tJVM监控与分析\t26\n11.1.\t输出GC日志\t27\n11.1.1.\t使用举例\t27\n11.2.\tjps 虚拟机进程状态工具\t31\n11.3.\tjstat 统计信息监控工具\t31\n11.4.\tjinfo java配置信息工具\t32\n11.5.\tjmap 内存映像工具\t33\n11.5.1.\t使用举例\t34\n11.6.\tjconsole\t36\n11.7.\tVisualVM 多合一故障处理工具\t38\n12.\tJVM调优过程\t39\n12.1.\t测试小例子\t40\n12.1.1.\t测试环境\t40\n12.1.2.\t测试场景1：默认tomcat配置\t41\n12.1.3.\t测试场景2：JVM配置：-Xmx512M -Xms512M -Xmn128M -XX:+UseSerialGC\t43\n12.1.4.\t测试场景3：JVM配置：-Xmx512M -Xms512M -Xmn128M -XX:+UseParallelGC -XX:+UseParallelOldGC\t44\n12.1.5.\t测试结果分析\t45\n13.\t参考资料\t46\n14.\t附录\t46\n14.1.\tServer-Class Machine Detection\t46\n14.2.\tGarbage Collector Ergonomics\t47\n14.3.\tShould I use a 32- or a 64-bit JVM?\t49\n14.4.\tIncreasing heap size – beware of the Cobra Effect\t53\n```\n","source":"_posts/2015-03-21-java-gc-basic.md","raw":"---\nlayout: post\ntitle: \"JAVA垃圾回收入门\"\ndate: 2015-03-21 21:04\ncomments: true\ncategories: jvm\n---\n\n2012年写的笔记。\n\n[点击下载pdf](http://pan.baidu.com/s/1jG03A8A)\n\n<!-- more -->\n\n\n文档目录\n\n```\n目录\t1\n1.\tjava编译执行\t3\n2.\t为什么有垃圾回收\t3\n3.\tjava内存区域\t4\n3.1.\tjava虚拟机运行时数据区\t4\n4.\tJVM内存参数\t5\n4.1.\t–server与-client\t5\n4.2.\t设置最大堆内存-Xmx<max>，最小堆内存-Xms<min>\t6\n4.3.\t设置新生代-Xmn<size>\t6\n4.4.\t设置持久代-XX:MaxPermSize=<N>, -XX:PermSize=<N>\t6\n4.5.\t设置线程栈-Xss<size>\t6\n4.6.\t设置新生代eden与survivor的比例-XX:SurvivorRatio\t7\n4.7.\t堆分配参数总结\t7\n5.\tjava程序运行时常见错误\t8\n5.1.\tjava.lang.OutOfMemoryError: Java heap space\t8\n5.2.\tjava.lang.OutOfMemoryError: PermGen space\t9\n5.3.\tjava.lang.OutOfMemoryError: unable to create new native thread\t9\n5.4.\tjava.lang.StackOverflowError\t10\n6.\ttomcat与resin中设置JVM参数\t10\n6.1.\ttomcat(tomcat-6.0.36)\t10\n6.2.\tresin(resin-3.1.12)\t10\n7.\t如何进行垃圾回收\t11\n8.\t哪些对象需要回收-发现垃圾对象\t11\n8.1.\t引用计数算法\t11\n8.2.\t根搜索算法\t12\n9.\t什么时候回收垃圾对象\t13\n9.1.\t分代\t13\n9.1.1.\t新生代(Young Generation)\t13\n9.1.2.\t旧生代（Old Generation/Tenuring Generation）\t13\n9.1.3.\t持久代（Permanent Generation）\t14\n9.2.\t分代GC的类型\t14\n9.2.1.\tMinor GC\t14\n9.2.2.\tFull GC\t14\n9.3.\tGC的步骤\t15\n10.\t如何回收垃圾对象\t15\n10.1.\t垃圾收集算法\t15\n10.1.1.\t标记-清除算法(Mark-Sweep)\t15\n10.1.2.\t复制算法(copying)\t16\n10.1.3.\t标记-压缩算法(Mark-Compact)\t17\n10.1.4.\t分代收集算法(Generation Collection)\t18\n10.2.\t垃圾收集器\t18\n10.2.1.\t串行收集器\t19\n10.2.2.\t并行收集器\t20\n10.2.3.\t并发收集器(CMS)\t22\n10.2.4.\tGarbage First(G1)收集器-略\t22\n10.2.5.\t选择收集器(Selecting a Collector)\t23\n10.2.6.\t总结\t24\n11.\tJVM监控与分析\t26\n11.1.\t输出GC日志\t27\n11.1.1.\t使用举例\t27\n11.2.\tjps 虚拟机进程状态工具\t31\n11.3.\tjstat 统计信息监控工具\t31\n11.4.\tjinfo java配置信息工具\t32\n11.5.\tjmap 内存映像工具\t33\n11.5.1.\t使用举例\t34\n11.6.\tjconsole\t36\n11.7.\tVisualVM 多合一故障处理工具\t38\n12.\tJVM调优过程\t39\n12.1.\t测试小例子\t40\n12.1.1.\t测试环境\t40\n12.1.2.\t测试场景1：默认tomcat配置\t41\n12.1.3.\t测试场景2：JVM配置：-Xmx512M -Xms512M -Xmn128M -XX:+UseSerialGC\t43\n12.1.4.\t测试场景3：JVM配置：-Xmx512M -Xms512M -Xmn128M -XX:+UseParallelGC -XX:+UseParallelOldGC\t44\n12.1.5.\t测试结果分析\t45\n13.\t参考资料\t46\n14.\t附录\t46\n14.1.\tServer-Class Machine Detection\t46\n14.2.\tGarbage Collector Ergonomics\t47\n14.3.\tShould I use a 32- or a 64-bit JVM?\t49\n14.4.\tIncreasing heap size – beware of the Cobra Effect\t53\n```\n","slug":"java-gc-basic","published":1,"updated":"2017-01-27T02:05:00.000Z","photos":[],"link":"","_id":"ciyf7fkc0001af2jyjhqpkafq","content":"<p>2012年写的笔记。</p>\n<p><a href=\"http://pan.baidu.com/s/1jG03A8A\" target=\"_blank\" rel=\"external\">点击下载pdf</a></p>\n<a id=\"more\"></a>\n<p>文档目录</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div></pre></td><td class=\"code\"><pre><div class=\"line\">目录\t1</div><div class=\"line\">1.\tjava编译执行\t3</div><div class=\"line\">2.\t为什么有垃圾回收\t3</div><div class=\"line\">3.\tjava内存区域\t4</div><div class=\"line\">3.1.\tjava虚拟机运行时数据区\t4</div><div class=\"line\">4.\tJVM内存参数\t5</div><div class=\"line\">4.1.\t–server与-client\t5</div><div class=\"line\">4.2.\t设置最大堆内存-Xmx&lt;max&gt;，最小堆内存-Xms&lt;min&gt;\t6</div><div class=\"line\">4.3.\t设置新生代-Xmn&lt;size&gt;\t6</div><div class=\"line\">4.4.\t设置持久代-XX:MaxPermSize=&lt;N&gt;, -XX:PermSize=&lt;N&gt;\t6</div><div class=\"line\">4.5.\t设置线程栈-Xss&lt;size&gt;\t6</div><div class=\"line\">4.6.\t设置新生代eden与survivor的比例-XX:SurvivorRatio\t7</div><div class=\"line\">4.7.\t堆分配参数总结\t7</div><div class=\"line\">5.\tjava程序运行时常见错误\t8</div><div class=\"line\">5.1.\tjava.lang.OutOfMemoryError: Java heap space\t8</div><div class=\"line\">5.2.\tjava.lang.OutOfMemoryError: PermGen space\t9</div><div class=\"line\">5.3.\tjava.lang.OutOfMemoryError: unable to create new native thread\t9</div><div class=\"line\">5.4.\tjava.lang.StackOverflowError\t10</div><div class=\"line\">6.\ttomcat与resin中设置JVM参数\t10</div><div class=\"line\">6.1.\ttomcat(tomcat-6.0.36)\t10</div><div class=\"line\">6.2.\tresin(resin-3.1.12)\t10</div><div class=\"line\">7.\t如何进行垃圾回收\t11</div><div class=\"line\">8.\t哪些对象需要回收-发现垃圾对象\t11</div><div class=\"line\">8.1.\t引用计数算法\t11</div><div class=\"line\">8.2.\t根搜索算法\t12</div><div class=\"line\">9.\t什么时候回收垃圾对象\t13</div><div class=\"line\">9.1.\t分代\t13</div><div class=\"line\">9.1.1.\t新生代(Young Generation)\t13</div><div class=\"line\">9.1.2.\t旧生代（Old Generation/Tenuring Generation）\t13</div><div class=\"line\">9.1.3.\t持久代（Permanent Generation）\t14</div><div class=\"line\">9.2.\t分代GC的类型\t14</div><div class=\"line\">9.2.1.\tMinor GC\t14</div><div class=\"line\">9.2.2.\tFull GC\t14</div><div class=\"line\">9.3.\tGC的步骤\t15</div><div class=\"line\">10.\t如何回收垃圾对象\t15</div><div class=\"line\">10.1.\t垃圾收集算法\t15</div><div class=\"line\">10.1.1.\t标记-清除算法(Mark-Sweep)\t15</div><div class=\"line\">10.1.2.\t复制算法(copying)\t16</div><div class=\"line\">10.1.3.\t标记-压缩算法(Mark-Compact)\t17</div><div class=\"line\">10.1.4.\t分代收集算法(Generation Collection)\t18</div><div class=\"line\">10.2.\t垃圾收集器\t18</div><div class=\"line\">10.2.1.\t串行收集器\t19</div><div class=\"line\">10.2.2.\t并行收集器\t20</div><div class=\"line\">10.2.3.\t并发收集器(CMS)\t22</div><div class=\"line\">10.2.4.\tGarbage First(G1)收集器-略\t22</div><div class=\"line\">10.2.5.\t选择收集器(Selecting a Collector)\t23</div><div class=\"line\">10.2.6.\t总结\t24</div><div class=\"line\">11.\tJVM监控与分析\t26</div><div class=\"line\">11.1.\t输出GC日志\t27</div><div class=\"line\">11.1.1.\t使用举例\t27</div><div class=\"line\">11.2.\tjps 虚拟机进程状态工具\t31</div><div class=\"line\">11.3.\tjstat 统计信息监控工具\t31</div><div class=\"line\">11.4.\tjinfo java配置信息工具\t32</div><div class=\"line\">11.5.\tjmap 内存映像工具\t33</div><div class=\"line\">11.5.1.\t使用举例\t34</div><div class=\"line\">11.6.\tjconsole\t36</div><div class=\"line\">11.7.\tVisualVM 多合一故障处理工具\t38</div><div class=\"line\">12.\tJVM调优过程\t39</div><div class=\"line\">12.1.\t测试小例子\t40</div><div class=\"line\">12.1.1.\t测试环境\t40</div><div class=\"line\">12.1.2.\t测试场景1：默认tomcat配置\t41</div><div class=\"line\">12.1.3.\t测试场景2：JVM配置：-Xmx512M -Xms512M -Xmn128M -XX:+UseSerialGC\t43</div><div class=\"line\">12.1.4.\t测试场景3：JVM配置：-Xmx512M -Xms512M -Xmn128M -XX:+UseParallelGC -XX:+UseParallelOldGC\t44</div><div class=\"line\">12.1.5.\t测试结果分析\t45</div><div class=\"line\">13.\t参考资料\t46</div><div class=\"line\">14.\t附录\t46</div><div class=\"line\">14.1.\tServer-Class Machine Detection\t46</div><div class=\"line\">14.2.\tGarbage Collector Ergonomics\t47</div><div class=\"line\">14.3.\tShould I use a 32- or a 64-bit JVM?\t49</div><div class=\"line\">14.4.\tIncreasing heap size – beware of the Cobra Effect\t53</div></pre></td></tr></table></figure>\n","excerpt":"<p>2012年写的笔记。</p>\n<p><a href=\"http://pan.baidu.com/s/1jG03A8A\">点击下载pdf</a></p>","more":"<p>文档目录</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div></pre></td><td class=\"code\"><pre><div class=\"line\">目录\t1</div><div class=\"line\">1.\tjava编译执行\t3</div><div class=\"line\">2.\t为什么有垃圾回收\t3</div><div class=\"line\">3.\tjava内存区域\t4</div><div class=\"line\">3.1.\tjava虚拟机运行时数据区\t4</div><div class=\"line\">4.\tJVM内存参数\t5</div><div class=\"line\">4.1.\t–server与-client\t5</div><div class=\"line\">4.2.\t设置最大堆内存-Xmx&lt;max&gt;，最小堆内存-Xms&lt;min&gt;\t6</div><div class=\"line\">4.3.\t设置新生代-Xmn&lt;size&gt;\t6</div><div class=\"line\">4.4.\t设置持久代-XX:MaxPermSize=&lt;N&gt;, -XX:PermSize=&lt;N&gt;\t6</div><div class=\"line\">4.5.\t设置线程栈-Xss&lt;size&gt;\t6</div><div class=\"line\">4.6.\t设置新生代eden与survivor的比例-XX:SurvivorRatio\t7</div><div class=\"line\">4.7.\t堆分配参数总结\t7</div><div class=\"line\">5.\tjava程序运行时常见错误\t8</div><div class=\"line\">5.1.\tjava.lang.OutOfMemoryError: Java heap space\t8</div><div class=\"line\">5.2.\tjava.lang.OutOfMemoryError: PermGen space\t9</div><div class=\"line\">5.3.\tjava.lang.OutOfMemoryError: unable to create new native thread\t9</div><div class=\"line\">5.4.\tjava.lang.StackOverflowError\t10</div><div class=\"line\">6.\ttomcat与resin中设置JVM参数\t10</div><div class=\"line\">6.1.\ttomcat(tomcat-6.0.36)\t10</div><div class=\"line\">6.2.\tresin(resin-3.1.12)\t10</div><div class=\"line\">7.\t如何进行垃圾回收\t11</div><div class=\"line\">8.\t哪些对象需要回收-发现垃圾对象\t11</div><div class=\"line\">8.1.\t引用计数算法\t11</div><div class=\"line\">8.2.\t根搜索算法\t12</div><div class=\"line\">9.\t什么时候回收垃圾对象\t13</div><div class=\"line\">9.1.\t分代\t13</div><div class=\"line\">9.1.1.\t新生代(Young Generation)\t13</div><div class=\"line\">9.1.2.\t旧生代（Old Generation/Tenuring Generation）\t13</div><div class=\"line\">9.1.3.\t持久代（Permanent Generation）\t14</div><div class=\"line\">9.2.\t分代GC的类型\t14</div><div class=\"line\">9.2.1.\tMinor GC\t14</div><div class=\"line\">9.2.2.\tFull GC\t14</div><div class=\"line\">9.3.\tGC的步骤\t15</div><div class=\"line\">10.\t如何回收垃圾对象\t15</div><div class=\"line\">10.1.\t垃圾收集算法\t15</div><div class=\"line\">10.1.1.\t标记-清除算法(Mark-Sweep)\t15</div><div class=\"line\">10.1.2.\t复制算法(copying)\t16</div><div class=\"line\">10.1.3.\t标记-压缩算法(Mark-Compact)\t17</div><div class=\"line\">10.1.4.\t分代收集算法(Generation Collection)\t18</div><div class=\"line\">10.2.\t垃圾收集器\t18</div><div class=\"line\">10.2.1.\t串行收集器\t19</div><div class=\"line\">10.2.2.\t并行收集器\t20</div><div class=\"line\">10.2.3.\t并发收集器(CMS)\t22</div><div class=\"line\">10.2.4.\tGarbage First(G1)收集器-略\t22</div><div class=\"line\">10.2.5.\t选择收集器(Selecting a Collector)\t23</div><div class=\"line\">10.2.6.\t总结\t24</div><div class=\"line\">11.\tJVM监控与分析\t26</div><div class=\"line\">11.1.\t输出GC日志\t27</div><div class=\"line\">11.1.1.\t使用举例\t27</div><div class=\"line\">11.2.\tjps 虚拟机进程状态工具\t31</div><div class=\"line\">11.3.\tjstat 统计信息监控工具\t31</div><div class=\"line\">11.4.\tjinfo java配置信息工具\t32</div><div class=\"line\">11.5.\tjmap 内存映像工具\t33</div><div class=\"line\">11.5.1.\t使用举例\t34</div><div class=\"line\">11.6.\tjconsole\t36</div><div class=\"line\">11.7.\tVisualVM 多合一故障处理工具\t38</div><div class=\"line\">12.\tJVM调优过程\t39</div><div class=\"line\">12.1.\t测试小例子\t40</div><div class=\"line\">12.1.1.\t测试环境\t40</div><div class=\"line\">12.1.2.\t测试场景1：默认tomcat配置\t41</div><div class=\"line\">12.1.3.\t测试场景2：JVM配置：-Xmx512M -Xms512M -Xmn128M -XX:+UseSerialGC\t43</div><div class=\"line\">12.1.4.\t测试场景3：JVM配置：-Xmx512M -Xms512M -Xmn128M -XX:+UseParallelGC -XX:+UseParallelOldGC\t44</div><div class=\"line\">12.1.5.\t测试结果分析\t45</div><div class=\"line\">13.\t参考资料\t46</div><div class=\"line\">14.\t附录\t46</div><div class=\"line\">14.1.\tServer-Class Machine Detection\t46</div><div class=\"line\">14.2.\tGarbage Collector Ergonomics\t47</div><div class=\"line\">14.3.\tShould I use a 32- or a 64-bit JVM?\t49</div><div class=\"line\">14.4.\tIncreasing heap size – beware of the Cobra Effect\t53</div></pre></td></tr></table></figure>"},{"layout":"post","title":"事情都没你想的那么简单","date":"2015-04-10T10:10:00.000Z","_content":"\n几个月前，项目组有一次开会说要为我们的活动频道集成支付模块，让一些需要交费的活动可以线上付款，免得活动发起人每次在活动举行前都催着交款。有人说，接口集成很快的，最多半天就行了。给人的感觉就像是活动集成支付模块，最多半天/一天的功夫就能集成上去一样。\n\n事情真的有那么简单吗？*有这么简单就好了*。\n\n<!-- more -->\n\n调通支付宝接口可能很快，但是与现有的业务对接起来，要做的事情还蛮多的：\n\n1. 你要申请支付宝接口吧？不同类型的接口的限制(是否能用信用卡，每笔交易的限额等)要了解清楚吧？这些限制会影响业务需求吗？\n2. 加上支付功能，当前活动模块的流程肯定会有变化:\n\t- 像创建活动时，要设置每人需要交多少钱。注明是否是需要交费的活动。\n\t- 活动报名的状态，可能要加上\"未支付\"/\"已支付\"的状态。\n\t- 活动发起人的报名表，要加上支付状态。\n\t- 支付过程中可能会出现各种推送通知，这些通知触发条件和内容模板是什么？\n\t- 如果用户真的不能在线支付，只能线下支付怎么办？\n\t- 用户支付成功，但由于各种原因不能参加活动了，钱如何处理？退款？\n\t- 用户支付成功，但最终活动取消，钱怎么退还给用户？\n\t- 用户交的钱，如何交给活动发起人？是否需要活动前只给70%，活动结束后再给剩余部分？\n\t- ...\n\n3. 加上支付模块，肯定不能只为\"活动\"服务。如果以后有频道需要支付功能，也应该能很轻松的集成进来。订单系统如何设计？\n4. 用户应该有一个交易明细表，这样用户就能看到自己的交易流水！\n交易明细表如何设计？用户查看交易明细的入口在哪里？\n5. 是否需要每天生成一个对账单？以便于每天与支付宝对账！\n6. 支付宝给出的示例代码，并不是万无一失的。其中可能隐藏一些bug。这些都要小心！\n7. ...\n\n\n老总要加上支付功能，并不是调通支付宝接口就OK了, 你要考虑的是整个支付模块及相应的频道功能的调整！\n\n其实，单是支付宝接口在调试时要特别注意两点：\n\n* 支付的编码问题。因为要考虑签名及商品名的正常显示。 \n* 要多测试特殊商品名(如含有html标签)对支付接口的影响。\n\n对于第三方接口，都要考虑以下的：\n\n```\n(1). 假定不稳定 \n不能因为对方挂掉而拖垮你的网站。\n\n(2). 设置超时 \n如http请求，要设置连接超时和读超时。\n以前我也是有教训的：在hui99时，使用第三方的短信接口，并使用官方提供的JAR包。由于接口方服务器调整，导致读接收短信时，数据不返回，且连接不释放。最终导致tomcat连接数耗尽而网站崩溃。\n主要是对方JAR包内http连接，未设置超时。说起来都是泪啊！\n\n(3). 添加监控 \n是否能连接？\n是否能正常响应请求(响应时间)？\n出错记录日志并提醒。\n\n(4). 用日志界定边界 \n–所有的输入输出 \n```\n\n*许多人都会高估自己，同时低估了事情的难度。一个功能，普通程序员预计一两天能完成，实际上到完全可用大概需要一周的时间。*\n\n*许多事情看起来简单的事，想真正做好却很难。*\n\n酷壳上有一篇\"[你会做Web上的用户登录功能吗？](http://coolshell.cn/articles/5353.html)\"也能说明这种情况。\n\n##不要轻易“低估”事情的难度\n\n在2012年，我决定学习linux/linux运维的时候，我就觉得学linux是困难的。不抓住重点学，不边学边用，没有人带你走，弄不好还被linux搞。\n\n从图形界面转到文本命令行，一开始是不适应的。\n\nlinux种类繁多的命令和参数选项是很吓人的。单是\"鸟哥\"那两本linux厚书，也让人有不少压力。\n\n就算你将常用的命令和软件都比较熟悉了，常见的问题和错误都遇到过、解决了。一些好的思想和习惯可能你都没有。如：\n\n```\n操作前备份，操作后检查;\n不清楚的命令，首先使用man;\n查软件文档，首先要去官网，这样就能拿到第一手的资料;\n...\n```\n\n所以 `rm -f /` 成了许多人心中的痛。\n\n大半年的时间，大过分的下班时间都放在linux运维学习上，写了过千页的总结文档和笔记。很多都是线上的生产环境上的经验。\n\n事情的\"困难\"和\"容易\"之分，就在于你所处的高度。大牛们经历过许多东西，所以他们能够*举重若轻*。\n\n笑来有一篇文章提到:\n\n>如若一个人在一个方面能做到优秀甚至极致，那么他自然就会懂得一个道理：\n\n>精通某个技能，需要大量的练习、重复、自我观察、自我纠正、反思、进阶、自我否定、自我怀疑……以上循环，最终达到一定地步，进而自信……这个过程中反复能体会到的东西就是，越是简单的环节越容易成为短板，所以要格外重视；越是复杂的东西就需要越多的重复训练——直至最终做到“举重若轻”……\n\n所以，简历上不要轻易写\"精通\"两字。\n\n","source":"_posts/2015-04-10-seemingly-simple-yet-very-difficult-feats.md","raw":"---\nlayout: post\ntitle: \"事情都没你想的那么简单\"\ncategories: 随笔\ndate: 2015-04-10 18:10\n---\n\n几个月前，项目组有一次开会说要为我们的活动频道集成支付模块，让一些需要交费的活动可以线上付款，免得活动发起人每次在活动举行前都催着交款。有人说，接口集成很快的，最多半天就行了。给人的感觉就像是活动集成支付模块，最多半天/一天的功夫就能集成上去一样。\n\n事情真的有那么简单吗？*有这么简单就好了*。\n\n<!-- more -->\n\n调通支付宝接口可能很快，但是与现有的业务对接起来，要做的事情还蛮多的：\n\n1. 你要申请支付宝接口吧？不同类型的接口的限制(是否能用信用卡，每笔交易的限额等)要了解清楚吧？这些限制会影响业务需求吗？\n2. 加上支付功能，当前活动模块的流程肯定会有变化:\n\t- 像创建活动时，要设置每人需要交多少钱。注明是否是需要交费的活动。\n\t- 活动报名的状态，可能要加上\"未支付\"/\"已支付\"的状态。\n\t- 活动发起人的报名表，要加上支付状态。\n\t- 支付过程中可能会出现各种推送通知，这些通知触发条件和内容模板是什么？\n\t- 如果用户真的不能在线支付，只能线下支付怎么办？\n\t- 用户支付成功，但由于各种原因不能参加活动了，钱如何处理？退款？\n\t- 用户支付成功，但最终活动取消，钱怎么退还给用户？\n\t- 用户交的钱，如何交给活动发起人？是否需要活动前只给70%，活动结束后再给剩余部分？\n\t- ...\n\n3. 加上支付模块，肯定不能只为\"活动\"服务。如果以后有频道需要支付功能，也应该能很轻松的集成进来。订单系统如何设计？\n4. 用户应该有一个交易明细表，这样用户就能看到自己的交易流水！\n交易明细表如何设计？用户查看交易明细的入口在哪里？\n5. 是否需要每天生成一个对账单？以便于每天与支付宝对账！\n6. 支付宝给出的示例代码，并不是万无一失的。其中可能隐藏一些bug。这些都要小心！\n7. ...\n\n\n老总要加上支付功能，并不是调通支付宝接口就OK了, 你要考虑的是整个支付模块及相应的频道功能的调整！\n\n其实，单是支付宝接口在调试时要特别注意两点：\n\n* 支付的编码问题。因为要考虑签名及商品名的正常显示。 \n* 要多测试特殊商品名(如含有html标签)对支付接口的影响。\n\n对于第三方接口，都要考虑以下的：\n\n```\n(1). 假定不稳定 \n不能因为对方挂掉而拖垮你的网站。\n\n(2). 设置超时 \n如http请求，要设置连接超时和读超时。\n以前我也是有教训的：在hui99时，使用第三方的短信接口，并使用官方提供的JAR包。由于接口方服务器调整，导致读接收短信时，数据不返回，且连接不释放。最终导致tomcat连接数耗尽而网站崩溃。\n主要是对方JAR包内http连接，未设置超时。说起来都是泪啊！\n\n(3). 添加监控 \n是否能连接？\n是否能正常响应请求(响应时间)？\n出错记录日志并提醒。\n\n(4). 用日志界定边界 \n–所有的输入输出 \n```\n\n*许多人都会高估自己，同时低估了事情的难度。一个功能，普通程序员预计一两天能完成，实际上到完全可用大概需要一周的时间。*\n\n*许多事情看起来简单的事，想真正做好却很难。*\n\n酷壳上有一篇\"[你会做Web上的用户登录功能吗？](http://coolshell.cn/articles/5353.html)\"也能说明这种情况。\n\n##不要轻易“低估”事情的难度\n\n在2012年，我决定学习linux/linux运维的时候，我就觉得学linux是困难的。不抓住重点学，不边学边用，没有人带你走，弄不好还被linux搞。\n\n从图形界面转到文本命令行，一开始是不适应的。\n\nlinux种类繁多的命令和参数选项是很吓人的。单是\"鸟哥\"那两本linux厚书，也让人有不少压力。\n\n就算你将常用的命令和软件都比较熟悉了，常见的问题和错误都遇到过、解决了。一些好的思想和习惯可能你都没有。如：\n\n```\n操作前备份，操作后检查;\n不清楚的命令，首先使用man;\n查软件文档，首先要去官网，这样就能拿到第一手的资料;\n...\n```\n\n所以 `rm -f /` 成了许多人心中的痛。\n\n大半年的时间，大过分的下班时间都放在linux运维学习上，写了过千页的总结文档和笔记。很多都是线上的生产环境上的经验。\n\n事情的\"困难\"和\"容易\"之分，就在于你所处的高度。大牛们经历过许多东西，所以他们能够*举重若轻*。\n\n笑来有一篇文章提到:\n\n>如若一个人在一个方面能做到优秀甚至极致，那么他自然就会懂得一个道理：\n\n>精通某个技能，需要大量的练习、重复、自我观察、自我纠正、反思、进阶、自我否定、自我怀疑……以上循环，最终达到一定地步，进而自信……这个过程中反复能体会到的东西就是，越是简单的环节越容易成为短板，所以要格外重视；越是复杂的东西就需要越多的重复训练——直至最终做到“举重若轻”……\n\n所以，简历上不要轻易写\"精通\"两字。\n\n","slug":"seemingly-simple-yet-very-difficult-feats","published":1,"updated":"2017-01-27T02:05:11.000Z","comments":1,"photos":[],"link":"","_id":"ciyf7fkcc001bf2jyqf8l0j2o","content":"<p>几个月前，项目组有一次开会说要为我们的活动频道集成支付模块，让一些需要交费的活动可以线上付款，免得活动发起人每次在活动举行前都催着交款。有人说，接口集成很快的，最多半天就行了。给人的感觉就像是活动集成支付模块，最多半天/一天的功夫就能集成上去一样。</p>\n<p>事情真的有那么简单吗？<em>有这么简单就好了</em>。</p>\n<a id=\"more\"></a>\n<p>调通支付宝接口可能很快，但是与现有的业务对接起来，要做的事情还蛮多的：</p>\n<ol>\n<li>你要申请支付宝接口吧？不同类型的接口的限制(是否能用信用卡，每笔交易的限额等)要了解清楚吧？这些限制会影响业务需求吗？</li>\n<li><p>加上支付功能，当前活动模块的流程肯定会有变化:</p>\n<ul>\n<li>像创建活动时，要设置每人需要交多少钱。注明是否是需要交费的活动。</li>\n<li>活动报名的状态，可能要加上”未支付”/“已支付”的状态。</li>\n<li>活动发起人的报名表，要加上支付状态。</li>\n<li>支付过程中可能会出现各种推送通知，这些通知触发条件和内容模板是什么？</li>\n<li>如果用户真的不能在线支付，只能线下支付怎么办？</li>\n<li>用户支付成功，但由于各种原因不能参加活动了，钱如何处理？退款？</li>\n<li>用户支付成功，但最终活动取消，钱怎么退还给用户？</li>\n<li>用户交的钱，如何交给活动发起人？是否需要活动前只给70%，活动结束后再给剩余部分？</li>\n<li>…</li>\n</ul>\n</li>\n<li><p>加上支付模块，肯定不能只为”活动”服务。如果以后有频道需要支付功能，也应该能很轻松的集成进来。订单系统如何设计？</p>\n</li>\n<li>用户应该有一个交易明细表，这样用户就能看到自己的交易流水！<br>交易明细表如何设计？用户查看交易明细的入口在哪里？</li>\n<li>是否需要每天生成一个对账单？以便于每天与支付宝对账！</li>\n<li>支付宝给出的示例代码，并不是万无一失的。其中可能隐藏一些bug。这些都要小心！</li>\n<li>…</li>\n</ol>\n<p>老总要加上支付功能，并不是调通支付宝接口就OK了, 你要考虑的是整个支付模块及相应的频道功能的调整！</p>\n<p>其实，单是支付宝接口在调试时要特别注意两点：</p>\n<ul>\n<li>支付的编码问题。因为要考虑签名及商品名的正常显示。 </li>\n<li>要多测试特殊商品名(如含有html标签)对支付接口的影响。</li>\n</ul>\n<p>对于第三方接口，都要考虑以下的：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\">(1). 假定不稳定 </div><div class=\"line\">不能因为对方挂掉而拖垮你的网站。</div><div class=\"line\"></div><div class=\"line\">(2). 设置超时 </div><div class=\"line\">如http请求，要设置连接超时和读超时。</div><div class=\"line\">以前我也是有教训的：在hui99时，使用第三方的短信接口，并使用官方提供的JAR包。由于接口方服务器调整，导致读接收短信时，数据不返回，且连接不释放。最终导致tomcat连接数耗尽而网站崩溃。</div><div class=\"line\">主要是对方JAR包内http连接，未设置超时。说起来都是泪啊！</div><div class=\"line\"></div><div class=\"line\">(3). 添加监控 </div><div class=\"line\">是否能连接？</div><div class=\"line\">是否能正常响应请求(响应时间)？</div><div class=\"line\">出错记录日志并提醒。</div><div class=\"line\"></div><div class=\"line\">(4). 用日志界定边界 </div><div class=\"line\">–所有的输入输出</div></pre></td></tr></table></figure>\n<p><em>许多人都会高估自己，同时低估了事情的难度。一个功能，普通程序员预计一两天能完成，实际上到完全可用大概需要一周的时间。</em></p>\n<p><em>许多事情看起来简单的事，想真正做好却很难。</em></p>\n<p>酷壳上有一篇”<a href=\"http://coolshell.cn/articles/5353.html\" target=\"_blank\" rel=\"external\">你会做Web上的用户登录功能吗？</a>“也能说明这种情况。</p>\n<p>##不要轻易“低估”事情的难度</p>\n<p>在2012年，我决定学习linux/linux运维的时候，我就觉得学linux是困难的。不抓住重点学，不边学边用，没有人带你走，弄不好还被linux搞。</p>\n<p>从图形界面转到文本命令行，一开始是不适应的。</p>\n<p>linux种类繁多的命令和参数选项是很吓人的。单是”鸟哥”那两本linux厚书，也让人有不少压力。</p>\n<p>就算你将常用的命令和软件都比较熟悉了，常见的问题和错误都遇到过、解决了。一些好的思想和习惯可能你都没有。如：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">操作前备份，操作后检查;</div><div class=\"line\">不清楚的命令，首先使用man;</div><div class=\"line\">查软件文档，首先要去官网，这样就能拿到第一手的资料;</div><div class=\"line\">...</div></pre></td></tr></table></figure>\n<p>所以 <code>rm -f /</code> 成了许多人心中的痛。</p>\n<p>大半年的时间，大过分的下班时间都放在linux运维学习上，写了过千页的总结文档和笔记。很多都是线上的生产环境上的经验。</p>\n<p>事情的”困难”和”容易”之分，就在于你所处的高度。大牛们经历过许多东西，所以他们能够<em>举重若轻</em>。</p>\n<p>笑来有一篇文章提到:</p>\n<blockquote>\n<p>如若一个人在一个方面能做到优秀甚至极致，那么他自然就会懂得一个道理：</p>\n<p>精通某个技能，需要大量的练习、重复、自我观察、自我纠正、反思、进阶、自我否定、自我怀疑……以上循环，最终达到一定地步，进而自信……这个过程中反复能体会到的东西就是，越是简单的环节越容易成为短板，所以要格外重视；越是复杂的东西就需要越多的重复训练——直至最终做到“举重若轻”……</p>\n</blockquote>\n<p>所以，简历上不要轻易写”精通”两字。</p>\n","excerpt":"<p>几个月前，项目组有一次开会说要为我们的活动频道集成支付模块，让一些需要交费的活动可以线上付款，免得活动发起人每次在活动举行前都催着交款。有人说，接口集成很快的，最多半天就行了。给人的感觉就像是活动集成支付模块，最多半天/一天的功夫就能集成上去一样。</p>\n<p>事情真的有那么简单吗？<em>有这么简单就好了</em>。</p>","more":"<p>调通支付宝接口可能很快，但是与现有的业务对接起来，要做的事情还蛮多的：</p>\n<ol>\n<li>你要申请支付宝接口吧？不同类型的接口的限制(是否能用信用卡，每笔交易的限额等)要了解清楚吧？这些限制会影响业务需求吗？</li>\n<li><p>加上支付功能，当前活动模块的流程肯定会有变化:</p>\n<ul>\n<li>像创建活动时，要设置每人需要交多少钱。注明是否是需要交费的活动。</li>\n<li>活动报名的状态，可能要加上”未支付”/“已支付”的状态。</li>\n<li>活动发起人的报名表，要加上支付状态。</li>\n<li>支付过程中可能会出现各种推送通知，这些通知触发条件和内容模板是什么？</li>\n<li>如果用户真的不能在线支付，只能线下支付怎么办？</li>\n<li>用户支付成功，但由于各种原因不能参加活动了，钱如何处理？退款？</li>\n<li>用户支付成功，但最终活动取消，钱怎么退还给用户？</li>\n<li>用户交的钱，如何交给活动发起人？是否需要活动前只给70%，活动结束后再给剩余部分？</li>\n<li>…</li>\n</ul>\n</li>\n<li><p>加上支付模块，肯定不能只为”活动”服务。如果以后有频道需要支付功能，也应该能很轻松的集成进来。订单系统如何设计？</p>\n</li>\n<li>用户应该有一个交易明细表，这样用户就能看到自己的交易流水！<br>交易明细表如何设计？用户查看交易明细的入口在哪里？</li>\n<li>是否需要每天生成一个对账单？以便于每天与支付宝对账！</li>\n<li>支付宝给出的示例代码，并不是万无一失的。其中可能隐藏一些bug。这些都要小心！</li>\n<li>…</li>\n</ol>\n<p>老总要加上支付功能，并不是调通支付宝接口就OK了, 你要考虑的是整个支付模块及相应的频道功能的调整！</p>\n<p>其实，单是支付宝接口在调试时要特别注意两点：</p>\n<ul>\n<li>支付的编码问题。因为要考虑签名及商品名的正常显示。 </li>\n<li>要多测试特殊商品名(如含有html标签)对支付接口的影响。</li>\n</ul>\n<p>对于第三方接口，都要考虑以下的：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\">(1). 假定不稳定 </div><div class=\"line\">不能因为对方挂掉而拖垮你的网站。</div><div class=\"line\"></div><div class=\"line\">(2). 设置超时 </div><div class=\"line\">如http请求，要设置连接超时和读超时。</div><div class=\"line\">以前我也是有教训的：在hui99时，使用第三方的短信接口，并使用官方提供的JAR包。由于接口方服务器调整，导致读接收短信时，数据不返回，且连接不释放。最终导致tomcat连接数耗尽而网站崩溃。</div><div class=\"line\">主要是对方JAR包内http连接，未设置超时。说起来都是泪啊！</div><div class=\"line\"></div><div class=\"line\">(3). 添加监控 </div><div class=\"line\">是否能连接？</div><div class=\"line\">是否能正常响应请求(响应时间)？</div><div class=\"line\">出错记录日志并提醒。</div><div class=\"line\"></div><div class=\"line\">(4). 用日志界定边界 </div><div class=\"line\">–所有的输入输出</div></pre></td></tr></table></figure>\n<p><em>许多人都会高估自己，同时低估了事情的难度。一个功能，普通程序员预计一两天能完成，实际上到完全可用大概需要一周的时间。</em></p>\n<p><em>许多事情看起来简单的事，想真正做好却很难。</em></p>\n<p>酷壳上有一篇”<a href=\"http://coolshell.cn/articles/5353.html\">你会做Web上的用户登录功能吗？</a>“也能说明这种情况。</p>\n<p>##不要轻易“低估”事情的难度</p>\n<p>在2012年，我决定学习linux/linux运维的时候，我就觉得学linux是困难的。不抓住重点学，不边学边用，没有人带你走，弄不好还被linux搞。</p>\n<p>从图形界面转到文本命令行，一开始是不适应的。</p>\n<p>linux种类繁多的命令和参数选项是很吓人的。单是”鸟哥”那两本linux厚书，也让人有不少压力。</p>\n<p>就算你将常用的命令和软件都比较熟悉了，常见的问题和错误都遇到过、解决了。一些好的思想和习惯可能你都没有。如：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">操作前备份，操作后检查;</div><div class=\"line\">不清楚的命令，首先使用man;</div><div class=\"line\">查软件文档，首先要去官网，这样就能拿到第一手的资料;</div><div class=\"line\">...</div></pre></td></tr></table></figure>\n<p>所以 <code>rm -f /</code> 成了许多人心中的痛。</p>\n<p>大半年的时间，大过分的下班时间都放在linux运维学习上，写了过千页的总结文档和笔记。很多都是线上的生产环境上的经验。</p>\n<p>事情的”困难”和”容易”之分，就在于你所处的高度。大牛们经历过许多东西，所以他们能够<em>举重若轻</em>。</p>\n<p>笑来有一篇文章提到:</p>\n<blockquote>\n<p>如若一个人在一个方面能做到优秀甚至极致，那么他自然就会懂得一个道理：</p>\n<p>精通某个技能，需要大量的练习、重复、自我观察、自我纠正、反思、进阶、自我否定、自我怀疑……以上循环，最终达到一定地步，进而自信……这个过程中反复能体会到的东西就是，越是简单的环节越容易成为短板，所以要格外重视；越是复杂的东西就需要越多的重复训练——直至最终做到“举重若轻”……</p>\n</blockquote>\n<p>所以，简历上不要轻易写”精通”两字。</p>"},{"layout":"post","title":"Fabric-02 主机(Hosts)和角色(Roles)","date":"2014-08-24T06:27:00.000Z","comments":1,"_content":"\n主要内容\n\n```\n#1.定义主机列表\n##1.1 主机\n##1.2 角色\n#2.如何构建主机列表(host lists) ?\n##2.1 四种主机定义方式\n###(1)Globally, via env\n###(2)Globally, via the command line\n###(3)Per-task, via the command line\n###(4)Per-task, via decorators\n##2.2 主机定义的优先顺序\n##2.3 测试\n#3. 其它\n##3.1 合并主机列表\n##3.2 重复的主机\n##3.3 不包含指定的主机\n##3.4 使用execute智能执行task\n```\n<!-- more -->\n\n#1.定义主机列表\n##1.1 主机\n主机的定义格式为: username@hostname:port\n\nusername和port是可选的(关联@和:),默认是本地用户，端口是22.\n\nip6格式同样是支持的。例如::1, [::1]:1222, user@2001:db8::1 or user@[2001:db8::1]:1222\n\n##1.2 角色\n\n有时候我们希望给主机分组，这样我们就能方便的控制它们。\n\n```python\nfrom fabric.api import env\n\nenv.roledefs['webservers'] = ['www1', 'www2', 'www3']\n```\n\n\n```python\nfrom fabric.api import env\n\nenv.roledefs = {\n    'web': ['www1', 'www2', 'www3'],\n    'dns': ['ns1', 'ns2']\n}\n```\n\n角色定义并是可必须的，它只是能让我们方便的管理同样功能的服务器组。\n\n\n\n#2.如何构建主机列表(host lists) ?\n\n##2.1 四种主机定义方式\n\n###(1)Globally, via env\n最常见的方式是通过设置 env: hosts and roles 。\n\nhosts和roles的值会在运行时进行检测，为每个task构造主机列表。\n\n####例子1： fabfile.py\n\n```python\nfrom fabric.api import env, run\n\nenv.hosts = ['host1', 'host2']\n\ndef mytask():\n    run('ls /var/www')\n```\n\n执行结果: \n\n```\n# fab mytask\n[host1] Executing task 'mytask'\n[host1] run: ls /var/www\n[host1] out: cgi-bin  error\thtml  icons\n[host1] out:\n\n[host2] Executing task 'mytask'\n[host2] run: ls /var/www\n[host2] out: cgi-bin  error\thtml  icons\n[host2] out:\n\n\nDone.\nDisconnecting from host2... done.\nDisconnecting from host1... done.\n```\n####例子2： 动态设置env.hosts\n我们可以在task中设置env.hosts, 它会影响接下来执行的tasks\n\n```\nfrom fabric.api import env, run\n\ndef set_hosts():\n    env.hosts = ['host1', 'host2']\n\ndef mytask():\n    run('ls /var/www')\n```\n\n执行命令: \n\t\n\tfab set_hosts mytask\n\n跟例子1是一样的效果。\n\n###(2)Globally, via the command line\n你可在在模块中通过 env.hosts, env.roles, env.exclude_hosts 来定义主机，也可以通过命令行参数 [hosts/-H](http://docs.fabfile.org/en/1.9/usage/fab.html#cmdoption-H) 和 [--roles/-R](http://docs.fabfile.org/en/1.9/usage/fab.html#cmdoption-R) 来定义主机。\n\n例如: \n\n\t$ fab -H host1,host2 mytask\n\n\n非常重要的一点是：\n>命令行参数会在fabfile文件载入方前被解释，所以fabfile文件中定义的env.hosts or env.roles会覆盖命令行参数。\n>如果你想合并它们,让在fabfile中使用 env.hosts.extend() 代替。\n\n```python\nfrom fabric.api import env, run\n\nenv.hosts.extend(['host3', 'host4'])\n\ndef mytask():\n    run('ls /var/www')\n```\n\n执行： fab -H host1,host2 mytask, 主机会包括： ['host1', 'host2', 'host3', 'host4']\n\n###(3)Per-task, via the command line\n对每个task, 使用命令行定义hosts。\n\n```\nfrom fabric.api import run\n\ndef mytask():\n    run('ls /var/www')\n```\n\n为mytask定义主机\n\n\t$ fab mytask:hosts=\"host1;host2\"\n\n这个会覆盖所有的主机列表，mytask只会在host1;host2中执行。\n\n```bash\n$ cat fabfile.py\nfrom fabric.api import env, run\n\ndef mytask():\n    run('ls /var/www')\n\n$ fab mytask:hosts=\"host1;host2\"\n[host1] Executing task 'mytask'\n[host1] run: ls /var/www\n[host1] out: cgi-bin  error\thtml  icons\n[host1] out:\n\n[host2] Executing task 'mytask'\n[host2] run: ls /var/www\n[host2] out: cgi-bin  error\thtml  icons\n[host2] out:\n\n\nDone.\nDisconnecting from host2... done.\nDisconnecting from host1... done.\n```\n\n\n###(4)Per-task, via decorators\n\n可以针对每一个task, 可以使用 hosts 或 roles decorators。\n\n```python\nfrom fabric.api import hosts, run\n\n@hosts('host1', 'host2')\ndef mytask():\n    run('ls /var/www')\n\n```\n\n或者这样定义\n\n```\nmy_hosts = ('host1', 'host2')\n@hosts(my_hosts)\ndef mytask():\n    run('ls /var/www')\n```\n\n##2.2 主机定义的优先顺序\n\n官方说明： [Order of precedence](http://docs.fabfile.org/en/1.9/usage/execution.html#order-of-precedence)\n\n 1. Per-task, command-line host lists (fab mytask:host=host1) override absolutely everything else.\n 2. Per-task, decorator-specified host lists (@hosts('host1')) override the env variables.\n 3. Globally specified host lists set in the fabfile (env.hosts = ['host1']) can override such lists set on the command-line, but only if you’re not careful (or want them to.)\n 4. Globally specified host lists set on the command-line (--hosts=host1) will initialize the env variables, but that’s it.\n\n说明：\n\n 1. Per-task, command-line host lists (fab mytask:host=host1) 会绝对覆盖所有的hosts定义。\n 2. Per-task, decorator-specified host lists (@hosts('host1')) 会覆盖 env 变量(env variables)。\n 3. Globally specified host lists set in the fabfile (env.hosts = ['host1']) 会覆盖command-lin定义的主机列表。\n 4. Globally specified host lists set on the command-line (--hosts=host1) 会初始化env 变量(env variables), 但仅仅如此。\n\n##2.3 测试\n###2.3.1 测试1\n\n```python\nfrom fabric.api import env, hosts, run\n\nenv.hosts = ['host1']\n\ndef mytask():\n    run('ls /var/www')\n```\n\n执行命令：\n\n```\n# fabfile定义的env.hosts会覆盖命令行的定义(-H)\n[root@fabserver fabric]# fab -H host2 mytask\n[host1] Executing task 'mytask'\n[host1] run: ls /var/www\n[host1] out: cgi-bin  error\thtml  icons\n[host1] out:\n\n\nDone.\nDisconnecting from host1... done.\n\n# 命令行task里面的主机定义会覆盖掉\"fabfile定义的env.hosts\"及\"命令行里的定义(-H)\"\n[root@fabserver fabric]# fab -H host2 mytask:hosts=host3\n[host3] Executing task 'mytask'\n[host3] run: ls /var/www\n[host3] out: cgi-bin  error\thtml  icons\n[host3] out:\n\n\nDone.\nDisconnecting from host3... done.\n```\n\n\n###2.3.2 测试2\n\n```\nfrom fabric.api import env, hosts, run\n\nenv.hosts = ['host1']\n\n@hosts('host2')\ndef mytask():\n    run('ls /var/www')\n```\n\n执行命令：\n\n```bash\n# fabfile里面的task hosts定义会覆盖env.hosts定义\n[root@fabserver fabric]# fab mytask\n[host2] Executing task 'mytask'\n[host2] run: ls /var/www\n[host2] out: cgi-bin  error\thtml  icons\n[host2] out:\n\n\nDone.\nDisconnecting from host2... done.\n[root@fabserver fabric]# fab -H 'host3' mytask\n[host2] Executing task 'mytask'\n[host2] run: ls /var/www\n[host2] out: cgi-bin  error\thtml  icons\n[host2] out:\n\n\nDone.\nDisconnecting from host2... done.\n[root@fabserver fabric]# fab -H host3 mytask\n[host2] Executing task 'mytask'\n[host2] run: ls /var/www\n[host2] out: cgi-bin  error\thtml  icons\n[host2] out:\n\n\nDone.\nDisconnecting from host2... done.\n \n# 命令行内的task hosts定义会覆盖所有定义\n[root@fabserver fabric]# fab -H host3 mytask:hosts=\"host1\"\n[host1] Executing task 'mytask'\n[host1] run: ls /var/www\n[host1] out: cgi-bin  error\thtml  icons\n[host1] out:\n\n\nDone.\nDisconnecting from host1... done.\n```\n\n#3. 其它\n\n##3.1 合并主机列表\n```python\nfrom fabric.api import env, hosts, roles, run\n\nenv.roledefs = {'role1': ['host2', 'host3']}\n\n@hosts('host1', 'host2')\n@roles('role1')\ndef mytask():\n    run('ls /var/www')\n\n```\n\n执行mytask时，[host1，host2，host3]都会执行。\n\n```bash\n[root@fabserver fabric]# fab mytask\n[host1] Executing task 'mytask'\n[host1] run: ls /var/www\n[host1] out: cgi-bin  error\thtml  icons\n[host1] out:\n\n[host2] Executing task 'mytask'\n[host2] run: ls /var/www\n[host2] out: cgi-bin  error\thtml  icons\n[host2] out:\n\n[host3] Executing task 'mytask'\n[host3] run: ls /var/www\n[host3] out: cgi-bin  error\thtml  icons\n[host3] out:\n\n\nDone.\nDisconnecting from host2... done.\nDisconnecting from host3... done.\nDisconnecting from host1... done.\n```\n\n##3.2 重复的主机\nfabric会删除重复的host, 所以对于每个task,每个host只会执行一次。\n如果不需要删除重复的主机，请设置 env.dedupe_hosts 为 False.\n\n例如，下面的host2会执行两次\n\n```bash\n[root@fabserver fabric]# cat fabfile.py\nfrom fabric.api import env, hosts, roles, run\n\nenv.roledefs = {'role1': ['host2', 'host3']}\nenv.dedupe_hosts = False\n\n@hosts('host1', 'host2')\n@roles('role1')\ndef mytask():\n    run('ls /var/www')\n\n[root@fabserver fabric]# fab mytask\n[host1] Executing task 'mytask'\n[host1] run: ls /var/www\n[host1] out: cgi-bin  error\thtml  icons\n[host1] out:\n\n[host2] Executing task 'mytask'\n[host2] run: ls /var/www\n[host2] out: cgi-bin  error\thtml  icons\n[host2] out:\n\n[host2] Executing task 'mytask'\n[host2] run: ls /var/www\n[host2] out: cgi-bin  error\thtml  icons\n[host2] out:\n\n[host3] Executing task 'mytask'\n[host3] run: ls /var/www\n[host3] out: cgi-bin  error\thtml  icons\n[host3] out:\n\n\nDone.\nDisconnecting from host2... done.\nDisconnecting from host3... done.\nDisconnecting from host1... done.\n```\n\n##3.3 不包含指定的主机\n在命令行中使用 --exclude-hosts/-x 定义\n\n```bash\n[root@fabserver fabric]# cat fabfile.py\nfrom fabric.api import env, hosts, roles, run\n\nenv.roledefs = {'role1': ['host2', 'host3']}\n\n@hosts('host1', 'host2')\n@roles('role1')\ndef mytask():\n    run('ls /var/www')\n\n#注意，这里声明排除host1是不起作用的\n[root@fabserver fabric]# fab mytask -x host1\n[host1] Executing task 'mytask'\n[host1] run: ls /var/www\n[host1] out: cgi-bin  error\thtml  icons\n[host1] out:\n\n[host2] Executing task 'mytask'\n[host2] run: ls /var/www\n[host2] out: cgi-bin  error\thtml  icons\n[host2] out:\n\n[host3] Executing task 'mytask'\n[host3] run: ls /var/www\n[host3] out: cgi-bin  error\thtml  icons\n[host3] out:\n\n\nDone.\nDisconnecting from host2... done.\nDisconnecting from host3... done.\nDisconnecting from host1... done.\n\n#成功排除host1\n[root@fabserver fabric]# fab mytask:exclude_hosts=\"host1\"\n[host2] Executing task 'mytask'\n[host2] run: ls /var/www\n[host2] out: cgi-bin  error\thtml  icons\n[host2] out:\n\n[host3] Executing task 'mytask'\n[host3] run: ls /var/www\n[host3] out: cgi-bin  error\thtml  icons\n[host3] out:\n\n\nDone.\nDisconnecting from host2... done.\nDisconnecting from host3... done.\n```\n\n注意：\nHost exclusion lists 跟 host lists 一样，是不能在不同的级别(level)合并在一起的。\n\n例如：全局的 -x 选项不会影响到per-task host list 设置的。同样的per-task的exclude_hosts会影响全局的-H 定义的主机列表。\n\n##3.4 使用execute智能执行task\n###3.4.1 智能执行task\n\n```\nfrom fabric.api import env, run, roles, execute\n\nenv.roledefs = {\n    'db': ['host1', 'host2'],\n    'web': ['host3'],\n}\n\n@roles('db')\ndef migrate():\n    # Database stuff here.\n    pass\n\n@roles('web')\ndef update():\n    # Code updates here.\n    pass\n\ndef deploy():\n    execute(migrate)\n    execute(update)\n\n```\n\n执行 $ fab migrate update 和 $ fab deploy 是一样的效果。\n\n```bash\n[root@fabserver fabric]# fab migrate update\n[host1] Executing task 'migrate'\n[host2] Executing task 'migrate'\n[host3] Executing task 'update'\n\nDone.\n[root@fabserver fabric]# fab deploy\n[host1] Executing task 'migrate'\n[host2] Executing task 'migrate'\n[host3] Executing task 'update'\n\nDone.\n```\n\n###3.4.2 动态设置主机列表\n\n```python\nfrom fabric.api import run, execute, task\n\n# For example, code talking to an HTTP API, or a database, or ...\nfrom mylib import external_datastore\n\n# This is the actual algorithm involved. It does not care about host\n# lists at all.\ndef do_work():\n    run(\"something interesting on a host\")\n\n# This is the user-facing task invoked on the command line.\n@task\ndef deploy(lookup_param):\n    # This is the magic you don't get with @hosts or @roles.\n    # Even lazy-loading roles require you to declare available roles\n    # beforehand. Here, the sky is the limit.\n    host_list = external_datastore.query(lookup_param)\n    # Put this dynamically generated host list together with the work to be\n    # done.\n    execute(do_work, hosts=host_list)\n```\n\n发布到app服务主机\n\n\t$ fab deploy:app\n\n发布到db服务主机\n\n\t$ fab deploy:db\n\n","source":"_posts/2014-08-24-learning-fabric2-hosts-and-roles.md","raw":"---\nlayout: post\ntitle: \"Fabric-02 主机(Hosts)和角色(Roles)\"\ndate: 2014-08-24 14:27\ncomments: true\ncategories: fabric\n---\n\n主要内容\n\n```\n#1.定义主机列表\n##1.1 主机\n##1.2 角色\n#2.如何构建主机列表(host lists) ?\n##2.1 四种主机定义方式\n###(1)Globally, via env\n###(2)Globally, via the command line\n###(3)Per-task, via the command line\n###(4)Per-task, via decorators\n##2.2 主机定义的优先顺序\n##2.3 测试\n#3. 其它\n##3.1 合并主机列表\n##3.2 重复的主机\n##3.3 不包含指定的主机\n##3.4 使用execute智能执行task\n```\n<!-- more -->\n\n#1.定义主机列表\n##1.1 主机\n主机的定义格式为: username@hostname:port\n\nusername和port是可选的(关联@和:),默认是本地用户，端口是22.\n\nip6格式同样是支持的。例如::1, [::1]:1222, user@2001:db8::1 or user@[2001:db8::1]:1222\n\n##1.2 角色\n\n有时候我们希望给主机分组，这样我们就能方便的控制它们。\n\n```python\nfrom fabric.api import env\n\nenv.roledefs['webservers'] = ['www1', 'www2', 'www3']\n```\n\n\n```python\nfrom fabric.api import env\n\nenv.roledefs = {\n    'web': ['www1', 'www2', 'www3'],\n    'dns': ['ns1', 'ns2']\n}\n```\n\n角色定义并是可必须的，它只是能让我们方便的管理同样功能的服务器组。\n\n\n\n#2.如何构建主机列表(host lists) ?\n\n##2.1 四种主机定义方式\n\n###(1)Globally, via env\n最常见的方式是通过设置 env: hosts and roles 。\n\nhosts和roles的值会在运行时进行检测，为每个task构造主机列表。\n\n####例子1： fabfile.py\n\n```python\nfrom fabric.api import env, run\n\nenv.hosts = ['host1', 'host2']\n\ndef mytask():\n    run('ls /var/www')\n```\n\n执行结果: \n\n```\n# fab mytask\n[host1] Executing task 'mytask'\n[host1] run: ls /var/www\n[host1] out: cgi-bin  error\thtml  icons\n[host1] out:\n\n[host2] Executing task 'mytask'\n[host2] run: ls /var/www\n[host2] out: cgi-bin  error\thtml  icons\n[host2] out:\n\n\nDone.\nDisconnecting from host2... done.\nDisconnecting from host1... done.\n```\n####例子2： 动态设置env.hosts\n我们可以在task中设置env.hosts, 它会影响接下来执行的tasks\n\n```\nfrom fabric.api import env, run\n\ndef set_hosts():\n    env.hosts = ['host1', 'host2']\n\ndef mytask():\n    run('ls /var/www')\n```\n\n执行命令: \n\t\n\tfab set_hosts mytask\n\n跟例子1是一样的效果。\n\n###(2)Globally, via the command line\n你可在在模块中通过 env.hosts, env.roles, env.exclude_hosts 来定义主机，也可以通过命令行参数 [hosts/-H](http://docs.fabfile.org/en/1.9/usage/fab.html#cmdoption-H) 和 [--roles/-R](http://docs.fabfile.org/en/1.9/usage/fab.html#cmdoption-R) 来定义主机。\n\n例如: \n\n\t$ fab -H host1,host2 mytask\n\n\n非常重要的一点是：\n>命令行参数会在fabfile文件载入方前被解释，所以fabfile文件中定义的env.hosts or env.roles会覆盖命令行参数。\n>如果你想合并它们,让在fabfile中使用 env.hosts.extend() 代替。\n\n```python\nfrom fabric.api import env, run\n\nenv.hosts.extend(['host3', 'host4'])\n\ndef mytask():\n    run('ls /var/www')\n```\n\n执行： fab -H host1,host2 mytask, 主机会包括： ['host1', 'host2', 'host3', 'host4']\n\n###(3)Per-task, via the command line\n对每个task, 使用命令行定义hosts。\n\n```\nfrom fabric.api import run\n\ndef mytask():\n    run('ls /var/www')\n```\n\n为mytask定义主机\n\n\t$ fab mytask:hosts=\"host1;host2\"\n\n这个会覆盖所有的主机列表，mytask只会在host1;host2中执行。\n\n```bash\n$ cat fabfile.py\nfrom fabric.api import env, run\n\ndef mytask():\n    run('ls /var/www')\n\n$ fab mytask:hosts=\"host1;host2\"\n[host1] Executing task 'mytask'\n[host1] run: ls /var/www\n[host1] out: cgi-bin  error\thtml  icons\n[host1] out:\n\n[host2] Executing task 'mytask'\n[host2] run: ls /var/www\n[host2] out: cgi-bin  error\thtml  icons\n[host2] out:\n\n\nDone.\nDisconnecting from host2... done.\nDisconnecting from host1... done.\n```\n\n\n###(4)Per-task, via decorators\n\n可以针对每一个task, 可以使用 hosts 或 roles decorators。\n\n```python\nfrom fabric.api import hosts, run\n\n@hosts('host1', 'host2')\ndef mytask():\n    run('ls /var/www')\n\n```\n\n或者这样定义\n\n```\nmy_hosts = ('host1', 'host2')\n@hosts(my_hosts)\ndef mytask():\n    run('ls /var/www')\n```\n\n##2.2 主机定义的优先顺序\n\n官方说明： [Order of precedence](http://docs.fabfile.org/en/1.9/usage/execution.html#order-of-precedence)\n\n 1. Per-task, command-line host lists (fab mytask:host=host1) override absolutely everything else.\n 2. Per-task, decorator-specified host lists (@hosts('host1')) override the env variables.\n 3. Globally specified host lists set in the fabfile (env.hosts = ['host1']) can override such lists set on the command-line, but only if you’re not careful (or want them to.)\n 4. Globally specified host lists set on the command-line (--hosts=host1) will initialize the env variables, but that’s it.\n\n说明：\n\n 1. Per-task, command-line host lists (fab mytask:host=host1) 会绝对覆盖所有的hosts定义。\n 2. Per-task, decorator-specified host lists (@hosts('host1')) 会覆盖 env 变量(env variables)。\n 3. Globally specified host lists set in the fabfile (env.hosts = ['host1']) 会覆盖command-lin定义的主机列表。\n 4. Globally specified host lists set on the command-line (--hosts=host1) 会初始化env 变量(env variables), 但仅仅如此。\n\n##2.3 测试\n###2.3.1 测试1\n\n```python\nfrom fabric.api import env, hosts, run\n\nenv.hosts = ['host1']\n\ndef mytask():\n    run('ls /var/www')\n```\n\n执行命令：\n\n```\n# fabfile定义的env.hosts会覆盖命令行的定义(-H)\n[root@fabserver fabric]# fab -H host2 mytask\n[host1] Executing task 'mytask'\n[host1] run: ls /var/www\n[host1] out: cgi-bin  error\thtml  icons\n[host1] out:\n\n\nDone.\nDisconnecting from host1... done.\n\n# 命令行task里面的主机定义会覆盖掉\"fabfile定义的env.hosts\"及\"命令行里的定义(-H)\"\n[root@fabserver fabric]# fab -H host2 mytask:hosts=host3\n[host3] Executing task 'mytask'\n[host3] run: ls /var/www\n[host3] out: cgi-bin  error\thtml  icons\n[host3] out:\n\n\nDone.\nDisconnecting from host3... done.\n```\n\n\n###2.3.2 测试2\n\n```\nfrom fabric.api import env, hosts, run\n\nenv.hosts = ['host1']\n\n@hosts('host2')\ndef mytask():\n    run('ls /var/www')\n```\n\n执行命令：\n\n```bash\n# fabfile里面的task hosts定义会覆盖env.hosts定义\n[root@fabserver fabric]# fab mytask\n[host2] Executing task 'mytask'\n[host2] run: ls /var/www\n[host2] out: cgi-bin  error\thtml  icons\n[host2] out:\n\n\nDone.\nDisconnecting from host2... done.\n[root@fabserver fabric]# fab -H 'host3' mytask\n[host2] Executing task 'mytask'\n[host2] run: ls /var/www\n[host2] out: cgi-bin  error\thtml  icons\n[host2] out:\n\n\nDone.\nDisconnecting from host2... done.\n[root@fabserver fabric]# fab -H host3 mytask\n[host2] Executing task 'mytask'\n[host2] run: ls /var/www\n[host2] out: cgi-bin  error\thtml  icons\n[host2] out:\n\n\nDone.\nDisconnecting from host2... done.\n \n# 命令行内的task hosts定义会覆盖所有定义\n[root@fabserver fabric]# fab -H host3 mytask:hosts=\"host1\"\n[host1] Executing task 'mytask'\n[host1] run: ls /var/www\n[host1] out: cgi-bin  error\thtml  icons\n[host1] out:\n\n\nDone.\nDisconnecting from host1... done.\n```\n\n#3. 其它\n\n##3.1 合并主机列表\n```python\nfrom fabric.api import env, hosts, roles, run\n\nenv.roledefs = {'role1': ['host2', 'host3']}\n\n@hosts('host1', 'host2')\n@roles('role1')\ndef mytask():\n    run('ls /var/www')\n\n```\n\n执行mytask时，[host1，host2，host3]都会执行。\n\n```bash\n[root@fabserver fabric]# fab mytask\n[host1] Executing task 'mytask'\n[host1] run: ls /var/www\n[host1] out: cgi-bin  error\thtml  icons\n[host1] out:\n\n[host2] Executing task 'mytask'\n[host2] run: ls /var/www\n[host2] out: cgi-bin  error\thtml  icons\n[host2] out:\n\n[host3] Executing task 'mytask'\n[host3] run: ls /var/www\n[host3] out: cgi-bin  error\thtml  icons\n[host3] out:\n\n\nDone.\nDisconnecting from host2... done.\nDisconnecting from host3... done.\nDisconnecting from host1... done.\n```\n\n##3.2 重复的主机\nfabric会删除重复的host, 所以对于每个task,每个host只会执行一次。\n如果不需要删除重复的主机，请设置 env.dedupe_hosts 为 False.\n\n例如，下面的host2会执行两次\n\n```bash\n[root@fabserver fabric]# cat fabfile.py\nfrom fabric.api import env, hosts, roles, run\n\nenv.roledefs = {'role1': ['host2', 'host3']}\nenv.dedupe_hosts = False\n\n@hosts('host1', 'host2')\n@roles('role1')\ndef mytask():\n    run('ls /var/www')\n\n[root@fabserver fabric]# fab mytask\n[host1] Executing task 'mytask'\n[host1] run: ls /var/www\n[host1] out: cgi-bin  error\thtml  icons\n[host1] out:\n\n[host2] Executing task 'mytask'\n[host2] run: ls /var/www\n[host2] out: cgi-bin  error\thtml  icons\n[host2] out:\n\n[host2] Executing task 'mytask'\n[host2] run: ls /var/www\n[host2] out: cgi-bin  error\thtml  icons\n[host2] out:\n\n[host3] Executing task 'mytask'\n[host3] run: ls /var/www\n[host3] out: cgi-bin  error\thtml  icons\n[host3] out:\n\n\nDone.\nDisconnecting from host2... done.\nDisconnecting from host3... done.\nDisconnecting from host1... done.\n```\n\n##3.3 不包含指定的主机\n在命令行中使用 --exclude-hosts/-x 定义\n\n```bash\n[root@fabserver fabric]# cat fabfile.py\nfrom fabric.api import env, hosts, roles, run\n\nenv.roledefs = {'role1': ['host2', 'host3']}\n\n@hosts('host1', 'host2')\n@roles('role1')\ndef mytask():\n    run('ls /var/www')\n\n#注意，这里声明排除host1是不起作用的\n[root@fabserver fabric]# fab mytask -x host1\n[host1] Executing task 'mytask'\n[host1] run: ls /var/www\n[host1] out: cgi-bin  error\thtml  icons\n[host1] out:\n\n[host2] Executing task 'mytask'\n[host2] run: ls /var/www\n[host2] out: cgi-bin  error\thtml  icons\n[host2] out:\n\n[host3] Executing task 'mytask'\n[host3] run: ls /var/www\n[host3] out: cgi-bin  error\thtml  icons\n[host3] out:\n\n\nDone.\nDisconnecting from host2... done.\nDisconnecting from host3... done.\nDisconnecting from host1... done.\n\n#成功排除host1\n[root@fabserver fabric]# fab mytask:exclude_hosts=\"host1\"\n[host2] Executing task 'mytask'\n[host2] run: ls /var/www\n[host2] out: cgi-bin  error\thtml  icons\n[host2] out:\n\n[host3] Executing task 'mytask'\n[host3] run: ls /var/www\n[host3] out: cgi-bin  error\thtml  icons\n[host3] out:\n\n\nDone.\nDisconnecting from host2... done.\nDisconnecting from host3... done.\n```\n\n注意：\nHost exclusion lists 跟 host lists 一样，是不能在不同的级别(level)合并在一起的。\n\n例如：全局的 -x 选项不会影响到per-task host list 设置的。同样的per-task的exclude_hosts会影响全局的-H 定义的主机列表。\n\n##3.4 使用execute智能执行task\n###3.4.1 智能执行task\n\n```\nfrom fabric.api import env, run, roles, execute\n\nenv.roledefs = {\n    'db': ['host1', 'host2'],\n    'web': ['host3'],\n}\n\n@roles('db')\ndef migrate():\n    # Database stuff here.\n    pass\n\n@roles('web')\ndef update():\n    # Code updates here.\n    pass\n\ndef deploy():\n    execute(migrate)\n    execute(update)\n\n```\n\n执行 $ fab migrate update 和 $ fab deploy 是一样的效果。\n\n```bash\n[root@fabserver fabric]# fab migrate update\n[host1] Executing task 'migrate'\n[host2] Executing task 'migrate'\n[host3] Executing task 'update'\n\nDone.\n[root@fabserver fabric]# fab deploy\n[host1] Executing task 'migrate'\n[host2] Executing task 'migrate'\n[host3] Executing task 'update'\n\nDone.\n```\n\n###3.4.2 动态设置主机列表\n\n```python\nfrom fabric.api import run, execute, task\n\n# For example, code talking to an HTTP API, or a database, or ...\nfrom mylib import external_datastore\n\n# This is the actual algorithm involved. It does not care about host\n# lists at all.\ndef do_work():\n    run(\"something interesting on a host\")\n\n# This is the user-facing task invoked on the command line.\n@task\ndef deploy(lookup_param):\n    # This is the magic you don't get with @hosts or @roles.\n    # Even lazy-loading roles require you to declare available roles\n    # beforehand. Here, the sky is the limit.\n    host_list = external_datastore.query(lookup_param)\n    # Put this dynamically generated host list together with the work to be\n    # done.\n    execute(do_work, hosts=host_list)\n```\n\n发布到app服务主机\n\n\t$ fab deploy:app\n\n发布到db服务主机\n\n\t$ fab deploy:db\n\n","slug":"learning-fabric2-hosts-and-roles","published":1,"updated":"2017-01-27T02:04:50.000Z","photos":[],"link":"","_id":"ciyf7fkcg001ef2jyci95xr8y","content":"<p>主要内容</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\">#1.定义主机列表</div><div class=\"line\">##1.1 主机</div><div class=\"line\">##1.2 角色</div><div class=\"line\">#2.如何构建主机列表(host lists) ?</div><div class=\"line\">##2.1 四种主机定义方式</div><div class=\"line\">###(1)Globally, via env</div><div class=\"line\">###(2)Globally, via the command line</div><div class=\"line\">###(3)Per-task, via the command line</div><div class=\"line\">###(4)Per-task, via decorators</div><div class=\"line\">##2.2 主机定义的优先顺序</div><div class=\"line\">##2.3 测试</div><div class=\"line\">#3. 其它</div><div class=\"line\">##3.1 合并主机列表</div><div class=\"line\">##3.2 重复的主机</div><div class=\"line\">##3.3 不包含指定的主机</div><div class=\"line\">##3.4 使用execute智能执行task</div></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<p>#1.定义主机列表</p>\n<p>##1.1 主机<br>主机的定义格式为: username@hostname:port</p>\n<p>username和port是可选的(关联@和:),默认是本地用户，端口是22.</p>\n<p>ip6格式同样是支持的。例如::1, [::1]:1222, user@2001:db8::1 or user@[2001:db8::1]:1222</p>\n<p>##1.2 角色</p>\n<p>有时候我们希望给主机分组，这样我们就能方便的控制它们。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">from</span> fabric.api <span class=\"keyword\">import</span> env</div><div class=\"line\"></div><div class=\"line\">env.roledefs[<span class=\"string\">'webservers'</span>] = [<span class=\"string\">'www1'</span>, <span class=\"string\">'www2'</span>, <span class=\"string\">'www3'</span>]</div></pre></td></tr></table></figure>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">from</span> fabric.api <span class=\"keyword\">import</span> env</div><div class=\"line\"></div><div class=\"line\">env.roledefs = &#123;</div><div class=\"line\">    <span class=\"string\">'web'</span>: [<span class=\"string\">'www1'</span>, <span class=\"string\">'www2'</span>, <span class=\"string\">'www3'</span>],</div><div class=\"line\">    <span class=\"string\">'dns'</span>: [<span class=\"string\">'ns1'</span>, <span class=\"string\">'ns2'</span>]</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>角色定义并是可必须的，它只是能让我们方便的管理同样功能的服务器组。</p>\n<p>#2.如何构建主机列表(host lists) ?</p>\n<p>##2.1 四种主机定义方式</p>\n<p>###(1)Globally, via env<br>最常见的方式是通过设置 env: hosts and roles 。</p>\n<p>hosts和roles的值会在运行时进行检测，为每个task构造主机列表。</p>\n<p>####例子1： fabfile.py</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">from</span> fabric.api <span class=\"keyword\">import</span> env, run</div><div class=\"line\"></div><div class=\"line\">env.hosts = [<span class=\"string\">'host1'</span>, <span class=\"string\">'host2'</span>]</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">mytask</span><span class=\"params\">()</span>:</span></div><div class=\"line\">    run(<span class=\"string\">'ls /var/www'</span>)</div></pre></td></tr></table></figure>\n<p>执行结果: </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\"># fab mytask</div><div class=\"line\">[host1] Executing task &apos;mytask&apos;</div><div class=\"line\">[host1] run: ls /var/www</div><div class=\"line\">[host1] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host1] out:</div><div class=\"line\"></div><div class=\"line\">[host2] Executing task &apos;mytask&apos;</div><div class=\"line\">[host2] run: ls /var/www</div><div class=\"line\">[host2] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host2] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host2... done.</div><div class=\"line\">Disconnecting from host1... done.</div></pre></td></tr></table></figure>\n<p>####例子2： 动态设置env.hosts<br>我们可以在task中设置env.hosts, 它会影响接下来执行的tasks</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">from fabric.api import env, run</div><div class=\"line\"></div><div class=\"line\">def set_hosts():</div><div class=\"line\">    env.hosts = [&apos;host1&apos;, &apos;host2&apos;]</div><div class=\"line\"></div><div class=\"line\">def mytask():</div><div class=\"line\">    run(&apos;ls /var/www&apos;)</div></pre></td></tr></table></figure>\n<p>执行命令: </p>\n<pre><code>fab set_hosts mytask\n</code></pre><p>跟例子1是一样的效果。</p>\n<p>###(2)Globally, via the command line<br>你可在在模块中通过 env.hosts, env.roles, env.exclude_hosts 来定义主机，也可以通过命令行参数 <a href=\"http://docs.fabfile.org/en/1.9/usage/fab.html#cmdoption-H\" target=\"_blank\" rel=\"external\">hosts/-H</a> 和 <a href=\"http://docs.fabfile.org/en/1.9/usage/fab.html#cmdoption-R\" target=\"_blank\" rel=\"external\">–roles/-R</a> 来定义主机。</p>\n<p>例如: </p>\n<pre><code>$ fab -H host1,host2 mytask\n</code></pre><p>非常重要的一点是：</p>\n<blockquote>\n<p>命令行参数会在fabfile文件载入方前被解释，所以fabfile文件中定义的env.hosts or env.roles会覆盖命令行参数。<br>如果你想合并它们,让在fabfile中使用 env.hosts.extend() 代替。</p>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">from</span> fabric.api <span class=\"keyword\">import</span> env, run</div><div class=\"line\"></div><div class=\"line\">env.hosts.extend([<span class=\"string\">'host3'</span>, <span class=\"string\">'host4'</span>])</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">mytask</span><span class=\"params\">()</span>:</span></div><div class=\"line\">    run(<span class=\"string\">'ls /var/www'</span>)</div></pre></td></tr></table></figure>\n<p>执行： fab -H host1,host2 mytask, 主机会包括： [‘host1’, ‘host2’, ‘host3’, ‘host4’]</p>\n<p>###(3)Per-task, via the command line<br>对每个task, 使用命令行定义hosts。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">from fabric.api import run</div><div class=\"line\"></div><div class=\"line\">def mytask():</div><div class=\"line\">    run(&apos;ls /var/www&apos;)</div></pre></td></tr></table></figure>\n<p>为mytask定义主机</p>\n<pre><code>$ fab mytask:hosts=&quot;host1;host2&quot;\n</code></pre><p>这个会覆盖所有的主机列表，mytask只会在host1;host2中执行。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ cat fabfile.py</div><div class=\"line\">from fabric.api import env, run</div><div class=\"line\"></div><div class=\"line\">def mytask():</div><div class=\"line\">    run(<span class=\"string\">'ls /var/www'</span>)</div><div class=\"line\"></div><div class=\"line\">$ fab mytask:hosts=<span class=\"string\">\"host1;host2\"</span></div><div class=\"line\">[host1] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host1] run: ls /var/www</div><div class=\"line\">[host1] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host1] out:</div><div class=\"line\"></div><div class=\"line\">[host2] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host2] run: ls /var/www</div><div class=\"line\">[host2] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host2] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host2... done.</div><div class=\"line\">Disconnecting from host1... done.</div></pre></td></tr></table></figure>\n<p>###(4)Per-task, via decorators</p>\n<p>可以针对每一个task, 可以使用 hosts 或 roles decorators。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">from</span> fabric.api <span class=\"keyword\">import</span> hosts, run</div><div class=\"line\"></div><div class=\"line\"><span class=\"meta\">@hosts('host1', 'host2')</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">mytask</span><span class=\"params\">()</span>:</span></div><div class=\"line\">    run(<span class=\"string\">'ls /var/www'</span>)</div></pre></td></tr></table></figure>\n<p>或者这样定义</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">my_hosts = (&apos;host1&apos;, &apos;host2&apos;)</div><div class=\"line\">@hosts(my_hosts)</div><div class=\"line\">def mytask():</div><div class=\"line\">    run(&apos;ls /var/www&apos;)</div></pre></td></tr></table></figure>\n<p>##2.2 主机定义的优先顺序</p>\n<p>官方说明： <a href=\"http://docs.fabfile.org/en/1.9/usage/execution.html#order-of-precedence\" target=\"_blank\" rel=\"external\">Order of precedence</a></p>\n<ol>\n<li>Per-task, command-line host lists (fab mytask:host=host1) override absolutely everything else.</li>\n<li>Per-task, decorator-specified host lists (@hosts(‘host1’)) override the env variables.</li>\n<li>Globally specified host lists set in the fabfile (env.hosts = [‘host1’]) can override such lists set on the command-line, but only if you’re not careful (or want them to.)</li>\n<li>Globally specified host lists set on the command-line (–hosts=host1) will initialize the env variables, but that’s it.</li>\n</ol>\n<p>说明：</p>\n<ol>\n<li>Per-task, command-line host lists (fab mytask:host=host1) 会绝对覆盖所有的hosts定义。</li>\n<li>Per-task, decorator-specified host lists (@hosts(‘host1’)) 会覆盖 env 变量(env variables)。</li>\n<li>Globally specified host lists set in the fabfile (env.hosts = [‘host1’]) 会覆盖command-lin定义的主机列表。</li>\n<li>Globally specified host lists set on the command-line (–hosts=host1) 会初始化env 变量(env variables), 但仅仅如此。</li>\n</ol>\n<p>##2.3 测试</p>\n<p>###2.3.1 测试1</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">from</span> fabric.api <span class=\"keyword\">import</span> env, hosts, run</div><div class=\"line\"></div><div class=\"line\">env.hosts = [<span class=\"string\">'host1'</span>]</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">mytask</span><span class=\"params\">()</span>:</span></div><div class=\"line\">    run(<span class=\"string\">'ls /var/www'</span>)</div></pre></td></tr></table></figure>\n<p>执行命令：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\"># fabfile定义的env.hosts会覆盖命令行的定义(-H)</div><div class=\"line\">[root@fabserver fabric]# fab -H host2 mytask</div><div class=\"line\">[host1] Executing task &apos;mytask&apos;</div><div class=\"line\">[host1] run: ls /var/www</div><div class=\"line\">[host1] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host1] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host1... done.</div><div class=\"line\"></div><div class=\"line\"># 命令行task里面的主机定义会覆盖掉&quot;fabfile定义的env.hosts&quot;及&quot;命令行里的定义(-H)&quot;</div><div class=\"line\">[root@fabserver fabric]# fab -H host2 mytask:hosts=host3</div><div class=\"line\">[host3] Executing task &apos;mytask&apos;</div><div class=\"line\">[host3] run: ls /var/www</div><div class=\"line\">[host3] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host3] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host3... done.</div></pre></td></tr></table></figure>\n<p>###2.3.2 测试2</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">from fabric.api import env, hosts, run</div><div class=\"line\"></div><div class=\"line\">env.hosts = [&apos;host1&apos;]</div><div class=\"line\"></div><div class=\"line\">@hosts(&apos;host2&apos;)</div><div class=\"line\">def mytask():</div><div class=\"line\">    run(&apos;ls /var/www&apos;)</div></pre></td></tr></table></figure>\n<p>执行命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># fabfile里面的task hosts定义会覆盖env.hosts定义</span></div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab mytask</span></div><div class=\"line\">[host2] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host2] run: ls /var/www</div><div class=\"line\">[host2] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host2] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host2... done.</div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab -H 'host3' mytask</span></div><div class=\"line\">[host2] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host2] run: ls /var/www</div><div class=\"line\">[host2] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host2] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host2... done.</div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab -H host3 mytask</span></div><div class=\"line\">[host2] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host2] run: ls /var/www</div><div class=\"line\">[host2] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host2] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host2... done.</div><div class=\"line\"> </div><div class=\"line\"><span class=\"comment\"># 命令行内的task hosts定义会覆盖所有定义</span></div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab -H host3 mytask:hosts=\"host1\"</span></div><div class=\"line\">[host1] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host1] run: ls /var/www</div><div class=\"line\">[host1] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host1] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host1... done.</div></pre></td></tr></table></figure>\n<p>#3. 其它</p>\n<p>##3.1 合并主机列表<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">from</span> fabric.api <span class=\"keyword\">import</span> env, hosts, roles, run</div><div class=\"line\"></div><div class=\"line\">env.roledefs = &#123;<span class=\"string\">'role1'</span>: [<span class=\"string\">'host2'</span>, <span class=\"string\">'host3'</span>]&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"meta\">@hosts('host1', 'host2')</span></div><div class=\"line\"><span class=\"meta\">@roles('role1')</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">mytask</span><span class=\"params\">()</span>:</span></div><div class=\"line\">    run(<span class=\"string\">'ls /var/www'</span>)</div></pre></td></tr></table></figure></p>\n<p>执行mytask时，[host1，host2，host3]都会执行。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab mytask</span></div><div class=\"line\">[host1] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host1] run: ls /var/www</div><div class=\"line\">[host1] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host1] out:</div><div class=\"line\"></div><div class=\"line\">[host2] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host2] run: ls /var/www</div><div class=\"line\">[host2] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host2] out:</div><div class=\"line\"></div><div class=\"line\">[host3] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host3] run: ls /var/www</div><div class=\"line\">[host3] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host3] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host2... done.</div><div class=\"line\">Disconnecting from host3... done.</div><div class=\"line\">Disconnecting from host1... done.</div></pre></td></tr></table></figure>\n<p>##3.2 重复的主机<br>fabric会删除重复的host, 所以对于每个task,每个host只会执行一次。<br>如果不需要删除重复的主机，请设置 env.dedupe_hosts 为 False.</p>\n<p>例如，下面的host2会执行两次</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># cat fabfile.py</span></div><div class=\"line\">from fabric.api import env, hosts, roles, run</div><div class=\"line\"></div><div class=\"line\">env.roledefs = &#123;<span class=\"string\">'role1'</span>: [<span class=\"string\">'host2'</span>, <span class=\"string\">'host3'</span>]&#125;</div><div class=\"line\">env.dedupe_hosts = False</div><div class=\"line\"></div><div class=\"line\">@hosts(<span class=\"string\">'host1'</span>, <span class=\"string\">'host2'</span>)</div><div class=\"line\">@roles(<span class=\"string\">'role1'</span>)</div><div class=\"line\">def mytask():</div><div class=\"line\">    run(<span class=\"string\">'ls /var/www'</span>)</div><div class=\"line\"></div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab mytask</span></div><div class=\"line\">[host1] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host1] run: ls /var/www</div><div class=\"line\">[host1] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host1] out:</div><div class=\"line\"></div><div class=\"line\">[host2] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host2] run: ls /var/www</div><div class=\"line\">[host2] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host2] out:</div><div class=\"line\"></div><div class=\"line\">[host2] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host2] run: ls /var/www</div><div class=\"line\">[host2] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host2] out:</div><div class=\"line\"></div><div class=\"line\">[host3] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host3] run: ls /var/www</div><div class=\"line\">[host3] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host3] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host2... done.</div><div class=\"line\">Disconnecting from host3... done.</div><div class=\"line\">Disconnecting from host1... done.</div></pre></td></tr></table></figure>\n<p>##3.3 不包含指定的主机<br>在命令行中使用 –exclude-hosts/-x 定义</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># cat fabfile.py</span></div><div class=\"line\">from fabric.api import env, hosts, roles, run</div><div class=\"line\"></div><div class=\"line\">env.roledefs = &#123;<span class=\"string\">'role1'</span>: [<span class=\"string\">'host2'</span>, <span class=\"string\">'host3'</span>]&#125;</div><div class=\"line\"></div><div class=\"line\">@hosts(<span class=\"string\">'host1'</span>, <span class=\"string\">'host2'</span>)</div><div class=\"line\">@roles(<span class=\"string\">'role1'</span>)</div><div class=\"line\">def mytask():</div><div class=\"line\">    run(<span class=\"string\">'ls /var/www'</span>)</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#注意，这里声明排除host1是不起作用的</span></div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab mytask -x host1</span></div><div class=\"line\">[host1] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host1] run: ls /var/www</div><div class=\"line\">[host1] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host1] out:</div><div class=\"line\"></div><div class=\"line\">[host2] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host2] run: ls /var/www</div><div class=\"line\">[host2] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host2] out:</div><div class=\"line\"></div><div class=\"line\">[host3] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host3] run: ls /var/www</div><div class=\"line\">[host3] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host3] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host2... done.</div><div class=\"line\">Disconnecting from host3... done.</div><div class=\"line\">Disconnecting from host1... done.</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#成功排除host1</span></div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab mytask:exclude_hosts=\"host1\"</span></div><div class=\"line\">[host2] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host2] run: ls /var/www</div><div class=\"line\">[host2] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host2] out:</div><div class=\"line\"></div><div class=\"line\">[host3] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host3] run: ls /var/www</div><div class=\"line\">[host3] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host3] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host2... done.</div><div class=\"line\">Disconnecting from host3... done.</div></pre></td></tr></table></figure>\n<p>注意：<br>Host exclusion lists 跟 host lists 一样，是不能在不同的级别(level)合并在一起的。</p>\n<p>例如：全局的 -x 选项不会影响到per-task host list 设置的。同样的per-task的exclude_hosts会影响全局的-H 定义的主机列表。</p>\n<p>##3.4 使用execute智能执行task</p>\n<p>###3.4.1 智能执行task</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\">from fabric.api import env, run, roles, execute</div><div class=\"line\"></div><div class=\"line\">env.roledefs = &#123;</div><div class=\"line\">    &apos;db&apos;: [&apos;host1&apos;, &apos;host2&apos;],</div><div class=\"line\">    &apos;web&apos;: [&apos;host3&apos;],</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">@roles(&apos;db&apos;)</div><div class=\"line\">def migrate():</div><div class=\"line\">    # Database stuff here.</div><div class=\"line\">    pass</div><div class=\"line\"></div><div class=\"line\">@roles(&apos;web&apos;)</div><div class=\"line\">def update():</div><div class=\"line\">    # Code updates here.</div><div class=\"line\">    pass</div><div class=\"line\"></div><div class=\"line\">def deploy():</div><div class=\"line\">    execute(migrate)</div><div class=\"line\">    execute(update)</div></pre></td></tr></table></figure>\n<p>执行 $ fab migrate update 和 $ fab deploy 是一样的效果。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab migrate update</span></div><div class=\"line\">[host1] Executing task <span class=\"string\">'migrate'</span></div><div class=\"line\">[host2] Executing task <span class=\"string\">'migrate'</span></div><div class=\"line\">[host3] Executing task <span class=\"string\">'update'</span></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab deploy</span></div><div class=\"line\">[host1] Executing task <span class=\"string\">'migrate'</span></div><div class=\"line\">[host2] Executing task <span class=\"string\">'migrate'</span></div><div class=\"line\">[host3] Executing task <span class=\"string\">'update'</span></div><div class=\"line\"></div><div class=\"line\">Done.</div></pre></td></tr></table></figure>\n<p>###3.4.2 动态设置主机列表</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">from</span> fabric.api <span class=\"keyword\">import</span> run, execute, task</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># For example, code talking to an HTTP API, or a database, or ...</span></div><div class=\"line\"><span class=\"keyword\">from</span> mylib <span class=\"keyword\">import</span> external_datastore</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># This is the actual algorithm involved. It does not care about host</span></div><div class=\"line\"><span class=\"comment\"># lists at all.</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">do_work</span><span class=\"params\">()</span>:</span></div><div class=\"line\">    run(<span class=\"string\">\"something interesting on a host\"</span>)</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># This is the user-facing task invoked on the command line.</span></div><div class=\"line\"><span class=\"meta\">@task</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">deploy</span><span class=\"params\">(lookup_param)</span>:</span></div><div class=\"line\">    <span class=\"comment\"># This is the magic you don't get with @hosts or @roles.</span></div><div class=\"line\">    <span class=\"comment\"># Even lazy-loading roles require you to declare available roles</span></div><div class=\"line\">    <span class=\"comment\"># beforehand. Here, the sky is the limit.</span></div><div class=\"line\">    host_list = external_datastore.query(lookup_param)</div><div class=\"line\">    <span class=\"comment\"># Put this dynamically generated host list together with the work to be</span></div><div class=\"line\">    <span class=\"comment\"># done.</span></div><div class=\"line\">    execute(do_work, hosts=host_list)</div></pre></td></tr></table></figure>\n<p>发布到app服务主机</p>\n<pre><code>$ fab deploy:app\n</code></pre><p>发布到db服务主机</p>\n<pre><code>$ fab deploy:db\n</code></pre>","excerpt":"<p>主要内容</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\">#1.定义主机列表</div><div class=\"line\">##1.1 主机</div><div class=\"line\">##1.2 角色</div><div class=\"line\">#2.如何构建主机列表(host lists) ?</div><div class=\"line\">##2.1 四种主机定义方式</div><div class=\"line\">###(1)Globally, via env</div><div class=\"line\">###(2)Globally, via the command line</div><div class=\"line\">###(3)Per-task, via the command line</div><div class=\"line\">###(4)Per-task, via decorators</div><div class=\"line\">##2.2 主机定义的优先顺序</div><div class=\"line\">##2.3 测试</div><div class=\"line\">#3. 其它</div><div class=\"line\">##3.1 合并主机列表</div><div class=\"line\">##3.2 重复的主机</div><div class=\"line\">##3.3 不包含指定的主机</div><div class=\"line\">##3.4 使用execute智能执行task</div></pre></td></tr></table></figure>","more":"<p>#1.定义主机列表</p>\n<p>##1.1 主机<br>主机的定义格式为: username@hostname:port</p>\n<p>username和port是可选的(关联@和:),默认是本地用户，端口是22.</p>\n<p>ip6格式同样是支持的。例如::1, [::1]:1222, user@2001:db8::1 or user@[2001:db8::1]:1222</p>\n<p>##1.2 角色</p>\n<p>有时候我们希望给主机分组，这样我们就能方便的控制它们。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">from</span> fabric.api <span class=\"keyword\">import</span> env</div><div class=\"line\"></div><div class=\"line\">env.roledefs[<span class=\"string\">'webservers'</span>] = [<span class=\"string\">'www1'</span>, <span class=\"string\">'www2'</span>, <span class=\"string\">'www3'</span>]</div></pre></td></tr></table></figure>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">from</span> fabric.api <span class=\"keyword\">import</span> env</div><div class=\"line\"></div><div class=\"line\">env.roledefs = &#123;</div><div class=\"line\">    <span class=\"string\">'web'</span>: [<span class=\"string\">'www1'</span>, <span class=\"string\">'www2'</span>, <span class=\"string\">'www3'</span>],</div><div class=\"line\">    <span class=\"string\">'dns'</span>: [<span class=\"string\">'ns1'</span>, <span class=\"string\">'ns2'</span>]</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>角色定义并是可必须的，它只是能让我们方便的管理同样功能的服务器组。</p>\n<p>#2.如何构建主机列表(host lists) ?</p>\n<p>##2.1 四种主机定义方式</p>\n<p>###(1)Globally, via env<br>最常见的方式是通过设置 env: hosts and roles 。</p>\n<p>hosts和roles的值会在运行时进行检测，为每个task构造主机列表。</p>\n<p>####例子1： fabfile.py</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">from</span> fabric.api <span class=\"keyword\">import</span> env, run</div><div class=\"line\"></div><div class=\"line\">env.hosts = [<span class=\"string\">'host1'</span>, <span class=\"string\">'host2'</span>]</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">mytask</span><span class=\"params\">()</span>:</span></div><div class=\"line\">    run(<span class=\"string\">'ls /var/www'</span>)</div></pre></td></tr></table></figure>\n<p>执行结果: </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\"># fab mytask</div><div class=\"line\">[host1] Executing task &apos;mytask&apos;</div><div class=\"line\">[host1] run: ls /var/www</div><div class=\"line\">[host1] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host1] out:</div><div class=\"line\"></div><div class=\"line\">[host2] Executing task &apos;mytask&apos;</div><div class=\"line\">[host2] run: ls /var/www</div><div class=\"line\">[host2] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host2] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host2... done.</div><div class=\"line\">Disconnecting from host1... done.</div></pre></td></tr></table></figure>\n<p>####例子2： 动态设置env.hosts<br>我们可以在task中设置env.hosts, 它会影响接下来执行的tasks</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">from fabric.api import env, run</div><div class=\"line\"></div><div class=\"line\">def set_hosts():</div><div class=\"line\">    env.hosts = [&apos;host1&apos;, &apos;host2&apos;]</div><div class=\"line\"></div><div class=\"line\">def mytask():</div><div class=\"line\">    run(&apos;ls /var/www&apos;)</div></pre></td></tr></table></figure>\n<p>执行命令: </p>\n<pre><code>fab set_hosts mytask\n</code></pre><p>跟例子1是一样的效果。</p>\n<p>###(2)Globally, via the command line<br>你可在在模块中通过 env.hosts, env.roles, env.exclude_hosts 来定义主机，也可以通过命令行参数 <a href=\"http://docs.fabfile.org/en/1.9/usage/fab.html#cmdoption-H\">hosts/-H</a> 和 <a href=\"http://docs.fabfile.org/en/1.9/usage/fab.html#cmdoption-R\">–roles/-R</a> 来定义主机。</p>\n<p>例如: </p>\n<pre><code>$ fab -H host1,host2 mytask\n</code></pre><p>非常重要的一点是：</p>\n<blockquote>\n<p>命令行参数会在fabfile文件载入方前被解释，所以fabfile文件中定义的env.hosts or env.roles会覆盖命令行参数。<br>如果你想合并它们,让在fabfile中使用 env.hosts.extend() 代替。</p>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">from</span> fabric.api <span class=\"keyword\">import</span> env, run</div><div class=\"line\"></div><div class=\"line\">env.hosts.extend([<span class=\"string\">'host3'</span>, <span class=\"string\">'host4'</span>])</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">mytask</span><span class=\"params\">()</span>:</span></div><div class=\"line\">    run(<span class=\"string\">'ls /var/www'</span>)</div></pre></td></tr></table></figure>\n<p>执行： fab -H host1,host2 mytask, 主机会包括： [‘host1’, ‘host2’, ‘host3’, ‘host4’]</p>\n<p>###(3)Per-task, via the command line<br>对每个task, 使用命令行定义hosts。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">from fabric.api import run</div><div class=\"line\"></div><div class=\"line\">def mytask():</div><div class=\"line\">    run(&apos;ls /var/www&apos;)</div></pre></td></tr></table></figure>\n<p>为mytask定义主机</p>\n<pre><code>$ fab mytask:hosts=&quot;host1;host2&quot;\n</code></pre><p>这个会覆盖所有的主机列表，mytask只会在host1;host2中执行。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ cat fabfile.py</div><div class=\"line\">from fabric.api import env, run</div><div class=\"line\"></div><div class=\"line\">def mytask():</div><div class=\"line\">    run(<span class=\"string\">'ls /var/www'</span>)</div><div class=\"line\"></div><div class=\"line\">$ fab mytask:hosts=<span class=\"string\">\"host1;host2\"</span></div><div class=\"line\">[host1] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host1] run: ls /var/www</div><div class=\"line\">[host1] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host1] out:</div><div class=\"line\"></div><div class=\"line\">[host2] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host2] run: ls /var/www</div><div class=\"line\">[host2] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host2] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host2... done.</div><div class=\"line\">Disconnecting from host1... done.</div></pre></td></tr></table></figure>\n<p>###(4)Per-task, via decorators</p>\n<p>可以针对每一个task, 可以使用 hosts 或 roles decorators。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">from</span> fabric.api <span class=\"keyword\">import</span> hosts, run</div><div class=\"line\"></div><div class=\"line\"><span class=\"meta\">@hosts('host1', 'host2')</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">mytask</span><span class=\"params\">()</span>:</span></div><div class=\"line\">    run(<span class=\"string\">'ls /var/www'</span>)</div></pre></td></tr></table></figure>\n<p>或者这样定义</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">my_hosts = (&apos;host1&apos;, &apos;host2&apos;)</div><div class=\"line\">@hosts(my_hosts)</div><div class=\"line\">def mytask():</div><div class=\"line\">    run(&apos;ls /var/www&apos;)</div></pre></td></tr></table></figure>\n<p>##2.2 主机定义的优先顺序</p>\n<p>官方说明： <a href=\"http://docs.fabfile.org/en/1.9/usage/execution.html#order-of-precedence\">Order of precedence</a></p>\n<ol>\n<li>Per-task, command-line host lists (fab mytask:host=host1) override absolutely everything else.</li>\n<li>Per-task, decorator-specified host lists (@hosts(‘host1’)) override the env variables.</li>\n<li>Globally specified host lists set in the fabfile (env.hosts = [‘host1’]) can override such lists set on the command-line, but only if you’re not careful (or want them to.)</li>\n<li>Globally specified host lists set on the command-line (–hosts=host1) will initialize the env variables, but that’s it.</li>\n</ol>\n<p>说明：</p>\n<ol>\n<li>Per-task, command-line host lists (fab mytask:host=host1) 会绝对覆盖所有的hosts定义。</li>\n<li>Per-task, decorator-specified host lists (@hosts(‘host1’)) 会覆盖 env 变量(env variables)。</li>\n<li>Globally specified host lists set in the fabfile (env.hosts = [‘host1’]) 会覆盖command-lin定义的主机列表。</li>\n<li>Globally specified host lists set on the command-line (–hosts=host1) 会初始化env 变量(env variables), 但仅仅如此。</li>\n</ol>\n<p>##2.3 测试</p>\n<p>###2.3.1 测试1</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">from</span> fabric.api <span class=\"keyword\">import</span> env, hosts, run</div><div class=\"line\"></div><div class=\"line\">env.hosts = [<span class=\"string\">'host1'</span>]</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">mytask</span><span class=\"params\">()</span>:</span></div><div class=\"line\">    run(<span class=\"string\">'ls /var/www'</span>)</div></pre></td></tr></table></figure>\n<p>执行命令：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\"># fabfile定义的env.hosts会覆盖命令行的定义(-H)</div><div class=\"line\">[root@fabserver fabric]# fab -H host2 mytask</div><div class=\"line\">[host1] Executing task &apos;mytask&apos;</div><div class=\"line\">[host1] run: ls /var/www</div><div class=\"line\">[host1] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host1] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host1... done.</div><div class=\"line\"></div><div class=\"line\"># 命令行task里面的主机定义会覆盖掉&quot;fabfile定义的env.hosts&quot;及&quot;命令行里的定义(-H)&quot;</div><div class=\"line\">[root@fabserver fabric]# fab -H host2 mytask:hosts=host3</div><div class=\"line\">[host3] Executing task &apos;mytask&apos;</div><div class=\"line\">[host3] run: ls /var/www</div><div class=\"line\">[host3] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host3] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host3... done.</div></pre></td></tr></table></figure>\n<p>###2.3.2 测试2</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">from fabric.api import env, hosts, run</div><div class=\"line\"></div><div class=\"line\">env.hosts = [&apos;host1&apos;]</div><div class=\"line\"></div><div class=\"line\">@hosts(&apos;host2&apos;)</div><div class=\"line\">def mytask():</div><div class=\"line\">    run(&apos;ls /var/www&apos;)</div></pre></td></tr></table></figure>\n<p>执行命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># fabfile里面的task hosts定义会覆盖env.hosts定义</span></div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab mytask</span></div><div class=\"line\">[host2] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host2] run: ls /var/www</div><div class=\"line\">[host2] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host2] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host2... done.</div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab -H 'host3' mytask</span></div><div class=\"line\">[host2] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host2] run: ls /var/www</div><div class=\"line\">[host2] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host2] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host2... done.</div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab -H host3 mytask</span></div><div class=\"line\">[host2] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host2] run: ls /var/www</div><div class=\"line\">[host2] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host2] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host2... done.</div><div class=\"line\"> </div><div class=\"line\"><span class=\"comment\"># 命令行内的task hosts定义会覆盖所有定义</span></div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab -H host3 mytask:hosts=\"host1\"</span></div><div class=\"line\">[host1] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host1] run: ls /var/www</div><div class=\"line\">[host1] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host1] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host1... done.</div></pre></td></tr></table></figure>\n<p>#3. 其它</p>\n<p>##3.1 合并主机列表<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">from</span> fabric.api <span class=\"keyword\">import</span> env, hosts, roles, run</div><div class=\"line\"></div><div class=\"line\">env.roledefs = &#123;<span class=\"string\">'role1'</span>: [<span class=\"string\">'host2'</span>, <span class=\"string\">'host3'</span>]&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"meta\">@hosts('host1', 'host2')</span></div><div class=\"line\"><span class=\"meta\">@roles('role1')</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">mytask</span><span class=\"params\">()</span>:</span></div><div class=\"line\">    run(<span class=\"string\">'ls /var/www'</span>)</div></pre></td></tr></table></figure></p>\n<p>执行mytask时，[host1，host2，host3]都会执行。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab mytask</span></div><div class=\"line\">[host1] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host1] run: ls /var/www</div><div class=\"line\">[host1] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host1] out:</div><div class=\"line\"></div><div class=\"line\">[host2] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host2] run: ls /var/www</div><div class=\"line\">[host2] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host2] out:</div><div class=\"line\"></div><div class=\"line\">[host3] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host3] run: ls /var/www</div><div class=\"line\">[host3] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host3] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host2... done.</div><div class=\"line\">Disconnecting from host3... done.</div><div class=\"line\">Disconnecting from host1... done.</div></pre></td></tr></table></figure>\n<p>##3.2 重复的主机<br>fabric会删除重复的host, 所以对于每个task,每个host只会执行一次。<br>如果不需要删除重复的主机，请设置 env.dedupe_hosts 为 False.</p>\n<p>例如，下面的host2会执行两次</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># cat fabfile.py</span></div><div class=\"line\">from fabric.api import env, hosts, roles, run</div><div class=\"line\"></div><div class=\"line\">env.roledefs = &#123;<span class=\"string\">'role1'</span>: [<span class=\"string\">'host2'</span>, <span class=\"string\">'host3'</span>]&#125;</div><div class=\"line\">env.dedupe_hosts = False</div><div class=\"line\"></div><div class=\"line\">@hosts(<span class=\"string\">'host1'</span>, <span class=\"string\">'host2'</span>)</div><div class=\"line\">@roles(<span class=\"string\">'role1'</span>)</div><div class=\"line\">def mytask():</div><div class=\"line\">    run(<span class=\"string\">'ls /var/www'</span>)</div><div class=\"line\"></div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab mytask</span></div><div class=\"line\">[host1] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host1] run: ls /var/www</div><div class=\"line\">[host1] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host1] out:</div><div class=\"line\"></div><div class=\"line\">[host2] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host2] run: ls /var/www</div><div class=\"line\">[host2] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host2] out:</div><div class=\"line\"></div><div class=\"line\">[host2] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host2] run: ls /var/www</div><div class=\"line\">[host2] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host2] out:</div><div class=\"line\"></div><div class=\"line\">[host3] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host3] run: ls /var/www</div><div class=\"line\">[host3] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host3] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host2... done.</div><div class=\"line\">Disconnecting from host3... done.</div><div class=\"line\">Disconnecting from host1... done.</div></pre></td></tr></table></figure>\n<p>##3.3 不包含指定的主机<br>在命令行中使用 –exclude-hosts/-x 定义</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># cat fabfile.py</span></div><div class=\"line\">from fabric.api import env, hosts, roles, run</div><div class=\"line\"></div><div class=\"line\">env.roledefs = &#123;<span class=\"string\">'role1'</span>: [<span class=\"string\">'host2'</span>, <span class=\"string\">'host3'</span>]&#125;</div><div class=\"line\"></div><div class=\"line\">@hosts(<span class=\"string\">'host1'</span>, <span class=\"string\">'host2'</span>)</div><div class=\"line\">@roles(<span class=\"string\">'role1'</span>)</div><div class=\"line\">def mytask():</div><div class=\"line\">    run(<span class=\"string\">'ls /var/www'</span>)</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#注意，这里声明排除host1是不起作用的</span></div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab mytask -x host1</span></div><div class=\"line\">[host1] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host1] run: ls /var/www</div><div class=\"line\">[host1] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host1] out:</div><div class=\"line\"></div><div class=\"line\">[host2] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host2] run: ls /var/www</div><div class=\"line\">[host2] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host2] out:</div><div class=\"line\"></div><div class=\"line\">[host3] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host3] run: ls /var/www</div><div class=\"line\">[host3] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host3] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host2... done.</div><div class=\"line\">Disconnecting from host3... done.</div><div class=\"line\">Disconnecting from host1... done.</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#成功排除host1</span></div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab mytask:exclude_hosts=\"host1\"</span></div><div class=\"line\">[host2] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host2] run: ls /var/www</div><div class=\"line\">[host2] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host2] out:</div><div class=\"line\"></div><div class=\"line\">[host3] Executing task <span class=\"string\">'mytask'</span></div><div class=\"line\">[host3] run: ls /var/www</div><div class=\"line\">[host3] out: cgi-bin  error\thtml  icons</div><div class=\"line\">[host3] out:</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">Disconnecting from host2... done.</div><div class=\"line\">Disconnecting from host3... done.</div></pre></td></tr></table></figure>\n<p>注意：<br>Host exclusion lists 跟 host lists 一样，是不能在不同的级别(level)合并在一起的。</p>\n<p>例如：全局的 -x 选项不会影响到per-task host list 设置的。同样的per-task的exclude_hosts会影响全局的-H 定义的主机列表。</p>\n<p>##3.4 使用execute智能执行task</p>\n<p>###3.4.1 智能执行task</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\">from fabric.api import env, run, roles, execute</div><div class=\"line\"></div><div class=\"line\">env.roledefs = &#123;</div><div class=\"line\">    &apos;db&apos;: [&apos;host1&apos;, &apos;host2&apos;],</div><div class=\"line\">    &apos;web&apos;: [&apos;host3&apos;],</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">@roles(&apos;db&apos;)</div><div class=\"line\">def migrate():</div><div class=\"line\">    # Database stuff here.</div><div class=\"line\">    pass</div><div class=\"line\"></div><div class=\"line\">@roles(&apos;web&apos;)</div><div class=\"line\">def update():</div><div class=\"line\">    # Code updates here.</div><div class=\"line\">    pass</div><div class=\"line\"></div><div class=\"line\">def deploy():</div><div class=\"line\">    execute(migrate)</div><div class=\"line\">    execute(update)</div></pre></td></tr></table></figure>\n<p>执行 $ fab migrate update 和 $ fab deploy 是一样的效果。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab migrate update</span></div><div class=\"line\">[host1] Executing task <span class=\"string\">'migrate'</span></div><div class=\"line\">[host2] Executing task <span class=\"string\">'migrate'</span></div><div class=\"line\">[host3] Executing task <span class=\"string\">'update'</span></div><div class=\"line\"></div><div class=\"line\">Done.</div><div class=\"line\">[root@fabserver fabric]<span class=\"comment\"># fab deploy</span></div><div class=\"line\">[host1] Executing task <span class=\"string\">'migrate'</span></div><div class=\"line\">[host2] Executing task <span class=\"string\">'migrate'</span></div><div class=\"line\">[host3] Executing task <span class=\"string\">'update'</span></div><div class=\"line\"></div><div class=\"line\">Done.</div></pre></td></tr></table></figure>\n<p>###3.4.2 动态设置主机列表</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">from</span> fabric.api <span class=\"keyword\">import</span> run, execute, task</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># For example, code talking to an HTTP API, or a database, or ...</span></div><div class=\"line\"><span class=\"keyword\">from</span> mylib <span class=\"keyword\">import</span> external_datastore</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># This is the actual algorithm involved. It does not care about host</span></div><div class=\"line\"><span class=\"comment\"># lists at all.</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">do_work</span><span class=\"params\">()</span>:</span></div><div class=\"line\">    run(<span class=\"string\">\"something interesting on a host\"</span>)</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># This is the user-facing task invoked on the command line.</span></div><div class=\"line\"><span class=\"meta\">@task</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">deploy</span><span class=\"params\">(lookup_param)</span>:</span></div><div class=\"line\">    <span class=\"comment\"># This is the magic you don't get with @hosts or @roles.</span></div><div class=\"line\">    <span class=\"comment\"># Even lazy-loading roles require you to declare available roles</span></div><div class=\"line\">    <span class=\"comment\"># beforehand. Here, the sky is the limit.</span></div><div class=\"line\">    host_list = external_datastore.query(lookup_param)</div><div class=\"line\">    <span class=\"comment\"># Put this dynamically generated host list together with the work to be</span></div><div class=\"line\">    <span class=\"comment\"># done.</span></div><div class=\"line\">    execute(do_work, hosts=host_list)</div></pre></td></tr></table></figure>\n<p>发布到app服务主机</p>\n<pre><code>$ fab deploy:app\n</code></pre><p>发布到db服务主机</p>\n<pre><code>$ fab deploy:db\n</code></pre>"},{"layout":"post","title":"迁移到jekyll","date":"2015-03-31T07:50:00.000Z","comments":1,"_content":"\n一直以来都想将博客从Octopress迁移到Jekyll，但本着能用就不动的原则(其实就是\"懒\")，一直没有动手。\n\nYesterday, you said tomorrow！\n\n与君共勉！\n","source":"_posts/2015-03-31-from-octopress-to-jekyll.md","raw":"---\nlayout: post\ntitle: \"迁移到jekyll\"\ndate: 2015-03-31 15:50\ncomments: true\n---\n\n一直以来都想将博客从Octopress迁移到Jekyll，但本着能用就不动的原则(其实就是\"懒\")，一直没有动手。\n\nYesterday, you said tomorrow！\n\n与君共勉！\n","slug":"from-octopress-to-jekyll","published":1,"updated":"2017-01-25T15:29:56.000Z","photos":[],"link":"","_id":"ciyf7fkcj001ff2jynjpjfram","content":"<p>一直以来都想将博客从Octopress迁移到Jekyll，但本着能用就不动的原则(其实就是”懒”)，一直没有动手。</p>\n<p>Yesterday, you said tomorrow！</p>\n<p>与君共勉！</p>\n","excerpt":"","more":"<p>一直以来都想将博客从Octopress迁移到Jekyll，但本着能用就不动的原则(其实就是”懒”)，一直没有动手。</p>\n<p>Yesterday, you said tomorrow！</p>\n<p>与君共勉！</p>\n"},{"layout":"post","title":"开发人员需要的技能","date":"2015-04-09T01:50:00.000Z","_content":"\n这是我在2012年5月写下的总结性的文章。昨晚我重新阅读了一遍，然后调整了一些内容，但总体的思想没有变。\n\n\n\n```\n目录\n 1. 概述\n  2.    开发技术\n   2.1. 编程素养\n   (1）算法类\n   (2) 提升类\n   2.2. 编程语言\n    2.2.1.  Java（或c、c++、c# 等）\n    2.2.2.  脚本语言python(或ruby等)\n     (1) 为什么要学脚本语言？\n     (2) 亲身经历\n   2.3. 集成开发环境IDE [不细谈]\n   2.4. 构建工具\n   2.5. 开发最佳实践(具体内容可参考我3月份写的\"应用开发部署实践.doc\")\n    2.5.1.  url怎样才是友好的?\n   2.5.2.   调用第三方接口应该注意什么？\n   2.5.3.   图片处理（压缩，水印等）\n   2.5.4.   测试、设计模式等等\n 3. 数据库技术[不细谈]\n 4. 其它??（上面提到的都不是本文所讲内容的关键）\n  4.1.  网站架构变迁路线\n   4.1.1.   单机模式\n   4.1.2.   数据库分离\n   4.1.3.   数据库主从复制与读写分离\n   4.1.4.   架设应用服务器集群\n   4.1.5.   数据库分库分表\n   4.1.6.   NoSQL？其它？\n  4.2.  架构变迁带来的问题\n    (1) 你如何知道系统的瓶颈在哪？\n   (2)  你如何架设这些服务器？\n   (3)  你如何监控这些服务器？\n   (4)  集群化，对开发的影响？存储、缓存、session等\n   (5)  数据库扩展(主从复制和读写分离,分库,分表)的过程中,你要做什么？\n  4.3.  日常工作中的问题\n  4.4.  问题的实质是什么？\n 5. 如何写出高性能的系统?\n 6. 结论：开发者需要什么技能？\n 7. 知道结论后，我做了什么？\n 8. 参考资料\n```\n\n<!-- more -->\n\n#1.\t概述\n\n从去年(2011)开始，我就陆续学习jvm调优、数据库调优等知识,但到现在(2012年5月)也只是懂一点皮毛。\n\n今天春节过来后，开始关注集群与负载均衡方面的内容。2月份北京出差回来后，总结了URL友好性、jvm优化、web组件优化、集群与负载均衡等方面的内容，写了一份《应用开发部署实践》的文档，但许多内容还在完善中。\n\n这期间看了很多人的博客，对照自身的工作经历，不得不让人有感而发，是要总结点东西才行，于是写下了这篇文章。\n\n从技术上面说，开发人员需要什么技能？可能每个人的看法都不一样。这里我只写了我个人当前的一些想法，想法对与错? 还需要自己思考辨别，或用时间来证明吧！\n\n```\n开发人员需要的技能\n(1)编程语言是基础，必须要掌握(怎么样才能称为掌握呢？)。\n(2)工作中的最佳实践你是需要了解的。但要明确的是，标准总是在不断变化的，最佳实践可能也会过时，不要让最佳实践阻止了我们持续改进。\n(3)数据库知识(备份/还原,sql语句等)要了解吧。\n```\n\n但仅有这些知识就足够了吗？\n开发完成了，要上线！上线就要考虑服务器的架设和优化；\n\n程序或服务不能提供正常的服务了，我们也希望立即得到反馈的吧！\n\n对一些高并发的应用，你要时时监控服务器(集群)的资源(CPU、IO、内存等的…).\n\n而且你只有真正去运维自己的系统，你才知道怎么在程序里写日志，做监控，做统计…\n\n这就是本文所讲内容的重点。\n\n本文的主要脉络如下：\n\n(1)\t先简要的说明了开发技术和数据库技术。开发技术以java为例，说明了要学习脚本语言(python)、总结开发最佳实践等。但像类似lucune等的技术其实也很重要，但在这里尚未提及。\n\n(2)\t接着以网站架构的变迁路线和自己的工作中的问题为例，说明了开发人员其实还要学习运维。\n\n(3)\t知道结论后，我采取什么行动!\n\n<!-- more -->\n\n# 2.\t开发技术\n## 2.1.\t编程素养\n###(1）算法篇\n\n```\n《算法导论》\n《算法（第4版）》 塞奇威克 (Robert Sedgewick) / 韦恩 (Kevin Wayne)\nleetcode算法题\n```\n\ncoursera上的一些算法课也不错！\n\n如果你不满足于信息管理系统的CRUD操作，这块肯定要拿下的。\n\n###(2) 提升篇\n\n```\n《程序员修炼之道》\n《黑客与画家》\n《Unix编程艺术》\n《代码大全》\n《Effective Java》\n《clean code》\n《编写可读代码的艺术》\n《编程之美》\n《构建之法——现代软件工程》邹欣\n《持续交付:发布可靠软件的系统方法》\n```\n\n## 2.2.\t编程语言\n### 2.2.1.\tJava（或c、c++、c#等）\n\n真正的读好下面几本书，java基础应该很扎实了。\n\n```\n《Java编程思想》\n《Java并发编程实战》\n《Effective Java》\n《分布式java应用 基础与实践》\n```\n\n事实上JVM的内存模型理应是Java程序员的基础知识。\n\n```\n《深入理解Java虚拟机:JVM高级特性与最佳实践(第2版)》\n《Java虚拟机规范》\n```\n\n如果涉及到其它方面(如web开发，网络编程)，当然还要学很多。\n\n```\n《TCP/IP详解 卷1：协议》\n...\n```\n\n基本的应用框架(如Spring/MyBatis、Shiro)及类库(如guava,commons包)肯定要熟悉的, 至少要明白实现的原理，如果能深入研究源码肯定是最好的。\n\n\n### 2.2.2.\t脚本语言python(或ruby等)\n\n#### (1) 为什么要学脚本语言？\n为什么要学脚本语言，因为他们实在是太方便了，很多时候我们需要写点小工具或是脚本来帮我们解决问题，你就会发现正规的编程语言太难用了。\n\t脚本语言学习简单上手快速，可以让你摆脱对底层语言的恐惧感，可以让你很快开发出能用得上的小程序。例如：\n\n* 处理文本文件，如csv文件，系统产生的log文件等\n* 遍历本地文件系统 (sys, os, path), 例如写一个程序统计一个目录下所有文件大小并按各种条件排序并保存结果。\n* 方便与数据库打交道。\n* 一些测试数据，用脚本语言非常容易生成。\n\n我为什么要推荐python呢？大家可以看一下Eric Raymond的Why Python?\n我简单总结python的几个优点：\n\n* 它很简单易读;\n* 它接近自然语言;\n* 第三方库成熟、适用面广;\n\n学习参考书：\n《Python核心编程（第二版）》 （美）丘恩（Chun，W.J.）\n\n\n#### (2) 亲身经历\n\n下面的例子都是我用脚本语言(perl/python)写的。\n\n(1)\t生成测试数据(建行团经常用) \n\n生成随机数并保存到文件\n\n```python\n#!/usr/bin/python2.7 \n# -*- coding: utf-8 -*- \nimport sys \nimport random \n \n''' \n生成随机数并保存到文件（可根据已生成的随机数文件生成） \ngenRand.py   minValue maxValue number bit rand_file  \npython genRand.py 0 100 10 5 rand_file \n@args     minValue  值范围最小值 0 \n@args     maxValue  值范围最小值 1000 \n@args     number 个数 \n@args     bit 位数 \n@args     rand_file 已生成的随机数文件(每行有一个数字串) \n''' \n \ns = set() \n \n#格式化数字 \ndef format(v, bit): \n    format_str = '%0'+str(bit)+'d' \n    return format_str % v \n \n#生成随机数 \ndef  rand(minValue, maxValue, bit) : \n    randint = random.randint(minValue, maxValue) \n    v = format(randint, bit) \n    while  v in s :  \n        randint = random.randint(minValue, maxValue) \n        v = format(randint, bit) \n    return v \n     \n#生成所有随机数 \ndef  randAll(minValue, maxValue, number , bit): \n    i = 0 \n    rand_list = [] \n    while i < number : \n        i += 1 \n        v = rand(minValue, maxValue , bit) \n        s.add(v) \n        rand_list.append(v) \n    return rand_list \n \n \n#从文件中读取随机数 \ndef  readRandFile(rand_file): \n    f = open(rand_file) \n    lines = f.readlines() \n    for line in lines  : \n        line=line.rstrip() \n        s.add(line) \n \n#将随机数保存到文件中 \ndef  writeRandToFile(list): \n    fw = open(\"out\",'w') \n    for v in list  : \n        fw.write(str(v)+'\\n'); \n \n \nif __name__ == '__main__': \n    lenArgc = len(sys.argv) \n    if lenArgc >=5 :  \n        minValue = int(sys.argv[1]) \n        maxValue = int(sys.argv[2]) \n        number = int(sys.argv[3]) \n        bit = int(sys.argv[4]) \n        if lenArgc > 5    : \n            rand_file = sys.argv[5]         \n            readRandFile(rand_file)    #从文件中读取随机数     \n \n        #生成随机数 \n        rand_list = randAll(minValue, maxValue, number , bit) \n        writeRandToFile(rand_list) \n    else : \n        print \"参数不正确！\" \n```\n\n(2)\t读取execl(hui99的操作定义)生成Selenium脚本\n\nexecl的数据列有以下，\n\n![01](/images/2015/0409/01.png)\n\n\n用脚本去读取execl文件，获取相关数据信息，生成selenium脚本文件并执行。\n不生成selenium脚本文件，生成sql文件也行，但并非每个人都能直接操作数据库的。\n\n(3)\tmp3 tag操作\n\n电脑下了n多mp3文件，你怎么读取mp3里的tag信息，里面的很多标签都乱七八糟的,如何去修改呢?一个一个文件属性去修改？ python里有非常简单的类库。\n\n![01](/images/2015/0409/02.png)\n\n(4)\t文件重命名\n\n你下载了数G的电视剧/动画片,文件名又乱又长，怎么办？\n\n我确实遇到过这种事情。\n\n柯南都500多集，海贼王400多集、棋魂、灌篮高手等，美剧都六七季，一季20集。你就别想手动修改了，会死人的。\n\n用脚本语言一下了就可以搞定，linux shell也可以轻松制定。\n\n美好生活就是如此的简单。\n\n## 2.3.\t集成开发环境IDE [不细谈]\n\n## 2.4.\t构建工具\n\n使用自动构建工具的理由：\n\n* (1)\t在非图形化界面下构建程序；\n* (2)\t构建过程繁琐而且步骤固定，自动构建工具比交互式的手动构建省事省心；\n* (3)\t多人分别为同一个项目工作，需要有统一和一致的构建环境，比如类库依赖。\n\nant/maven在几年前还不错，到了现在(2015年)已经略显沉重。我这里推荐gradle。我从13年就开始用gradle,上手简单，值得拥有。\n \n## 2.5.\t开发最佳实践(具体内容可参考我3月份写的\"应用开发部署实践.doc\")\n### 2.5.1.\turl怎样才是友好的?\n\n阿烈：为什么我会提到url的问题？\n\n产品运营天天跟你闹：URL太长了，URL参数太多了，URL太乱了，这样搜索引擎搜不到我们的产品啊？你要怎么办？\n\n![01](/images/2015/0409/03.png)\n\n###2.5.2.\t调用第三方接口应该注意什么？\n\n![01](/images/2015/0409/04.png)\n\n###2.5.3.\t图片处理（压缩，水印等）\n\n阿烈：为什么hui99的图片处理这么烂？\n\n压缩的效果太差了!\n\n![01](/images/2015/0409/05.png)\n\n###2.5.4.\t测试、设计模式等等\n\n#3.\t数据库技术[不细谈]\n\n能有dba级别肯定牛，但这种人可能会比较少。\n\n但也至少熟练应用mysql(或其它关系数据库), 知道SQL优化。\n\n#4.\t其它??（上面提到的都不是本文所讲内容的关键）\n\n我们从一个网站从小到大引起的架构变迁，来看待这个问题！\n\n这里以豆瓣为例。具体内容请点击[豆瓣网技术架构变迁](http://www.infoq.com/cn/presentations/hongqn-douban)。\n\n##4.1.\t网站架构变迁路线\n\n###4.1.1.\t单机模式\n这一阶段没有太大的访问量，甚至只有一台服务器就搞定了所有的访问。压力不高。\n应用服务器和数据库放在同一台机子上，前端可能还会架设web服务器(IIS/apache/nginx等)，实现动静分离。\n\n![01](/images/2015/0409/41.png)\n\n![01](/images/2015/0409/42.png)\n\n\n###4.1.2.\t数据库分离\n压力增大，出现瓶颈，开始分离数据库。\n\n![01](/images/2015/0409/43.png)\n\n![01](/images/2015/0409/44.png)\n\n![01](/images/2015/0409/45.png)\n\n\n###4.1.3.\t数据库主从复制与读写分离\n网站初具规模，DB压力大增，单独的一台DB已经满足不了现在的访问量，开始考虑读写分离的Master-slave库，使用三个及以上的服务器。\n\n访问量继续增加，增加到了DB的压力在Master的机器上非常的明显了，Master开始出现吃不消的情况，出现写耗尽。主从也已经不能满足要求，需要进一步解决负载问题，此时要引入Mysql Proxy程序，进行中间层代理，实现负载均衡，易于扩展。\n\n注：读写分离采用的方法是写数据库时在一个数据库上写入，而要读取时则从多个其他的数据库中读取，通常将用于写入的库称为master库，用于读取的库为slave库。读写分离适用于读多写少，并允许一定延时的业务中。\n\n![01](/images/2015/0409/46.png)\n\n![01](/images/2015/0409/47.png)\n\n![01](/images/2015/0409/48.png)\n\n###4.1.4.\t架设应用服务器集群\n随着访问数的增长，单台应用服务器已经不能响应如此多的请求，必须要架设应用服务器集群了。\n\n![01](/images/2015/0409/49.png)\n\n![01](/images/2015/0409/50.png)\n\n![01](/images/2015/0409/51.png)\n\n###4.1.5.\t数据库分库分表\n\n在系统发展的初期，通常会将各种不同的数据库放在同一个数据库中，随着业务的多元化及业务的水平伸缩，数据库的连接数会成为稀缺和资源，对于这种情况分库是个不错的选择。\n\n分库通常按照业务领域将原来存储在同一个数据库的数据拆分到多个数据库中。例如ebay就按照其业务领域分为商品、用户、评价、交易等数据库，每个数据库只用于处理相关业务的数据，因此可用的数据库连接数会得到很大提升。\n\n分表意味着我们可以将同一数据表中的记录通过特定的算法进行分离，分别保存在不同的数据库表中，从而可以部署在不同的数据库服务器上。\n\n![01](/images/2015/0409/53.png)\n\n![01](/images/2015/0409/54.png)\n\n![01](/images/2015/0409/55.png)\n\n\n###4.1.6.\tNoSQL？其它？\n##4.2.\t架构变迁带来的问题\n####(1)\t你如何知道系统的瓶颈在哪？\n大家也看得出来，访问量的不断增大导致了架构的不断变迁。访问量的增大导致了系统出现瓶颈，而不能满足用户的请求了。\n\n通常瓶颈的表象是资源消耗过多、外部处理系统的性能不足，或者资源消耗不多，但程序的响应速度却仍达不到要求(建行团有一次秒杀时遇到到这种问题)。\n\n资源主要消耗在CPU、文件IO、网络IO以及内存方面，机器有资源是有限的，当某资源消耗过多时，通常会造成系统的响应速度慢。\n\n你怎么知道系统出现了瓶颈了呢？出现的瓶颈在哪里呢？\n\n###(2)\t你如何架设这些服务器？\n\n###(3)\t你如何监控这些服务器？\n你不监控，你就不知道系统的瓶颈在哪，性能优化、架构变迁也就无从谈起！\n\n而且网络状况复杂，难以保证7×24小时100%的在线，你当然不希望自己网站或者服务器由于各种原因而不能访问。\n\n故障的原因主要：\n\n* 网站被挂马。网站一旦有漏洞，被挂马是常有的事。\n* 网站代码出错、数据库出错、网站占CPU太高、空间占满、空间过期。\n* 域名解析出错、域名过期。\n* 网站或者服务器由于有害信息、备案等原因被关或封IP。\n* 网站或者服务器被攻击。同台服务器网站或者网段被攻击也殃及池鱼。\n* 服务器出现故障或者需要维护。\n* 网络运营商线路出现故障，特别是南北互通。\n\n很多故障是不定时、不可预料的。最勤快的站长网管都不可能24小时去刷新网页，去Ping服务器。这自然需要自动的监控服务。\n\n###(4)\t集群化，对开发的影响？存储、缓存、session等\n###(5)\t数据库扩展(主从复制和读写分离,分库,分表)的过程中,你要做什么？\n\n##4.3.\t日常工作中的问题\n\n也许大家会说，我们的网站的访问量这么少，还没有必要考虑上面的问题。\n好，我列出工作中一些问题:\n\n```\n(1)\t为什么我们的服务器都是windows机器，而不是linux\n(2)\thui99存储空间不足，导致hui99邮件服务器挂掉。\n(3)\t北京农商行,手机银行服务端连接到网银服务器，为什么自己写负载均衡策略？\n(4)\t为什么建行团，迁移机房后，远程登录用户不用administrator了。\n(5)\t21的数据服务器僵死，导致hui99的tomcat线程到达200,而不能提供正常服务！(2012-03-25)\n(6)\t建行团有一个200M的日志文件，你如何查看其内容？如果是2G的呢?(一般的文件编辑器打不开这么大的)\n(7)\t建行团秒杀过程中，如何监控CPU，内存，磁盘IO等？\n(8)\t如何提供7*24*365的服务(项目更新必须停机重起，服务会暂停)?\n(9) ...\n```\n##4.4.\t问题的实质是什么？\n\n服务器（集群）架设。\n\n服务器的监控。\n\n服务器的优化。\n\n服务器的安全。\n\n。。。\n\n实现这些，你还需要掌握运维的知识。\n\n那什么是运维呢？\n运维关键技术点：\n\n*\t大量高并发网站的设计方案 ；\n*\t高可靠、高可伸缩性网络架构设计；\n*\t网站安全问题，如何避免被黑？\n*\t南北互联问题,动态CDN解决方案；\n*\t海量数据存储架构;\n*\t等等...\n\n#5.\t如何写出高性能的系统?\n从当当网上搜\"高性能\"，你可以看到下面列出来的图书：\n\n```\n《高性能Linux服务器构建实战:运维监控、性能调优与集群应用》\n《高性能网站建设指南》\n《高性能MYSQL影印版》\n《构建高性能Web站点》\n《实战Nginx：取代Apache的高性能Web服务器》\n………\n```\n\n一个高性能的系统，不仅涉及到开发的程序代码，也与服务器、数据库、web服务器等息息相关。\n\n罗马不是一日建成的，高性能系统不是一下子就能实现的？高性能系统是PDCA（Plan Do Check Act）持续改善的过程，是开发、上线、监控、优化反复循环的过程。\n\n#6.\t结论：开发者需要什么技能？\n\n(1)\t开发技术\n\n(2)\t数据库技术\n\n(3)\t运维技术\n\n技术之间是相辅相成的。\n\n#7.\t知道结论后，我做了什么？\n\n(1)\t学习linux\n\n(2)\t参加运维培训班\n\n(3)\t学习python\n\n(4)\t多思考、总结、实践\n\n#8.\t参考资料\n(1)\tJava应用运维 by bluedavy \n\n<http://blog.bluedavy.com/?p=363>\n\n(2)\t我们需要专职的QA吗？ by 陈皓\n\n<http://coolshell.cn/articles/6994.html>\n\n(3)\t程序员技术练级攻略 by 陈皓\n\n<http://coolshell.cn/articles/4990.html>\n\n(4)\tWhy Python? By Eric Raymond\n\n<http://www.linuxjournal.com/article/3882>\n\nEric Raymond的Why Python?的中文翻译\n\n<http://blog.donews.com/ygao/archive/2005/10/25/602051.aspx>\n\n(5)\t程序员需要具备的基本技能 by 陈皓\n\n<http://coolshell.cn/articles/428.html>\n\n-----\n\n初稿写于2012年5月，2015年4月9日修改了部分内容。\n\n(全书完)","source":"_posts/2015-04-09-what-skills-do-developer-have.md","raw":"---\nlayout: post\ntitle: \"开发人员需要的技能\"\ndate: 2015-04-09 09:50\ncategories: 开发\n---\n\n这是我在2012年5月写下的总结性的文章。昨晚我重新阅读了一遍，然后调整了一些内容，但总体的思想没有变。\n\n\n\n```\n目录\n 1. 概述\n  2.    开发技术\n   2.1. 编程素养\n   (1）算法类\n   (2) 提升类\n   2.2. 编程语言\n    2.2.1.  Java（或c、c++、c# 等）\n    2.2.2.  脚本语言python(或ruby等)\n     (1) 为什么要学脚本语言？\n     (2) 亲身经历\n   2.3. 集成开发环境IDE [不细谈]\n   2.4. 构建工具\n   2.5. 开发最佳实践(具体内容可参考我3月份写的\"应用开发部署实践.doc\")\n    2.5.1.  url怎样才是友好的?\n   2.5.2.   调用第三方接口应该注意什么？\n   2.5.3.   图片处理（压缩，水印等）\n   2.5.4.   测试、设计模式等等\n 3. 数据库技术[不细谈]\n 4. 其它??（上面提到的都不是本文所讲内容的关键）\n  4.1.  网站架构变迁路线\n   4.1.1.   单机模式\n   4.1.2.   数据库分离\n   4.1.3.   数据库主从复制与读写分离\n   4.1.4.   架设应用服务器集群\n   4.1.5.   数据库分库分表\n   4.1.6.   NoSQL？其它？\n  4.2.  架构变迁带来的问题\n    (1) 你如何知道系统的瓶颈在哪？\n   (2)  你如何架设这些服务器？\n   (3)  你如何监控这些服务器？\n   (4)  集群化，对开发的影响？存储、缓存、session等\n   (5)  数据库扩展(主从复制和读写分离,分库,分表)的过程中,你要做什么？\n  4.3.  日常工作中的问题\n  4.4.  问题的实质是什么？\n 5. 如何写出高性能的系统?\n 6. 结论：开发者需要什么技能？\n 7. 知道结论后，我做了什么？\n 8. 参考资料\n```\n\n<!-- more -->\n\n#1.\t概述\n\n从去年(2011)开始，我就陆续学习jvm调优、数据库调优等知识,但到现在(2012年5月)也只是懂一点皮毛。\n\n今天春节过来后，开始关注集群与负载均衡方面的内容。2月份北京出差回来后，总结了URL友好性、jvm优化、web组件优化、集群与负载均衡等方面的内容，写了一份《应用开发部署实践》的文档，但许多内容还在完善中。\n\n这期间看了很多人的博客，对照自身的工作经历，不得不让人有感而发，是要总结点东西才行，于是写下了这篇文章。\n\n从技术上面说，开发人员需要什么技能？可能每个人的看法都不一样。这里我只写了我个人当前的一些想法，想法对与错? 还需要自己思考辨别，或用时间来证明吧！\n\n```\n开发人员需要的技能\n(1)编程语言是基础，必须要掌握(怎么样才能称为掌握呢？)。\n(2)工作中的最佳实践你是需要了解的。但要明确的是，标准总是在不断变化的，最佳实践可能也会过时，不要让最佳实践阻止了我们持续改进。\n(3)数据库知识(备份/还原,sql语句等)要了解吧。\n```\n\n但仅有这些知识就足够了吗？\n开发完成了，要上线！上线就要考虑服务器的架设和优化；\n\n程序或服务不能提供正常的服务了，我们也希望立即得到反馈的吧！\n\n对一些高并发的应用，你要时时监控服务器(集群)的资源(CPU、IO、内存等的…).\n\n而且你只有真正去运维自己的系统，你才知道怎么在程序里写日志，做监控，做统计…\n\n这就是本文所讲内容的重点。\n\n本文的主要脉络如下：\n\n(1)\t先简要的说明了开发技术和数据库技术。开发技术以java为例，说明了要学习脚本语言(python)、总结开发最佳实践等。但像类似lucune等的技术其实也很重要，但在这里尚未提及。\n\n(2)\t接着以网站架构的变迁路线和自己的工作中的问题为例，说明了开发人员其实还要学习运维。\n\n(3)\t知道结论后，我采取什么行动!\n\n<!-- more -->\n\n# 2.\t开发技术\n## 2.1.\t编程素养\n###(1）算法篇\n\n```\n《算法导论》\n《算法（第4版）》 塞奇威克 (Robert Sedgewick) / 韦恩 (Kevin Wayne)\nleetcode算法题\n```\n\ncoursera上的一些算法课也不错！\n\n如果你不满足于信息管理系统的CRUD操作，这块肯定要拿下的。\n\n###(2) 提升篇\n\n```\n《程序员修炼之道》\n《黑客与画家》\n《Unix编程艺术》\n《代码大全》\n《Effective Java》\n《clean code》\n《编写可读代码的艺术》\n《编程之美》\n《构建之法——现代软件工程》邹欣\n《持续交付:发布可靠软件的系统方法》\n```\n\n## 2.2.\t编程语言\n### 2.2.1.\tJava（或c、c++、c#等）\n\n真正的读好下面几本书，java基础应该很扎实了。\n\n```\n《Java编程思想》\n《Java并发编程实战》\n《Effective Java》\n《分布式java应用 基础与实践》\n```\n\n事实上JVM的内存模型理应是Java程序员的基础知识。\n\n```\n《深入理解Java虚拟机:JVM高级特性与最佳实践(第2版)》\n《Java虚拟机规范》\n```\n\n如果涉及到其它方面(如web开发，网络编程)，当然还要学很多。\n\n```\n《TCP/IP详解 卷1：协议》\n...\n```\n\n基本的应用框架(如Spring/MyBatis、Shiro)及类库(如guava,commons包)肯定要熟悉的, 至少要明白实现的原理，如果能深入研究源码肯定是最好的。\n\n\n### 2.2.2.\t脚本语言python(或ruby等)\n\n#### (1) 为什么要学脚本语言？\n为什么要学脚本语言，因为他们实在是太方便了，很多时候我们需要写点小工具或是脚本来帮我们解决问题，你就会发现正规的编程语言太难用了。\n\t脚本语言学习简单上手快速，可以让你摆脱对底层语言的恐惧感，可以让你很快开发出能用得上的小程序。例如：\n\n* 处理文本文件，如csv文件，系统产生的log文件等\n* 遍历本地文件系统 (sys, os, path), 例如写一个程序统计一个目录下所有文件大小并按各种条件排序并保存结果。\n* 方便与数据库打交道。\n* 一些测试数据，用脚本语言非常容易生成。\n\n我为什么要推荐python呢？大家可以看一下Eric Raymond的Why Python?\n我简单总结python的几个优点：\n\n* 它很简单易读;\n* 它接近自然语言;\n* 第三方库成熟、适用面广;\n\n学习参考书：\n《Python核心编程（第二版）》 （美）丘恩（Chun，W.J.）\n\n\n#### (2) 亲身经历\n\n下面的例子都是我用脚本语言(perl/python)写的。\n\n(1)\t生成测试数据(建行团经常用) \n\n生成随机数并保存到文件\n\n```python\n#!/usr/bin/python2.7 \n# -*- coding: utf-8 -*- \nimport sys \nimport random \n \n''' \n生成随机数并保存到文件（可根据已生成的随机数文件生成） \ngenRand.py   minValue maxValue number bit rand_file  \npython genRand.py 0 100 10 5 rand_file \n@args     minValue  值范围最小值 0 \n@args     maxValue  值范围最小值 1000 \n@args     number 个数 \n@args     bit 位数 \n@args     rand_file 已生成的随机数文件(每行有一个数字串) \n''' \n \ns = set() \n \n#格式化数字 \ndef format(v, bit): \n    format_str = '%0'+str(bit)+'d' \n    return format_str % v \n \n#生成随机数 \ndef  rand(minValue, maxValue, bit) : \n    randint = random.randint(minValue, maxValue) \n    v = format(randint, bit) \n    while  v in s :  \n        randint = random.randint(minValue, maxValue) \n        v = format(randint, bit) \n    return v \n     \n#生成所有随机数 \ndef  randAll(minValue, maxValue, number , bit): \n    i = 0 \n    rand_list = [] \n    while i < number : \n        i += 1 \n        v = rand(minValue, maxValue , bit) \n        s.add(v) \n        rand_list.append(v) \n    return rand_list \n \n \n#从文件中读取随机数 \ndef  readRandFile(rand_file): \n    f = open(rand_file) \n    lines = f.readlines() \n    for line in lines  : \n        line=line.rstrip() \n        s.add(line) \n \n#将随机数保存到文件中 \ndef  writeRandToFile(list): \n    fw = open(\"out\",'w') \n    for v in list  : \n        fw.write(str(v)+'\\n'); \n \n \nif __name__ == '__main__': \n    lenArgc = len(sys.argv) \n    if lenArgc >=5 :  \n        minValue = int(sys.argv[1]) \n        maxValue = int(sys.argv[2]) \n        number = int(sys.argv[3]) \n        bit = int(sys.argv[4]) \n        if lenArgc > 5    : \n            rand_file = sys.argv[5]         \n            readRandFile(rand_file)    #从文件中读取随机数     \n \n        #生成随机数 \n        rand_list = randAll(minValue, maxValue, number , bit) \n        writeRandToFile(rand_list) \n    else : \n        print \"参数不正确！\" \n```\n\n(2)\t读取execl(hui99的操作定义)生成Selenium脚本\n\nexecl的数据列有以下，\n\n![01](/images/2015/0409/01.png)\n\n\n用脚本去读取execl文件，获取相关数据信息，生成selenium脚本文件并执行。\n不生成selenium脚本文件，生成sql文件也行，但并非每个人都能直接操作数据库的。\n\n(3)\tmp3 tag操作\n\n电脑下了n多mp3文件，你怎么读取mp3里的tag信息，里面的很多标签都乱七八糟的,如何去修改呢?一个一个文件属性去修改？ python里有非常简单的类库。\n\n![01](/images/2015/0409/02.png)\n\n(4)\t文件重命名\n\n你下载了数G的电视剧/动画片,文件名又乱又长，怎么办？\n\n我确实遇到过这种事情。\n\n柯南都500多集，海贼王400多集、棋魂、灌篮高手等，美剧都六七季，一季20集。你就别想手动修改了，会死人的。\n\n用脚本语言一下了就可以搞定，linux shell也可以轻松制定。\n\n美好生活就是如此的简单。\n\n## 2.3.\t集成开发环境IDE [不细谈]\n\n## 2.4.\t构建工具\n\n使用自动构建工具的理由：\n\n* (1)\t在非图形化界面下构建程序；\n* (2)\t构建过程繁琐而且步骤固定，自动构建工具比交互式的手动构建省事省心；\n* (3)\t多人分别为同一个项目工作，需要有统一和一致的构建环境，比如类库依赖。\n\nant/maven在几年前还不错，到了现在(2015年)已经略显沉重。我这里推荐gradle。我从13年就开始用gradle,上手简单，值得拥有。\n \n## 2.5.\t开发最佳实践(具体内容可参考我3月份写的\"应用开发部署实践.doc\")\n### 2.5.1.\turl怎样才是友好的?\n\n阿烈：为什么我会提到url的问题？\n\n产品运营天天跟你闹：URL太长了，URL参数太多了，URL太乱了，这样搜索引擎搜不到我们的产品啊？你要怎么办？\n\n![01](/images/2015/0409/03.png)\n\n###2.5.2.\t调用第三方接口应该注意什么？\n\n![01](/images/2015/0409/04.png)\n\n###2.5.3.\t图片处理（压缩，水印等）\n\n阿烈：为什么hui99的图片处理这么烂？\n\n压缩的效果太差了!\n\n![01](/images/2015/0409/05.png)\n\n###2.5.4.\t测试、设计模式等等\n\n#3.\t数据库技术[不细谈]\n\n能有dba级别肯定牛，但这种人可能会比较少。\n\n但也至少熟练应用mysql(或其它关系数据库), 知道SQL优化。\n\n#4.\t其它??（上面提到的都不是本文所讲内容的关键）\n\n我们从一个网站从小到大引起的架构变迁，来看待这个问题！\n\n这里以豆瓣为例。具体内容请点击[豆瓣网技术架构变迁](http://www.infoq.com/cn/presentations/hongqn-douban)。\n\n##4.1.\t网站架构变迁路线\n\n###4.1.1.\t单机模式\n这一阶段没有太大的访问量，甚至只有一台服务器就搞定了所有的访问。压力不高。\n应用服务器和数据库放在同一台机子上，前端可能还会架设web服务器(IIS/apache/nginx等)，实现动静分离。\n\n![01](/images/2015/0409/41.png)\n\n![01](/images/2015/0409/42.png)\n\n\n###4.1.2.\t数据库分离\n压力增大，出现瓶颈，开始分离数据库。\n\n![01](/images/2015/0409/43.png)\n\n![01](/images/2015/0409/44.png)\n\n![01](/images/2015/0409/45.png)\n\n\n###4.1.3.\t数据库主从复制与读写分离\n网站初具规模，DB压力大增，单独的一台DB已经满足不了现在的访问量，开始考虑读写分离的Master-slave库，使用三个及以上的服务器。\n\n访问量继续增加，增加到了DB的压力在Master的机器上非常的明显了，Master开始出现吃不消的情况，出现写耗尽。主从也已经不能满足要求，需要进一步解决负载问题，此时要引入Mysql Proxy程序，进行中间层代理，实现负载均衡，易于扩展。\n\n注：读写分离采用的方法是写数据库时在一个数据库上写入，而要读取时则从多个其他的数据库中读取，通常将用于写入的库称为master库，用于读取的库为slave库。读写分离适用于读多写少，并允许一定延时的业务中。\n\n![01](/images/2015/0409/46.png)\n\n![01](/images/2015/0409/47.png)\n\n![01](/images/2015/0409/48.png)\n\n###4.1.4.\t架设应用服务器集群\n随着访问数的增长，单台应用服务器已经不能响应如此多的请求，必须要架设应用服务器集群了。\n\n![01](/images/2015/0409/49.png)\n\n![01](/images/2015/0409/50.png)\n\n![01](/images/2015/0409/51.png)\n\n###4.1.5.\t数据库分库分表\n\n在系统发展的初期，通常会将各种不同的数据库放在同一个数据库中，随着业务的多元化及业务的水平伸缩，数据库的连接数会成为稀缺和资源，对于这种情况分库是个不错的选择。\n\n分库通常按照业务领域将原来存储在同一个数据库的数据拆分到多个数据库中。例如ebay就按照其业务领域分为商品、用户、评价、交易等数据库，每个数据库只用于处理相关业务的数据，因此可用的数据库连接数会得到很大提升。\n\n分表意味着我们可以将同一数据表中的记录通过特定的算法进行分离，分别保存在不同的数据库表中，从而可以部署在不同的数据库服务器上。\n\n![01](/images/2015/0409/53.png)\n\n![01](/images/2015/0409/54.png)\n\n![01](/images/2015/0409/55.png)\n\n\n###4.1.6.\tNoSQL？其它？\n##4.2.\t架构变迁带来的问题\n####(1)\t你如何知道系统的瓶颈在哪？\n大家也看得出来，访问量的不断增大导致了架构的不断变迁。访问量的增大导致了系统出现瓶颈，而不能满足用户的请求了。\n\n通常瓶颈的表象是资源消耗过多、外部处理系统的性能不足，或者资源消耗不多，但程序的响应速度却仍达不到要求(建行团有一次秒杀时遇到到这种问题)。\n\n资源主要消耗在CPU、文件IO、网络IO以及内存方面，机器有资源是有限的，当某资源消耗过多时，通常会造成系统的响应速度慢。\n\n你怎么知道系统出现了瓶颈了呢？出现的瓶颈在哪里呢？\n\n###(2)\t你如何架设这些服务器？\n\n###(3)\t你如何监控这些服务器？\n你不监控，你就不知道系统的瓶颈在哪，性能优化、架构变迁也就无从谈起！\n\n而且网络状况复杂，难以保证7×24小时100%的在线，你当然不希望自己网站或者服务器由于各种原因而不能访问。\n\n故障的原因主要：\n\n* 网站被挂马。网站一旦有漏洞，被挂马是常有的事。\n* 网站代码出错、数据库出错、网站占CPU太高、空间占满、空间过期。\n* 域名解析出错、域名过期。\n* 网站或者服务器由于有害信息、备案等原因被关或封IP。\n* 网站或者服务器被攻击。同台服务器网站或者网段被攻击也殃及池鱼。\n* 服务器出现故障或者需要维护。\n* 网络运营商线路出现故障，特别是南北互通。\n\n很多故障是不定时、不可预料的。最勤快的站长网管都不可能24小时去刷新网页，去Ping服务器。这自然需要自动的监控服务。\n\n###(4)\t集群化，对开发的影响？存储、缓存、session等\n###(5)\t数据库扩展(主从复制和读写分离,分库,分表)的过程中,你要做什么？\n\n##4.3.\t日常工作中的问题\n\n也许大家会说，我们的网站的访问量这么少，还没有必要考虑上面的问题。\n好，我列出工作中一些问题:\n\n```\n(1)\t为什么我们的服务器都是windows机器，而不是linux\n(2)\thui99存储空间不足，导致hui99邮件服务器挂掉。\n(3)\t北京农商行,手机银行服务端连接到网银服务器，为什么自己写负载均衡策略？\n(4)\t为什么建行团，迁移机房后，远程登录用户不用administrator了。\n(5)\t21的数据服务器僵死，导致hui99的tomcat线程到达200,而不能提供正常服务！(2012-03-25)\n(6)\t建行团有一个200M的日志文件，你如何查看其内容？如果是2G的呢?(一般的文件编辑器打不开这么大的)\n(7)\t建行团秒杀过程中，如何监控CPU，内存，磁盘IO等？\n(8)\t如何提供7*24*365的服务(项目更新必须停机重起，服务会暂停)?\n(9) ...\n```\n##4.4.\t问题的实质是什么？\n\n服务器（集群）架设。\n\n服务器的监控。\n\n服务器的优化。\n\n服务器的安全。\n\n。。。\n\n实现这些，你还需要掌握运维的知识。\n\n那什么是运维呢？\n运维关键技术点：\n\n*\t大量高并发网站的设计方案 ；\n*\t高可靠、高可伸缩性网络架构设计；\n*\t网站安全问题，如何避免被黑？\n*\t南北互联问题,动态CDN解决方案；\n*\t海量数据存储架构;\n*\t等等...\n\n#5.\t如何写出高性能的系统?\n从当当网上搜\"高性能\"，你可以看到下面列出来的图书：\n\n```\n《高性能Linux服务器构建实战:运维监控、性能调优与集群应用》\n《高性能网站建设指南》\n《高性能MYSQL影印版》\n《构建高性能Web站点》\n《实战Nginx：取代Apache的高性能Web服务器》\n………\n```\n\n一个高性能的系统，不仅涉及到开发的程序代码，也与服务器、数据库、web服务器等息息相关。\n\n罗马不是一日建成的，高性能系统不是一下子就能实现的？高性能系统是PDCA（Plan Do Check Act）持续改善的过程，是开发、上线、监控、优化反复循环的过程。\n\n#6.\t结论：开发者需要什么技能？\n\n(1)\t开发技术\n\n(2)\t数据库技术\n\n(3)\t运维技术\n\n技术之间是相辅相成的。\n\n#7.\t知道结论后，我做了什么？\n\n(1)\t学习linux\n\n(2)\t参加运维培训班\n\n(3)\t学习python\n\n(4)\t多思考、总结、实践\n\n#8.\t参考资料\n(1)\tJava应用运维 by bluedavy \n\n<http://blog.bluedavy.com/?p=363>\n\n(2)\t我们需要专职的QA吗？ by 陈皓\n\n<http://coolshell.cn/articles/6994.html>\n\n(3)\t程序员技术练级攻略 by 陈皓\n\n<http://coolshell.cn/articles/4990.html>\n\n(4)\tWhy Python? By Eric Raymond\n\n<http://www.linuxjournal.com/article/3882>\n\nEric Raymond的Why Python?的中文翻译\n\n<http://blog.donews.com/ygao/archive/2005/10/25/602051.aspx>\n\n(5)\t程序员需要具备的基本技能 by 陈皓\n\n<http://coolshell.cn/articles/428.html>\n\n-----\n\n初稿写于2012年5月，2015年4月9日修改了部分内容。\n\n(全书完)","slug":"what-skills-do-developer-have","published":1,"updated":"2017-01-27T01:34:43.000Z","comments":1,"photos":[],"link":"","_id":"ciyf7fkcl001hf2jyeei0gt9g","content":"<p>这是我在2012年5月写下的总结性的文章。昨晚我重新阅读了一遍，然后调整了一些内容，但总体的思想没有变。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div></pre></td><td class=\"code\"><pre><div class=\"line\">目录</div><div class=\"line\"> 1. 概述</div><div class=\"line\">  2.    开发技术</div><div class=\"line\">   2.1. 编程素养</div><div class=\"line\">   (1）算法类</div><div class=\"line\">   (2) 提升类</div><div class=\"line\">   2.2. 编程语言</div><div class=\"line\">    2.2.1.  Java（或c、c++、c# 等）</div><div class=\"line\">    2.2.2.  脚本语言python(或ruby等)</div><div class=\"line\">     (1) 为什么要学脚本语言？</div><div class=\"line\">     (2) 亲身经历</div><div class=\"line\">   2.3. 集成开发环境IDE [不细谈]</div><div class=\"line\">   2.4. 构建工具</div><div class=\"line\">   2.5. 开发最佳实践(具体内容可参考我3月份写的&quot;应用开发部署实践.doc&quot;)</div><div class=\"line\">    2.5.1.  url怎样才是友好的?</div><div class=\"line\">   2.5.2.   调用第三方接口应该注意什么？</div><div class=\"line\">   2.5.3.   图片处理（压缩，水印等）</div><div class=\"line\">   2.5.4.   测试、设计模式等等</div><div class=\"line\"> 3. 数据库技术[不细谈]</div><div class=\"line\"> 4. 其它??（上面提到的都不是本文所讲内容的关键）</div><div class=\"line\">  4.1.  网站架构变迁路线</div><div class=\"line\">   4.1.1.   单机模式</div><div class=\"line\">   4.1.2.   数据库分离</div><div class=\"line\">   4.1.3.   数据库主从复制与读写分离</div><div class=\"line\">   4.1.4.   架设应用服务器集群</div><div class=\"line\">   4.1.5.   数据库分库分表</div><div class=\"line\">   4.1.6.   NoSQL？其它？</div><div class=\"line\">  4.2.  架构变迁带来的问题</div><div class=\"line\">    (1) 你如何知道系统的瓶颈在哪？</div><div class=\"line\">   (2)  你如何架设这些服务器？</div><div class=\"line\">   (3)  你如何监控这些服务器？</div><div class=\"line\">   (4)  集群化，对开发的影响？存储、缓存、session等</div><div class=\"line\">   (5)  数据库扩展(主从复制和读写分离,分库,分表)的过程中,你要做什么？</div><div class=\"line\">  4.3.  日常工作中的问题</div><div class=\"line\">  4.4.  问题的实质是什么？</div><div class=\"line\"> 5. 如何写出高性能的系统?</div><div class=\"line\"> 6. 结论：开发者需要什么技能？</div><div class=\"line\"> 7. 知道结论后，我做了什么？</div><div class=\"line\"> 8. 参考资料</div></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<p>#1.    概述</p>\n<p>从去年(2011)开始，我就陆续学习jvm调优、数据库调优等知识,但到现在(2012年5月)也只是懂一点皮毛。</p>\n<p>今天春节过来后，开始关注集群与负载均衡方面的内容。2月份北京出差回来后，总结了URL友好性、jvm优化、web组件优化、集群与负载均衡等方面的内容，写了一份《应用开发部署实践》的文档，但许多内容还在完善中。</p>\n<p>这期间看了很多人的博客，对照自身的工作经历，不得不让人有感而发，是要总结点东西才行，于是写下了这篇文章。</p>\n<p>从技术上面说，开发人员需要什么技能？可能每个人的看法都不一样。这里我只写了我个人当前的一些想法，想法对与错? 还需要自己思考辨别，或用时间来证明吧！</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">开发人员需要的技能</div><div class=\"line\">(1)编程语言是基础，必须要掌握(怎么样才能称为掌握呢？)。</div><div class=\"line\">(2)工作中的最佳实践你是需要了解的。但要明确的是，标准总是在不断变化的，最佳实践可能也会过时，不要让最佳实践阻止了我们持续改进。</div><div class=\"line\">(3)数据库知识(备份/还原,sql语句等)要了解吧。</div></pre></td></tr></table></figure>\n<p>但仅有这些知识就足够了吗？<br>开发完成了，要上线！上线就要考虑服务器的架设和优化；</p>\n<p>程序或服务不能提供正常的服务了，我们也希望立即得到反馈的吧！</p>\n<p>对一些高并发的应用，你要时时监控服务器(集群)的资源(CPU、IO、内存等的…).</p>\n<p>而且你只有真正去运维自己的系统，你才知道怎么在程序里写日志，做监控，做统计…</p>\n<p>这就是本文所讲内容的重点。</p>\n<p>本文的主要脉络如下：</p>\n<p>(1)    先简要的说明了开发技术和数据库技术。开发技术以java为例，说明了要学习脚本语言(python)、总结开发最佳实践等。但像类似lucune等的技术其实也很重要，但在这里尚未提及。</p>\n<p>(2)    接着以网站架构的变迁路线和自己的工作中的问题为例，说明了开发人员其实还要学习运维。</p>\n<p>(3)    知道结论后，我采取什么行动!</p>\n<!-- more -->\n<h1 id=\"2-开发技术\"><a href=\"#2-开发技术\" class=\"headerlink\" title=\"2.    开发技术\"></a>2.    开发技术</h1><h2 id=\"2-1-编程素养\"><a href=\"#2-1-编程素养\" class=\"headerlink\" title=\"2.1.    编程素养\"></a>2.1.    编程素养</h2><p>###(1）算法篇</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">《算法导论》</div><div class=\"line\">《算法（第4版）》 塞奇威克 (Robert Sedgewick) / 韦恩 (Kevin Wayne)</div><div class=\"line\">leetcode算法题</div></pre></td></tr></table></figure>\n<p>coursera上的一些算法课也不错！</p>\n<p>如果你不满足于信息管理系统的CRUD操作，这块肯定要拿下的。</p>\n<p>###(2) 提升篇</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">《程序员修炼之道》</div><div class=\"line\">《黑客与画家》</div><div class=\"line\">《Unix编程艺术》</div><div class=\"line\">《代码大全》</div><div class=\"line\">《Effective Java》</div><div class=\"line\">《clean code》</div><div class=\"line\">《编写可读代码的艺术》</div><div class=\"line\">《编程之美》</div><div class=\"line\">《构建之法——现代软件工程》邹欣</div><div class=\"line\">《持续交付:发布可靠软件的系统方法》</div></pre></td></tr></table></figure>\n<h2 id=\"2-2-编程语言\"><a href=\"#2-2-编程语言\" class=\"headerlink\" title=\"2.2.    编程语言\"></a>2.2.    编程语言</h2><h3 id=\"2-2-1-Java（或c、c-、c-等）\"><a href=\"#2-2-1-Java（或c、c-、c-等）\" class=\"headerlink\" title=\"2.2.1.    Java（或c、c++、c#等）\"></a>2.2.1.    Java（或c、c++、c#等）</h3><p>真正的读好下面几本书，java基础应该很扎实了。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">《Java编程思想》</div><div class=\"line\">《Java并发编程实战》</div><div class=\"line\">《Effective Java》</div><div class=\"line\">《分布式java应用 基础与实践》</div></pre></td></tr></table></figure>\n<p>事实上JVM的内存模型理应是Java程序员的基础知识。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">《深入理解Java虚拟机:JVM高级特性与最佳实践(第2版)》</div><div class=\"line\">《Java虚拟机规范》</div></pre></td></tr></table></figure>\n<p>如果涉及到其它方面(如web开发，网络编程)，当然还要学很多。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">《TCP/IP详解 卷1：协议》</div><div class=\"line\">...</div></pre></td></tr></table></figure>\n<p>基本的应用框架(如Spring/MyBatis、Shiro)及类库(如guava,commons包)肯定要熟悉的, 至少要明白实现的原理，如果能深入研究源码肯定是最好的。</p>\n<h3 id=\"2-2-2-脚本语言python-或ruby等\"><a href=\"#2-2-2-脚本语言python-或ruby等\" class=\"headerlink\" title=\"2.2.2.    脚本语言python(或ruby等)\"></a>2.2.2.    脚本语言python(或ruby等)</h3><h4 id=\"1-为什么要学脚本语言？\"><a href=\"#1-为什么要学脚本语言？\" class=\"headerlink\" title=\"(1) 为什么要学脚本语言？\"></a>(1) 为什么要学脚本语言？</h4><p>为什么要学脚本语言，因为他们实在是太方便了，很多时候我们需要写点小工具或是脚本来帮我们解决问题，你就会发现正规的编程语言太难用了。<br>    脚本语言学习简单上手快速，可以让你摆脱对底层语言的恐惧感，可以让你很快开发出能用得上的小程序。例如：</p>\n<ul>\n<li>处理文本文件，如csv文件，系统产生的log文件等</li>\n<li>遍历本地文件系统 (sys, os, path), 例如写一个程序统计一个目录下所有文件大小并按各种条件排序并保存结果。</li>\n<li>方便与数据库打交道。</li>\n<li>一些测试数据，用脚本语言非常容易生成。</li>\n</ul>\n<p>我为什么要推荐python呢？大家可以看一下Eric Raymond的Why Python?<br>我简单总结python的几个优点：</p>\n<ul>\n<li>它很简单易读;</li>\n<li>它接近自然语言;</li>\n<li>第三方库成熟、适用面广;</li>\n</ul>\n<p>学习参考书：<br>《Python核心编程（第二版）》 （美）丘恩（Chun，W.J.）</p>\n<h4 id=\"2-亲身经历\"><a href=\"#2-亲身经历\" class=\"headerlink\" title=\"(2) 亲身经历\"></a>(2) 亲身经历</h4><p>下面的例子都是我用脚本语言(perl/python)写的。</p>\n<p>(1)    生成测试数据(建行团经常用) </p>\n<p>生成随机数并保存到文件</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#!/usr/bin/python2.7 </span></div><div class=\"line\"><span class=\"comment\"># -*- coding: utf-8 -*- </span></div><div class=\"line\"><span class=\"keyword\">import</span> sys </div><div class=\"line\"><span class=\"keyword\">import</span> random </div><div class=\"line\"> </div><div class=\"line\"><span class=\"string\">''' </span></div><div class=\"line\">生成随机数并保存到文件（可根据已生成的随机数文件生成） </div><div class=\"line\">genRand.py   minValue maxValue number bit rand_file  </div><div class=\"line\">python genRand.py 0 100 10 5 rand_file </div><div class=\"line\">@args     minValue  值范围最小值 0 </div><div class=\"line\">@args     maxValue  值范围最小值 1000 </div><div class=\"line\">@args     number 个数 </div><div class=\"line\">@args     bit 位数 </div><div class=\"line\">@args     rand_file 已生成的随机数文件(每行有一个数字串) </div><div class=\"line\">''' </div><div class=\"line\"> </div><div class=\"line\">s = set() </div><div class=\"line\"> </div><div class=\"line\"><span class=\"comment\">#格式化数字 </span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">format</span><span class=\"params\">(v, bit)</span>:</span> </div><div class=\"line\">    format_str = <span class=\"string\">'%0'</span>+str(bit)+<span class=\"string\">'d'</span> </div><div class=\"line\">    <span class=\"keyword\">return</span> format_str % v </div><div class=\"line\"> </div><div class=\"line\"><span class=\"comment\">#生成随机数 </span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span>  <span class=\"title\">rand</span><span class=\"params\">(minValue, maxValue, bit)</span> :</span> </div><div class=\"line\">    randint = random.randint(minValue, maxValue) </div><div class=\"line\">    v = format(randint, bit) </div><div class=\"line\">    <span class=\"keyword\">while</span>  v <span class=\"keyword\">in</span> s :  </div><div class=\"line\">        randint = random.randint(minValue, maxValue) </div><div class=\"line\">        v = format(randint, bit) </div><div class=\"line\">    <span class=\"keyword\">return</span> v </div><div class=\"line\">     </div><div class=\"line\"><span class=\"comment\">#生成所有随机数 </span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span>  <span class=\"title\">randAll</span><span class=\"params\">(minValue, maxValue, number , bit)</span>:</span> </div><div class=\"line\">    i = <span class=\"number\">0</span> </div><div class=\"line\">    rand_list = [] </div><div class=\"line\">    <span class=\"keyword\">while</span> i &lt; number : </div><div class=\"line\">        i += <span class=\"number\">1</span> </div><div class=\"line\">        v = rand(minValue, maxValue , bit) </div><div class=\"line\">        s.add(v) </div><div class=\"line\">        rand_list.append(v) </div><div class=\"line\">    <span class=\"keyword\">return</span> rand_list </div><div class=\"line\"> </div><div class=\"line\"> </div><div class=\"line\"><span class=\"comment\">#从文件中读取随机数 </span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span>  <span class=\"title\">readRandFile</span><span class=\"params\">(rand_file)</span>:</span> </div><div class=\"line\">    f = open(rand_file) </div><div class=\"line\">    lines = f.readlines() </div><div class=\"line\">    <span class=\"keyword\">for</span> line <span class=\"keyword\">in</span> lines  : </div><div class=\"line\">        line=line.rstrip() </div><div class=\"line\">        s.add(line) </div><div class=\"line\"> </div><div class=\"line\"><span class=\"comment\">#将随机数保存到文件中 </span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span>  <span class=\"title\">writeRandToFile</span><span class=\"params\">(list)</span>:</span> </div><div class=\"line\">    fw = open(<span class=\"string\">\"out\"</span>,<span class=\"string\">'w'</span>) </div><div class=\"line\">    <span class=\"keyword\">for</span> v <span class=\"keyword\">in</span> list  : </div><div class=\"line\">        fw.write(str(v)+<span class=\"string\">'\\n'</span>); </div><div class=\"line\"> </div><div class=\"line\"> </div><div class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>: </div><div class=\"line\">    lenArgc = len(sys.argv) </div><div class=\"line\">    <span class=\"keyword\">if</span> lenArgc &gt;=<span class=\"number\">5</span> :  </div><div class=\"line\">        minValue = int(sys.argv[<span class=\"number\">1</span>]) </div><div class=\"line\">        maxValue = int(sys.argv[<span class=\"number\">2</span>]) </div><div class=\"line\">        number = int(sys.argv[<span class=\"number\">3</span>]) </div><div class=\"line\">        bit = int(sys.argv[<span class=\"number\">4</span>]) </div><div class=\"line\">        <span class=\"keyword\">if</span> lenArgc &gt; <span class=\"number\">5</span>    : </div><div class=\"line\">            rand_file = sys.argv[<span class=\"number\">5</span>]         </div><div class=\"line\">            readRandFile(rand_file)    <span class=\"comment\">#从文件中读取随机数     </span></div><div class=\"line\"> </div><div class=\"line\">        <span class=\"comment\">#生成随机数 </span></div><div class=\"line\">        rand_list = randAll(minValue, maxValue, number , bit) </div><div class=\"line\">        writeRandToFile(rand_list) </div><div class=\"line\">    <span class=\"keyword\">else</span> : </div><div class=\"line\">        <span class=\"keyword\">print</span> <span class=\"string\">\"参数不正确！\"</span></div></pre></td></tr></table></figure>\n<p>(2)    读取execl(hui99的操作定义)生成Selenium脚本</p>\n<p>execl的数据列有以下，</p>\n<p><img src=\"/images/2015/0409/01.png\" alt=\"01\"></p>\n<p>用脚本去读取execl文件，获取相关数据信息，生成selenium脚本文件并执行。<br>不生成selenium脚本文件，生成sql文件也行，但并非每个人都能直接操作数据库的。</p>\n<p>(3)    mp3 tag操作</p>\n<p>电脑下了n多mp3文件，你怎么读取mp3里的tag信息，里面的很多标签都乱七八糟的,如何去修改呢?一个一个文件属性去修改？ python里有非常简单的类库。</p>\n<p><img src=\"/images/2015/0409/02.png\" alt=\"01\"></p>\n<p>(4)    文件重命名</p>\n<p>你下载了数G的电视剧/动画片,文件名又乱又长，怎么办？</p>\n<p>我确实遇到过这种事情。</p>\n<p>柯南都500多集，海贼王400多集、棋魂、灌篮高手等，美剧都六七季，一季20集。你就别想手动修改了，会死人的。</p>\n<p>用脚本语言一下了就可以搞定，linux shell也可以轻松制定。</p>\n<p>美好生活就是如此的简单。</p>\n<h2 id=\"2-3-集成开发环境IDE-不细谈\"><a href=\"#2-3-集成开发环境IDE-不细谈\" class=\"headerlink\" title=\"2.3.    集成开发环境IDE [不细谈]\"></a>2.3.    集成开发环境IDE [不细谈]</h2><h2 id=\"2-4-构建工具\"><a href=\"#2-4-构建工具\" class=\"headerlink\" title=\"2.4.    构建工具\"></a>2.4.    构建工具</h2><p>使用自动构建工具的理由：</p>\n<ul>\n<li>(1)    在非图形化界面下构建程序；</li>\n<li>(2)    构建过程繁琐而且步骤固定，自动构建工具比交互式的手动构建省事省心；</li>\n<li>(3)    多人分别为同一个项目工作，需要有统一和一致的构建环境，比如类库依赖。</li>\n</ul>\n<p>ant/maven在几年前还不错，到了现在(2015年)已经略显沉重。我这里推荐gradle。我从13年就开始用gradle,上手简单，值得拥有。</p>\n<h2 id=\"2-5-开发最佳实践-具体内容可参考我3月份写的”应用开发部署实践-doc”\"><a href=\"#2-5-开发最佳实践-具体内容可参考我3月份写的”应用开发部署实践-doc”\" class=\"headerlink\" title=\"2.5.    开发最佳实践(具体内容可参考我3月份写的”应用开发部署实践.doc”)\"></a>2.5.    开发最佳实践(具体内容可参考我3月份写的”应用开发部署实践.doc”)</h2><h3 id=\"2-5-1-url怎样才是友好的\"><a href=\"#2-5-1-url怎样才是友好的\" class=\"headerlink\" title=\"2.5.1.    url怎样才是友好的?\"></a>2.5.1.    url怎样才是友好的?</h3><p>阿烈：为什么我会提到url的问题？</p>\n<p>产品运营天天跟你闹：URL太长了，URL参数太多了，URL太乱了，这样搜索引擎搜不到我们的产品啊？你要怎么办？</p>\n<p><img src=\"/images/2015/0409/03.png\" alt=\"01\"></p>\n<p>###2.5.2.    调用第三方接口应该注意什么？</p>\n<p><img src=\"/images/2015/0409/04.png\" alt=\"01\"></p>\n<p>###2.5.3.    图片处理（压缩，水印等）</p>\n<p>阿烈：为什么hui99的图片处理这么烂？</p>\n<p>压缩的效果太差了!</p>\n<p><img src=\"/images/2015/0409/05.png\" alt=\"01\"></p>\n<p>###2.5.4.    测试、设计模式等等</p>\n<p>#3.    数据库技术[不细谈]</p>\n<p>能有dba级别肯定牛，但这种人可能会比较少。</p>\n<p>但也至少熟练应用mysql(或其它关系数据库), 知道SQL优化。</p>\n<p>#4.    其它??（上面提到的都不是本文所讲内容的关键）</p>\n<p>我们从一个网站从小到大引起的架构变迁，来看待这个问题！</p>\n<p>这里以豆瓣为例。具体内容请点击<a href=\"http://www.infoq.com/cn/presentations/hongqn-douban\" target=\"_blank\" rel=\"external\">豆瓣网技术架构变迁</a>。</p>\n<p>##4.1.    网站架构变迁路线</p>\n<p>###4.1.1.    单机模式<br>这一阶段没有太大的访问量，甚至只有一台服务器就搞定了所有的访问。压力不高。<br>应用服务器和数据库放在同一台机子上，前端可能还会架设web服务器(IIS/apache/nginx等)，实现动静分离。</p>\n<p><img src=\"/images/2015/0409/41.png\" alt=\"01\"></p>\n<p><img src=\"/images/2015/0409/42.png\" alt=\"01\"></p>\n<p>###4.1.2.    数据库分离<br>压力增大，出现瓶颈，开始分离数据库。</p>\n<p><img src=\"/images/2015/0409/43.png\" alt=\"01\"></p>\n<p><img src=\"/images/2015/0409/44.png\" alt=\"01\"></p>\n<p><img src=\"/images/2015/0409/45.png\" alt=\"01\"></p>\n<p>###4.1.3.    数据库主从复制与读写分离<br>网站初具规模，DB压力大增，单独的一台DB已经满足不了现在的访问量，开始考虑读写分离的Master-slave库，使用三个及以上的服务器。</p>\n<p>访问量继续增加，增加到了DB的压力在Master的机器上非常的明显了，Master开始出现吃不消的情况，出现写耗尽。主从也已经不能满足要求，需要进一步解决负载问题，此时要引入Mysql Proxy程序，进行中间层代理，实现负载均衡，易于扩展。</p>\n<p>注：读写分离采用的方法是写数据库时在一个数据库上写入，而要读取时则从多个其他的数据库中读取，通常将用于写入的库称为master库，用于读取的库为slave库。读写分离适用于读多写少，并允许一定延时的业务中。</p>\n<p><img src=\"/images/2015/0409/46.png\" alt=\"01\"></p>\n<p><img src=\"/images/2015/0409/47.png\" alt=\"01\"></p>\n<p><img src=\"/images/2015/0409/48.png\" alt=\"01\"></p>\n<p>###4.1.4.    架设应用服务器集群<br>随着访问数的增长，单台应用服务器已经不能响应如此多的请求，必须要架设应用服务器集群了。</p>\n<p><img src=\"/images/2015/0409/49.png\" alt=\"01\"></p>\n<p><img src=\"/images/2015/0409/50.png\" alt=\"01\"></p>\n<p><img src=\"/images/2015/0409/51.png\" alt=\"01\"></p>\n<p>###4.1.5.    数据库分库分表</p>\n<p>在系统发展的初期，通常会将各种不同的数据库放在同一个数据库中，随着业务的多元化及业务的水平伸缩，数据库的连接数会成为稀缺和资源，对于这种情况分库是个不错的选择。</p>\n<p>分库通常按照业务领域将原来存储在同一个数据库的数据拆分到多个数据库中。例如ebay就按照其业务领域分为商品、用户、评价、交易等数据库，每个数据库只用于处理相关业务的数据，因此可用的数据库连接数会得到很大提升。</p>\n<p>分表意味着我们可以将同一数据表中的记录通过特定的算法进行分离，分别保存在不同的数据库表中，从而可以部署在不同的数据库服务器上。</p>\n<p><img src=\"/images/2015/0409/53.png\" alt=\"01\"></p>\n<p><img src=\"/images/2015/0409/54.png\" alt=\"01\"></p>\n<p><img src=\"/images/2015/0409/55.png\" alt=\"01\"></p>\n<p>###4.1.6.    NoSQL？其它？</p>\n<p>##4.2.    架构变迁带来的问题</p>\n<p>####(1)    你如何知道系统的瓶颈在哪？<br>大家也看得出来，访问量的不断增大导致了架构的不断变迁。访问量的增大导致了系统出现瓶颈，而不能满足用户的请求了。</p>\n<p>通常瓶颈的表象是资源消耗过多、外部处理系统的性能不足，或者资源消耗不多，但程序的响应速度却仍达不到要求(建行团有一次秒杀时遇到到这种问题)。</p>\n<p>资源主要消耗在CPU、文件IO、网络IO以及内存方面，机器有资源是有限的，当某资源消耗过多时，通常会造成系统的响应速度慢。</p>\n<p>你怎么知道系统出现了瓶颈了呢？出现的瓶颈在哪里呢？</p>\n<p>###(2)    你如何架设这些服务器？</p>\n<p>###(3)    你如何监控这些服务器？<br>你不监控，你就不知道系统的瓶颈在哪，性能优化、架构变迁也就无从谈起！</p>\n<p>而且网络状况复杂，难以保证7×24小时100%的在线，你当然不希望自己网站或者服务器由于各种原因而不能访问。</p>\n<p>故障的原因主要：</p>\n<ul>\n<li>网站被挂马。网站一旦有漏洞，被挂马是常有的事。</li>\n<li>网站代码出错、数据库出错、网站占CPU太高、空间占满、空间过期。</li>\n<li>域名解析出错、域名过期。</li>\n<li>网站或者服务器由于有害信息、备案等原因被关或封IP。</li>\n<li>网站或者服务器被攻击。同台服务器网站或者网段被攻击也殃及池鱼。</li>\n<li>服务器出现故障或者需要维护。</li>\n<li>网络运营商线路出现故障，特别是南北互通。</li>\n</ul>\n<p>很多故障是不定时、不可预料的。最勤快的站长网管都不可能24小时去刷新网页，去Ping服务器。这自然需要自动的监控服务。</p>\n<p>###(4)    集群化，对开发的影响？存储、缓存、session等</p>\n<p>###(5)    数据库扩展(主从复制和读写分离,分库,分表)的过程中,你要做什么？</p>\n<p>##4.3.    日常工作中的问题</p>\n<p>也许大家会说，我们的网站的访问量这么少，还没有必要考虑上面的问题。<br>好，我列出工作中一些问题:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">(1)\t为什么我们的服务器都是windows机器，而不是linux</div><div class=\"line\">(2)\thui99存储空间不足，导致hui99邮件服务器挂掉。</div><div class=\"line\">(3)\t北京农商行,手机银行服务端连接到网银服务器，为什么自己写负载均衡策略？</div><div class=\"line\">(4)\t为什么建行团，迁移机房后，远程登录用户不用administrator了。</div><div class=\"line\">(5)\t21的数据服务器僵死，导致hui99的tomcat线程到达200,而不能提供正常服务！(2012-03-25)</div><div class=\"line\">(6)\t建行团有一个200M的日志文件，你如何查看其内容？如果是2G的呢?(一般的文件编辑器打不开这么大的)</div><div class=\"line\">(7)\t建行团秒杀过程中，如何监控CPU，内存，磁盘IO等？</div><div class=\"line\">(8)\t如何提供7*24*365的服务(项目更新必须停机重起，服务会暂停)?</div><div class=\"line\">(9) ...</div></pre></td></tr></table></figure>\n<p>##4.4.    问题的实质是什么？</p>\n<p>服务器（集群）架设。</p>\n<p>服务器的监控。</p>\n<p>服务器的优化。</p>\n<p>服务器的安全。</p>\n<p>。。。</p>\n<p>实现这些，你还需要掌握运维的知识。</p>\n<p>那什么是运维呢？<br>运维关键技术点：</p>\n<ul>\n<li>大量高并发网站的设计方案 ；</li>\n<li>高可靠、高可伸缩性网络架构设计；</li>\n<li>网站安全问题，如何避免被黑？</li>\n<li>南北互联问题,动态CDN解决方案；</li>\n<li>海量数据存储架构;</li>\n<li>等等…</li>\n</ul>\n<p>#5.    如何写出高性能的系统?<br>从当当网上搜”高性能”，你可以看到下面列出来的图书：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">《高性能Linux服务器构建实战:运维监控、性能调优与集群应用》</div><div class=\"line\">《高性能网站建设指南》</div><div class=\"line\">《高性能MYSQL影印版》</div><div class=\"line\">《构建高性能Web站点》</div><div class=\"line\">《实战Nginx：取代Apache的高性能Web服务器》</div><div class=\"line\">………</div></pre></td></tr></table></figure>\n<p>一个高性能的系统，不仅涉及到开发的程序代码，也与服务器、数据库、web服务器等息息相关。</p>\n<p>罗马不是一日建成的，高性能系统不是一下子就能实现的？高性能系统是PDCA（Plan Do Check Act）持续改善的过程，是开发、上线、监控、优化反复循环的过程。</p>\n<p>#6.    结论：开发者需要什么技能？</p>\n<p>(1)    开发技术</p>\n<p>(2)    数据库技术</p>\n<p>(3)    运维技术</p>\n<p>技术之间是相辅相成的。</p>\n<p>#7.    知道结论后，我做了什么？</p>\n<p>(1)    学习linux</p>\n<p>(2)    参加运维培训班</p>\n<p>(3)    学习python</p>\n<p>(4)    多思考、总结、实践</p>\n<p>#8.    参考资料<br>(1)    Java应用运维 by bluedavy </p>\n<p><a href=\"http://blog.bluedavy.com/?p=363\" target=\"_blank\" rel=\"external\">http://blog.bluedavy.com/?p=363</a></p>\n<p>(2)    我们需要专职的QA吗？ by 陈皓</p>\n<p><a href=\"http://coolshell.cn/articles/6994.html\" target=\"_blank\" rel=\"external\">http://coolshell.cn/articles/6994.html</a></p>\n<p>(3)    程序员技术练级攻略 by 陈皓</p>\n<p><a href=\"http://coolshell.cn/articles/4990.html\" target=\"_blank\" rel=\"external\">http://coolshell.cn/articles/4990.html</a></p>\n<p>(4)    Why Python? By Eric Raymond</p>\n<p><a href=\"http://www.linuxjournal.com/article/3882\" target=\"_blank\" rel=\"external\">http://www.linuxjournal.com/article/3882</a></p>\n<p>Eric Raymond的Why Python?的中文翻译</p>\n<p><a href=\"http://blog.donews.com/ygao/archive/2005/10/25/602051.aspx\" target=\"_blank\" rel=\"external\">http://blog.donews.com/ygao/archive/2005/10/25/602051.aspx</a></p>\n<p>(5)    程序员需要具备的基本技能 by 陈皓</p>\n<p><a href=\"http://coolshell.cn/articles/428.html\" target=\"_blank\" rel=\"external\">http://coolshell.cn/articles/428.html</a></p>\n<hr>\n<p>初稿写于2012年5月，2015年4月9日修改了部分内容。</p>\n<p>(全书完)</p>\n","excerpt":"<p>这是我在2012年5月写下的总结性的文章。昨晚我重新阅读了一遍，然后调整了一些内容，但总体的思想没有变。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div></pre></td><td class=\"code\"><pre><div class=\"line\">目录</div><div class=\"line\"> 1. 概述</div><div class=\"line\">  2.    开发技术</div><div class=\"line\">   2.1. 编程素养</div><div class=\"line\">   (1）算法类</div><div class=\"line\">   (2) 提升类</div><div class=\"line\">   2.2. 编程语言</div><div class=\"line\">    2.2.1.  Java（或c、c++、c# 等）</div><div class=\"line\">    2.2.2.  脚本语言python(或ruby等)</div><div class=\"line\">     (1) 为什么要学脚本语言？</div><div class=\"line\">     (2) 亲身经历</div><div class=\"line\">   2.3. 集成开发环境IDE [不细谈]</div><div class=\"line\">   2.4. 构建工具</div><div class=\"line\">   2.5. 开发最佳实践(具体内容可参考我3月份写的&quot;应用开发部署实践.doc&quot;)</div><div class=\"line\">    2.5.1.  url怎样才是友好的?</div><div class=\"line\">   2.5.2.   调用第三方接口应该注意什么？</div><div class=\"line\">   2.5.3.   图片处理（压缩，水印等）</div><div class=\"line\">   2.5.4.   测试、设计模式等等</div><div class=\"line\"> 3. 数据库技术[不细谈]</div><div class=\"line\"> 4. 其它??（上面提到的都不是本文所讲内容的关键）</div><div class=\"line\">  4.1.  网站架构变迁路线</div><div class=\"line\">   4.1.1.   单机模式</div><div class=\"line\">   4.1.2.   数据库分离</div><div class=\"line\">   4.1.3.   数据库主从复制与读写分离</div><div class=\"line\">   4.1.4.   架设应用服务器集群</div><div class=\"line\">   4.1.5.   数据库分库分表</div><div class=\"line\">   4.1.6.   NoSQL？其它？</div><div class=\"line\">  4.2.  架构变迁带来的问题</div><div class=\"line\">    (1) 你如何知道系统的瓶颈在哪？</div><div class=\"line\">   (2)  你如何架设这些服务器？</div><div class=\"line\">   (3)  你如何监控这些服务器？</div><div class=\"line\">   (4)  集群化，对开发的影响？存储、缓存、session等</div><div class=\"line\">   (5)  数据库扩展(主从复制和读写分离,分库,分表)的过程中,你要做什么？</div><div class=\"line\">  4.3.  日常工作中的问题</div><div class=\"line\">  4.4.  问题的实质是什么？</div><div class=\"line\"> 5. 如何写出高性能的系统?</div><div class=\"line\"> 6. 结论：开发者需要什么技能？</div><div class=\"line\"> 7. 知道结论后，我做了什么？</div><div class=\"line\"> 8. 参考资料</div></pre></td></tr></table></figure>","more":"<p>#1.    概述</p>\n<p>从去年(2011)开始，我就陆续学习jvm调优、数据库调优等知识,但到现在(2012年5月)也只是懂一点皮毛。</p>\n<p>今天春节过来后，开始关注集群与负载均衡方面的内容。2月份北京出差回来后，总结了URL友好性、jvm优化、web组件优化、集群与负载均衡等方面的内容，写了一份《应用开发部署实践》的文档，但许多内容还在完善中。</p>\n<p>这期间看了很多人的博客，对照自身的工作经历，不得不让人有感而发，是要总结点东西才行，于是写下了这篇文章。</p>\n<p>从技术上面说，开发人员需要什么技能？可能每个人的看法都不一样。这里我只写了我个人当前的一些想法，想法对与错? 还需要自己思考辨别，或用时间来证明吧！</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">开发人员需要的技能</div><div class=\"line\">(1)编程语言是基础，必须要掌握(怎么样才能称为掌握呢？)。</div><div class=\"line\">(2)工作中的最佳实践你是需要了解的。但要明确的是，标准总是在不断变化的，最佳实践可能也会过时，不要让最佳实践阻止了我们持续改进。</div><div class=\"line\">(3)数据库知识(备份/还原,sql语句等)要了解吧。</div></pre></td></tr></table></figure>\n<p>但仅有这些知识就足够了吗？<br>开发完成了，要上线！上线就要考虑服务器的架设和优化；</p>\n<p>程序或服务不能提供正常的服务了，我们也希望立即得到反馈的吧！</p>\n<p>对一些高并发的应用，你要时时监控服务器(集群)的资源(CPU、IO、内存等的…).</p>\n<p>而且你只有真正去运维自己的系统，你才知道怎么在程序里写日志，做监控，做统计…</p>\n<p>这就是本文所讲内容的重点。</p>\n<p>本文的主要脉络如下：</p>\n<p>(1)    先简要的说明了开发技术和数据库技术。开发技术以java为例，说明了要学习脚本语言(python)、总结开发最佳实践等。但像类似lucune等的技术其实也很重要，但在这里尚未提及。</p>\n<p>(2)    接着以网站架构的变迁路线和自己的工作中的问题为例，说明了开发人员其实还要学习运维。</p>\n<p>(3)    知道结论后，我采取什么行动!</p>\n<!-- more -->\n<h1 id=\"2-开发技术\"><a href=\"#2-开发技术\" class=\"headerlink\" title=\"2.    开发技术\"></a>2.    开发技术</h1><h2 id=\"2-1-编程素养\"><a href=\"#2-1-编程素养\" class=\"headerlink\" title=\"2.1.    编程素养\"></a>2.1.    编程素养</h2><p>###(1）算法篇</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">《算法导论》</div><div class=\"line\">《算法（第4版）》 塞奇威克 (Robert Sedgewick) / 韦恩 (Kevin Wayne)</div><div class=\"line\">leetcode算法题</div></pre></td></tr></table></figure>\n<p>coursera上的一些算法课也不错！</p>\n<p>如果你不满足于信息管理系统的CRUD操作，这块肯定要拿下的。</p>\n<p>###(2) 提升篇</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">《程序员修炼之道》</div><div class=\"line\">《黑客与画家》</div><div class=\"line\">《Unix编程艺术》</div><div class=\"line\">《代码大全》</div><div class=\"line\">《Effective Java》</div><div class=\"line\">《clean code》</div><div class=\"line\">《编写可读代码的艺术》</div><div class=\"line\">《编程之美》</div><div class=\"line\">《构建之法——现代软件工程》邹欣</div><div class=\"line\">《持续交付:发布可靠软件的系统方法》</div></pre></td></tr></table></figure>\n<h2 id=\"2-2-编程语言\"><a href=\"#2-2-编程语言\" class=\"headerlink\" title=\"2.2.    编程语言\"></a>2.2.    编程语言</h2><h3 id=\"2-2-1-Java（或c、c-、c-等）\"><a href=\"#2-2-1-Java（或c、c-、c-等）\" class=\"headerlink\" title=\"2.2.1.    Java（或c、c++、c#等）\"></a>2.2.1.    Java（或c、c++、c#等）</h3><p>真正的读好下面几本书，java基础应该很扎实了。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">《Java编程思想》</div><div class=\"line\">《Java并发编程实战》</div><div class=\"line\">《Effective Java》</div><div class=\"line\">《分布式java应用 基础与实践》</div></pre></td></tr></table></figure>\n<p>事实上JVM的内存模型理应是Java程序员的基础知识。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">《深入理解Java虚拟机:JVM高级特性与最佳实践(第2版)》</div><div class=\"line\">《Java虚拟机规范》</div></pre></td></tr></table></figure>\n<p>如果涉及到其它方面(如web开发，网络编程)，当然还要学很多。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">《TCP/IP详解 卷1：协议》</div><div class=\"line\">...</div></pre></td></tr></table></figure>\n<p>基本的应用框架(如Spring/MyBatis、Shiro)及类库(如guava,commons包)肯定要熟悉的, 至少要明白实现的原理，如果能深入研究源码肯定是最好的。</p>\n<h3 id=\"2-2-2-脚本语言python-或ruby等\"><a href=\"#2-2-2-脚本语言python-或ruby等\" class=\"headerlink\" title=\"2.2.2.    脚本语言python(或ruby等)\"></a>2.2.2.    脚本语言python(或ruby等)</h3><h4 id=\"1-为什么要学脚本语言？\"><a href=\"#1-为什么要学脚本语言？\" class=\"headerlink\" title=\"(1) 为什么要学脚本语言？\"></a>(1) 为什么要学脚本语言？</h4><p>为什么要学脚本语言，因为他们实在是太方便了，很多时候我们需要写点小工具或是脚本来帮我们解决问题，你就会发现正规的编程语言太难用了。<br>    脚本语言学习简单上手快速，可以让你摆脱对底层语言的恐惧感，可以让你很快开发出能用得上的小程序。例如：</p>\n<ul>\n<li>处理文本文件，如csv文件，系统产生的log文件等</li>\n<li>遍历本地文件系统 (sys, os, path), 例如写一个程序统计一个目录下所有文件大小并按各种条件排序并保存结果。</li>\n<li>方便与数据库打交道。</li>\n<li>一些测试数据，用脚本语言非常容易生成。</li>\n</ul>\n<p>我为什么要推荐python呢？大家可以看一下Eric Raymond的Why Python?<br>我简单总结python的几个优点：</p>\n<ul>\n<li>它很简单易读;</li>\n<li>它接近自然语言;</li>\n<li>第三方库成熟、适用面广;</li>\n</ul>\n<p>学习参考书：<br>《Python核心编程（第二版）》 （美）丘恩（Chun，W.J.）</p>\n<h4 id=\"2-亲身经历\"><a href=\"#2-亲身经历\" class=\"headerlink\" title=\"(2) 亲身经历\"></a>(2) 亲身经历</h4><p>下面的例子都是我用脚本语言(perl/python)写的。</p>\n<p>(1)    生成测试数据(建行团经常用) </p>\n<p>生成随机数并保存到文件</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#!/usr/bin/python2.7 </span></div><div class=\"line\"><span class=\"comment\"># -*- coding: utf-8 -*- </span></div><div class=\"line\"><span class=\"keyword\">import</span> sys </div><div class=\"line\"><span class=\"keyword\">import</span> random </div><div class=\"line\"> </div><div class=\"line\"><span class=\"string\">''' </div><div class=\"line\">生成随机数并保存到文件（可根据已生成的随机数文件生成） </div><div class=\"line\">genRand.py   minValue maxValue number bit rand_file  </div><div class=\"line\">python genRand.py 0 100 10 5 rand_file </div><div class=\"line\">@args     minValue  值范围最小值 0 </div><div class=\"line\">@args     maxValue  值范围最小值 1000 </div><div class=\"line\">@args     number 个数 </div><div class=\"line\">@args     bit 位数 </div><div class=\"line\">@args     rand_file 已生成的随机数文件(每行有一个数字串) </div><div class=\"line\">'''</span> </div><div class=\"line\"> </div><div class=\"line\">s = set() </div><div class=\"line\"> </div><div class=\"line\"><span class=\"comment\">#格式化数字 </span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">format</span><span class=\"params\">(v, bit)</span>:</span> </div><div class=\"line\">    format_str = <span class=\"string\">'%0'</span>+str(bit)+<span class=\"string\">'d'</span> </div><div class=\"line\">    <span class=\"keyword\">return</span> format_str % v </div><div class=\"line\"> </div><div class=\"line\"><span class=\"comment\">#生成随机数 </span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span>  <span class=\"title\">rand</span><span class=\"params\">(minValue, maxValue, bit)</span> :</span> </div><div class=\"line\">    randint = random.randint(minValue, maxValue) </div><div class=\"line\">    v = format(randint, bit) </div><div class=\"line\">    <span class=\"keyword\">while</span>  v <span class=\"keyword\">in</span> s :  </div><div class=\"line\">        randint = random.randint(minValue, maxValue) </div><div class=\"line\">        v = format(randint, bit) </div><div class=\"line\">    <span class=\"keyword\">return</span> v </div><div class=\"line\">     </div><div class=\"line\"><span class=\"comment\">#生成所有随机数 </span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span>  <span class=\"title\">randAll</span><span class=\"params\">(minValue, maxValue, number , bit)</span>:</span> </div><div class=\"line\">    i = <span class=\"number\">0</span> </div><div class=\"line\">    rand_list = [] </div><div class=\"line\">    <span class=\"keyword\">while</span> i &lt; number : </div><div class=\"line\">        i += <span class=\"number\">1</span> </div><div class=\"line\">        v = rand(minValue, maxValue , bit) </div><div class=\"line\">        s.add(v) </div><div class=\"line\">        rand_list.append(v) </div><div class=\"line\">    <span class=\"keyword\">return</span> rand_list </div><div class=\"line\"> </div><div class=\"line\"> </div><div class=\"line\"><span class=\"comment\">#从文件中读取随机数 </span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span>  <span class=\"title\">readRandFile</span><span class=\"params\">(rand_file)</span>:</span> </div><div class=\"line\">    f = open(rand_file) </div><div class=\"line\">    lines = f.readlines() </div><div class=\"line\">    <span class=\"keyword\">for</span> line <span class=\"keyword\">in</span> lines  : </div><div class=\"line\">        line=line.rstrip() </div><div class=\"line\">        s.add(line) </div><div class=\"line\"> </div><div class=\"line\"><span class=\"comment\">#将随机数保存到文件中 </span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span>  <span class=\"title\">writeRandToFile</span><span class=\"params\">(list)</span>:</span> </div><div class=\"line\">    fw = open(<span class=\"string\">\"out\"</span>,<span class=\"string\">'w'</span>) </div><div class=\"line\">    <span class=\"keyword\">for</span> v <span class=\"keyword\">in</span> list  : </div><div class=\"line\">        fw.write(str(v)+<span class=\"string\">'\\n'</span>); </div><div class=\"line\"> </div><div class=\"line\"> </div><div class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>: </div><div class=\"line\">    lenArgc = len(sys.argv) </div><div class=\"line\">    <span class=\"keyword\">if</span> lenArgc &gt;=<span class=\"number\">5</span> :  </div><div class=\"line\">        minValue = int(sys.argv[<span class=\"number\">1</span>]) </div><div class=\"line\">        maxValue = int(sys.argv[<span class=\"number\">2</span>]) </div><div class=\"line\">        number = int(sys.argv[<span class=\"number\">3</span>]) </div><div class=\"line\">        bit = int(sys.argv[<span class=\"number\">4</span>]) </div><div class=\"line\">        <span class=\"keyword\">if</span> lenArgc &gt; <span class=\"number\">5</span>    : </div><div class=\"line\">            rand_file = sys.argv[<span class=\"number\">5</span>]         </div><div class=\"line\">            readRandFile(rand_file)    <span class=\"comment\">#从文件中读取随机数     </span></div><div class=\"line\"> </div><div class=\"line\">        <span class=\"comment\">#生成随机数 </span></div><div class=\"line\">        rand_list = randAll(minValue, maxValue, number , bit) </div><div class=\"line\">        writeRandToFile(rand_list) </div><div class=\"line\">    <span class=\"keyword\">else</span> : </div><div class=\"line\">        <span class=\"keyword\">print</span> <span class=\"string\">\"参数不正确！\"</span></div></pre></td></tr></table></figure>\n<p>(2)    读取execl(hui99的操作定义)生成Selenium脚本</p>\n<p>execl的数据列有以下，</p>\n<p><img src=\"/images/2015/0409/01.png\" alt=\"01\"></p>\n<p>用脚本去读取execl文件，获取相关数据信息，生成selenium脚本文件并执行。<br>不生成selenium脚本文件，生成sql文件也行，但并非每个人都能直接操作数据库的。</p>\n<p>(3)    mp3 tag操作</p>\n<p>电脑下了n多mp3文件，你怎么读取mp3里的tag信息，里面的很多标签都乱七八糟的,如何去修改呢?一个一个文件属性去修改？ python里有非常简单的类库。</p>\n<p><img src=\"/images/2015/0409/02.png\" alt=\"01\"></p>\n<p>(4)    文件重命名</p>\n<p>你下载了数G的电视剧/动画片,文件名又乱又长，怎么办？</p>\n<p>我确实遇到过这种事情。</p>\n<p>柯南都500多集，海贼王400多集、棋魂、灌篮高手等，美剧都六七季，一季20集。你就别想手动修改了，会死人的。</p>\n<p>用脚本语言一下了就可以搞定，linux shell也可以轻松制定。</p>\n<p>美好生活就是如此的简单。</p>\n<h2 id=\"2-3-集成开发环境IDE-不细谈\"><a href=\"#2-3-集成开发环境IDE-不细谈\" class=\"headerlink\" title=\"2.3.    集成开发环境IDE [不细谈]\"></a>2.3.    集成开发环境IDE [不细谈]</h2><h2 id=\"2-4-构建工具\"><a href=\"#2-4-构建工具\" class=\"headerlink\" title=\"2.4.    构建工具\"></a>2.4.    构建工具</h2><p>使用自动构建工具的理由：</p>\n<ul>\n<li>(1)    在非图形化界面下构建程序；</li>\n<li>(2)    构建过程繁琐而且步骤固定，自动构建工具比交互式的手动构建省事省心；</li>\n<li>(3)    多人分别为同一个项目工作，需要有统一和一致的构建环境，比如类库依赖。</li>\n</ul>\n<p>ant/maven在几年前还不错，到了现在(2015年)已经略显沉重。我这里推荐gradle。我从13年就开始用gradle,上手简单，值得拥有。</p>\n<h2 id=\"2-5-开发最佳实践-具体内容可参考我3月份写的”应用开发部署实践-doc”\"><a href=\"#2-5-开发最佳实践-具体内容可参考我3月份写的”应用开发部署实践-doc”\" class=\"headerlink\" title=\"2.5.    开发最佳实践(具体内容可参考我3月份写的”应用开发部署实践.doc”)\"></a>2.5.    开发最佳实践(具体内容可参考我3月份写的”应用开发部署实践.doc”)</h2><h3 id=\"2-5-1-url怎样才是友好的\"><a href=\"#2-5-1-url怎样才是友好的\" class=\"headerlink\" title=\"2.5.1.    url怎样才是友好的?\"></a>2.5.1.    url怎样才是友好的?</h3><p>阿烈：为什么我会提到url的问题？</p>\n<p>产品运营天天跟你闹：URL太长了，URL参数太多了，URL太乱了，这样搜索引擎搜不到我们的产品啊？你要怎么办？</p>\n<p><img src=\"/images/2015/0409/03.png\" alt=\"01\"></p>\n<p>###2.5.2.    调用第三方接口应该注意什么？</p>\n<p><img src=\"/images/2015/0409/04.png\" alt=\"01\"></p>\n<p>###2.5.3.    图片处理（压缩，水印等）</p>\n<p>阿烈：为什么hui99的图片处理这么烂？</p>\n<p>压缩的效果太差了!</p>\n<p><img src=\"/images/2015/0409/05.png\" alt=\"01\"></p>\n<p>###2.5.4.    测试、设计模式等等</p>\n<p>#3.    数据库技术[不细谈]</p>\n<p>能有dba级别肯定牛，但这种人可能会比较少。</p>\n<p>但也至少熟练应用mysql(或其它关系数据库), 知道SQL优化。</p>\n<p>#4.    其它??（上面提到的都不是本文所讲内容的关键）</p>\n<p>我们从一个网站从小到大引起的架构变迁，来看待这个问题！</p>\n<p>这里以豆瓣为例。具体内容请点击<a href=\"http://www.infoq.com/cn/presentations/hongqn-douban\">豆瓣网技术架构变迁</a>。</p>\n<p>##4.1.    网站架构变迁路线</p>\n<p>###4.1.1.    单机模式<br>这一阶段没有太大的访问量，甚至只有一台服务器就搞定了所有的访问。压力不高。<br>应用服务器和数据库放在同一台机子上，前端可能还会架设web服务器(IIS/apache/nginx等)，实现动静分离。</p>\n<p><img src=\"/images/2015/0409/41.png\" alt=\"01\"></p>\n<p><img src=\"/images/2015/0409/42.png\" alt=\"01\"></p>\n<p>###4.1.2.    数据库分离<br>压力增大，出现瓶颈，开始分离数据库。</p>\n<p><img src=\"/images/2015/0409/43.png\" alt=\"01\"></p>\n<p><img src=\"/images/2015/0409/44.png\" alt=\"01\"></p>\n<p><img src=\"/images/2015/0409/45.png\" alt=\"01\"></p>\n<p>###4.1.3.    数据库主从复制与读写分离<br>网站初具规模，DB压力大增，单独的一台DB已经满足不了现在的访问量，开始考虑读写分离的Master-slave库，使用三个及以上的服务器。</p>\n<p>访问量继续增加，增加到了DB的压力在Master的机器上非常的明显了，Master开始出现吃不消的情况，出现写耗尽。主从也已经不能满足要求，需要进一步解决负载问题，此时要引入Mysql Proxy程序，进行中间层代理，实现负载均衡，易于扩展。</p>\n<p>注：读写分离采用的方法是写数据库时在一个数据库上写入，而要读取时则从多个其他的数据库中读取，通常将用于写入的库称为master库，用于读取的库为slave库。读写分离适用于读多写少，并允许一定延时的业务中。</p>\n<p><img src=\"/images/2015/0409/46.png\" alt=\"01\"></p>\n<p><img src=\"/images/2015/0409/47.png\" alt=\"01\"></p>\n<p><img src=\"/images/2015/0409/48.png\" alt=\"01\"></p>\n<p>###4.1.4.    架设应用服务器集群<br>随着访问数的增长，单台应用服务器已经不能响应如此多的请求，必须要架设应用服务器集群了。</p>\n<p><img src=\"/images/2015/0409/49.png\" alt=\"01\"></p>\n<p><img src=\"/images/2015/0409/50.png\" alt=\"01\"></p>\n<p><img src=\"/images/2015/0409/51.png\" alt=\"01\"></p>\n<p>###4.1.5.    数据库分库分表</p>\n<p>在系统发展的初期，通常会将各种不同的数据库放在同一个数据库中，随着业务的多元化及业务的水平伸缩，数据库的连接数会成为稀缺和资源，对于这种情况分库是个不错的选择。</p>\n<p>分库通常按照业务领域将原来存储在同一个数据库的数据拆分到多个数据库中。例如ebay就按照其业务领域分为商品、用户、评价、交易等数据库，每个数据库只用于处理相关业务的数据，因此可用的数据库连接数会得到很大提升。</p>\n<p>分表意味着我们可以将同一数据表中的记录通过特定的算法进行分离，分别保存在不同的数据库表中，从而可以部署在不同的数据库服务器上。</p>\n<p><img src=\"/images/2015/0409/53.png\" alt=\"01\"></p>\n<p><img src=\"/images/2015/0409/54.png\" alt=\"01\"></p>\n<p><img src=\"/images/2015/0409/55.png\" alt=\"01\"></p>\n<p>###4.1.6.    NoSQL？其它？</p>\n<p>##4.2.    架构变迁带来的问题</p>\n<p>####(1)    你如何知道系统的瓶颈在哪？<br>大家也看得出来，访问量的不断增大导致了架构的不断变迁。访问量的增大导致了系统出现瓶颈，而不能满足用户的请求了。</p>\n<p>通常瓶颈的表象是资源消耗过多、外部处理系统的性能不足，或者资源消耗不多，但程序的响应速度却仍达不到要求(建行团有一次秒杀时遇到到这种问题)。</p>\n<p>资源主要消耗在CPU、文件IO、网络IO以及内存方面，机器有资源是有限的，当某资源消耗过多时，通常会造成系统的响应速度慢。</p>\n<p>你怎么知道系统出现了瓶颈了呢？出现的瓶颈在哪里呢？</p>\n<p>###(2)    你如何架设这些服务器？</p>\n<p>###(3)    你如何监控这些服务器？<br>你不监控，你就不知道系统的瓶颈在哪，性能优化、架构变迁也就无从谈起！</p>\n<p>而且网络状况复杂，难以保证7×24小时100%的在线，你当然不希望自己网站或者服务器由于各种原因而不能访问。</p>\n<p>故障的原因主要：</p>\n<ul>\n<li>网站被挂马。网站一旦有漏洞，被挂马是常有的事。</li>\n<li>网站代码出错、数据库出错、网站占CPU太高、空间占满、空间过期。</li>\n<li>域名解析出错、域名过期。</li>\n<li>网站或者服务器由于有害信息、备案等原因被关或封IP。</li>\n<li>网站或者服务器被攻击。同台服务器网站或者网段被攻击也殃及池鱼。</li>\n<li>服务器出现故障或者需要维护。</li>\n<li>网络运营商线路出现故障，特别是南北互通。</li>\n</ul>\n<p>很多故障是不定时、不可预料的。最勤快的站长网管都不可能24小时去刷新网页，去Ping服务器。这自然需要自动的监控服务。</p>\n<p>###(4)    集群化，对开发的影响？存储、缓存、session等</p>\n<p>###(5)    数据库扩展(主从复制和读写分离,分库,分表)的过程中,你要做什么？</p>\n<p>##4.3.    日常工作中的问题</p>\n<p>也许大家会说，我们的网站的访问量这么少，还没有必要考虑上面的问题。<br>好，我列出工作中一些问题:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">(1)\t为什么我们的服务器都是windows机器，而不是linux</div><div class=\"line\">(2)\thui99存储空间不足，导致hui99邮件服务器挂掉。</div><div class=\"line\">(3)\t北京农商行,手机银行服务端连接到网银服务器，为什么自己写负载均衡策略？</div><div class=\"line\">(4)\t为什么建行团，迁移机房后，远程登录用户不用administrator了。</div><div class=\"line\">(5)\t21的数据服务器僵死，导致hui99的tomcat线程到达200,而不能提供正常服务！(2012-03-25)</div><div class=\"line\">(6)\t建行团有一个200M的日志文件，你如何查看其内容？如果是2G的呢?(一般的文件编辑器打不开这么大的)</div><div class=\"line\">(7)\t建行团秒杀过程中，如何监控CPU，内存，磁盘IO等？</div><div class=\"line\">(8)\t如何提供7*24*365的服务(项目更新必须停机重起，服务会暂停)?</div><div class=\"line\">(9) ...</div></pre></td></tr></table></figure>\n<p>##4.4.    问题的实质是什么？</p>\n<p>服务器（集群）架设。</p>\n<p>服务器的监控。</p>\n<p>服务器的优化。</p>\n<p>服务器的安全。</p>\n<p>。。。</p>\n<p>实现这些，你还需要掌握运维的知识。</p>\n<p>那什么是运维呢？<br>运维关键技术点：</p>\n<ul>\n<li>大量高并发网站的设计方案 ；</li>\n<li>高可靠、高可伸缩性网络架构设计；</li>\n<li>网站安全问题，如何避免被黑？</li>\n<li>南北互联问题,动态CDN解决方案；</li>\n<li>海量数据存储架构;</li>\n<li>等等…</li>\n</ul>\n<p>#5.    如何写出高性能的系统?<br>从当当网上搜”高性能”，你可以看到下面列出来的图书：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">《高性能Linux服务器构建实战:运维监控、性能调优与集群应用》</div><div class=\"line\">《高性能网站建设指南》</div><div class=\"line\">《高性能MYSQL影印版》</div><div class=\"line\">《构建高性能Web站点》</div><div class=\"line\">《实战Nginx：取代Apache的高性能Web服务器》</div><div class=\"line\">………</div></pre></td></tr></table></figure>\n<p>一个高性能的系统，不仅涉及到开发的程序代码，也与服务器、数据库、web服务器等息息相关。</p>\n<p>罗马不是一日建成的，高性能系统不是一下子就能实现的？高性能系统是PDCA（Plan Do Check Act）持续改善的过程，是开发、上线、监控、优化反复循环的过程。</p>\n<p>#6.    结论：开发者需要什么技能？</p>\n<p>(1)    开发技术</p>\n<p>(2)    数据库技术</p>\n<p>(3)    运维技术</p>\n<p>技术之间是相辅相成的。</p>\n<p>#7.    知道结论后，我做了什么？</p>\n<p>(1)    学习linux</p>\n<p>(2)    参加运维培训班</p>\n<p>(3)    学习python</p>\n<p>(4)    多思考、总结、实践</p>\n<p>#8.    参考资料<br>(1)    Java应用运维 by bluedavy </p>\n<p><a href=\"http://blog.bluedavy.com/?p=363\">http://blog.bluedavy.com/?p=363</a></p>\n<p>(2)    我们需要专职的QA吗？ by 陈皓</p>\n<p><a href=\"http://coolshell.cn/articles/6994.html\">http://coolshell.cn/articles/6994.html</a></p>\n<p>(3)    程序员技术练级攻略 by 陈皓</p>\n<p><a href=\"http://coolshell.cn/articles/4990.html\">http://coolshell.cn/articles/4990.html</a></p>\n<p>(4)    Why Python? By Eric Raymond</p>\n<p><a href=\"http://www.linuxjournal.com/article/3882\">http://www.linuxjournal.com/article/3882</a></p>\n<p>Eric Raymond的Why Python?的中文翻译</p>\n<p><a href=\"http://blog.donews.com/ygao/archive/2005/10/25/602051.aspx\">http://blog.donews.com/ygao/archive/2005/10/25/602051.aspx</a></p>\n<p>(5)    程序员需要具备的基本技能 by 陈皓</p>\n<p><a href=\"http://coolshell.cn/articles/428.html\">http://coolshell.cn/articles/428.html</a></p>\n<hr>\n<p>初稿写于2012年5月，2015年4月9日修改了部分内容。</p>\n<p>(全书完)</p>"},{"title":"从Jekyll迁移到Hexo","date":"2017-01-26T11:06:32.000Z","_content":"\n我的博客以前由Jekyll搭建，但从 Jekyll 2升级到 Jekyll 3后，我发现自己开始关注于Jekyll及其模板本身而不是博文内容本身。故转而使用Hexo来搭建博客，并更换了更加简洁明快的next主题模板。如果想从Jekyll转到Hexo可以参考本文。\n\n<!-- more -->\n\n# 安装Hexo\n\n## 安装\n\n```\nnpm install -g hexo-cli\n```\n\nnode与hexo环境版本：\n\n```bash\n➜  ~ node -v\nv7.2.1\n➜  ~ hexo -v\nhexo-cli: 1.0.2\nos: Darwin 16.3.0 darwin x64\nhttp_parser: 2.7.0\nnode: 7.2.1\nv8: 5.4.500.44\nuv: 1.10.1\nzlib: 1.2.8\nares: 1.10.1-DEV\nmodules: 51\nopenssl: 1.0.2j\nicu: 58.1\nunicode: 9.0\ncldr: 30.0.2\ntz: 2016g\n```\n\n## 部署\n\n```\nhexo init quxionglie.com\ncd quxionglie.com\nnpm install\n```\n\n安装后目录\n\n```\n.\n├── _config.yml\n├── node_modules\n├── package.json\n├── scaffolds\n├── source\n└── themes\n\n4 directories, 2 files\n```\n\n<!-- more -->\n\n# Hexo常用命令\n## new - 生成新的blog\n\n```\nhexo new [layout] <title>\n```\n\n执行new命令，生成指定名称的文章至 source/posts/title.md。\n\n其中layout是可选参数，默认值为post。scaffolds目录下的文件名称就是layout名称。你也可以添加自己的layout，方法就是添加一个文件即可，同时你也可以编辑现有的layout，比如post的layout默认是scaffolds/post.md\n\n```\n➜  ls -l scaffolds\ntotal 24\n-rw-r--r--  1 quxl  staff  33 Jan 26 19:18 draft.md\n-rw-r--r--  1 quxl  staff  44 Jan 26 19:18 page.md\n-rw-r--r--  1 quxl  staff  50 Jan 26 19:18 post.md\n\n➜  cat scaffolds/post.md\n---\ntitle: {{ title }}\ndate: {{ date }}\ntags:\n---\n```\n\n参考：[writing](https://hexo.io/docs/writing.html)\n\n## server - 启动服务器\n\n```\nhexo server\n```\n\n参考：[server](https://hexo.io/docs/server.html)\n\n运行后，可以在浏览器上打开`http://localhost:4000`查看效果。启动后，hexo会监听文件变化并自动更新，所以没必要重启服务器。\n\n## generate - 生成静态站点文件\n\n```\nhexo generate\n```\n生成静态文件。\n\n生成后自动部署:\n\n```\n#下面命令是同样的效果\nhexo generate --deploy\nhexo deploy --generate\n```\n\n参考：[generate](https://hexo.io/docs/generate.html)\n\n\n# 安装Next\n\n参考：[next getting-started](http://theme-next.iissnan.com/getting-started.html)\n\n\n## 下载Next主题\n\n克隆最新版本。\n在终端窗口下，定位到 Hexo 站点目录下。使用 Git checkout 代码：\n\n```\ncd quxionglie.com\ngit clone https://github.com/iissnan/hexo-theme-next themes/next\n```\n\n## 应用Next主题\n\n与所有 Hexo 主题启用的模式一样。在根目录下找到`_config.yml`配置文件，找到 theme 字段，并将其值更改为 next ：\n\n```\ntheme: next\n```\n\n\n## 选择 Scheme\n\nScheme 是 NexT 提供的一种特性，借助于 Scheme，NexT 为你提供多种不同的外观。同时，几乎所有的配置都可以 在 Scheme 之间共用。目前 NexT 支持三种 Scheme，他们是：\n\n- `Muse` - 默认 Scheme，这是 NexT 最初的版本，黑白主调，大量留白\n- `Mist` - Muse 的紧凑版本，整洁有序的单栏外观\n- `Pisces` - 双栏 Scheme，小家碧玉似的清新\n\nScheme 的切换通过更改主题配置文件`themes/next/_config.yml`，搜索 scheme 关键字。 你会看到有三行 scheme 的配置，将你需用启用的 scheme 前面注释 # 即可。\n\n选择 Mist Scheme\n\n```\n#scheme: Muse\nscheme: Mist\n#scheme: Pisces   \n```\n\n## 设置 语言\n\n编辑 站点配置文件`_config.yml`， 将 language 设置成你所需要的语言。建议明确设置你所需要的语言，例如选用简体中文，配置如下：\n\n```\nlanguage: zh-Hans\n```\n\n## 设置 菜单\n\n菜单配置包括三个部分，第一是菜单项（名称和链接），第二是菜单项的显示文本，第三是菜单项对应的图标。 NexT 使用的是 Font Awesome 提供的图标， Font Awesome 提供了 600+ 的图标，可以满足绝大的多数的场景，同时无须担心在 Retina 屏幕下 图标模糊的问题。\n\n编辑主题配置文件`themes/next/_config.yml`，修改以下内容：\n\n* 设定菜单内容，对应的字段是 menu。 菜单内容的设置格式是：item name: link。其中 item name 是一个名称，这个名称并不直接显示在页面上，她将用于匹配图标以及翻译。\n  \n```yml\nmenu:\n  home: /\n  categories: /categories\n  archives: /archives\n  tags: /tags\n  about: /about\n  #sitemap: /sitemap.xml\n  #commonweal: /404.html\n```\n\n# 主题设定\n\n参考：[next 主题配置](http://theme-next.iissnan.com/theme-settings.html)\n\n## 设置RSS\n\nNexT 中 RSS 有三个设置选项，满足特定的使用场景。 更改 主题配置文件`themes/next/_config.yml`，设定 rss 字段的值：\n\n- false：禁用 RSS，不在页面上显示 RSS 连接。\n- 留空：使用 Hexo 生成的 Feed 链接。 你可以需要先安装 [hexo-generator-feed](https://github.com/hexojs/hexo-generator-feed) 插件。\n\n```nodejs\nnpm install hexo-generator-feed --save\n```\n\n站点配置文件`_config.yml`添加如下内容：\n\n```\nfeed:\n  type: atom\n  path: atom.xml\n  limit: 20\n  hub:\n  content:\n```\n\n  \n\n- 具体的链接地址：适用于已经烧制过 Feed 的情形。\n\n## 添加标签页面\n\n```\ncd quxionglie.com\nhexo new page tags\n```\n\n关闭tags页面的评论,设置comments为false：\n\nvi source/tags/index.md\n\n```\ntitle: 标签\ndate: 2017-01-26 22:23:01\ntype: \"tags\"\ncomments: false\n```\n\n新建「标签」页面，并在菜单中显示「标签」链接。「标签」页面将展示站点的所有标签，若你的所有文章都未包含标签，此页面将是空的。 底下代码是一篇包含标签的文章的例子：\n\n```\ntitle: 标签测试文章\ntags:\n  - Testing\n  - Another Tag\n---\n```\n\n\n\n\n## 添加分类页面\n\n新建「分类」页面，并在菜单中显示「分类」链接。「分类」页面将展示站点的所有分类，若你的所有文章都未包含分类，此页面将是空的。 底下代码是一篇包含分类的文章的例子：\n\n```\nhexo new page categories\n```\n\nvi source/categories/index.md\n\n```\ntitle: 分类测试文章\ncategories: Testing\n---\n```\n\n## 添加about页面\n\n```\nhexo new page about\n```\n\n## 添加404页面\n\n新建一个404.html文件，放到themes/next/source目录下，内容自定。\n\n## 代码高亮\n\nNexT 使用 `Tomorrow Theme` 作为代码高亮，共有5款主题供你选择。 NexT 默认使用的是 白色的 normal 主题，可选的值有 normal，night， night blue， night bright， night eighties：\n\n更改 highlight_theme 字段，将其值设定成你所喜爱的高亮主题，例如：\n\n```\n# Code Highlight theme\n# Available value:\n#    normal | night | night eighties | night blue | night bright\n# https://github.com/chriskempson/tomorrow-theme\nhighlight_theme: normal\n```\n\n## 站点建立时间\n\n这个时间将在站点的底部显示，例如 © 2013 - 2015。 编辑 主题配置文件`themes/next/_config.yml`，新增字段 since。\n\n```\n# Specify the date when the site was setup\nsince: 2013\n```\n\n# 第三方服务\n## 多说评论\n修改主题配置文件`themes/next/_config.yml`中的duoshuo_shortname成你自己的。\n```\n# Duoshuo ShortName\nduoshuo_shortname: quxionglie\n```\n\n## 百度统计\n修改主题配置文件`themes/next/_config.yml`中的baidu_analytics成你自己的。\n\n```\n# Baidu Analytics ID\nbaidu_analytics: 36175c8b1958d080e840f34fc69cf52d \n```\n\n# 集成\n## Jekyll\n移动所有 Jekyll `_posts` 目录文件到 `source/_posts` 目录.\n\n修改站点配置文件`_config.yml`的`new_post_name`配置为:\n\n```\nnew_post_name: :year-:month-:day-:title.md\n```\n\n```\n# 修改前配置： new_post_name: :title.md\n# 执行命令：\n➜  quxionglie.com git:(master) ✗ hexo new page categories\nINFO  Created: ~/Documents/quxionglie.com/source/categories/index.md\n\n# 修改后配置： new_post_name: :year-:month-:day-:title.md\n# 执行命令：\n➜  quxionglie.com git:(master) ✗ hexo new \"test1\"        \nINFO  Created: ~/Documents/quxionglie.com/source/_posts/2017-01-26-test1.md\n```\n\n# 完整配置\n## 站点配置文件`_config.yml`\n\n```yml\n# Hexo Configuration\n## Docs: https://hexo.io/docs/configuration.html\n## Source: https://github.com/hexojs/hexo/\n\n# Site\ntitle: 阿烈的博客\nsubtitle:\ndescription: Yesterday, you said tomorrow！\nauthor: 阿烈\nlanguage: zh-Hans\ntimezone: Asia/Shanghai\n\n# URL\n## If your site is put in a subdirectory, set url as 'http://yoursite.com/child' and root as '/child/'\nurl: http://www.quxionglie.com\nroot: /\npermalink: :year/:month/:day/:title/\npermalink_defaults:\n\n# Directory\nsource_dir: source\npublic_dir: public\ntag_dir: tags\narchive_dir: archives\ncategory_dir: categories\ncode_dir: downloads/code\ni18n_dir: :lang\nskip_render:\n\n# Writing\nnew_post_name: :year-:month-:day-:title.md   # migrate Jekyll\n#new_post_name: :title.md # File name of new posts\ndefault_layout: post\ntitlecase: false # Transform title into titlecase\nexternal_link: true # Open external links in new tab\nfilename_case: 0\nrender_drafts: false\npost_asset_folder: false\nrelative_link: false\nfuture: true\nhighlight:\n  enable: true\n  line_number: true\n  auto_detect: false\n  tab_replace:\n\n# Category & Tag\ndefault_category: uncategorized\ncategory_map:\ntag_map:\n\n# Date / Time format\n## Hexo uses Moment.js to parse and display date\n## You can customize the date format as defined in\n## http://momentjs.com/docs/#/displaying/format/\ndate_format: YYYY-MM-DD\ntime_format: HH:mm:ss\n\n# Pagination\n## Set per_page to 0 to disable pagination\nper_page: 10\npagination_dir: page\n\n# Extensions\n## Plugins: https://hexo.io/plugins/\n## Themes: https://hexo.io/themes/\ntheme: next\n\n# Deployment\n## Docs: https://hexo.io/docs/deployment.html\ndeploy:\n  type:\n\nfeed:\n  type: atom\n  path: atom.xml\n  limit: 20\n  hub:\n  content:\n```\n\n## 主题配置文件`themes/next/_config.yml`\n\n```yml\n# ---------------------------------------------------------------\n# Site Information Settings\n# ---------------------------------------------------------------\n\n# Put your favicon.ico into `hexo-site/source/` directory.\nfavicon: /favicon.ico\n\n# Set default keywords (Use a comma to separate)\nkeywords: \"Hexo, NexT\"\n\n# Set rss to false to disable feed link.\n# Leave rss as empty to use site's feed link.\n# Set rss to specific value if you have burned your feed already.\nrss:\n\n# Specify the date when the site was setup\nsince: 2012\n\n# icon between year and author @Footer\nauthoricon: heart\n\n# Footer `powered-by` and `theme-info` copyright\ncopyright: true\n\n# Canonical, set a canonical link tag in your hexo, you could use it for your SEO of blog.\n# See: https://support.google.com/webmasters/answer/139066\n# Tips: Before you open this tag, remeber set up your URL in hexo _config.yml ( ex. url: http://yourdomain.com )\ncanonical: true\n\n# Change headers hierarchy on site-subtitle (will be main site description) and on all post/pages titles for better SEO-optimization.\nseo: false\n\n# ---------------------------------------------------------------\n# Menu Settings\n# ---------------------------------------------------------------\n\n# When running the site in a subdirectory (e.g. domain.tld/blog), remove the leading slash (/archives -> archives)\nmenu:\n  home: /\n  categories: /categories\n  archives: /archives\n  tags: /tags\n  about: /about\n  #sitemap: /sitemap.xml\n  #commonweal: /404.html\n\n# Enable/Disable menu icons.\n# Icon Mapping:\n#   Map a menu item to a specific FontAwesome icon name.\n#   Key is the name of menu item and value is the name of FontAwsome icon. Key is case-senstive.\n#   When an question mask icon presenting up means that the item has no mapping icon.\nmenu_icons:\n  enable: true\n  #KeyMapsToMenuItemKey: NameOfTheIconFromFontAwesome\n  home: home\n  about: user\n  categories: th\n  schedule: calendar\n  tags: tags\n  archives: archive\n  sitemap: sitemap\n  commonweal: heartbeat\n\n\n\n\n# ---------------------------------------------------------------\n# Scheme Settings\n# ---------------------------------------------------------------\n\n# Schemes\n#scheme: Muse\nscheme: Mist\n#scheme: Pisces\n\n\n# ---------------------------------------------------------------\n# Font Settings\n# - Find fonts on Google Fonts (https://www.google.com/fonts)\n# - All fonts set here will have the following styles:\n#     light, light italic, normal, normal intalic, bold, bold italic\n# - Be aware that setting too much fonts will cause site running slowly\n# - Introduce in 5.0.1\n# ---------------------------------------------------------------\nfont:\n  enable: true\n\n  # Uri of fonts host. E.g. //fonts.googleapis.com (Default)\n  host:\n\n  # Global font settings used on <body> element.\n  global:\n    # external: true will load this font family from host.\n    external: true\n    family: Lato\n\n  # Font settings for Headlines (h1, h2, h3, h4, h5, h6)\n  # Fallback to `global` font settings.\n  headings:\n    external: true\n    family:\n\n  # Font settings for posts\n  # Fallback to `global` font settings.\n  posts:\n    external: true\n    family:\n\n  # Font settings for Logo\n  # Fallback to `global` font settings.\n  # The `size` option use `px` as unit\n  logo:\n    external: true\n    family:\n    size:\n\n  # Font settings for <code> and code blocks.\n  codes:\n    external: true\n    family:\n    size:\n\n\n\n\n# ---------------------------------------------------------------\n# Sidebar Settings\n# ---------------------------------------------------------------\n\n\n# Social Links\n# Key is the link label showing to end users.\n# Value is the target link (E.g. GitHub: https://github.com/iissnan)\n#social:\n  #LinkLabel: Link\n\n\n# Social Links Icons\n# Icon Mapping:\n#   Map a menu item to a specific FontAwesome icon name.\n#   Key is the name of the item and value is the name of FontAwsome icon. Key is case-senstive.\n#   When an globe mask icon presenting up means that the item has no mapping icon.\nsocial_icons:\n  enable: true\n  # Icon Mappings.\n  # KeyMapsToSocalItemKey: NameOfTheIconFromFontAwesome\n  GitHub: github\n  Twitter: twitter\n  Weibo: weibo\n\n\n# Sidebar Avatar\n# in theme directory(source/images): /images/avatar.jpg\n# in site  directory(source/uploads): /uploads/avatar.jpg\navatar: /images/avatar.png\n\n\n# Table Of Contents in the Sidebar\ntoc:\n  enable: true\n\n  # Automatically add list number to toc.\n  number: true\n\n\n# Creative Commons 4.0 International License.\n# http://creativecommons.org/\n# Available: by | by-nc | by-nc-nd | by-nc-sa | by-nd | by-sa | zero\n#creative_commons: by-nc-sa\n#creative_commons:\n\n\nsidebar:\n  # Sidebar Position, available value: left | right\n  position: left\n  #position: right\n\n  # Sidebar Display, available value:\n  #  - post    expand on posts automatically. Default.\n  #  - always  expand for all pages automatically\n  #  - hide    expand only when click on the sidebar toggle icon.\n  #  - remove  Totally remove sidebar including sidebar toggler.\n  display: post\n  #display: always\n  #display: hide\n  #display: remove\n\n\n# Blogrolls\n#links_title: Links\n#links_layout: block\n#links_layout: inline\n#links:\n  #Title: http://example.com/\n\n\n# ---------------------------------------------------------------\n# Post Settings\n# ---------------------------------------------------------------\n\n# Automatically scroll page to section which is under <!-- more --> mark.\nscroll_to_more: true\n\n# Automatically excerpt description in homepage as preamble text.\nexcerpt_description: true\n\n# Automatically Excerpt. Not recommand.\n# Please use <!-- more --> in the post to control excerpt accurately.\nauto_excerpt:\n  enable: false\n  length: 150\n\n# Post meta display settings\npost_meta:\n  item_text: true\n  created_at: true\n  updated_at: false\n  categories: true\n\n\n# Wechat Subscriber\n#wechat_subscriber:\n  #enabled: true\n  #qcode: /path/to/your/wechatqcode ex. /uploads/wechat-qcode.jpg\n  #description: ex. subscribe to my blog by scanning my public wechat account\n\n\n\n# ---------------------------------------------------------------\n# Misc Theme Settings\n# ---------------------------------------------------------------\n\n# Custom Logo.\n# !!Only available for Default Scheme currently.\n# Options:\n#   enabled: [true/false] - Replace with specific image\n#   image: url-of-image   - Images's url\ncustom_logo:\n  enabled: false\n  image:\n\n\n# Code Highlight theme\n# Available value:\n#    normal | night | night eighties | night blue | night bright\n# https://github.com/chriskempson/tomorrow-theme\nhighlight_theme: normal\n\n\n# ---------------------------------------------------------------\n# Third Party Services Settings\n# ---------------------------------------------------------------\n\n# MathJax Support\nmathjax:\n  enable: false\n  per_page: false\n  cdn: //cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML\n\n\n# Swiftype Search API Key\n#swiftype_key:\n\n# Baidu Analytics ID\nbaidu_analytics: 36175c8b1958d080e840f34fc69cf52d\n\n# Duoshuo ShortName\nduoshuo_shortname: quxionglie\n\n# Disqus\n#disqus_shortname:\n\n# Hypercomments\n#hypercomments_id:\n\n# Gentie productKey\n#gentie_productKey:\n\n# Support for youyan comments system.\n# You can get your uid from http://www.uyan.cc\n#youyan_uid: your uid\n\n# Baidu Share\n# Available value:\n#    button | slide\n# Warning: Baidu Share does not support https.\n#baidushare:\n##  type: button\n\n# Share\n#jiathis:\n# Warning: JiaThis does not support https.\n#add_this_id:\n\n# Share\n#duoshuo_share: true\n\n# Google Webmaster tools verification setting\n# See: https://www.google.com/webmasters/\n#google_site_verification:\n\n\n# Google Analytics\n#google_analytics:\n\n# CNZZ count\n#cnzz_siteid:\n\n# Application Insights\n# See https://azure.microsoft.com/en-us/services/application-insights/\n# application_insights:\n\n# Make duoshuo show UA\n# user_id must NOT be null when admin_enable is true!\n# you can visit http://dev.duoshuo.com get duoshuo user id.\nduoshuo_info:\n  ua_enable: true\n  admin_enable: false\n  user_id: 0\n  #admin_nickname: Author\n\n\n# Facebook SDK Support.\n# https://github.com/iissnan/hexo-theme-next/pull/410\nfacebook_sdk:\n  enable: false\n  app_id:       #<app_id>\n  fb_admin:     #<user_id>\n  like_button:  #true\n  webmaster:    #true\n\n# Facebook comments plugin\n# This plugin depends on Facebook SDK.\n# If facebook_sdk.enable is false, Facebook comments plugin is unavailable.\nfacebook_comments_plugin:\n  enable: false\n  num_of_posts: 10  # min posts num is 1\n  width: 100%       # default width is 550px\n  scheme: light     # default scheme is light (light or dark)\n\n\n# Show number of visitors to each article.\n# You can visit https://leancloud.cn get AppID and AppKey.\nleancloud_visitors:\n  enable: false\n  app_id: #<app_id>\n  app_key: #<app_key>\n\n# Show PV/UV of the website/page with busuanzi.\n# Get more information on http://ibruce.info/2015/04/04/busuanzi/\nbusuanzi_count:\n  # count values only if the other configs are false\n  enable: false\n  # custom uv span for the whole site\n  site_uv: true\n  site_uv_header: <i class=\"fa fa-user\"></i>\n  site_uv_footer:\n  # custom pv span for the whole site\n  site_pv: true\n  site_pv_header: <i class=\"fa fa-eye\"></i>\n  site_pv_footer:\n  # custom pv span for one page only\n  page_pv: true\n  page_pv_header: <i class=\"fa fa-file-o\"></i>\n  page_pv_footer:\n\n\n# Tencent analytics ID\n# tencent_analytics:\n\n\n# Enable baidu push so that the blog will push the url to baidu automatically which is very helpful for SEO\nbaidu_push: false\n\n# Google Calendar\n# Share your recent schedule to others via calendar page\n#\n# API Documentation:\n# https://developers.google.com/google-apps/calendar/v3/reference/events/list\ncalendar:\n  enable: false\n  calendar_id: <required>\n  api_key: <required>\n  orderBy: startTime\n  offsetMax: 24\n  offsetMin: 4\n  timeZone:\n  showDeleted: false\n  singleEvents: true\n  maxResults: 250\n\n# Algolia Search\nalgolia_search:\n  enable: false\n  hits:\n    per_page: 10\n  labels:\n    input_placeholder: Search for Posts\n    hits_empty: \"We didn't find any results for the search: ${query}\"\n    hits_stats: \"${hits} results found in ${time} ms\"\n\n\n\n#! ---------------------------------------------------------------\n#! DO NOT EDIT THE FOLLOWING SETTINGS\n#! UNLESS YOU KNOW WHAT YOU ARE DOING\n#! ---------------------------------------------------------------\n\n# Motion\nuse_motion: true\n\n# Fancybox\nfancybox: true\n\n# Canvas-nest\ncanvas_nest: false\n\n# Script Vendors.\n# Set a CDN address for the vendor you want to customize.\n# For example\n#    jquery: https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js\n# Be aware that you should use the same version as internal ones to avoid potential problems.\n# Please use the https protocol of CDN files when you enable https on your site.\nvendors:\n  # Internal path prefix. Please do not edit it.\n  _internal: lib\n\n  # Internal version: 2.1.3\n  jquery:\n\n  # Internal version: 2.1.5\n  # See: http://fancyapps.com/fancybox/\n  fancybox:\n  fancybox_css:\n\n  # Internal version: 1.0.6\n  # See: https://github.com/ftlabs/fastclick\n  fastclick:\n\n  # Internal version: 1.9.7\n  # See: https://github.com/tuupola/jquery_lazyload\n  lazyload:\n\n  # Internal version: 1.2.1\n  # See: http://VelocityJS.org\n  velocity:\n\n  # Internal version: 1.2.1\n  # See: http://VelocityJS.org\n  velocity_ui:\n\n  # Internal version: 0.7.9\n  # See: https://faisalman.github.io/ua-parser-js/\n  ua_parser:\n\n  # Internal version: 4.6.2\n  # See: http://fontawesome.io/\n  fontawesome:\n\n  # Internal version: 1\n  # https://www.algolia.com\n  algolia_instant_js:\n  algolia_instant_css:\n\n  # Internal version: 1.0.0\n  # https://github.com/hustcc/canvas-nest.js\n  canvas_nest:\n\n\n\n# Assets\ncss: css\njs: js\nimages: images\n\n# Theme version\nversion: 5.1.0\n\n\n```\n\n","source":"_posts/2017-01-26-jekyll-to-hexo.md","raw":"---\ntitle: 从Jekyll迁移到Hexo\ndate: 2017-01-26 19:06:32\ncategories: hexo\n---\n\n我的博客以前由Jekyll搭建，但从 Jekyll 2升级到 Jekyll 3后，我发现自己开始关注于Jekyll及其模板本身而不是博文内容本身。故转而使用Hexo来搭建博客，并更换了更加简洁明快的next主题模板。如果想从Jekyll转到Hexo可以参考本文。\n\n<!-- more -->\n\n# 安装Hexo\n\n## 安装\n\n```\nnpm install -g hexo-cli\n```\n\nnode与hexo环境版本：\n\n```bash\n➜  ~ node -v\nv7.2.1\n➜  ~ hexo -v\nhexo-cli: 1.0.2\nos: Darwin 16.3.0 darwin x64\nhttp_parser: 2.7.0\nnode: 7.2.1\nv8: 5.4.500.44\nuv: 1.10.1\nzlib: 1.2.8\nares: 1.10.1-DEV\nmodules: 51\nopenssl: 1.0.2j\nicu: 58.1\nunicode: 9.0\ncldr: 30.0.2\ntz: 2016g\n```\n\n## 部署\n\n```\nhexo init quxionglie.com\ncd quxionglie.com\nnpm install\n```\n\n安装后目录\n\n```\n.\n├── _config.yml\n├── node_modules\n├── package.json\n├── scaffolds\n├── source\n└── themes\n\n4 directories, 2 files\n```\n\n<!-- more -->\n\n# Hexo常用命令\n## new - 生成新的blog\n\n```\nhexo new [layout] <title>\n```\n\n执行new命令，生成指定名称的文章至 source/posts/title.md。\n\n其中layout是可选参数，默认值为post。scaffolds目录下的文件名称就是layout名称。你也可以添加自己的layout，方法就是添加一个文件即可，同时你也可以编辑现有的layout，比如post的layout默认是scaffolds/post.md\n\n```\n➜  ls -l scaffolds\ntotal 24\n-rw-r--r--  1 quxl  staff  33 Jan 26 19:18 draft.md\n-rw-r--r--  1 quxl  staff  44 Jan 26 19:18 page.md\n-rw-r--r--  1 quxl  staff  50 Jan 26 19:18 post.md\n\n➜  cat scaffolds/post.md\n---\ntitle: {{ title }}\ndate: {{ date }}\ntags:\n---\n```\n\n参考：[writing](https://hexo.io/docs/writing.html)\n\n## server - 启动服务器\n\n```\nhexo server\n```\n\n参考：[server](https://hexo.io/docs/server.html)\n\n运行后，可以在浏览器上打开`http://localhost:4000`查看效果。启动后，hexo会监听文件变化并自动更新，所以没必要重启服务器。\n\n## generate - 生成静态站点文件\n\n```\nhexo generate\n```\n生成静态文件。\n\n生成后自动部署:\n\n```\n#下面命令是同样的效果\nhexo generate --deploy\nhexo deploy --generate\n```\n\n参考：[generate](https://hexo.io/docs/generate.html)\n\n\n# 安装Next\n\n参考：[next getting-started](http://theme-next.iissnan.com/getting-started.html)\n\n\n## 下载Next主题\n\n克隆最新版本。\n在终端窗口下，定位到 Hexo 站点目录下。使用 Git checkout 代码：\n\n```\ncd quxionglie.com\ngit clone https://github.com/iissnan/hexo-theme-next themes/next\n```\n\n## 应用Next主题\n\n与所有 Hexo 主题启用的模式一样。在根目录下找到`_config.yml`配置文件，找到 theme 字段，并将其值更改为 next ：\n\n```\ntheme: next\n```\n\n\n## 选择 Scheme\n\nScheme 是 NexT 提供的一种特性，借助于 Scheme，NexT 为你提供多种不同的外观。同时，几乎所有的配置都可以 在 Scheme 之间共用。目前 NexT 支持三种 Scheme，他们是：\n\n- `Muse` - 默认 Scheme，这是 NexT 最初的版本，黑白主调，大量留白\n- `Mist` - Muse 的紧凑版本，整洁有序的单栏外观\n- `Pisces` - 双栏 Scheme，小家碧玉似的清新\n\nScheme 的切换通过更改主题配置文件`themes/next/_config.yml`，搜索 scheme 关键字。 你会看到有三行 scheme 的配置，将你需用启用的 scheme 前面注释 # 即可。\n\n选择 Mist Scheme\n\n```\n#scheme: Muse\nscheme: Mist\n#scheme: Pisces   \n```\n\n## 设置 语言\n\n编辑 站点配置文件`_config.yml`， 将 language 设置成你所需要的语言。建议明确设置你所需要的语言，例如选用简体中文，配置如下：\n\n```\nlanguage: zh-Hans\n```\n\n## 设置 菜单\n\n菜单配置包括三个部分，第一是菜单项（名称和链接），第二是菜单项的显示文本，第三是菜单项对应的图标。 NexT 使用的是 Font Awesome 提供的图标， Font Awesome 提供了 600+ 的图标，可以满足绝大的多数的场景，同时无须担心在 Retina 屏幕下 图标模糊的问题。\n\n编辑主题配置文件`themes/next/_config.yml`，修改以下内容：\n\n* 设定菜单内容，对应的字段是 menu。 菜单内容的设置格式是：item name: link。其中 item name 是一个名称，这个名称并不直接显示在页面上，她将用于匹配图标以及翻译。\n  \n```yml\nmenu:\n  home: /\n  categories: /categories\n  archives: /archives\n  tags: /tags\n  about: /about\n  #sitemap: /sitemap.xml\n  #commonweal: /404.html\n```\n\n# 主题设定\n\n参考：[next 主题配置](http://theme-next.iissnan.com/theme-settings.html)\n\n## 设置RSS\n\nNexT 中 RSS 有三个设置选项，满足特定的使用场景。 更改 主题配置文件`themes/next/_config.yml`，设定 rss 字段的值：\n\n- false：禁用 RSS，不在页面上显示 RSS 连接。\n- 留空：使用 Hexo 生成的 Feed 链接。 你可以需要先安装 [hexo-generator-feed](https://github.com/hexojs/hexo-generator-feed) 插件。\n\n```nodejs\nnpm install hexo-generator-feed --save\n```\n\n站点配置文件`_config.yml`添加如下内容：\n\n```\nfeed:\n  type: atom\n  path: atom.xml\n  limit: 20\n  hub:\n  content:\n```\n\n  \n\n- 具体的链接地址：适用于已经烧制过 Feed 的情形。\n\n## 添加标签页面\n\n```\ncd quxionglie.com\nhexo new page tags\n```\n\n关闭tags页面的评论,设置comments为false：\n\nvi source/tags/index.md\n\n```\ntitle: 标签\ndate: 2017-01-26 22:23:01\ntype: \"tags\"\ncomments: false\n```\n\n新建「标签」页面，并在菜单中显示「标签」链接。「标签」页面将展示站点的所有标签，若你的所有文章都未包含标签，此页面将是空的。 底下代码是一篇包含标签的文章的例子：\n\n```\ntitle: 标签测试文章\ntags:\n  - Testing\n  - Another Tag\n---\n```\n\n\n\n\n## 添加分类页面\n\n新建「分类」页面，并在菜单中显示「分类」链接。「分类」页面将展示站点的所有分类，若你的所有文章都未包含分类，此页面将是空的。 底下代码是一篇包含分类的文章的例子：\n\n```\nhexo new page categories\n```\n\nvi source/categories/index.md\n\n```\ntitle: 分类测试文章\ncategories: Testing\n---\n```\n\n## 添加about页面\n\n```\nhexo new page about\n```\n\n## 添加404页面\n\n新建一个404.html文件，放到themes/next/source目录下，内容自定。\n\n## 代码高亮\n\nNexT 使用 `Tomorrow Theme` 作为代码高亮，共有5款主题供你选择。 NexT 默认使用的是 白色的 normal 主题，可选的值有 normal，night， night blue， night bright， night eighties：\n\n更改 highlight_theme 字段，将其值设定成你所喜爱的高亮主题，例如：\n\n```\n# Code Highlight theme\n# Available value:\n#    normal | night | night eighties | night blue | night bright\n# https://github.com/chriskempson/tomorrow-theme\nhighlight_theme: normal\n```\n\n## 站点建立时间\n\n这个时间将在站点的底部显示，例如 © 2013 - 2015。 编辑 主题配置文件`themes/next/_config.yml`，新增字段 since。\n\n```\n# Specify the date when the site was setup\nsince: 2013\n```\n\n# 第三方服务\n## 多说评论\n修改主题配置文件`themes/next/_config.yml`中的duoshuo_shortname成你自己的。\n```\n# Duoshuo ShortName\nduoshuo_shortname: quxionglie\n```\n\n## 百度统计\n修改主题配置文件`themes/next/_config.yml`中的baidu_analytics成你自己的。\n\n```\n# Baidu Analytics ID\nbaidu_analytics: 36175c8b1958d080e840f34fc69cf52d \n```\n\n# 集成\n## Jekyll\n移动所有 Jekyll `_posts` 目录文件到 `source/_posts` 目录.\n\n修改站点配置文件`_config.yml`的`new_post_name`配置为:\n\n```\nnew_post_name: :year-:month-:day-:title.md\n```\n\n```\n# 修改前配置： new_post_name: :title.md\n# 执行命令：\n➜  quxionglie.com git:(master) ✗ hexo new page categories\nINFO  Created: ~/Documents/quxionglie.com/source/categories/index.md\n\n# 修改后配置： new_post_name: :year-:month-:day-:title.md\n# 执行命令：\n➜  quxionglie.com git:(master) ✗ hexo new \"test1\"        \nINFO  Created: ~/Documents/quxionglie.com/source/_posts/2017-01-26-test1.md\n```\n\n# 完整配置\n## 站点配置文件`_config.yml`\n\n```yml\n# Hexo Configuration\n## Docs: https://hexo.io/docs/configuration.html\n## Source: https://github.com/hexojs/hexo/\n\n# Site\ntitle: 阿烈的博客\nsubtitle:\ndescription: Yesterday, you said tomorrow！\nauthor: 阿烈\nlanguage: zh-Hans\ntimezone: Asia/Shanghai\n\n# URL\n## If your site is put in a subdirectory, set url as 'http://yoursite.com/child' and root as '/child/'\nurl: http://www.quxionglie.com\nroot: /\npermalink: :year/:month/:day/:title/\npermalink_defaults:\n\n# Directory\nsource_dir: source\npublic_dir: public\ntag_dir: tags\narchive_dir: archives\ncategory_dir: categories\ncode_dir: downloads/code\ni18n_dir: :lang\nskip_render:\n\n# Writing\nnew_post_name: :year-:month-:day-:title.md   # migrate Jekyll\n#new_post_name: :title.md # File name of new posts\ndefault_layout: post\ntitlecase: false # Transform title into titlecase\nexternal_link: true # Open external links in new tab\nfilename_case: 0\nrender_drafts: false\npost_asset_folder: false\nrelative_link: false\nfuture: true\nhighlight:\n  enable: true\n  line_number: true\n  auto_detect: false\n  tab_replace:\n\n# Category & Tag\ndefault_category: uncategorized\ncategory_map:\ntag_map:\n\n# Date / Time format\n## Hexo uses Moment.js to parse and display date\n## You can customize the date format as defined in\n## http://momentjs.com/docs/#/displaying/format/\ndate_format: YYYY-MM-DD\ntime_format: HH:mm:ss\n\n# Pagination\n## Set per_page to 0 to disable pagination\nper_page: 10\npagination_dir: page\n\n# Extensions\n## Plugins: https://hexo.io/plugins/\n## Themes: https://hexo.io/themes/\ntheme: next\n\n# Deployment\n## Docs: https://hexo.io/docs/deployment.html\ndeploy:\n  type:\n\nfeed:\n  type: atom\n  path: atom.xml\n  limit: 20\n  hub:\n  content:\n```\n\n## 主题配置文件`themes/next/_config.yml`\n\n```yml\n# ---------------------------------------------------------------\n# Site Information Settings\n# ---------------------------------------------------------------\n\n# Put your favicon.ico into `hexo-site/source/` directory.\nfavicon: /favicon.ico\n\n# Set default keywords (Use a comma to separate)\nkeywords: \"Hexo, NexT\"\n\n# Set rss to false to disable feed link.\n# Leave rss as empty to use site's feed link.\n# Set rss to specific value if you have burned your feed already.\nrss:\n\n# Specify the date when the site was setup\nsince: 2012\n\n# icon between year and author @Footer\nauthoricon: heart\n\n# Footer `powered-by` and `theme-info` copyright\ncopyright: true\n\n# Canonical, set a canonical link tag in your hexo, you could use it for your SEO of blog.\n# See: https://support.google.com/webmasters/answer/139066\n# Tips: Before you open this tag, remeber set up your URL in hexo _config.yml ( ex. url: http://yourdomain.com )\ncanonical: true\n\n# Change headers hierarchy on site-subtitle (will be main site description) and on all post/pages titles for better SEO-optimization.\nseo: false\n\n# ---------------------------------------------------------------\n# Menu Settings\n# ---------------------------------------------------------------\n\n# When running the site in a subdirectory (e.g. domain.tld/blog), remove the leading slash (/archives -> archives)\nmenu:\n  home: /\n  categories: /categories\n  archives: /archives\n  tags: /tags\n  about: /about\n  #sitemap: /sitemap.xml\n  #commonweal: /404.html\n\n# Enable/Disable menu icons.\n# Icon Mapping:\n#   Map a menu item to a specific FontAwesome icon name.\n#   Key is the name of menu item and value is the name of FontAwsome icon. Key is case-senstive.\n#   When an question mask icon presenting up means that the item has no mapping icon.\nmenu_icons:\n  enable: true\n  #KeyMapsToMenuItemKey: NameOfTheIconFromFontAwesome\n  home: home\n  about: user\n  categories: th\n  schedule: calendar\n  tags: tags\n  archives: archive\n  sitemap: sitemap\n  commonweal: heartbeat\n\n\n\n\n# ---------------------------------------------------------------\n# Scheme Settings\n# ---------------------------------------------------------------\n\n# Schemes\n#scheme: Muse\nscheme: Mist\n#scheme: Pisces\n\n\n# ---------------------------------------------------------------\n# Font Settings\n# - Find fonts on Google Fonts (https://www.google.com/fonts)\n# - All fonts set here will have the following styles:\n#     light, light italic, normal, normal intalic, bold, bold italic\n# - Be aware that setting too much fonts will cause site running slowly\n# - Introduce in 5.0.1\n# ---------------------------------------------------------------\nfont:\n  enable: true\n\n  # Uri of fonts host. E.g. //fonts.googleapis.com (Default)\n  host:\n\n  # Global font settings used on <body> element.\n  global:\n    # external: true will load this font family from host.\n    external: true\n    family: Lato\n\n  # Font settings for Headlines (h1, h2, h3, h4, h5, h6)\n  # Fallback to `global` font settings.\n  headings:\n    external: true\n    family:\n\n  # Font settings for posts\n  # Fallback to `global` font settings.\n  posts:\n    external: true\n    family:\n\n  # Font settings for Logo\n  # Fallback to `global` font settings.\n  # The `size` option use `px` as unit\n  logo:\n    external: true\n    family:\n    size:\n\n  # Font settings for <code> and code blocks.\n  codes:\n    external: true\n    family:\n    size:\n\n\n\n\n# ---------------------------------------------------------------\n# Sidebar Settings\n# ---------------------------------------------------------------\n\n\n# Social Links\n# Key is the link label showing to end users.\n# Value is the target link (E.g. GitHub: https://github.com/iissnan)\n#social:\n  #LinkLabel: Link\n\n\n# Social Links Icons\n# Icon Mapping:\n#   Map a menu item to a specific FontAwesome icon name.\n#   Key is the name of the item and value is the name of FontAwsome icon. Key is case-senstive.\n#   When an globe mask icon presenting up means that the item has no mapping icon.\nsocial_icons:\n  enable: true\n  # Icon Mappings.\n  # KeyMapsToSocalItemKey: NameOfTheIconFromFontAwesome\n  GitHub: github\n  Twitter: twitter\n  Weibo: weibo\n\n\n# Sidebar Avatar\n# in theme directory(source/images): /images/avatar.jpg\n# in site  directory(source/uploads): /uploads/avatar.jpg\navatar: /images/avatar.png\n\n\n# Table Of Contents in the Sidebar\ntoc:\n  enable: true\n\n  # Automatically add list number to toc.\n  number: true\n\n\n# Creative Commons 4.0 International License.\n# http://creativecommons.org/\n# Available: by | by-nc | by-nc-nd | by-nc-sa | by-nd | by-sa | zero\n#creative_commons: by-nc-sa\n#creative_commons:\n\n\nsidebar:\n  # Sidebar Position, available value: left | right\n  position: left\n  #position: right\n\n  # Sidebar Display, available value:\n  #  - post    expand on posts automatically. Default.\n  #  - always  expand for all pages automatically\n  #  - hide    expand only when click on the sidebar toggle icon.\n  #  - remove  Totally remove sidebar including sidebar toggler.\n  display: post\n  #display: always\n  #display: hide\n  #display: remove\n\n\n# Blogrolls\n#links_title: Links\n#links_layout: block\n#links_layout: inline\n#links:\n  #Title: http://example.com/\n\n\n# ---------------------------------------------------------------\n# Post Settings\n# ---------------------------------------------------------------\n\n# Automatically scroll page to section which is under <!-- more --> mark.\nscroll_to_more: true\n\n# Automatically excerpt description in homepage as preamble text.\nexcerpt_description: true\n\n# Automatically Excerpt. Not recommand.\n# Please use <!-- more --> in the post to control excerpt accurately.\nauto_excerpt:\n  enable: false\n  length: 150\n\n# Post meta display settings\npost_meta:\n  item_text: true\n  created_at: true\n  updated_at: false\n  categories: true\n\n\n# Wechat Subscriber\n#wechat_subscriber:\n  #enabled: true\n  #qcode: /path/to/your/wechatqcode ex. /uploads/wechat-qcode.jpg\n  #description: ex. subscribe to my blog by scanning my public wechat account\n\n\n\n# ---------------------------------------------------------------\n# Misc Theme Settings\n# ---------------------------------------------------------------\n\n# Custom Logo.\n# !!Only available for Default Scheme currently.\n# Options:\n#   enabled: [true/false] - Replace with specific image\n#   image: url-of-image   - Images's url\ncustom_logo:\n  enabled: false\n  image:\n\n\n# Code Highlight theme\n# Available value:\n#    normal | night | night eighties | night blue | night bright\n# https://github.com/chriskempson/tomorrow-theme\nhighlight_theme: normal\n\n\n# ---------------------------------------------------------------\n# Third Party Services Settings\n# ---------------------------------------------------------------\n\n# MathJax Support\nmathjax:\n  enable: false\n  per_page: false\n  cdn: //cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML\n\n\n# Swiftype Search API Key\n#swiftype_key:\n\n# Baidu Analytics ID\nbaidu_analytics: 36175c8b1958d080e840f34fc69cf52d\n\n# Duoshuo ShortName\nduoshuo_shortname: quxionglie\n\n# Disqus\n#disqus_shortname:\n\n# Hypercomments\n#hypercomments_id:\n\n# Gentie productKey\n#gentie_productKey:\n\n# Support for youyan comments system.\n# You can get your uid from http://www.uyan.cc\n#youyan_uid: your uid\n\n# Baidu Share\n# Available value:\n#    button | slide\n# Warning: Baidu Share does not support https.\n#baidushare:\n##  type: button\n\n# Share\n#jiathis:\n# Warning: JiaThis does not support https.\n#add_this_id:\n\n# Share\n#duoshuo_share: true\n\n# Google Webmaster tools verification setting\n# See: https://www.google.com/webmasters/\n#google_site_verification:\n\n\n# Google Analytics\n#google_analytics:\n\n# CNZZ count\n#cnzz_siteid:\n\n# Application Insights\n# See https://azure.microsoft.com/en-us/services/application-insights/\n# application_insights:\n\n# Make duoshuo show UA\n# user_id must NOT be null when admin_enable is true!\n# you can visit http://dev.duoshuo.com get duoshuo user id.\nduoshuo_info:\n  ua_enable: true\n  admin_enable: false\n  user_id: 0\n  #admin_nickname: Author\n\n\n# Facebook SDK Support.\n# https://github.com/iissnan/hexo-theme-next/pull/410\nfacebook_sdk:\n  enable: false\n  app_id:       #<app_id>\n  fb_admin:     #<user_id>\n  like_button:  #true\n  webmaster:    #true\n\n# Facebook comments plugin\n# This plugin depends on Facebook SDK.\n# If facebook_sdk.enable is false, Facebook comments plugin is unavailable.\nfacebook_comments_plugin:\n  enable: false\n  num_of_posts: 10  # min posts num is 1\n  width: 100%       # default width is 550px\n  scheme: light     # default scheme is light (light or dark)\n\n\n# Show number of visitors to each article.\n# You can visit https://leancloud.cn get AppID and AppKey.\nleancloud_visitors:\n  enable: false\n  app_id: #<app_id>\n  app_key: #<app_key>\n\n# Show PV/UV of the website/page with busuanzi.\n# Get more information on http://ibruce.info/2015/04/04/busuanzi/\nbusuanzi_count:\n  # count values only if the other configs are false\n  enable: false\n  # custom uv span for the whole site\n  site_uv: true\n  site_uv_header: <i class=\"fa fa-user\"></i>\n  site_uv_footer:\n  # custom pv span for the whole site\n  site_pv: true\n  site_pv_header: <i class=\"fa fa-eye\"></i>\n  site_pv_footer:\n  # custom pv span for one page only\n  page_pv: true\n  page_pv_header: <i class=\"fa fa-file-o\"></i>\n  page_pv_footer:\n\n\n# Tencent analytics ID\n# tencent_analytics:\n\n\n# Enable baidu push so that the blog will push the url to baidu automatically which is very helpful for SEO\nbaidu_push: false\n\n# Google Calendar\n# Share your recent schedule to others via calendar page\n#\n# API Documentation:\n# https://developers.google.com/google-apps/calendar/v3/reference/events/list\ncalendar:\n  enable: false\n  calendar_id: <required>\n  api_key: <required>\n  orderBy: startTime\n  offsetMax: 24\n  offsetMin: 4\n  timeZone:\n  showDeleted: false\n  singleEvents: true\n  maxResults: 250\n\n# Algolia Search\nalgolia_search:\n  enable: false\n  hits:\n    per_page: 10\n  labels:\n    input_placeholder: Search for Posts\n    hits_empty: \"We didn't find any results for the search: ${query}\"\n    hits_stats: \"${hits} results found in ${time} ms\"\n\n\n\n#! ---------------------------------------------------------------\n#! DO NOT EDIT THE FOLLOWING SETTINGS\n#! UNLESS YOU KNOW WHAT YOU ARE DOING\n#! ---------------------------------------------------------------\n\n# Motion\nuse_motion: true\n\n# Fancybox\nfancybox: true\n\n# Canvas-nest\ncanvas_nest: false\n\n# Script Vendors.\n# Set a CDN address for the vendor you want to customize.\n# For example\n#    jquery: https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js\n# Be aware that you should use the same version as internal ones to avoid potential problems.\n# Please use the https protocol of CDN files when you enable https on your site.\nvendors:\n  # Internal path prefix. Please do not edit it.\n  _internal: lib\n\n  # Internal version: 2.1.3\n  jquery:\n\n  # Internal version: 2.1.5\n  # See: http://fancyapps.com/fancybox/\n  fancybox:\n  fancybox_css:\n\n  # Internal version: 1.0.6\n  # See: https://github.com/ftlabs/fastclick\n  fastclick:\n\n  # Internal version: 1.9.7\n  # See: https://github.com/tuupola/jquery_lazyload\n  lazyload:\n\n  # Internal version: 1.2.1\n  # See: http://VelocityJS.org\n  velocity:\n\n  # Internal version: 1.2.1\n  # See: http://VelocityJS.org\n  velocity_ui:\n\n  # Internal version: 0.7.9\n  # See: https://faisalman.github.io/ua-parser-js/\n  ua_parser:\n\n  # Internal version: 4.6.2\n  # See: http://fontawesome.io/\n  fontawesome:\n\n  # Internal version: 1\n  # https://www.algolia.com\n  algolia_instant_js:\n  algolia_instant_css:\n\n  # Internal version: 1.0.0\n  # https://github.com/hustcc/canvas-nest.js\n  canvas_nest:\n\n\n\n# Assets\ncss: css\njs: js\nimages: images\n\n# Theme version\nversion: 5.1.0\n\n\n```\n\n","slug":"jekyll-to-hexo","published":1,"updated":"2017-01-27T02:03:01.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciyf7fkcq001jf2jywro70jrg","content":"<p>我的博客以前由Jekyll搭建，但从 Jekyll 2升级到 Jekyll 3后，我发现自己开始关注于Jekyll及其模板本身而不是博文内容本身。故转而使用Hexo来搭建博客，并更换了更加简洁明快的next主题模板。如果想从Jekyll转到Hexo可以参考本文。</p>\n<a id=\"more\"></a>\n<h1 id=\"安装Hexo\"><a href=\"#安装Hexo\" class=\"headerlink\" title=\"安装Hexo\"></a>安装Hexo</h1><h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">npm install -g hexo-cli</div></pre></td></tr></table></figure>\n<p>node与hexo环境版本：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\">➜  ~ node -v</div><div class=\"line\">v7.2.1</div><div class=\"line\">➜  ~ hexo -v</div><div class=\"line\">hexo-cli: 1.0.2</div><div class=\"line\">os: Darwin 16.3.0 darwin x64</div><div class=\"line\">http_parser: 2.7.0</div><div class=\"line\">node: 7.2.1</div><div class=\"line\">v8: 5.4.500.44</div><div class=\"line\">uv: 1.10.1</div><div class=\"line\">zlib: 1.2.8</div><div class=\"line\">ares: 1.10.1-DEV</div><div class=\"line\">modules: 51</div><div class=\"line\">openssl: 1.0.2j</div><div class=\"line\">icu: 58.1</div><div class=\"line\">unicode: 9.0</div><div class=\"line\">cldr: 30.0.2</div><div class=\"line\">tz: 2016g</div></pre></td></tr></table></figure>\n<h2 id=\"部署\"><a href=\"#部署\" class=\"headerlink\" title=\"部署\"></a>部署</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">hexo init quxionglie.com</div><div class=\"line\">cd quxionglie.com</div><div class=\"line\">npm install</div></pre></td></tr></table></figure>\n<p>安装后目录</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">.</div><div class=\"line\">├── _config.yml</div><div class=\"line\">├── node_modules</div><div class=\"line\">├── package.json</div><div class=\"line\">├── scaffolds</div><div class=\"line\">├── source</div><div class=\"line\">└── themes</div><div class=\"line\"></div><div class=\"line\">4 directories, 2 files</div></pre></td></tr></table></figure>\n<!-- more -->\n<h1 id=\"Hexo常用命令\"><a href=\"#Hexo常用命令\" class=\"headerlink\" title=\"Hexo常用命令\"></a>Hexo常用命令</h1><h2 id=\"new-生成新的blog\"><a href=\"#new-生成新的blog\" class=\"headerlink\" title=\"new - 生成新的blog\"></a>new - 生成新的blog</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">hexo new [layout] &lt;title&gt;</div></pre></td></tr></table></figure>\n<p>执行new命令，生成指定名称的文章至 source/posts/title.md。</p>\n<p>其中layout是可选参数，默认值为post。scaffolds目录下的文件名称就是layout名称。你也可以添加自己的layout，方法就是添加一个文件即可，同时你也可以编辑现有的layout，比如post的layout默认是scaffolds/post.md</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">➜  ls -l scaffolds</div><div class=\"line\">total 24</div><div class=\"line\">-rw-r--r--  1 quxl  staff  33 Jan 26 19:18 draft.md</div><div class=\"line\">-rw-r--r--  1 quxl  staff  44 Jan 26 19:18 page.md</div><div class=\"line\">-rw-r--r--  1 quxl  staff  50 Jan 26 19:18 post.md</div><div class=\"line\"></div><div class=\"line\">➜  cat scaffolds/post.md</div><div class=\"line\">---</div><div class=\"line\">title: &#123;&#123; title &#125;&#125;</div><div class=\"line\">date: &#123;&#123; date &#125;&#125;</div><div class=\"line\">tags:</div><div class=\"line\">---</div></pre></td></tr></table></figure>\n<p>参考：<a href=\"https://hexo.io/docs/writing.html\" target=\"_blank\" rel=\"external\">writing</a></p>\n<h2 id=\"server-启动服务器\"><a href=\"#server-启动服务器\" class=\"headerlink\" title=\"server - 启动服务器\"></a>server - 启动服务器</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">hexo server</div></pre></td></tr></table></figure>\n<p>参考：<a href=\"https://hexo.io/docs/server.html\" target=\"_blank\" rel=\"external\">server</a></p>\n<p>运行后，可以在浏览器上打开<code>http://localhost:4000</code>查看效果。启动后，hexo会监听文件变化并自动更新，所以没必要重启服务器。</p>\n<h2 id=\"generate-生成静态站点文件\"><a href=\"#generate-生成静态站点文件\" class=\"headerlink\" title=\"generate - 生成静态站点文件\"></a>generate - 生成静态站点文件</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">hexo generate</div></pre></td></tr></table></figure>\n<p>生成静态文件。</p>\n<p>生成后自动部署:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">#下面命令是同样的效果</div><div class=\"line\">hexo generate --deploy</div><div class=\"line\">hexo deploy --generate</div></pre></td></tr></table></figure>\n<p>参考：<a href=\"https://hexo.io/docs/generate.html\" target=\"_blank\" rel=\"external\">generate</a></p>\n<h1 id=\"安装Next\"><a href=\"#安装Next\" class=\"headerlink\" title=\"安装Next\"></a>安装Next</h1><p>参考：<a href=\"http://theme-next.iissnan.com/getting-started.html\" target=\"_blank\" rel=\"external\">next getting-started</a></p>\n<h2 id=\"下载Next主题\"><a href=\"#下载Next主题\" class=\"headerlink\" title=\"下载Next主题\"></a>下载Next主题</h2><p>克隆最新版本。<br>在终端窗口下，定位到 Hexo 站点目录下。使用 Git checkout 代码：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd quxionglie.com</div><div class=\"line\">git clone https://github.com/iissnan/hexo-theme-next themes/next</div></pre></td></tr></table></figure>\n<h2 id=\"应用Next主题\"><a href=\"#应用Next主题\" class=\"headerlink\" title=\"应用Next主题\"></a>应用Next主题</h2><p>与所有 Hexo 主题启用的模式一样。在根目录下找到<code>_config.yml</code>配置文件，找到 theme 字段，并将其值更改为 next ：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">theme: next</div></pre></td></tr></table></figure>\n<h2 id=\"选择-Scheme\"><a href=\"#选择-Scheme\" class=\"headerlink\" title=\"选择 Scheme\"></a>选择 Scheme</h2><p>Scheme 是 NexT 提供的一种特性，借助于 Scheme，NexT 为你提供多种不同的外观。同时，几乎所有的配置都可以 在 Scheme 之间共用。目前 NexT 支持三种 Scheme，他们是：</p>\n<ul>\n<li><code>Muse</code> - 默认 Scheme，这是 NexT 最初的版本，黑白主调，大量留白</li>\n<li><code>Mist</code> - Muse 的紧凑版本，整洁有序的单栏外观</li>\n<li><code>Pisces</code> - 双栏 Scheme，小家碧玉似的清新</li>\n</ul>\n<p>Scheme 的切换通过更改主题配置文件<code>themes/next/_config.yml</code>，搜索 scheme 关键字。 你会看到有三行 scheme 的配置，将你需用启用的 scheme 前面注释 # 即可。</p>\n<p>选择 Mist Scheme</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">#scheme: Muse</div><div class=\"line\">scheme: Mist</div><div class=\"line\">#scheme: Pisces</div></pre></td></tr></table></figure>\n<h2 id=\"设置-语言\"><a href=\"#设置-语言\" class=\"headerlink\" title=\"设置 语言\"></a>设置 语言</h2><p>编辑 站点配置文件<code>_config.yml</code>， 将 language 设置成你所需要的语言。建议明确设置你所需要的语言，例如选用简体中文，配置如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">language: zh-Hans</div></pre></td></tr></table></figure>\n<h2 id=\"设置-菜单\"><a href=\"#设置-菜单\" class=\"headerlink\" title=\"设置 菜单\"></a>设置 菜单</h2><p>菜单配置包括三个部分，第一是菜单项（名称和链接），第二是菜单项的显示文本，第三是菜单项对应的图标。 NexT 使用的是 Font Awesome 提供的图标， Font Awesome 提供了 600+ 的图标，可以满足绝大的多数的场景，同时无须担心在 Retina 屏幕下 图标模糊的问题。</p>\n<p>编辑主题配置文件<code>themes/next/_config.yml</code>，修改以下内容：</p>\n<ul>\n<li>设定菜单内容，对应的字段是 menu。 菜单内容的设置格式是：item name: link。其中 item name 是一个名称，这个名称并不直接显示在页面上，她将用于匹配图标以及翻译。</li>\n</ul>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"attr\">menu:</span></div><div class=\"line\"><span class=\"attr\">  home:</span> /</div><div class=\"line\"><span class=\"attr\">  categories:</span> /categories</div><div class=\"line\"><span class=\"attr\">  archives:</span> /archives</div><div class=\"line\"><span class=\"attr\">  tags:</span> /tags</div><div class=\"line\"><span class=\"attr\">  about:</span> /about</div><div class=\"line\">  <span class=\"comment\">#sitemap: /sitemap.xml</span></div><div class=\"line\">  <span class=\"comment\">#commonweal: /404.html</span></div></pre></td></tr></table></figure>\n<h1 id=\"主题设定\"><a href=\"#主题设定\" class=\"headerlink\" title=\"主题设定\"></a>主题设定</h1><p>参考：<a href=\"http://theme-next.iissnan.com/theme-settings.html\" target=\"_blank\" rel=\"external\">next 主题配置</a></p>\n<h2 id=\"设置RSS\"><a href=\"#设置RSS\" class=\"headerlink\" title=\"设置RSS\"></a>设置RSS</h2><p>NexT 中 RSS 有三个设置选项，满足特定的使用场景。 更改 主题配置文件<code>themes/next/_config.yml</code>，设定 rss 字段的值：</p>\n<ul>\n<li>false：禁用 RSS，不在页面上显示 RSS 连接。</li>\n<li>留空：使用 Hexo 生成的 Feed 链接。 你可以需要先安装 <a href=\"https://github.com/hexojs/hexo-generator-feed\" target=\"_blank\" rel=\"external\">hexo-generator-feed</a> 插件。</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">npm install hexo-generator-feed --save</div></pre></td></tr></table></figure>\n<p>站点配置文件<code>_config.yml</code>添加如下内容：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">feed:</div><div class=\"line\">  type: atom</div><div class=\"line\">  path: atom.xml</div><div class=\"line\">  limit: 20</div><div class=\"line\">  hub:</div><div class=\"line\">  content:</div></pre></td></tr></table></figure>\n<ul>\n<li>具体的链接地址：适用于已经烧制过 Feed 的情形。</li>\n</ul>\n<h2 id=\"添加标签页面\"><a href=\"#添加标签页面\" class=\"headerlink\" title=\"添加标签页面\"></a>添加标签页面</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd quxionglie.com</div><div class=\"line\">hexo new page tags</div></pre></td></tr></table></figure>\n<p>关闭tags页面的评论,设置comments为false：</p>\n<p>vi source/tags/index.md</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">title: 标签</div><div class=\"line\">date: 2017-01-26 22:23:01</div><div class=\"line\">type: &quot;tags&quot;</div><div class=\"line\">comments: false</div></pre></td></tr></table></figure>\n<p>新建「标签」页面，并在菜单中显示「标签」链接。「标签」页面将展示站点的所有标签，若你的所有文章都未包含标签，此页面将是空的。 底下代码是一篇包含标签的文章的例子：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">title: 标签测试文章</div><div class=\"line\">tags:</div><div class=\"line\">  - Testing</div><div class=\"line\">  - Another Tag</div><div class=\"line\">---</div></pre></td></tr></table></figure>\n<h2 id=\"添加分类页面\"><a href=\"#添加分类页面\" class=\"headerlink\" title=\"添加分类页面\"></a>添加分类页面</h2><p>新建「分类」页面，并在菜单中显示「分类」链接。「分类」页面将展示站点的所有分类，若你的所有文章都未包含分类，此页面将是空的。 底下代码是一篇包含分类的文章的例子：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">hexo new page categories</div></pre></td></tr></table></figure>\n<p>vi source/categories/index.md</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">title: 分类测试文章</div><div class=\"line\">categories: Testing</div><div class=\"line\">---</div></pre></td></tr></table></figure>\n<h2 id=\"添加about页面\"><a href=\"#添加about页面\" class=\"headerlink\" title=\"添加about页面\"></a>添加about页面</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">hexo new page about</div></pre></td></tr></table></figure>\n<h2 id=\"添加404页面\"><a href=\"#添加404页面\" class=\"headerlink\" title=\"添加404页面\"></a>添加404页面</h2><p>新建一个404.html文件，放到themes/next/source目录下，内容自定。</p>\n<h2 id=\"代码高亮\"><a href=\"#代码高亮\" class=\"headerlink\" title=\"代码高亮\"></a>代码高亮</h2><p>NexT 使用 <code>Tomorrow Theme</code> 作为代码高亮，共有5款主题供你选择。 NexT 默认使用的是 白色的 normal 主题，可选的值有 normal，night， night blue， night bright， night eighties：</p>\n<p>更改 highlight_theme 字段，将其值设定成你所喜爱的高亮主题，例如：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Code Highlight theme</div><div class=\"line\"># Available value:</div><div class=\"line\">#    normal | night | night eighties | night blue | night bright</div><div class=\"line\"># https://github.com/chriskempson/tomorrow-theme</div><div class=\"line\">highlight_theme: normal</div></pre></td></tr></table></figure>\n<h2 id=\"站点建立时间\"><a href=\"#站点建立时间\" class=\"headerlink\" title=\"站点建立时间\"></a>站点建立时间</h2><p>这个时间将在站点的底部显示，例如 © 2013 - 2015。 编辑 主题配置文件<code>themes/next/_config.yml</code>，新增字段 since。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Specify the date when the site was setup</div><div class=\"line\">since: 2013</div></pre></td></tr></table></figure>\n<h1 id=\"第三方服务\"><a href=\"#第三方服务\" class=\"headerlink\" title=\"第三方服务\"></a>第三方服务</h1><h2 id=\"多说评论\"><a href=\"#多说评论\" class=\"headerlink\" title=\"多说评论\"></a>多说评论</h2><p>修改主题配置文件<code>themes/next/_config.yml</code>中的duoshuo_shortname成你自己的。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Duoshuo ShortName</div><div class=\"line\">duoshuo_shortname: quxionglie</div></pre></td></tr></table></figure></p>\n<h2 id=\"百度统计\"><a href=\"#百度统计\" class=\"headerlink\" title=\"百度统计\"></a>百度统计</h2><p>修改主题配置文件<code>themes/next/_config.yml</code>中的baidu_analytics成你自己的。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Baidu Analytics ID</div><div class=\"line\">baidu_analytics: 36175c8b1958d080e840f34fc69cf52d</div></pre></td></tr></table></figure>\n<h1 id=\"集成\"><a href=\"#集成\" class=\"headerlink\" title=\"集成\"></a>集成</h1><h2 id=\"Jekyll\"><a href=\"#Jekyll\" class=\"headerlink\" title=\"Jekyll\"></a>Jekyll</h2><p>移动所有 Jekyll <code>_posts</code> 目录文件到 <code>source/_posts</code> 目录.</p>\n<p>修改站点配置文件<code>_config.yml</code>的<code>new_post_name</code>配置为:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">new_post_name: :year-:month-:day-:title.md</div></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 修改前配置： new_post_name: :title.md</div><div class=\"line\"># 执行命令：</div><div class=\"line\">➜  quxionglie.com git:(master) ✗ hexo new page categories</div><div class=\"line\">INFO  Created: ~/Documents/quxionglie.com/source/categories/index.md</div><div class=\"line\"></div><div class=\"line\"># 修改后配置： new_post_name: :year-:month-:day-:title.md</div><div class=\"line\"># 执行命令：</div><div class=\"line\">➜  quxionglie.com git:(master) ✗ hexo new &quot;test1&quot;        </div><div class=\"line\">INFO  Created: ~/Documents/quxionglie.com/source/_posts/2017-01-26-test1.md</div></pre></td></tr></table></figure>\n<h1 id=\"完整配置\"><a href=\"#完整配置\" class=\"headerlink\" title=\"完整配置\"></a>完整配置</h1><h2 id=\"站点配置文件-config-yml\"><a href=\"#站点配置文件-config-yml\" class=\"headerlink\" title=\"站点配置文件_config.yml\"></a>站点配置文件<code>_config.yml</code></h2><figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># Hexo Configuration</span></div><div class=\"line\"><span class=\"comment\">## Docs: https://hexo.io/docs/configuration.html</span></div><div class=\"line\"><span class=\"comment\">## Source: https://github.com/hexojs/hexo/</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Site</span></div><div class=\"line\"><span class=\"attr\">title:</span> 阿烈的博客</div><div class=\"line\"><span class=\"attr\">subtitle:</span></div><div class=\"line\"><span class=\"attr\">description:</span> Yesterday, you said tomorrow！</div><div class=\"line\"><span class=\"attr\">author:</span> 阿烈</div><div class=\"line\"><span class=\"attr\">language:</span> zh-Hans</div><div class=\"line\"><span class=\"attr\">timezone:</span> Asia/Shanghai</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># URL</span></div><div class=\"line\"><span class=\"comment\">## If your site is put in a subdirectory, set url as 'http://yoursite.com/child' and root as '/child/'</span></div><div class=\"line\"><span class=\"attr\">url:</span> http://www.quxionglie.com</div><div class=\"line\"><span class=\"attr\">root:</span> /</div><div class=\"line\"><span class=\"attr\">permalink:</span> :year/:month/:day/:title/</div><div class=\"line\"><span class=\"attr\">permalink_defaults:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Directory</span></div><div class=\"line\"><span class=\"attr\">source_dir:</span> source</div><div class=\"line\"><span class=\"attr\">public_dir:</span> public</div><div class=\"line\"><span class=\"attr\">tag_dir:</span> tags</div><div class=\"line\"><span class=\"attr\">archive_dir:</span> archives</div><div class=\"line\"><span class=\"attr\">category_dir:</span> categories</div><div class=\"line\"><span class=\"attr\">code_dir:</span> downloads/code</div><div class=\"line\"><span class=\"attr\">i18n_dir:</span> :lang</div><div class=\"line\"><span class=\"attr\">skip_render:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Writing</span></div><div class=\"line\"><span class=\"attr\">new_post_name:</span> :year-:month-:day-:title.md   <span class=\"comment\"># migrate Jekyll</span></div><div class=\"line\"><span class=\"comment\">#new_post_name: :title.md # File name of new posts</span></div><div class=\"line\"><span class=\"attr\">default_layout:</span> post</div><div class=\"line\"><span class=\"attr\">titlecase:</span> <span class=\"literal\">false</span> <span class=\"comment\"># Transform title into titlecase</span></div><div class=\"line\"><span class=\"attr\">external_link:</span> <span class=\"literal\">true</span> <span class=\"comment\"># Open external links in new tab</span></div><div class=\"line\"><span class=\"attr\">filename_case:</span> <span class=\"number\">0</span></div><div class=\"line\"><span class=\"attr\">render_drafts:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">post_asset_folder:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">relative_link:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">future:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">highlight:</span></div><div class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">  line_number:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">  auto_detect:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">  tab_replace:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Category &amp; Tag</span></div><div class=\"line\"><span class=\"attr\">default_category:</span> uncategorized</div><div class=\"line\"><span class=\"attr\">category_map:</span></div><div class=\"line\"><span class=\"attr\">tag_map:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Date / Time format</span></div><div class=\"line\"><span class=\"comment\">## Hexo uses Moment.js to parse and display date</span></div><div class=\"line\"><span class=\"comment\">## You can customize the date format as defined in</span></div><div class=\"line\"><span class=\"comment\">## http://momentjs.com/docs/#/displaying/format/</span></div><div class=\"line\"><span class=\"attr\">date_format:</span> YYYY-MM-DD</div><div class=\"line\"><span class=\"attr\">time_format:</span> HH:mm:ss</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Pagination</span></div><div class=\"line\"><span class=\"comment\">## Set per_page to 0 to disable pagination</span></div><div class=\"line\"><span class=\"attr\">per_page:</span> <span class=\"number\">10</span></div><div class=\"line\"><span class=\"attr\">pagination_dir:</span> page</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Extensions</span></div><div class=\"line\"><span class=\"comment\">## Plugins: https://hexo.io/plugins/</span></div><div class=\"line\"><span class=\"comment\">## Themes: https://hexo.io/themes/</span></div><div class=\"line\"><span class=\"attr\">theme:</span> next</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Deployment</span></div><div class=\"line\"><span class=\"comment\">## Docs: https://hexo.io/docs/deployment.html</span></div><div class=\"line\"><span class=\"attr\">deploy:</span></div><div class=\"line\"><span class=\"attr\">  type:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"attr\">feed:</span></div><div class=\"line\"><span class=\"attr\">  type:</span> atom</div><div class=\"line\"><span class=\"attr\">  path:</span> atom.xml</div><div class=\"line\"><span class=\"attr\">  limit:</span> <span class=\"number\">20</span></div><div class=\"line\"><span class=\"attr\">  hub:</span></div><div class=\"line\"><span class=\"attr\">  content:</span></div></pre></td></tr></table></figure>\n<h2 id=\"主题配置文件themes-next-config-yml\"><a href=\"#主题配置文件themes-next-config-yml\" class=\"headerlink\" title=\"主题配置文件themes/next/_config.yml\"></a>主题配置文件<code>themes/next/_config.yml</code></h2><figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div><div class=\"line\">147</div><div class=\"line\">148</div><div class=\"line\">149</div><div class=\"line\">150</div><div class=\"line\">151</div><div class=\"line\">152</div><div class=\"line\">153</div><div class=\"line\">154</div><div class=\"line\">155</div><div class=\"line\">156</div><div class=\"line\">157</div><div class=\"line\">158</div><div class=\"line\">159</div><div class=\"line\">160</div><div class=\"line\">161</div><div class=\"line\">162</div><div class=\"line\">163</div><div class=\"line\">164</div><div class=\"line\">165</div><div class=\"line\">166</div><div class=\"line\">167</div><div class=\"line\">168</div><div class=\"line\">169</div><div class=\"line\">170</div><div class=\"line\">171</div><div class=\"line\">172</div><div class=\"line\">173</div><div class=\"line\">174</div><div class=\"line\">175</div><div class=\"line\">176</div><div class=\"line\">177</div><div class=\"line\">178</div><div class=\"line\">179</div><div class=\"line\">180</div><div class=\"line\">181</div><div class=\"line\">182</div><div class=\"line\">183</div><div class=\"line\">184</div><div class=\"line\">185</div><div class=\"line\">186</div><div class=\"line\">187</div><div class=\"line\">188</div><div class=\"line\">189</div><div class=\"line\">190</div><div class=\"line\">191</div><div class=\"line\">192</div><div class=\"line\">193</div><div class=\"line\">194</div><div class=\"line\">195</div><div class=\"line\">196</div><div class=\"line\">197</div><div class=\"line\">198</div><div class=\"line\">199</div><div class=\"line\">200</div><div class=\"line\">201</div><div class=\"line\">202</div><div class=\"line\">203</div><div class=\"line\">204</div><div class=\"line\">205</div><div class=\"line\">206</div><div class=\"line\">207</div><div class=\"line\">208</div><div class=\"line\">209</div><div class=\"line\">210</div><div class=\"line\">211</div><div class=\"line\">212</div><div class=\"line\">213</div><div class=\"line\">214</div><div class=\"line\">215</div><div class=\"line\">216</div><div class=\"line\">217</div><div class=\"line\">218</div><div class=\"line\">219</div><div class=\"line\">220</div><div class=\"line\">221</div><div class=\"line\">222</div><div class=\"line\">223</div><div class=\"line\">224</div><div class=\"line\">225</div><div class=\"line\">226</div><div class=\"line\">227</div><div class=\"line\">228</div><div class=\"line\">229</div><div class=\"line\">230</div><div class=\"line\">231</div><div class=\"line\">232</div><div class=\"line\">233</div><div class=\"line\">234</div><div class=\"line\">235</div><div class=\"line\">236</div><div class=\"line\">237</div><div class=\"line\">238</div><div class=\"line\">239</div><div class=\"line\">240</div><div class=\"line\">241</div><div class=\"line\">242</div><div class=\"line\">243</div><div class=\"line\">244</div><div class=\"line\">245</div><div class=\"line\">246</div><div class=\"line\">247</div><div class=\"line\">248</div><div class=\"line\">249</div><div class=\"line\">250</div><div class=\"line\">251</div><div class=\"line\">252</div><div class=\"line\">253</div><div class=\"line\">254</div><div class=\"line\">255</div><div class=\"line\">256</div><div class=\"line\">257</div><div class=\"line\">258</div><div class=\"line\">259</div><div class=\"line\">260</div><div class=\"line\">261</div><div class=\"line\">262</div><div class=\"line\">263</div><div class=\"line\">264</div><div class=\"line\">265</div><div class=\"line\">266</div><div class=\"line\">267</div><div class=\"line\">268</div><div class=\"line\">269</div><div class=\"line\">270</div><div class=\"line\">271</div><div class=\"line\">272</div><div class=\"line\">273</div><div class=\"line\">274</div><div class=\"line\">275</div><div class=\"line\">276</div><div class=\"line\">277</div><div class=\"line\">278</div><div class=\"line\">279</div><div class=\"line\">280</div><div class=\"line\">281</div><div class=\"line\">282</div><div class=\"line\">283</div><div class=\"line\">284</div><div class=\"line\">285</div><div class=\"line\">286</div><div class=\"line\">287</div><div class=\"line\">288</div><div class=\"line\">289</div><div class=\"line\">290</div><div class=\"line\">291</div><div class=\"line\">292</div><div class=\"line\">293</div><div class=\"line\">294</div><div class=\"line\">295</div><div class=\"line\">296</div><div class=\"line\">297</div><div class=\"line\">298</div><div class=\"line\">299</div><div class=\"line\">300</div><div class=\"line\">301</div><div class=\"line\">302</div><div class=\"line\">303</div><div class=\"line\">304</div><div class=\"line\">305</div><div class=\"line\">306</div><div class=\"line\">307</div><div class=\"line\">308</div><div class=\"line\">309</div><div class=\"line\">310</div><div class=\"line\">311</div><div class=\"line\">312</div><div class=\"line\">313</div><div class=\"line\">314</div><div class=\"line\">315</div><div class=\"line\">316</div><div class=\"line\">317</div><div class=\"line\">318</div><div class=\"line\">319</div><div class=\"line\">320</div><div class=\"line\">321</div><div class=\"line\">322</div><div class=\"line\">323</div><div class=\"line\">324</div><div class=\"line\">325</div><div class=\"line\">326</div><div class=\"line\">327</div><div class=\"line\">328</div><div class=\"line\">329</div><div class=\"line\">330</div><div class=\"line\">331</div><div class=\"line\">332</div><div class=\"line\">333</div><div class=\"line\">334</div><div class=\"line\">335</div><div class=\"line\">336</div><div class=\"line\">337</div><div class=\"line\">338</div><div class=\"line\">339</div><div class=\"line\">340</div><div class=\"line\">341</div><div class=\"line\">342</div><div class=\"line\">343</div><div class=\"line\">344</div><div class=\"line\">345</div><div class=\"line\">346</div><div class=\"line\">347</div><div class=\"line\">348</div><div class=\"line\">349</div><div class=\"line\">350</div><div class=\"line\">351</div><div class=\"line\">352</div><div class=\"line\">353</div><div class=\"line\">354</div><div class=\"line\">355</div><div class=\"line\">356</div><div class=\"line\">357</div><div class=\"line\">358</div><div class=\"line\">359</div><div class=\"line\">360</div><div class=\"line\">361</div><div class=\"line\">362</div><div class=\"line\">363</div><div class=\"line\">364</div><div class=\"line\">365</div><div class=\"line\">366</div><div class=\"line\">367</div><div class=\"line\">368</div><div class=\"line\">369</div><div class=\"line\">370</div><div class=\"line\">371</div><div class=\"line\">372</div><div class=\"line\">373</div><div class=\"line\">374</div><div class=\"line\">375</div><div class=\"line\">376</div><div class=\"line\">377</div><div class=\"line\">378</div><div class=\"line\">379</div><div class=\"line\">380</div><div class=\"line\">381</div><div class=\"line\">382</div><div class=\"line\">383</div><div class=\"line\">384</div><div class=\"line\">385</div><div class=\"line\">386</div><div class=\"line\">387</div><div class=\"line\">388</div><div class=\"line\">389</div><div class=\"line\">390</div><div class=\"line\">391</div><div class=\"line\">392</div><div class=\"line\">393</div><div class=\"line\">394</div><div class=\"line\">395</div><div class=\"line\">396</div><div class=\"line\">397</div><div class=\"line\">398</div><div class=\"line\">399</div><div class=\"line\">400</div><div class=\"line\">401</div><div class=\"line\">402</div><div class=\"line\">403</div><div class=\"line\">404</div><div class=\"line\">405</div><div class=\"line\">406</div><div class=\"line\">407</div><div class=\"line\">408</div><div class=\"line\">409</div><div class=\"line\">410</div><div class=\"line\">411</div><div class=\"line\">412</div><div class=\"line\">413</div><div class=\"line\">414</div><div class=\"line\">415</div><div class=\"line\">416</div><div class=\"line\">417</div><div class=\"line\">418</div><div class=\"line\">419</div><div class=\"line\">420</div><div class=\"line\">421</div><div class=\"line\">422</div><div class=\"line\">423</div><div class=\"line\">424</div><div class=\"line\">425</div><div class=\"line\">426</div><div class=\"line\">427</div><div class=\"line\">428</div><div class=\"line\">429</div><div class=\"line\">430</div><div class=\"line\">431</div><div class=\"line\">432</div><div class=\"line\">433</div><div class=\"line\">434</div><div class=\"line\">435</div><div class=\"line\">436</div><div class=\"line\">437</div><div class=\"line\">438</div><div class=\"line\">439</div><div class=\"line\">440</div><div class=\"line\">441</div><div class=\"line\">442</div><div class=\"line\">443</div><div class=\"line\">444</div><div class=\"line\">445</div><div class=\"line\">446</div><div class=\"line\">447</div><div class=\"line\">448</div><div class=\"line\">449</div><div class=\"line\">450</div><div class=\"line\">451</div><div class=\"line\">452</div><div class=\"line\">453</div><div class=\"line\">454</div><div class=\"line\">455</div><div class=\"line\">456</div><div class=\"line\">457</div><div class=\"line\">458</div><div class=\"line\">459</div><div class=\"line\">460</div><div class=\"line\">461</div><div class=\"line\">462</div><div class=\"line\">463</div><div class=\"line\">464</div><div class=\"line\">465</div><div class=\"line\">466</div><div class=\"line\">467</div><div class=\"line\">468</div><div class=\"line\">469</div><div class=\"line\">470</div><div class=\"line\">471</div><div class=\"line\">472</div><div class=\"line\">473</div><div class=\"line\">474</div><div class=\"line\">475</div><div class=\"line\">476</div><div class=\"line\">477</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"><span class=\"comment\"># Site Information Settings</span></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Put your favicon.ico into `hexo-site/source/` directory.</span></div><div class=\"line\"><span class=\"attr\">favicon:</span> /favicon.ico</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Set default keywords (Use a comma to separate)</span></div><div class=\"line\"><span class=\"attr\">keywords:</span> <span class=\"string\">\"Hexo, NexT\"</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Set rss to false to disable feed link.</span></div><div class=\"line\"><span class=\"comment\"># Leave rss as empty to use site's feed link.</span></div><div class=\"line\"><span class=\"comment\"># Set rss to specific value if you have burned your feed already.</span></div><div class=\"line\"><span class=\"attr\">rss:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Specify the date when the site was setup</span></div><div class=\"line\"><span class=\"attr\">since:</span> <span class=\"number\">2012</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># icon between year and author @Footer</span></div><div class=\"line\"><span class=\"attr\">authoricon:</span> heart</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Footer `powered-by` and `theme-info` copyright</span></div><div class=\"line\"><span class=\"attr\">copyright:</span> <span class=\"literal\">true</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Canonical, set a canonical link tag in your hexo, you could use it for your SEO of blog.</span></div><div class=\"line\"><span class=\"comment\"># See: https://support.google.com/webmasters/answer/139066</span></div><div class=\"line\"><span class=\"comment\"># Tips: Before you open this tag, remeber set up your URL in hexo _config.yml ( ex. url: http://yourdomain.com )</span></div><div class=\"line\"><span class=\"attr\">canonical:</span> <span class=\"literal\">true</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Change headers hierarchy on site-subtitle (will be main site description) and on all post/pages titles for better SEO-optimization.</span></div><div class=\"line\"><span class=\"attr\">seo:</span> <span class=\"literal\">false</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"><span class=\"comment\"># Menu Settings</span></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># When running the site in a subdirectory (e.g. domain.tld/blog), remove the leading slash (/archives -&gt; archives)</span></div><div class=\"line\"><span class=\"attr\">menu:</span></div><div class=\"line\"><span class=\"attr\">  home:</span> /</div><div class=\"line\"><span class=\"attr\">  categories:</span> /categories</div><div class=\"line\"><span class=\"attr\">  archives:</span> /archives</div><div class=\"line\"><span class=\"attr\">  tags:</span> /tags</div><div class=\"line\"><span class=\"attr\">  about:</span> /about</div><div class=\"line\">  <span class=\"comment\">#sitemap: /sitemap.xml</span></div><div class=\"line\">  <span class=\"comment\">#commonweal: /404.html</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Enable/Disable menu icons.</span></div><div class=\"line\"><span class=\"comment\"># Icon Mapping:</span></div><div class=\"line\"><span class=\"comment\">#   Map a menu item to a specific FontAwesome icon name.</span></div><div class=\"line\"><span class=\"comment\">#   Key is the name of menu item and value is the name of FontAwsome icon. Key is case-senstive.</span></div><div class=\"line\"><span class=\"comment\">#   When an question mask icon presenting up means that the item has no mapping icon.</span></div><div class=\"line\"><span class=\"attr\">menu_icons:</span></div><div class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></div><div class=\"line\">  <span class=\"comment\">#KeyMapsToMenuItemKey: NameOfTheIconFromFontAwesome</span></div><div class=\"line\"><span class=\"attr\">  home:</span> home</div><div class=\"line\"><span class=\"attr\">  about:</span> user</div><div class=\"line\"><span class=\"attr\">  categories:</span> th</div><div class=\"line\"><span class=\"attr\">  schedule:</span> calendar</div><div class=\"line\"><span class=\"attr\">  tags:</span> tags</div><div class=\"line\"><span class=\"attr\">  archives:</span> archive</div><div class=\"line\"><span class=\"attr\">  sitemap:</span> sitemap</div><div class=\"line\"><span class=\"attr\">  commonweal:</span> heartbeat</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"><span class=\"comment\"># Scheme Settings</span></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Schemes</span></div><div class=\"line\"><span class=\"comment\">#scheme: Muse</span></div><div class=\"line\"><span class=\"attr\">scheme:</span> Mist</div><div class=\"line\"><span class=\"comment\">#scheme: Pisces</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"><span class=\"comment\"># Font Settings</span></div><div class=\"line\"><span class=\"comment\"># - Find fonts on Google Fonts (https://www.google.com/fonts)</span></div><div class=\"line\"><span class=\"comment\"># - All fonts set here will have the following styles:</span></div><div class=\"line\"><span class=\"comment\">#     light, light italic, normal, normal intalic, bold, bold italic</span></div><div class=\"line\"><span class=\"comment\"># - Be aware that setting too much fonts will cause site running slowly</span></div><div class=\"line\"><span class=\"comment\"># - Introduce in 5.0.1</span></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"><span class=\"attr\">font:</span></div><div class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Uri of fonts host. E.g. //fonts.googleapis.com (Default)</span></div><div class=\"line\"><span class=\"attr\">  host:</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Global font settings used on &lt;body&gt; element.</span></div><div class=\"line\"><span class=\"attr\">  global:</span></div><div class=\"line\">    <span class=\"comment\"># external: true will load this font family from host.</span></div><div class=\"line\"><span class=\"attr\">    external:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">    family:</span> Lato</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Font settings for Headlines (h1, h2, h3, h4, h5, h6)</span></div><div class=\"line\">  <span class=\"comment\"># Fallback to `global` font settings.</span></div><div class=\"line\"><span class=\"attr\">  headings:</span></div><div class=\"line\"><span class=\"attr\">    external:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">    family:</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Font settings for posts</span></div><div class=\"line\">  <span class=\"comment\"># Fallback to `global` font settings.</span></div><div class=\"line\"><span class=\"attr\">  posts:</span></div><div class=\"line\"><span class=\"attr\">    external:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">    family:</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Font settings for Logo</span></div><div class=\"line\">  <span class=\"comment\"># Fallback to `global` font settings.</span></div><div class=\"line\">  <span class=\"comment\"># The `size` option use `px` as unit</span></div><div class=\"line\"><span class=\"attr\">  logo:</span></div><div class=\"line\"><span class=\"attr\">    external:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">    family:</span></div><div class=\"line\"><span class=\"attr\">    size:</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Font settings for &lt;code&gt; and code blocks.</span></div><div class=\"line\"><span class=\"attr\">  codes:</span></div><div class=\"line\"><span class=\"attr\">    external:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">    family:</span></div><div class=\"line\"><span class=\"attr\">    size:</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"><span class=\"comment\"># Sidebar Settings</span></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Social Links</span></div><div class=\"line\"><span class=\"comment\"># Key is the link label showing to end users.</span></div><div class=\"line\"><span class=\"comment\"># Value is the target link (E.g. GitHub: https://github.com/iissnan)</span></div><div class=\"line\"><span class=\"comment\">#social:</span></div><div class=\"line\">  <span class=\"comment\">#LinkLabel: Link</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Social Links Icons</span></div><div class=\"line\"><span class=\"comment\"># Icon Mapping:</span></div><div class=\"line\"><span class=\"comment\">#   Map a menu item to a specific FontAwesome icon name.</span></div><div class=\"line\"><span class=\"comment\">#   Key is the name of the item and value is the name of FontAwsome icon. Key is case-senstive.</span></div><div class=\"line\"><span class=\"comment\">#   When an globe mask icon presenting up means that the item has no mapping icon.</span></div><div class=\"line\"><span class=\"attr\">social_icons:</span></div><div class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></div><div class=\"line\">  <span class=\"comment\"># Icon Mappings.</span></div><div class=\"line\">  <span class=\"comment\"># KeyMapsToSocalItemKey: NameOfTheIconFromFontAwesome</span></div><div class=\"line\"><span class=\"attr\">  GitHub:</span> github</div><div class=\"line\"><span class=\"attr\">  Twitter:</span> twitter</div><div class=\"line\"><span class=\"attr\">  Weibo:</span> weibo</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Sidebar Avatar</span></div><div class=\"line\"><span class=\"comment\"># in theme directory(source/images): /images/avatar.jpg</span></div><div class=\"line\"><span class=\"comment\"># in site  directory(source/uploads): /uploads/avatar.jpg</span></div><div class=\"line\"><span class=\"attr\">avatar:</span> /images/avatar.png</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Table Of Contents in the Sidebar</span></div><div class=\"line\"><span class=\"attr\">toc:</span></div><div class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Automatically add list number to toc.</span></div><div class=\"line\"><span class=\"attr\">  number:</span> <span class=\"literal\">true</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Creative Commons 4.0 International License.</span></div><div class=\"line\"><span class=\"comment\"># http://creativecommons.org/</span></div><div class=\"line\"><span class=\"comment\"># Available: by | by-nc | by-nc-nd | by-nc-sa | by-nd | by-sa | zero</span></div><div class=\"line\"><span class=\"comment\">#creative_commons: by-nc-sa</span></div><div class=\"line\"><span class=\"comment\">#creative_commons:</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"attr\">sidebar:</span></div><div class=\"line\">  <span class=\"comment\"># Sidebar Position, available value: left | right</span></div><div class=\"line\"><span class=\"attr\">  position:</span> left</div><div class=\"line\">  <span class=\"comment\">#position: right</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Sidebar Display, available value:</span></div><div class=\"line\">  <span class=\"comment\">#  - post    expand on posts automatically. Default.</span></div><div class=\"line\">  <span class=\"comment\">#  - always  expand for all pages automatically</span></div><div class=\"line\">  <span class=\"comment\">#  - hide    expand only when click on the sidebar toggle icon.</span></div><div class=\"line\">  <span class=\"comment\">#  - remove  Totally remove sidebar including sidebar toggler.</span></div><div class=\"line\"><span class=\"attr\">  display:</span> post</div><div class=\"line\">  <span class=\"comment\">#display: always</span></div><div class=\"line\">  <span class=\"comment\">#display: hide</span></div><div class=\"line\">  <span class=\"comment\">#display: remove</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Blogrolls</span></div><div class=\"line\"><span class=\"comment\">#links_title: Links</span></div><div class=\"line\"><span class=\"comment\">#links_layout: block</span></div><div class=\"line\"><span class=\"comment\">#links_layout: inline</span></div><div class=\"line\"><span class=\"comment\">#links:</span></div><div class=\"line\">  <span class=\"comment\">#Title: http://example.com/</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"><span class=\"comment\"># Post Settings</span></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Automatically scroll page to section which is under &lt;!-- more --&gt; mark.</span></div><div class=\"line\"><span class=\"attr\">scroll_to_more:</span> <span class=\"literal\">true</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Automatically excerpt description in homepage as preamble text.</span></div><div class=\"line\"><span class=\"attr\">excerpt_description:</span> <span class=\"literal\">true</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Automatically Excerpt. Not recommand.</span></div><div class=\"line\"><span class=\"comment\"># Please use &lt;!-- more --&gt; in the post to control excerpt accurately.</span></div><div class=\"line\"><span class=\"attr\">auto_excerpt:</span></div><div class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">  length:</span> <span class=\"number\">150</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Post meta display settings</span></div><div class=\"line\"><span class=\"attr\">post_meta:</span></div><div class=\"line\"><span class=\"attr\">  item_text:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">  created_at:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">  updated_at:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">  categories:</span> <span class=\"literal\">true</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Wechat Subscriber</span></div><div class=\"line\"><span class=\"comment\">#wechat_subscriber:</span></div><div class=\"line\">  <span class=\"comment\">#enabled: true</span></div><div class=\"line\">  <span class=\"comment\">#qcode: /path/to/your/wechatqcode ex. /uploads/wechat-qcode.jpg</span></div><div class=\"line\">  <span class=\"comment\">#description: ex. subscribe to my blog by scanning my public wechat account</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"><span class=\"comment\"># Misc Theme Settings</span></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Custom Logo.</span></div><div class=\"line\"><span class=\"comment\"># !!Only available for Default Scheme currently.</span></div><div class=\"line\"><span class=\"comment\"># Options:</span></div><div class=\"line\"><span class=\"comment\">#   enabled: [true/false] - Replace with specific image</span></div><div class=\"line\"><span class=\"comment\">#   image: url-of-image   - Images's url</span></div><div class=\"line\"><span class=\"attr\">custom_logo:</span></div><div class=\"line\"><span class=\"attr\">  enabled:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">  image:</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Code Highlight theme</span></div><div class=\"line\"><span class=\"comment\"># Available value:</span></div><div class=\"line\"><span class=\"comment\">#    normal | night | night eighties | night blue | night bright</span></div><div class=\"line\"><span class=\"comment\"># https://github.com/chriskempson/tomorrow-theme</span></div><div class=\"line\"><span class=\"attr\">highlight_theme:</span> normal</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"><span class=\"comment\"># Third Party Services Settings</span></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># MathJax Support</span></div><div class=\"line\"><span class=\"attr\">mathjax:</span></div><div class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">  per_page:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">  cdn:</span> //cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Swiftype Search API Key</span></div><div class=\"line\"><span class=\"comment\">#swiftype_key:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Baidu Analytics ID</span></div><div class=\"line\"><span class=\"attr\">baidu_analytics:</span> <span class=\"number\">36175</span>c8b1958d080e840f34fc69cf52d</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Duoshuo ShortName</span></div><div class=\"line\"><span class=\"attr\">duoshuo_shortname:</span> quxionglie</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Disqus</span></div><div class=\"line\"><span class=\"comment\">#disqus_shortname:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Hypercomments</span></div><div class=\"line\"><span class=\"comment\">#hypercomments_id:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Gentie productKey</span></div><div class=\"line\"><span class=\"comment\">#gentie_productKey:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Support for youyan comments system.</span></div><div class=\"line\"><span class=\"comment\"># You can get your uid from http://www.uyan.cc</span></div><div class=\"line\"><span class=\"comment\">#youyan_uid: your uid</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Baidu Share</span></div><div class=\"line\"><span class=\"comment\"># Available value:</span></div><div class=\"line\"><span class=\"comment\">#    button | slide</span></div><div class=\"line\"><span class=\"comment\"># Warning: Baidu Share does not support https.</span></div><div class=\"line\"><span class=\"comment\">#baidushare:</span></div><div class=\"line\"><span class=\"comment\">##  type: button</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Share</span></div><div class=\"line\"><span class=\"comment\">#jiathis:</span></div><div class=\"line\"><span class=\"comment\"># Warning: JiaThis does not support https.</span></div><div class=\"line\"><span class=\"comment\">#add_this_id:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Share</span></div><div class=\"line\"><span class=\"comment\">#duoshuo_share: true</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Google Webmaster tools verification setting</span></div><div class=\"line\"><span class=\"comment\"># See: https://www.google.com/webmasters/</span></div><div class=\"line\"><span class=\"comment\">#google_site_verification:</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Google Analytics</span></div><div class=\"line\"><span class=\"comment\">#google_analytics:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># CNZZ count</span></div><div class=\"line\"><span class=\"comment\">#cnzz_siteid:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Application Insights</span></div><div class=\"line\"><span class=\"comment\"># See https://azure.microsoft.com/en-us/services/application-insights/</span></div><div class=\"line\"><span class=\"comment\"># application_insights:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Make duoshuo show UA</span></div><div class=\"line\"><span class=\"comment\"># user_id must NOT be null when admin_enable is true!</span></div><div class=\"line\"><span class=\"comment\"># you can visit http://dev.duoshuo.com get duoshuo user id.</span></div><div class=\"line\"><span class=\"attr\">duoshuo_info:</span></div><div class=\"line\"><span class=\"attr\">  ua_enable:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">  admin_enable:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">  user_id:</span> <span class=\"number\">0</span></div><div class=\"line\">  <span class=\"comment\">#admin_nickname: Author</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Facebook SDK Support.</span></div><div class=\"line\"><span class=\"comment\"># https://github.com/iissnan/hexo-theme-next/pull/410</span></div><div class=\"line\"><span class=\"attr\">facebook_sdk:</span></div><div class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">  app_id:</span>       <span class=\"comment\">#&lt;app_id&gt;</span></div><div class=\"line\"><span class=\"attr\">  fb_admin:</span>     <span class=\"comment\">#&lt;user_id&gt;</span></div><div class=\"line\"><span class=\"attr\">  like_button:</span>  <span class=\"comment\">#true</span></div><div class=\"line\"><span class=\"attr\">  webmaster:</span>    <span class=\"comment\">#true</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Facebook comments plugin</span></div><div class=\"line\"><span class=\"comment\"># This plugin depends on Facebook SDK.</span></div><div class=\"line\"><span class=\"comment\"># If facebook_sdk.enable is false, Facebook comments plugin is unavailable.</span></div><div class=\"line\"><span class=\"attr\">facebook_comments_plugin:</span></div><div class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">  num_of_posts:</span> <span class=\"number\">10</span>  <span class=\"comment\"># min posts num is 1</span></div><div class=\"line\"><span class=\"attr\">  width:</span> <span class=\"number\">100</span>%       <span class=\"comment\"># default width is 550px</span></div><div class=\"line\"><span class=\"attr\">  scheme:</span> light     <span class=\"comment\"># default scheme is light (light or dark)</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Show number of visitors to each article.</span></div><div class=\"line\"><span class=\"comment\"># You can visit https://leancloud.cn get AppID and AppKey.</span></div><div class=\"line\"><span class=\"attr\">leancloud_visitors:</span></div><div class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">  app_id:</span> <span class=\"comment\">#&lt;app_id&gt;</span></div><div class=\"line\"><span class=\"attr\">  app_key:</span> <span class=\"comment\">#&lt;app_key&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Show PV/UV of the website/page with busuanzi.</span></div><div class=\"line\"><span class=\"comment\"># Get more information on http://ibruce.info/2015/04/04/busuanzi/</span></div><div class=\"line\"><span class=\"attr\">busuanzi_count:</span></div><div class=\"line\">  <span class=\"comment\"># count values only if the other configs are false</span></div><div class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">false</span></div><div class=\"line\">  <span class=\"comment\"># custom uv span for the whole site</span></div><div class=\"line\"><span class=\"attr\">  site_uv:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">  site_uv_header:</span> &lt;i class=<span class=\"string\">\"fa fa-user\"</span>&gt;&lt;/i<span class=\"string\">&gt;</span></div><div class=\"line\"><span class=\"attr\">  site_uv_footer:</span></div><div class=\"line\">  <span class=\"comment\"># custom pv span for the whole site</span></div><div class=\"line\"><span class=\"attr\">  site_pv:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">  site_pv_header:</span> &lt;i class=<span class=\"string\">\"fa fa-eye\"</span>&gt;&lt;/i<span class=\"string\">&gt;</span></div><div class=\"line\"><span class=\"attr\">  site_pv_footer:</span></div><div class=\"line\">  <span class=\"comment\"># custom pv span for one page only</span></div><div class=\"line\"><span class=\"attr\">  page_pv:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">  page_pv_header:</span> &lt;i class=<span class=\"string\">\"fa fa-file-o\"</span>&gt;&lt;/i<span class=\"string\">&gt;</span></div><div class=\"line\"><span class=\"attr\">  page_pv_footer:</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Tencent analytics ID</span></div><div class=\"line\"><span class=\"comment\"># tencent_analytics:</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Enable baidu push so that the blog will push the url to baidu automatically which is very helpful for SEO</span></div><div class=\"line\"><span class=\"attr\">baidu_push:</span> <span class=\"literal\">false</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Google Calendar</span></div><div class=\"line\"><span class=\"comment\"># Share your recent schedule to others via calendar page</span></div><div class=\"line\"><span class=\"comment\">#</span></div><div class=\"line\"><span class=\"comment\"># API Documentation:</span></div><div class=\"line\"><span class=\"comment\"># https://developers.google.com/google-apps/calendar/v3/reference/events/list</span></div><div class=\"line\"><span class=\"attr\">calendar:</span></div><div class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">  calendar_id:</span> &lt;required<span class=\"string\">&gt;</span></div><div class=\"line\"><span class=\"attr\">  api_key:</span> &lt;required<span class=\"string\">&gt;</span></div><div class=\"line\"><span class=\"attr\">  orderBy:</span> startTime</div><div class=\"line\"><span class=\"attr\">  offsetMax:</span> <span class=\"number\">24</span></div><div class=\"line\"><span class=\"attr\">  offsetMin:</span> <span class=\"number\">4</span></div><div class=\"line\"><span class=\"attr\">  timeZone:</span></div><div class=\"line\"><span class=\"attr\">  showDeleted:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">  singleEvents:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">  maxResults:</span> <span class=\"number\">250</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Algolia Search</span></div><div class=\"line\"><span class=\"attr\">algolia_search:</span></div><div class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">  hits:</span></div><div class=\"line\"><span class=\"attr\">    per_page:</span> <span class=\"number\">10</span></div><div class=\"line\"><span class=\"attr\">  labels:</span></div><div class=\"line\"><span class=\"attr\">    input_placeholder:</span> Search for Posts</div><div class=\"line\"><span class=\"attr\">    hits_empty:</span> <span class=\"string\">\"We didn't find any results for the search: $&#123;query&#125;\"</span></div><div class=\"line\"><span class=\"attr\">    hits_stats:</span> <span class=\"string\">\"$&#123;hits&#125; results found in $&#123;time&#125; ms\"</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#! ---------------------------------------------------------------</span></div><div class=\"line\"><span class=\"comment\">#! DO NOT EDIT THE FOLLOWING SETTINGS</span></div><div class=\"line\"><span class=\"comment\">#! UNLESS YOU KNOW WHAT YOU ARE DOING</span></div><div class=\"line\"><span class=\"comment\">#! ---------------------------------------------------------------</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Motion</span></div><div class=\"line\"><span class=\"attr\">use_motion:</span> <span class=\"literal\">true</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Fancybox</span></div><div class=\"line\"><span class=\"attr\">fancybox:</span> <span class=\"literal\">true</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Canvas-nest</span></div><div class=\"line\"><span class=\"attr\">canvas_nest:</span> <span class=\"literal\">false</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Script Vendors.</span></div><div class=\"line\"><span class=\"comment\"># Set a CDN address for the vendor you want to customize.</span></div><div class=\"line\"><span class=\"comment\"># For example</span></div><div class=\"line\"><span class=\"comment\">#    jquery: https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js</span></div><div class=\"line\"><span class=\"comment\"># Be aware that you should use the same version as internal ones to avoid potential problems.</span></div><div class=\"line\"><span class=\"comment\"># Please use the https protocol of CDN files when you enable https on your site.</span></div><div class=\"line\"><span class=\"attr\">vendors:</span></div><div class=\"line\">  <span class=\"comment\"># Internal path prefix. Please do not edit it.</span></div><div class=\"line\"><span class=\"attr\">  _internal:</span> lib</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Internal version: 2.1.3</span></div><div class=\"line\"><span class=\"attr\">  jquery:</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Internal version: 2.1.5</span></div><div class=\"line\">  <span class=\"comment\"># See: http://fancyapps.com/fancybox/</span></div><div class=\"line\"><span class=\"attr\">  fancybox:</span></div><div class=\"line\"><span class=\"attr\">  fancybox_css:</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Internal version: 1.0.6</span></div><div class=\"line\">  <span class=\"comment\"># See: https://github.com/ftlabs/fastclick</span></div><div class=\"line\"><span class=\"attr\">  fastclick:</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Internal version: 1.9.7</span></div><div class=\"line\">  <span class=\"comment\"># See: https://github.com/tuupola/jquery_lazyload</span></div><div class=\"line\"><span class=\"attr\">  lazyload:</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Internal version: 1.2.1</span></div><div class=\"line\">  <span class=\"comment\"># See: http://VelocityJS.org</span></div><div class=\"line\"><span class=\"attr\">  velocity:</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Internal version: 1.2.1</span></div><div class=\"line\">  <span class=\"comment\"># See: http://VelocityJS.org</span></div><div class=\"line\"><span class=\"attr\">  velocity_ui:</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Internal version: 0.7.9</span></div><div class=\"line\">  <span class=\"comment\"># See: https://faisalman.github.io/ua-parser-js/</span></div><div class=\"line\"><span class=\"attr\">  ua_parser:</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Internal version: 4.6.2</span></div><div class=\"line\">  <span class=\"comment\"># See: http://fontawesome.io/</span></div><div class=\"line\"><span class=\"attr\">  fontawesome:</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Internal version: 1</span></div><div class=\"line\">  <span class=\"comment\"># https://www.algolia.com</span></div><div class=\"line\"><span class=\"attr\">  algolia_instant_js:</span></div><div class=\"line\"><span class=\"attr\">  algolia_instant_css:</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Internal version: 1.0.0</span></div><div class=\"line\">  <span class=\"comment\"># https://github.com/hustcc/canvas-nest.js</span></div><div class=\"line\"><span class=\"attr\">  canvas_nest:</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Assets</span></div><div class=\"line\"><span class=\"attr\">css:</span> css</div><div class=\"line\"><span class=\"attr\">js:</span> js</div><div class=\"line\"><span class=\"attr\">images:</span> images</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Theme version</span></div><div class=\"line\"><span class=\"attr\">version:</span> <span class=\"number\">5.1</span><span class=\"number\">.0</span></div></pre></td></tr></table></figure>\n","excerpt":"<p>我的博客以前由Jekyll搭建，但从 Jekyll 2升级到 Jekyll 3后，我发现自己开始关注于Jekyll及其模板本身而不是博文内容本身。故转而使用Hexo来搭建博客，并更换了更加简洁明快的next主题模板。如果想从Jekyll转到Hexo可以参考本文。</p>","more":"<h1 id=\"安装Hexo\"><a href=\"#安装Hexo\" class=\"headerlink\" title=\"安装Hexo\"></a>安装Hexo</h1><h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">npm install -g hexo-cli</div></pre></td></tr></table></figure>\n<p>node与hexo环境版本：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\">➜  ~ node -v</div><div class=\"line\">v7.2.1</div><div class=\"line\">➜  ~ hexo -v</div><div class=\"line\">hexo-cli: 1.0.2</div><div class=\"line\">os: Darwin 16.3.0 darwin x64</div><div class=\"line\">http_parser: 2.7.0</div><div class=\"line\">node: 7.2.1</div><div class=\"line\">v8: 5.4.500.44</div><div class=\"line\">uv: 1.10.1</div><div class=\"line\">zlib: 1.2.8</div><div class=\"line\">ares: 1.10.1-DEV</div><div class=\"line\">modules: 51</div><div class=\"line\">openssl: 1.0.2j</div><div class=\"line\">icu: 58.1</div><div class=\"line\">unicode: 9.0</div><div class=\"line\">cldr: 30.0.2</div><div class=\"line\">tz: 2016g</div></pre></td></tr></table></figure>\n<h2 id=\"部署\"><a href=\"#部署\" class=\"headerlink\" title=\"部署\"></a>部署</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">hexo init quxionglie.com</div><div class=\"line\">cd quxionglie.com</div><div class=\"line\">npm install</div></pre></td></tr></table></figure>\n<p>安装后目录</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">.</div><div class=\"line\">├── _config.yml</div><div class=\"line\">├── node_modules</div><div class=\"line\">├── package.json</div><div class=\"line\">├── scaffolds</div><div class=\"line\">├── source</div><div class=\"line\">└── themes</div><div class=\"line\"></div><div class=\"line\">4 directories, 2 files</div></pre></td></tr></table></figure>\n<!-- more -->\n<h1 id=\"Hexo常用命令\"><a href=\"#Hexo常用命令\" class=\"headerlink\" title=\"Hexo常用命令\"></a>Hexo常用命令</h1><h2 id=\"new-生成新的blog\"><a href=\"#new-生成新的blog\" class=\"headerlink\" title=\"new - 生成新的blog\"></a>new - 生成新的blog</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">hexo new [layout] &lt;title&gt;</div></pre></td></tr></table></figure>\n<p>执行new命令，生成指定名称的文章至 source/posts/title.md。</p>\n<p>其中layout是可选参数，默认值为post。scaffolds目录下的文件名称就是layout名称。你也可以添加自己的layout，方法就是添加一个文件即可，同时你也可以编辑现有的layout，比如post的layout默认是scaffolds/post.md</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">➜  ls -l scaffolds</div><div class=\"line\">total 24</div><div class=\"line\">-rw-r--r--  1 quxl  staff  33 Jan 26 19:18 draft.md</div><div class=\"line\">-rw-r--r--  1 quxl  staff  44 Jan 26 19:18 page.md</div><div class=\"line\">-rw-r--r--  1 quxl  staff  50 Jan 26 19:18 post.md</div><div class=\"line\"></div><div class=\"line\">➜  cat scaffolds/post.md</div><div class=\"line\">---</div><div class=\"line\">title: &#123;&#123; title &#125;&#125;</div><div class=\"line\">date: &#123;&#123; date &#125;&#125;</div><div class=\"line\">tags:</div><div class=\"line\">---</div></pre></td></tr></table></figure>\n<p>参考：<a href=\"https://hexo.io/docs/writing.html\">writing</a></p>\n<h2 id=\"server-启动服务器\"><a href=\"#server-启动服务器\" class=\"headerlink\" title=\"server - 启动服务器\"></a>server - 启动服务器</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">hexo server</div></pre></td></tr></table></figure>\n<p>参考：<a href=\"https://hexo.io/docs/server.html\">server</a></p>\n<p>运行后，可以在浏览器上打开<code>http://localhost:4000</code>查看效果。启动后，hexo会监听文件变化并自动更新，所以没必要重启服务器。</p>\n<h2 id=\"generate-生成静态站点文件\"><a href=\"#generate-生成静态站点文件\" class=\"headerlink\" title=\"generate - 生成静态站点文件\"></a>generate - 生成静态站点文件</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">hexo generate</div></pre></td></tr></table></figure>\n<p>生成静态文件。</p>\n<p>生成后自动部署:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">#下面命令是同样的效果</div><div class=\"line\">hexo generate --deploy</div><div class=\"line\">hexo deploy --generate</div></pre></td></tr></table></figure>\n<p>参考：<a href=\"https://hexo.io/docs/generate.html\">generate</a></p>\n<h1 id=\"安装Next\"><a href=\"#安装Next\" class=\"headerlink\" title=\"安装Next\"></a>安装Next</h1><p>参考：<a href=\"http://theme-next.iissnan.com/getting-started.html\">next getting-started</a></p>\n<h2 id=\"下载Next主题\"><a href=\"#下载Next主题\" class=\"headerlink\" title=\"下载Next主题\"></a>下载Next主题</h2><p>克隆最新版本。<br>在终端窗口下，定位到 Hexo 站点目录下。使用 Git checkout 代码：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd quxionglie.com</div><div class=\"line\">git clone https://github.com/iissnan/hexo-theme-next themes/next</div></pre></td></tr></table></figure>\n<h2 id=\"应用Next主题\"><a href=\"#应用Next主题\" class=\"headerlink\" title=\"应用Next主题\"></a>应用Next主题</h2><p>与所有 Hexo 主题启用的模式一样。在根目录下找到<code>_config.yml</code>配置文件，找到 theme 字段，并将其值更改为 next ：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">theme: next</div></pre></td></tr></table></figure>\n<h2 id=\"选择-Scheme\"><a href=\"#选择-Scheme\" class=\"headerlink\" title=\"选择 Scheme\"></a>选择 Scheme</h2><p>Scheme 是 NexT 提供的一种特性，借助于 Scheme，NexT 为你提供多种不同的外观。同时，几乎所有的配置都可以 在 Scheme 之间共用。目前 NexT 支持三种 Scheme，他们是：</p>\n<ul>\n<li><code>Muse</code> - 默认 Scheme，这是 NexT 最初的版本，黑白主调，大量留白</li>\n<li><code>Mist</code> - Muse 的紧凑版本，整洁有序的单栏外观</li>\n<li><code>Pisces</code> - 双栏 Scheme，小家碧玉似的清新</li>\n</ul>\n<p>Scheme 的切换通过更改主题配置文件<code>themes/next/_config.yml</code>，搜索 scheme 关键字。 你会看到有三行 scheme 的配置，将你需用启用的 scheme 前面注释 # 即可。</p>\n<p>选择 Mist Scheme</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">#scheme: Muse</div><div class=\"line\">scheme: Mist</div><div class=\"line\">#scheme: Pisces</div></pre></td></tr></table></figure>\n<h2 id=\"设置-语言\"><a href=\"#设置-语言\" class=\"headerlink\" title=\"设置 语言\"></a>设置 语言</h2><p>编辑 站点配置文件<code>_config.yml</code>， 将 language 设置成你所需要的语言。建议明确设置你所需要的语言，例如选用简体中文，配置如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">language: zh-Hans</div></pre></td></tr></table></figure>\n<h2 id=\"设置-菜单\"><a href=\"#设置-菜单\" class=\"headerlink\" title=\"设置 菜单\"></a>设置 菜单</h2><p>菜单配置包括三个部分，第一是菜单项（名称和链接），第二是菜单项的显示文本，第三是菜单项对应的图标。 NexT 使用的是 Font Awesome 提供的图标， Font Awesome 提供了 600+ 的图标，可以满足绝大的多数的场景，同时无须担心在 Retina 屏幕下 图标模糊的问题。</p>\n<p>编辑主题配置文件<code>themes/next/_config.yml</code>，修改以下内容：</p>\n<ul>\n<li>设定菜单内容，对应的字段是 menu。 菜单内容的设置格式是：item name: link。其中 item name 是一个名称，这个名称并不直接显示在页面上，她将用于匹配图标以及翻译。</li>\n</ul>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"attr\">menu:</span></div><div class=\"line\"><span class=\"attr\">  home:</span> /</div><div class=\"line\"><span class=\"attr\">  categories:</span> /categories</div><div class=\"line\"><span class=\"attr\">  archives:</span> /archives</div><div class=\"line\"><span class=\"attr\">  tags:</span> /tags</div><div class=\"line\"><span class=\"attr\">  about:</span> /about</div><div class=\"line\">  <span class=\"comment\">#sitemap: /sitemap.xml</span></div><div class=\"line\">  <span class=\"comment\">#commonweal: /404.html</span></div></pre></td></tr></table></figure>\n<h1 id=\"主题设定\"><a href=\"#主题设定\" class=\"headerlink\" title=\"主题设定\"></a>主题设定</h1><p>参考：<a href=\"http://theme-next.iissnan.com/theme-settings.html\">next 主题配置</a></p>\n<h2 id=\"设置RSS\"><a href=\"#设置RSS\" class=\"headerlink\" title=\"设置RSS\"></a>设置RSS</h2><p>NexT 中 RSS 有三个设置选项，满足特定的使用场景。 更改 主题配置文件<code>themes/next/_config.yml</code>，设定 rss 字段的值：</p>\n<ul>\n<li>false：禁用 RSS，不在页面上显示 RSS 连接。</li>\n<li>留空：使用 Hexo 生成的 Feed 链接。 你可以需要先安装 <a href=\"https://github.com/hexojs/hexo-generator-feed\">hexo-generator-feed</a> 插件。</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">npm install hexo-generator-feed --save</div></pre></td></tr></table></figure>\n<p>站点配置文件<code>_config.yml</code>添加如下内容：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">feed:</div><div class=\"line\">  type: atom</div><div class=\"line\">  path: atom.xml</div><div class=\"line\">  limit: 20</div><div class=\"line\">  hub:</div><div class=\"line\">  content:</div></pre></td></tr></table></figure>\n<ul>\n<li>具体的链接地址：适用于已经烧制过 Feed 的情形。</li>\n</ul>\n<h2 id=\"添加标签页面\"><a href=\"#添加标签页面\" class=\"headerlink\" title=\"添加标签页面\"></a>添加标签页面</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd quxionglie.com</div><div class=\"line\">hexo new page tags</div></pre></td></tr></table></figure>\n<p>关闭tags页面的评论,设置comments为false：</p>\n<p>vi source/tags/index.md</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">title: 标签</div><div class=\"line\">date: 2017-01-26 22:23:01</div><div class=\"line\">type: &quot;tags&quot;</div><div class=\"line\">comments: false</div></pre></td></tr></table></figure>\n<p>新建「标签」页面，并在菜单中显示「标签」链接。「标签」页面将展示站点的所有标签，若你的所有文章都未包含标签，此页面将是空的。 底下代码是一篇包含标签的文章的例子：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">title: 标签测试文章</div><div class=\"line\">tags:</div><div class=\"line\">  - Testing</div><div class=\"line\">  - Another Tag</div><div class=\"line\">---</div></pre></td></tr></table></figure>\n<h2 id=\"添加分类页面\"><a href=\"#添加分类页面\" class=\"headerlink\" title=\"添加分类页面\"></a>添加分类页面</h2><p>新建「分类」页面，并在菜单中显示「分类」链接。「分类」页面将展示站点的所有分类，若你的所有文章都未包含分类，此页面将是空的。 底下代码是一篇包含分类的文章的例子：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">hexo new page categories</div></pre></td></tr></table></figure>\n<p>vi source/categories/index.md</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">title: 分类测试文章</div><div class=\"line\">categories: Testing</div><div class=\"line\">---</div></pre></td></tr></table></figure>\n<h2 id=\"添加about页面\"><a href=\"#添加about页面\" class=\"headerlink\" title=\"添加about页面\"></a>添加about页面</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">hexo new page about</div></pre></td></tr></table></figure>\n<h2 id=\"添加404页面\"><a href=\"#添加404页面\" class=\"headerlink\" title=\"添加404页面\"></a>添加404页面</h2><p>新建一个404.html文件，放到themes/next/source目录下，内容自定。</p>\n<h2 id=\"代码高亮\"><a href=\"#代码高亮\" class=\"headerlink\" title=\"代码高亮\"></a>代码高亮</h2><p>NexT 使用 <code>Tomorrow Theme</code> 作为代码高亮，共有5款主题供你选择。 NexT 默认使用的是 白色的 normal 主题，可选的值有 normal，night， night blue， night bright， night eighties：</p>\n<p>更改 highlight_theme 字段，将其值设定成你所喜爱的高亮主题，例如：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Code Highlight theme</div><div class=\"line\"># Available value:</div><div class=\"line\">#    normal | night | night eighties | night blue | night bright</div><div class=\"line\"># https://github.com/chriskempson/tomorrow-theme</div><div class=\"line\">highlight_theme: normal</div></pre></td></tr></table></figure>\n<h2 id=\"站点建立时间\"><a href=\"#站点建立时间\" class=\"headerlink\" title=\"站点建立时间\"></a>站点建立时间</h2><p>这个时间将在站点的底部显示，例如 © 2013 - 2015。 编辑 主题配置文件<code>themes/next/_config.yml</code>，新增字段 since。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Specify the date when the site was setup</div><div class=\"line\">since: 2013</div></pre></td></tr></table></figure>\n<h1 id=\"第三方服务\"><a href=\"#第三方服务\" class=\"headerlink\" title=\"第三方服务\"></a>第三方服务</h1><h2 id=\"多说评论\"><a href=\"#多说评论\" class=\"headerlink\" title=\"多说评论\"></a>多说评论</h2><p>修改主题配置文件<code>themes/next/_config.yml</code>中的duoshuo_shortname成你自己的。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Duoshuo ShortName</div><div class=\"line\">duoshuo_shortname: quxionglie</div></pre></td></tr></table></figure></p>\n<h2 id=\"百度统计\"><a href=\"#百度统计\" class=\"headerlink\" title=\"百度统计\"></a>百度统计</h2><p>修改主题配置文件<code>themes/next/_config.yml</code>中的baidu_analytics成你自己的。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Baidu Analytics ID</div><div class=\"line\">baidu_analytics: 36175c8b1958d080e840f34fc69cf52d</div></pre></td></tr></table></figure>\n<h1 id=\"集成\"><a href=\"#集成\" class=\"headerlink\" title=\"集成\"></a>集成</h1><h2 id=\"Jekyll\"><a href=\"#Jekyll\" class=\"headerlink\" title=\"Jekyll\"></a>Jekyll</h2><p>移动所有 Jekyll <code>_posts</code> 目录文件到 <code>source/_posts</code> 目录.</p>\n<p>修改站点配置文件<code>_config.yml</code>的<code>new_post_name</code>配置为:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">new_post_name: :year-:month-:day-:title.md</div></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 修改前配置： new_post_name: :title.md</div><div class=\"line\"># 执行命令：</div><div class=\"line\">➜  quxionglie.com git:(master) ✗ hexo new page categories</div><div class=\"line\">INFO  Created: ~/Documents/quxionglie.com/source/categories/index.md</div><div class=\"line\"></div><div class=\"line\"># 修改后配置： new_post_name: :year-:month-:day-:title.md</div><div class=\"line\"># 执行命令：</div><div class=\"line\">➜  quxionglie.com git:(master) ✗ hexo new &quot;test1&quot;        </div><div class=\"line\">INFO  Created: ~/Documents/quxionglie.com/source/_posts/2017-01-26-test1.md</div></pre></td></tr></table></figure>\n<h1 id=\"完整配置\"><a href=\"#完整配置\" class=\"headerlink\" title=\"完整配置\"></a>完整配置</h1><h2 id=\"站点配置文件-config-yml\"><a href=\"#站点配置文件-config-yml\" class=\"headerlink\" title=\"站点配置文件_config.yml\"></a>站点配置文件<code>_config.yml</code></h2><figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># Hexo Configuration</span></div><div class=\"line\"><span class=\"comment\">## Docs: https://hexo.io/docs/configuration.html</span></div><div class=\"line\"><span class=\"comment\">## Source: https://github.com/hexojs/hexo/</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Site</span></div><div class=\"line\"><span class=\"attr\">title:</span> 阿烈的博客</div><div class=\"line\"><span class=\"attr\">subtitle:</span></div><div class=\"line\"><span class=\"attr\">description:</span> Yesterday, you said tomorrow！</div><div class=\"line\"><span class=\"attr\">author:</span> 阿烈</div><div class=\"line\"><span class=\"attr\">language:</span> zh-Hans</div><div class=\"line\"><span class=\"attr\">timezone:</span> Asia/Shanghai</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># URL</span></div><div class=\"line\"><span class=\"comment\">## If your site is put in a subdirectory, set url as 'http://yoursite.com/child' and root as '/child/'</span></div><div class=\"line\"><span class=\"attr\">url:</span> http://www.quxionglie.com</div><div class=\"line\"><span class=\"attr\">root:</span> /</div><div class=\"line\"><span class=\"attr\">permalink:</span> :year/:month/:day/:title/</div><div class=\"line\"><span class=\"attr\">permalink_defaults:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Directory</span></div><div class=\"line\"><span class=\"attr\">source_dir:</span> source</div><div class=\"line\"><span class=\"attr\">public_dir:</span> public</div><div class=\"line\"><span class=\"attr\">tag_dir:</span> tags</div><div class=\"line\"><span class=\"attr\">archive_dir:</span> archives</div><div class=\"line\"><span class=\"attr\">category_dir:</span> categories</div><div class=\"line\"><span class=\"attr\">code_dir:</span> downloads/code</div><div class=\"line\"><span class=\"attr\">i18n_dir:</span> :lang</div><div class=\"line\"><span class=\"attr\">skip_render:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Writing</span></div><div class=\"line\"><span class=\"attr\">new_post_name:</span> :year-:month-:day-:title.md   <span class=\"comment\"># migrate Jekyll</span></div><div class=\"line\"><span class=\"comment\">#new_post_name: :title.md # File name of new posts</span></div><div class=\"line\"><span class=\"attr\">default_layout:</span> post</div><div class=\"line\"><span class=\"attr\">titlecase:</span> <span class=\"literal\">false</span> <span class=\"comment\"># Transform title into titlecase</span></div><div class=\"line\"><span class=\"attr\">external_link:</span> <span class=\"literal\">true</span> <span class=\"comment\"># Open external links in new tab</span></div><div class=\"line\"><span class=\"attr\">filename_case:</span> <span class=\"number\">0</span></div><div class=\"line\"><span class=\"attr\">render_drafts:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">post_asset_folder:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">relative_link:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">future:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">highlight:</span></div><div class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">  line_number:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">  auto_detect:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">  tab_replace:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Category &amp; Tag</span></div><div class=\"line\"><span class=\"attr\">default_category:</span> uncategorized</div><div class=\"line\"><span class=\"attr\">category_map:</span></div><div class=\"line\"><span class=\"attr\">tag_map:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Date / Time format</span></div><div class=\"line\"><span class=\"comment\">## Hexo uses Moment.js to parse and display date</span></div><div class=\"line\"><span class=\"comment\">## You can customize the date format as defined in</span></div><div class=\"line\"><span class=\"comment\">## http://momentjs.com/docs/#/displaying/format/</span></div><div class=\"line\"><span class=\"attr\">date_format:</span> YYYY-MM-DD</div><div class=\"line\"><span class=\"attr\">time_format:</span> HH:mm:ss</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Pagination</span></div><div class=\"line\"><span class=\"comment\">## Set per_page to 0 to disable pagination</span></div><div class=\"line\"><span class=\"attr\">per_page:</span> <span class=\"number\">10</span></div><div class=\"line\"><span class=\"attr\">pagination_dir:</span> page</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Extensions</span></div><div class=\"line\"><span class=\"comment\">## Plugins: https://hexo.io/plugins/</span></div><div class=\"line\"><span class=\"comment\">## Themes: https://hexo.io/themes/</span></div><div class=\"line\"><span class=\"attr\">theme:</span> next</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Deployment</span></div><div class=\"line\"><span class=\"comment\">## Docs: https://hexo.io/docs/deployment.html</span></div><div class=\"line\"><span class=\"attr\">deploy:</span></div><div class=\"line\"><span class=\"attr\">  type:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"attr\">feed:</span></div><div class=\"line\"><span class=\"attr\">  type:</span> atom</div><div class=\"line\"><span class=\"attr\">  path:</span> atom.xml</div><div class=\"line\"><span class=\"attr\">  limit:</span> <span class=\"number\">20</span></div><div class=\"line\"><span class=\"attr\">  hub:</span></div><div class=\"line\"><span class=\"attr\">  content:</span></div></pre></td></tr></table></figure>\n<h2 id=\"主题配置文件themes-next-config-yml\"><a href=\"#主题配置文件themes-next-config-yml\" class=\"headerlink\" title=\"主题配置文件themes/next/_config.yml\"></a>主题配置文件<code>themes/next/_config.yml</code></h2><figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div><div class=\"line\">147</div><div class=\"line\">148</div><div class=\"line\">149</div><div class=\"line\">150</div><div class=\"line\">151</div><div class=\"line\">152</div><div class=\"line\">153</div><div class=\"line\">154</div><div class=\"line\">155</div><div class=\"line\">156</div><div class=\"line\">157</div><div class=\"line\">158</div><div class=\"line\">159</div><div class=\"line\">160</div><div class=\"line\">161</div><div class=\"line\">162</div><div class=\"line\">163</div><div class=\"line\">164</div><div class=\"line\">165</div><div class=\"line\">166</div><div class=\"line\">167</div><div class=\"line\">168</div><div class=\"line\">169</div><div class=\"line\">170</div><div class=\"line\">171</div><div class=\"line\">172</div><div class=\"line\">173</div><div class=\"line\">174</div><div class=\"line\">175</div><div class=\"line\">176</div><div class=\"line\">177</div><div class=\"line\">178</div><div class=\"line\">179</div><div class=\"line\">180</div><div class=\"line\">181</div><div class=\"line\">182</div><div class=\"line\">183</div><div class=\"line\">184</div><div class=\"line\">185</div><div class=\"line\">186</div><div class=\"line\">187</div><div class=\"line\">188</div><div class=\"line\">189</div><div class=\"line\">190</div><div class=\"line\">191</div><div class=\"line\">192</div><div class=\"line\">193</div><div class=\"line\">194</div><div class=\"line\">195</div><div class=\"line\">196</div><div class=\"line\">197</div><div class=\"line\">198</div><div class=\"line\">199</div><div class=\"line\">200</div><div class=\"line\">201</div><div class=\"line\">202</div><div class=\"line\">203</div><div class=\"line\">204</div><div class=\"line\">205</div><div class=\"line\">206</div><div class=\"line\">207</div><div class=\"line\">208</div><div class=\"line\">209</div><div class=\"line\">210</div><div class=\"line\">211</div><div class=\"line\">212</div><div class=\"line\">213</div><div class=\"line\">214</div><div class=\"line\">215</div><div class=\"line\">216</div><div class=\"line\">217</div><div class=\"line\">218</div><div class=\"line\">219</div><div class=\"line\">220</div><div class=\"line\">221</div><div class=\"line\">222</div><div class=\"line\">223</div><div class=\"line\">224</div><div class=\"line\">225</div><div class=\"line\">226</div><div class=\"line\">227</div><div class=\"line\">228</div><div class=\"line\">229</div><div class=\"line\">230</div><div class=\"line\">231</div><div class=\"line\">232</div><div class=\"line\">233</div><div class=\"line\">234</div><div class=\"line\">235</div><div class=\"line\">236</div><div class=\"line\">237</div><div class=\"line\">238</div><div class=\"line\">239</div><div class=\"line\">240</div><div class=\"line\">241</div><div class=\"line\">242</div><div class=\"line\">243</div><div class=\"line\">244</div><div class=\"line\">245</div><div class=\"line\">246</div><div class=\"line\">247</div><div class=\"line\">248</div><div class=\"line\">249</div><div class=\"line\">250</div><div class=\"line\">251</div><div class=\"line\">252</div><div class=\"line\">253</div><div class=\"line\">254</div><div class=\"line\">255</div><div class=\"line\">256</div><div class=\"line\">257</div><div class=\"line\">258</div><div class=\"line\">259</div><div class=\"line\">260</div><div class=\"line\">261</div><div class=\"line\">262</div><div class=\"line\">263</div><div class=\"line\">264</div><div class=\"line\">265</div><div class=\"line\">266</div><div class=\"line\">267</div><div class=\"line\">268</div><div class=\"line\">269</div><div class=\"line\">270</div><div class=\"line\">271</div><div class=\"line\">272</div><div class=\"line\">273</div><div class=\"line\">274</div><div class=\"line\">275</div><div class=\"line\">276</div><div class=\"line\">277</div><div class=\"line\">278</div><div class=\"line\">279</div><div class=\"line\">280</div><div class=\"line\">281</div><div class=\"line\">282</div><div class=\"line\">283</div><div class=\"line\">284</div><div class=\"line\">285</div><div class=\"line\">286</div><div class=\"line\">287</div><div class=\"line\">288</div><div class=\"line\">289</div><div class=\"line\">290</div><div class=\"line\">291</div><div class=\"line\">292</div><div class=\"line\">293</div><div class=\"line\">294</div><div class=\"line\">295</div><div class=\"line\">296</div><div class=\"line\">297</div><div class=\"line\">298</div><div class=\"line\">299</div><div class=\"line\">300</div><div class=\"line\">301</div><div class=\"line\">302</div><div class=\"line\">303</div><div class=\"line\">304</div><div class=\"line\">305</div><div class=\"line\">306</div><div class=\"line\">307</div><div class=\"line\">308</div><div class=\"line\">309</div><div class=\"line\">310</div><div class=\"line\">311</div><div class=\"line\">312</div><div class=\"line\">313</div><div class=\"line\">314</div><div class=\"line\">315</div><div class=\"line\">316</div><div class=\"line\">317</div><div class=\"line\">318</div><div class=\"line\">319</div><div class=\"line\">320</div><div class=\"line\">321</div><div class=\"line\">322</div><div class=\"line\">323</div><div class=\"line\">324</div><div class=\"line\">325</div><div class=\"line\">326</div><div class=\"line\">327</div><div class=\"line\">328</div><div class=\"line\">329</div><div class=\"line\">330</div><div class=\"line\">331</div><div class=\"line\">332</div><div class=\"line\">333</div><div class=\"line\">334</div><div class=\"line\">335</div><div class=\"line\">336</div><div class=\"line\">337</div><div class=\"line\">338</div><div class=\"line\">339</div><div class=\"line\">340</div><div class=\"line\">341</div><div class=\"line\">342</div><div class=\"line\">343</div><div class=\"line\">344</div><div class=\"line\">345</div><div class=\"line\">346</div><div class=\"line\">347</div><div class=\"line\">348</div><div class=\"line\">349</div><div class=\"line\">350</div><div class=\"line\">351</div><div class=\"line\">352</div><div class=\"line\">353</div><div class=\"line\">354</div><div class=\"line\">355</div><div class=\"line\">356</div><div class=\"line\">357</div><div class=\"line\">358</div><div class=\"line\">359</div><div class=\"line\">360</div><div class=\"line\">361</div><div class=\"line\">362</div><div class=\"line\">363</div><div class=\"line\">364</div><div class=\"line\">365</div><div class=\"line\">366</div><div class=\"line\">367</div><div class=\"line\">368</div><div class=\"line\">369</div><div class=\"line\">370</div><div class=\"line\">371</div><div class=\"line\">372</div><div class=\"line\">373</div><div class=\"line\">374</div><div class=\"line\">375</div><div class=\"line\">376</div><div class=\"line\">377</div><div class=\"line\">378</div><div class=\"line\">379</div><div class=\"line\">380</div><div class=\"line\">381</div><div class=\"line\">382</div><div class=\"line\">383</div><div class=\"line\">384</div><div class=\"line\">385</div><div class=\"line\">386</div><div class=\"line\">387</div><div class=\"line\">388</div><div class=\"line\">389</div><div class=\"line\">390</div><div class=\"line\">391</div><div class=\"line\">392</div><div class=\"line\">393</div><div class=\"line\">394</div><div class=\"line\">395</div><div class=\"line\">396</div><div class=\"line\">397</div><div class=\"line\">398</div><div class=\"line\">399</div><div class=\"line\">400</div><div class=\"line\">401</div><div class=\"line\">402</div><div class=\"line\">403</div><div class=\"line\">404</div><div class=\"line\">405</div><div class=\"line\">406</div><div class=\"line\">407</div><div class=\"line\">408</div><div class=\"line\">409</div><div class=\"line\">410</div><div class=\"line\">411</div><div class=\"line\">412</div><div class=\"line\">413</div><div class=\"line\">414</div><div class=\"line\">415</div><div class=\"line\">416</div><div class=\"line\">417</div><div class=\"line\">418</div><div class=\"line\">419</div><div class=\"line\">420</div><div class=\"line\">421</div><div class=\"line\">422</div><div class=\"line\">423</div><div class=\"line\">424</div><div class=\"line\">425</div><div class=\"line\">426</div><div class=\"line\">427</div><div class=\"line\">428</div><div class=\"line\">429</div><div class=\"line\">430</div><div class=\"line\">431</div><div class=\"line\">432</div><div class=\"line\">433</div><div class=\"line\">434</div><div class=\"line\">435</div><div class=\"line\">436</div><div class=\"line\">437</div><div class=\"line\">438</div><div class=\"line\">439</div><div class=\"line\">440</div><div class=\"line\">441</div><div class=\"line\">442</div><div class=\"line\">443</div><div class=\"line\">444</div><div class=\"line\">445</div><div class=\"line\">446</div><div class=\"line\">447</div><div class=\"line\">448</div><div class=\"line\">449</div><div class=\"line\">450</div><div class=\"line\">451</div><div class=\"line\">452</div><div class=\"line\">453</div><div class=\"line\">454</div><div class=\"line\">455</div><div class=\"line\">456</div><div class=\"line\">457</div><div class=\"line\">458</div><div class=\"line\">459</div><div class=\"line\">460</div><div class=\"line\">461</div><div class=\"line\">462</div><div class=\"line\">463</div><div class=\"line\">464</div><div class=\"line\">465</div><div class=\"line\">466</div><div class=\"line\">467</div><div class=\"line\">468</div><div class=\"line\">469</div><div class=\"line\">470</div><div class=\"line\">471</div><div class=\"line\">472</div><div class=\"line\">473</div><div class=\"line\">474</div><div class=\"line\">475</div><div class=\"line\">476</div><div class=\"line\">477</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"><span class=\"comment\"># Site Information Settings</span></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Put your favicon.ico into `hexo-site/source/` directory.</span></div><div class=\"line\"><span class=\"attr\">favicon:</span> /favicon.ico</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Set default keywords (Use a comma to separate)</span></div><div class=\"line\"><span class=\"attr\">keywords:</span> <span class=\"string\">\"Hexo, NexT\"</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Set rss to false to disable feed link.</span></div><div class=\"line\"><span class=\"comment\"># Leave rss as empty to use site's feed link.</span></div><div class=\"line\"><span class=\"comment\"># Set rss to specific value if you have burned your feed already.</span></div><div class=\"line\"><span class=\"attr\">rss:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Specify the date when the site was setup</span></div><div class=\"line\"><span class=\"attr\">since:</span> <span class=\"number\">2012</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># icon between year and author @Footer</span></div><div class=\"line\"><span class=\"attr\">authoricon:</span> heart</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Footer `powered-by` and `theme-info` copyright</span></div><div class=\"line\"><span class=\"attr\">copyright:</span> <span class=\"literal\">true</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Canonical, set a canonical link tag in your hexo, you could use it for your SEO of blog.</span></div><div class=\"line\"><span class=\"comment\"># See: https://support.google.com/webmasters/answer/139066</span></div><div class=\"line\"><span class=\"comment\"># Tips: Before you open this tag, remeber set up your URL in hexo _config.yml ( ex. url: http://yourdomain.com )</span></div><div class=\"line\"><span class=\"attr\">canonical:</span> <span class=\"literal\">true</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Change headers hierarchy on site-subtitle (will be main site description) and on all post/pages titles for better SEO-optimization.</span></div><div class=\"line\"><span class=\"attr\">seo:</span> <span class=\"literal\">false</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"><span class=\"comment\"># Menu Settings</span></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># When running the site in a subdirectory (e.g. domain.tld/blog), remove the leading slash (/archives -&gt; archives)</span></div><div class=\"line\"><span class=\"attr\">menu:</span></div><div class=\"line\"><span class=\"attr\">  home:</span> /</div><div class=\"line\"><span class=\"attr\">  categories:</span> /categories</div><div class=\"line\"><span class=\"attr\">  archives:</span> /archives</div><div class=\"line\"><span class=\"attr\">  tags:</span> /tags</div><div class=\"line\"><span class=\"attr\">  about:</span> /about</div><div class=\"line\">  <span class=\"comment\">#sitemap: /sitemap.xml</span></div><div class=\"line\">  <span class=\"comment\">#commonweal: /404.html</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Enable/Disable menu icons.</span></div><div class=\"line\"><span class=\"comment\"># Icon Mapping:</span></div><div class=\"line\"><span class=\"comment\">#   Map a menu item to a specific FontAwesome icon name.</span></div><div class=\"line\"><span class=\"comment\">#   Key is the name of menu item and value is the name of FontAwsome icon. Key is case-senstive.</span></div><div class=\"line\"><span class=\"comment\">#   When an question mask icon presenting up means that the item has no mapping icon.</span></div><div class=\"line\"><span class=\"attr\">menu_icons:</span></div><div class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></div><div class=\"line\">  <span class=\"comment\">#KeyMapsToMenuItemKey: NameOfTheIconFromFontAwesome</span></div><div class=\"line\"><span class=\"attr\">  home:</span> home</div><div class=\"line\"><span class=\"attr\">  about:</span> user</div><div class=\"line\"><span class=\"attr\">  categories:</span> th</div><div class=\"line\"><span class=\"attr\">  schedule:</span> calendar</div><div class=\"line\"><span class=\"attr\">  tags:</span> tags</div><div class=\"line\"><span class=\"attr\">  archives:</span> archive</div><div class=\"line\"><span class=\"attr\">  sitemap:</span> sitemap</div><div class=\"line\"><span class=\"attr\">  commonweal:</span> heartbeat</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"><span class=\"comment\"># Scheme Settings</span></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Schemes</span></div><div class=\"line\"><span class=\"comment\">#scheme: Muse</span></div><div class=\"line\"><span class=\"attr\">scheme:</span> Mist</div><div class=\"line\"><span class=\"comment\">#scheme: Pisces</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"><span class=\"comment\"># Font Settings</span></div><div class=\"line\"><span class=\"comment\"># - Find fonts on Google Fonts (https://www.google.com/fonts)</span></div><div class=\"line\"><span class=\"comment\"># - All fonts set here will have the following styles:</span></div><div class=\"line\"><span class=\"comment\">#     light, light italic, normal, normal intalic, bold, bold italic</span></div><div class=\"line\"><span class=\"comment\"># - Be aware that setting too much fonts will cause site running slowly</span></div><div class=\"line\"><span class=\"comment\"># - Introduce in 5.0.1</span></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"><span class=\"attr\">font:</span></div><div class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Uri of fonts host. E.g. //fonts.googleapis.com (Default)</span></div><div class=\"line\"><span class=\"attr\">  host:</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Global font settings used on &lt;body&gt; element.</span></div><div class=\"line\"><span class=\"attr\">  global:</span></div><div class=\"line\">    <span class=\"comment\"># external: true will load this font family from host.</span></div><div class=\"line\"><span class=\"attr\">    external:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">    family:</span> Lato</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Font settings for Headlines (h1, h2, h3, h4, h5, h6)</span></div><div class=\"line\">  <span class=\"comment\"># Fallback to `global` font settings.</span></div><div class=\"line\"><span class=\"attr\">  headings:</span></div><div class=\"line\"><span class=\"attr\">    external:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">    family:</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Font settings for posts</span></div><div class=\"line\">  <span class=\"comment\"># Fallback to `global` font settings.</span></div><div class=\"line\"><span class=\"attr\">  posts:</span></div><div class=\"line\"><span class=\"attr\">    external:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">    family:</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Font settings for Logo</span></div><div class=\"line\">  <span class=\"comment\"># Fallback to `global` font settings.</span></div><div class=\"line\">  <span class=\"comment\"># The `size` option use `px` as unit</span></div><div class=\"line\"><span class=\"attr\">  logo:</span></div><div class=\"line\"><span class=\"attr\">    external:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">    family:</span></div><div class=\"line\"><span class=\"attr\">    size:</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Font settings for &lt;code&gt; and code blocks.</span></div><div class=\"line\"><span class=\"attr\">  codes:</span></div><div class=\"line\"><span class=\"attr\">    external:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">    family:</span></div><div class=\"line\"><span class=\"attr\">    size:</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"><span class=\"comment\"># Sidebar Settings</span></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Social Links</span></div><div class=\"line\"><span class=\"comment\"># Key is the link label showing to end users.</span></div><div class=\"line\"><span class=\"comment\"># Value is the target link (E.g. GitHub: https://github.com/iissnan)</span></div><div class=\"line\"><span class=\"comment\">#social:</span></div><div class=\"line\">  <span class=\"comment\">#LinkLabel: Link</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Social Links Icons</span></div><div class=\"line\"><span class=\"comment\"># Icon Mapping:</span></div><div class=\"line\"><span class=\"comment\">#   Map a menu item to a specific FontAwesome icon name.</span></div><div class=\"line\"><span class=\"comment\">#   Key is the name of the item and value is the name of FontAwsome icon. Key is case-senstive.</span></div><div class=\"line\"><span class=\"comment\">#   When an globe mask icon presenting up means that the item has no mapping icon.</span></div><div class=\"line\"><span class=\"attr\">social_icons:</span></div><div class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></div><div class=\"line\">  <span class=\"comment\"># Icon Mappings.</span></div><div class=\"line\">  <span class=\"comment\"># KeyMapsToSocalItemKey: NameOfTheIconFromFontAwesome</span></div><div class=\"line\"><span class=\"attr\">  GitHub:</span> github</div><div class=\"line\"><span class=\"attr\">  Twitter:</span> twitter</div><div class=\"line\"><span class=\"attr\">  Weibo:</span> weibo</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Sidebar Avatar</span></div><div class=\"line\"><span class=\"comment\"># in theme directory(source/images): /images/avatar.jpg</span></div><div class=\"line\"><span class=\"comment\"># in site  directory(source/uploads): /uploads/avatar.jpg</span></div><div class=\"line\"><span class=\"attr\">avatar:</span> /images/avatar.png</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Table Of Contents in the Sidebar</span></div><div class=\"line\"><span class=\"attr\">toc:</span></div><div class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Automatically add list number to toc.</span></div><div class=\"line\"><span class=\"attr\">  number:</span> <span class=\"literal\">true</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Creative Commons 4.0 International License.</span></div><div class=\"line\"><span class=\"comment\"># http://creativecommons.org/</span></div><div class=\"line\"><span class=\"comment\"># Available: by | by-nc | by-nc-nd | by-nc-sa | by-nd | by-sa | zero</span></div><div class=\"line\"><span class=\"comment\">#creative_commons: by-nc-sa</span></div><div class=\"line\"><span class=\"comment\">#creative_commons:</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"attr\">sidebar:</span></div><div class=\"line\">  <span class=\"comment\"># Sidebar Position, available value: left | right</span></div><div class=\"line\"><span class=\"attr\">  position:</span> left</div><div class=\"line\">  <span class=\"comment\">#position: right</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Sidebar Display, available value:</span></div><div class=\"line\">  <span class=\"comment\">#  - post    expand on posts automatically. Default.</span></div><div class=\"line\">  <span class=\"comment\">#  - always  expand for all pages automatically</span></div><div class=\"line\">  <span class=\"comment\">#  - hide    expand only when click on the sidebar toggle icon.</span></div><div class=\"line\">  <span class=\"comment\">#  - remove  Totally remove sidebar including sidebar toggler.</span></div><div class=\"line\"><span class=\"attr\">  display:</span> post</div><div class=\"line\">  <span class=\"comment\">#display: always</span></div><div class=\"line\">  <span class=\"comment\">#display: hide</span></div><div class=\"line\">  <span class=\"comment\">#display: remove</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Blogrolls</span></div><div class=\"line\"><span class=\"comment\">#links_title: Links</span></div><div class=\"line\"><span class=\"comment\">#links_layout: block</span></div><div class=\"line\"><span class=\"comment\">#links_layout: inline</span></div><div class=\"line\"><span class=\"comment\">#links:</span></div><div class=\"line\">  <span class=\"comment\">#Title: http://example.com/</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"><span class=\"comment\"># Post Settings</span></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Automatically scroll page to section which is under &lt;!-- more --&gt; mark.</span></div><div class=\"line\"><span class=\"attr\">scroll_to_more:</span> <span class=\"literal\">true</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Automatically excerpt description in homepage as preamble text.</span></div><div class=\"line\"><span class=\"attr\">excerpt_description:</span> <span class=\"literal\">true</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Automatically Excerpt. Not recommand.</span></div><div class=\"line\"><span class=\"comment\"># Please use &lt;!-- more --&gt; in the post to control excerpt accurately.</span></div><div class=\"line\"><span class=\"attr\">auto_excerpt:</span></div><div class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">  length:</span> <span class=\"number\">150</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Post meta display settings</span></div><div class=\"line\"><span class=\"attr\">post_meta:</span></div><div class=\"line\"><span class=\"attr\">  item_text:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">  created_at:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">  updated_at:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">  categories:</span> <span class=\"literal\">true</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Wechat Subscriber</span></div><div class=\"line\"><span class=\"comment\">#wechat_subscriber:</span></div><div class=\"line\">  <span class=\"comment\">#enabled: true</span></div><div class=\"line\">  <span class=\"comment\">#qcode: /path/to/your/wechatqcode ex. /uploads/wechat-qcode.jpg</span></div><div class=\"line\">  <span class=\"comment\">#description: ex. subscribe to my blog by scanning my public wechat account</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"><span class=\"comment\"># Misc Theme Settings</span></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Custom Logo.</span></div><div class=\"line\"><span class=\"comment\"># !!Only available for Default Scheme currently.</span></div><div class=\"line\"><span class=\"comment\"># Options:</span></div><div class=\"line\"><span class=\"comment\">#   enabled: [true/false] - Replace with specific image</span></div><div class=\"line\"><span class=\"comment\">#   image: url-of-image   - Images's url</span></div><div class=\"line\"><span class=\"attr\">custom_logo:</span></div><div class=\"line\"><span class=\"attr\">  enabled:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">  image:</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Code Highlight theme</span></div><div class=\"line\"><span class=\"comment\"># Available value:</span></div><div class=\"line\"><span class=\"comment\">#    normal | night | night eighties | night blue | night bright</span></div><div class=\"line\"><span class=\"comment\"># https://github.com/chriskempson/tomorrow-theme</span></div><div class=\"line\"><span class=\"attr\">highlight_theme:</span> normal</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"><span class=\"comment\"># Third Party Services Settings</span></div><div class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># MathJax Support</span></div><div class=\"line\"><span class=\"attr\">mathjax:</span></div><div class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">  per_page:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">  cdn:</span> //cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Swiftype Search API Key</span></div><div class=\"line\"><span class=\"comment\">#swiftype_key:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Baidu Analytics ID</span></div><div class=\"line\"><span class=\"attr\">baidu_analytics:</span> <span class=\"number\">36175</span>c8b1958d080e840f34fc69cf52d</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Duoshuo ShortName</span></div><div class=\"line\"><span class=\"attr\">duoshuo_shortname:</span> quxionglie</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Disqus</span></div><div class=\"line\"><span class=\"comment\">#disqus_shortname:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Hypercomments</span></div><div class=\"line\"><span class=\"comment\">#hypercomments_id:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Gentie productKey</span></div><div class=\"line\"><span class=\"comment\">#gentie_productKey:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Support for youyan comments system.</span></div><div class=\"line\"><span class=\"comment\"># You can get your uid from http://www.uyan.cc</span></div><div class=\"line\"><span class=\"comment\">#youyan_uid: your uid</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Baidu Share</span></div><div class=\"line\"><span class=\"comment\"># Available value:</span></div><div class=\"line\"><span class=\"comment\">#    button | slide</span></div><div class=\"line\"><span class=\"comment\"># Warning: Baidu Share does not support https.</span></div><div class=\"line\"><span class=\"comment\">#baidushare:</span></div><div class=\"line\"><span class=\"comment\">##  type: button</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Share</span></div><div class=\"line\"><span class=\"comment\">#jiathis:</span></div><div class=\"line\"><span class=\"comment\"># Warning: JiaThis does not support https.</span></div><div class=\"line\"><span class=\"comment\">#add_this_id:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Share</span></div><div class=\"line\"><span class=\"comment\">#duoshuo_share: true</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Google Webmaster tools verification setting</span></div><div class=\"line\"><span class=\"comment\"># See: https://www.google.com/webmasters/</span></div><div class=\"line\"><span class=\"comment\">#google_site_verification:</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Google Analytics</span></div><div class=\"line\"><span class=\"comment\">#google_analytics:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># CNZZ count</span></div><div class=\"line\"><span class=\"comment\">#cnzz_siteid:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Application Insights</span></div><div class=\"line\"><span class=\"comment\"># See https://azure.microsoft.com/en-us/services/application-insights/</span></div><div class=\"line\"><span class=\"comment\"># application_insights:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Make duoshuo show UA</span></div><div class=\"line\"><span class=\"comment\"># user_id must NOT be null when admin_enable is true!</span></div><div class=\"line\"><span class=\"comment\"># you can visit http://dev.duoshuo.com get duoshuo user id.</span></div><div class=\"line\"><span class=\"attr\">duoshuo_info:</span></div><div class=\"line\"><span class=\"attr\">  ua_enable:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">  admin_enable:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">  user_id:</span> <span class=\"number\">0</span></div><div class=\"line\">  <span class=\"comment\">#admin_nickname: Author</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Facebook SDK Support.</span></div><div class=\"line\"><span class=\"comment\"># https://github.com/iissnan/hexo-theme-next/pull/410</span></div><div class=\"line\"><span class=\"attr\">facebook_sdk:</span></div><div class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">  app_id:</span>       <span class=\"comment\">#&lt;app_id&gt;</span></div><div class=\"line\"><span class=\"attr\">  fb_admin:</span>     <span class=\"comment\">#&lt;user_id&gt;</span></div><div class=\"line\"><span class=\"attr\">  like_button:</span>  <span class=\"comment\">#true</span></div><div class=\"line\"><span class=\"attr\">  webmaster:</span>    <span class=\"comment\">#true</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Facebook comments plugin</span></div><div class=\"line\"><span class=\"comment\"># This plugin depends on Facebook SDK.</span></div><div class=\"line\"><span class=\"comment\"># If facebook_sdk.enable is false, Facebook comments plugin is unavailable.</span></div><div class=\"line\"><span class=\"attr\">facebook_comments_plugin:</span></div><div class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">  num_of_posts:</span> <span class=\"number\">10</span>  <span class=\"comment\"># min posts num is 1</span></div><div class=\"line\"><span class=\"attr\">  width:</span> <span class=\"number\">100</span>%       <span class=\"comment\"># default width is 550px</span></div><div class=\"line\"><span class=\"attr\">  scheme:</span> light     <span class=\"comment\"># default scheme is light (light or dark)</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Show number of visitors to each article.</span></div><div class=\"line\"><span class=\"comment\"># You can visit https://leancloud.cn get AppID and AppKey.</span></div><div class=\"line\"><span class=\"attr\">leancloud_visitors:</span></div><div class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">  app_id:</span> <span class=\"comment\">#&lt;app_id&gt;</span></div><div class=\"line\"><span class=\"attr\">  app_key:</span> <span class=\"comment\">#&lt;app_key&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Show PV/UV of the website/page with busuanzi.</span></div><div class=\"line\"><span class=\"comment\"># Get more information on http://ibruce.info/2015/04/04/busuanzi/</span></div><div class=\"line\"><span class=\"attr\">busuanzi_count:</span></div><div class=\"line\">  <span class=\"comment\"># count values only if the other configs are false</span></div><div class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">false</span></div><div class=\"line\">  <span class=\"comment\"># custom uv span for the whole site</span></div><div class=\"line\"><span class=\"attr\">  site_uv:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">  site_uv_header:</span> &lt;i class=<span class=\"string\">\"fa fa-user\"</span>&gt;&lt;/i<span class=\"string\">&gt;</div><div class=\"line\"></span><span class=\"attr\">  site_uv_footer:</span></div><div class=\"line\">  <span class=\"comment\"># custom pv span for the whole site</span></div><div class=\"line\"><span class=\"attr\">  site_pv:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">  site_pv_header:</span> &lt;i class=<span class=\"string\">\"fa fa-eye\"</span>&gt;&lt;/i<span class=\"string\">&gt;</div><div class=\"line\"></span><span class=\"attr\">  site_pv_footer:</span></div><div class=\"line\">  <span class=\"comment\"># custom pv span for one page only</span></div><div class=\"line\"><span class=\"attr\">  page_pv:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">  page_pv_header:</span> &lt;i class=<span class=\"string\">\"fa fa-file-o\"</span>&gt;&lt;/i<span class=\"string\">&gt;</div><div class=\"line\"></span><span class=\"attr\">  page_pv_footer:</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Tencent analytics ID</span></div><div class=\"line\"><span class=\"comment\"># tencent_analytics:</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Enable baidu push so that the blog will push the url to baidu automatically which is very helpful for SEO</span></div><div class=\"line\"><span class=\"attr\">baidu_push:</span> <span class=\"literal\">false</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Google Calendar</span></div><div class=\"line\"><span class=\"comment\"># Share your recent schedule to others via calendar page</span></div><div class=\"line\"><span class=\"comment\">#</span></div><div class=\"line\"><span class=\"comment\"># API Documentation:</span></div><div class=\"line\"><span class=\"comment\"># https://developers.google.com/google-apps/calendar/v3/reference/events/list</span></div><div class=\"line\"><span class=\"attr\">calendar:</span></div><div class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">  calendar_id:</span> &lt;required<span class=\"string\">&gt;</div><div class=\"line\"></span><span class=\"attr\">  api_key:</span> &lt;required<span class=\"string\">&gt;</div><div class=\"line\"></span><span class=\"attr\">  orderBy:</span> startTime</div><div class=\"line\"><span class=\"attr\">  offsetMax:</span> <span class=\"number\">24</span></div><div class=\"line\"><span class=\"attr\">  offsetMin:</span> <span class=\"number\">4</span></div><div class=\"line\"><span class=\"attr\">  timeZone:</span></div><div class=\"line\"><span class=\"attr\">  showDeleted:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">  singleEvents:</span> <span class=\"literal\">true</span></div><div class=\"line\"><span class=\"attr\">  maxResults:</span> <span class=\"number\">250</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Algolia Search</span></div><div class=\"line\"><span class=\"attr\">algolia_search:</span></div><div class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">false</span></div><div class=\"line\"><span class=\"attr\">  hits:</span></div><div class=\"line\"><span class=\"attr\">    per_page:</span> <span class=\"number\">10</span></div><div class=\"line\"><span class=\"attr\">  labels:</span></div><div class=\"line\"><span class=\"attr\">    input_placeholder:</span> Search for Posts</div><div class=\"line\"><span class=\"attr\">    hits_empty:</span> <span class=\"string\">\"We didn't find any results for the search: $&#123;query&#125;\"</span></div><div class=\"line\"><span class=\"attr\">    hits_stats:</span> <span class=\"string\">\"$&#123;hits&#125; results found in $&#123;time&#125; ms\"</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#! ---------------------------------------------------------------</span></div><div class=\"line\"><span class=\"comment\">#! DO NOT EDIT THE FOLLOWING SETTINGS</span></div><div class=\"line\"><span class=\"comment\">#! UNLESS YOU KNOW WHAT YOU ARE DOING</span></div><div class=\"line\"><span class=\"comment\">#! ---------------------------------------------------------------</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Motion</span></div><div class=\"line\"><span class=\"attr\">use_motion:</span> <span class=\"literal\">true</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Fancybox</span></div><div class=\"line\"><span class=\"attr\">fancybox:</span> <span class=\"literal\">true</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Canvas-nest</span></div><div class=\"line\"><span class=\"attr\">canvas_nest:</span> <span class=\"literal\">false</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Script Vendors.</span></div><div class=\"line\"><span class=\"comment\"># Set a CDN address for the vendor you want to customize.</span></div><div class=\"line\"><span class=\"comment\"># For example</span></div><div class=\"line\"><span class=\"comment\">#    jquery: https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js</span></div><div class=\"line\"><span class=\"comment\"># Be aware that you should use the same version as internal ones to avoid potential problems.</span></div><div class=\"line\"><span class=\"comment\"># Please use the https protocol of CDN files when you enable https on your site.</span></div><div class=\"line\"><span class=\"attr\">vendors:</span></div><div class=\"line\">  <span class=\"comment\"># Internal path prefix. Please do not edit it.</span></div><div class=\"line\"><span class=\"attr\">  _internal:</span> lib</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Internal version: 2.1.3</span></div><div class=\"line\"><span class=\"attr\">  jquery:</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Internal version: 2.1.5</span></div><div class=\"line\">  <span class=\"comment\"># See: http://fancyapps.com/fancybox/</span></div><div class=\"line\"><span class=\"attr\">  fancybox:</span></div><div class=\"line\"><span class=\"attr\">  fancybox_css:</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Internal version: 1.0.6</span></div><div class=\"line\">  <span class=\"comment\"># See: https://github.com/ftlabs/fastclick</span></div><div class=\"line\"><span class=\"attr\">  fastclick:</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Internal version: 1.9.7</span></div><div class=\"line\">  <span class=\"comment\"># See: https://github.com/tuupola/jquery_lazyload</span></div><div class=\"line\"><span class=\"attr\">  lazyload:</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Internal version: 1.2.1</span></div><div class=\"line\">  <span class=\"comment\"># See: http://VelocityJS.org</span></div><div class=\"line\"><span class=\"attr\">  velocity:</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Internal version: 1.2.1</span></div><div class=\"line\">  <span class=\"comment\"># See: http://VelocityJS.org</span></div><div class=\"line\"><span class=\"attr\">  velocity_ui:</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Internal version: 0.7.9</span></div><div class=\"line\">  <span class=\"comment\"># See: https://faisalman.github.io/ua-parser-js/</span></div><div class=\"line\"><span class=\"attr\">  ua_parser:</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Internal version: 4.6.2</span></div><div class=\"line\">  <span class=\"comment\"># See: http://fontawesome.io/</span></div><div class=\"line\"><span class=\"attr\">  fontawesome:</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Internal version: 1</span></div><div class=\"line\">  <span class=\"comment\"># https://www.algolia.com</span></div><div class=\"line\"><span class=\"attr\">  algolia_instant_js:</span></div><div class=\"line\"><span class=\"attr\">  algolia_instant_css:</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\"># Internal version: 1.0.0</span></div><div class=\"line\">  <span class=\"comment\"># https://github.com/hustcc/canvas-nest.js</span></div><div class=\"line\"><span class=\"attr\">  canvas_nest:</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Assets</span></div><div class=\"line\"><span class=\"attr\">css:</span> css</div><div class=\"line\"><span class=\"attr\">js:</span> js</div><div class=\"line\"><span class=\"attr\">images:</span> images</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Theme version</span></div><div class=\"line\"><span class=\"attr\">version:</span> <span class=\"number\">5.1</span><span class=\"number\">.0</span></div></pre></td></tr></table></figure>"}],"PostAsset":[],"PostCategory":[{"post_id":"ciyf7fka00007f2jy4op324p9","category_id":"ciyf7fk9q0004f2jy7imqj30k","_id":"ciyf7fkah000bf2jyfr2xynjp"},{"post_id":"ciyf7fk960001f2jy4b9sdzya","category_id":"ciyf7fk9q0004f2jy7imqj30k","_id":"ciyf7fkao000ef2jyz3pkj7zh"},{"post_id":"ciyf7fkaa000af2jyzon67xb7","category_id":"ciyf7fk9q0004f2jy7imqj30k","_id":"ciyf7fkaq000gf2jyly38lv34"},{"post_id":"ciyf7fk9k0003f2jyihhkr22t","category_id":"ciyf7fk9q0004f2jy7imqj30k","_id":"ciyf7fkat000jf2jy0i1ys3u9"},{"post_id":"ciyf7fka60008f2jyazcjyiqx","category_id":"ciyf7fkam000df2jyxgm5hopc","_id":"ciyf7fkaw000mf2jyrnv2xfll"},{"post_id":"ciyf7fkaj000cf2jy48dzf8xz","category_id":"ciyf7fkas000if2jyb6e9gtx8","_id":"ciyf7fkb5000qf2jy44s280ns"},{"post_id":"ciyf7fkao000ff2jybv2ozhwd","category_id":"ciyf7fkax000nf2jynrku88pf","_id":"ciyf7fkb8000uf2jyhwcxqubr"},{"post_id":"ciyf7fkaq000hf2jy0l49zzjx","category_id":"ciyf7fkb5000rf2jyh5budx19","_id":"ciyf7fkbj000yf2jy1uqss9fh"},{"post_id":"ciyf7fkat000kf2jy1j3vk1ll","category_id":"ciyf7fkba000wf2jyf1zbnlwg","_id":"ciyf7fkbu0013f2jykkyjvii8"},{"post_id":"ciyf7fkbq0011f2jywce721j1","category_id":"ciyf7fkba000wf2jyf1zbnlwg","_id":"ciyf7fkbx0016f2jy213i6xcg"},{"post_id":"ciyf7fkau000lf2jyay0dwc54","category_id":"ciyf7fkbn0010f2jy2qre1h64","_id":"ciyf7fkc00019f2jydzpeqb46"},{"post_id":"ciyf7fkay000of2jympg6o04k","category_id":"ciyf7fkbn0010f2jy2qre1h64","_id":"ciyf7fkce001cf2jyc2pbnf0t"},{"post_id":"ciyf7fkb2000pf2jy1hr73h1j","category_id":"ciyf7fkbz0018f2jy2h4jwerb","_id":"ciyf7fkck001gf2jydpgxpe1d"},{"post_id":"ciyf7fkb5000sf2jy5eomhp7u","category_id":"ciyf7fkcf001df2jy5uhqh9e9","_id":"ciyf7fkct001kf2jyik5szvdf"},{"post_id":"ciyf7fkb7000tf2jyferktnjh","category_id":"ciyf7fkcp001if2jyusng6m3r","_id":"ciyf7fkcw001mf2jym4f6ssg7"},{"post_id":"ciyf7fkb8000vf2jyy55ghrhd","category_id":"ciyf7fkct001lf2jybslqez2o","_id":"ciyf7fkd0001of2jy1kt1wo50"},{"post_id":"ciyf7fkbg000xf2jylf0dylj8","category_id":"ciyf7fkbn0010f2jy2qre1h64","_id":"ciyf7fkd3001qf2jyjgnmpodx"},{"post_id":"ciyf7fkbk000zf2jyaov1pnfo","category_id":"ciyf7fkbn0010f2jy2qre1h64","_id":"ciyf7fkd7001sf2jy39pn3rbp"},{"post_id":"ciyf7fkbs0012f2jyvyayepv3","category_id":"ciyf7fkd4001rf2jypfdf9i8h","_id":"ciyf7fkdc001uf2jy9hheimad"},{"post_id":"ciyf7fkbw0015f2jysel60hjd","category_id":"ciyf7fkd8001tf2jycl53ov1h","_id":"ciyf7fkdf001wf2jy7x08qesk"},{"post_id":"ciyf7fkbx0017f2jyw11r1pvg","category_id":"ciyf7fkd4001rf2jypfdf9i8h","_id":"ciyf7fkdn001yf2jyu0yse3vn"},{"post_id":"ciyf7fkc0001af2jyjhqpkafq","category_id":"ciyf7fkdf001xf2jy0wojtw7n","_id":"ciyf7fkdq0020f2jy8jlzai6x"},{"post_id":"ciyf7fkcc001bf2jyqf8l0j2o","category_id":"ciyf7fkdn001zf2jyd187c9bn","_id":"ciyf7fkdr0022f2jyyexj3u7h"},{"post_id":"ciyf7fkcg001ef2jyci95xr8y","category_id":"ciyf7fkd4001rf2jypfdf9i8h","_id":"ciyf7fkdt0024f2jyn5lnrh7c"},{"post_id":"ciyf7fkcl001hf2jyeei0gt9g","category_id":"ciyf7fkdr0023f2jy9k6zop1z","_id":"ciyf7fkdx0026f2jysngjnve9"},{"post_id":"ciyf7fkcq001jf2jywro70jrg","category_id":"ciyf7fkdv0025f2jyhhb4lg3o","_id":"ciyf7fke00027f2jyzyaoypzb"}],"PostTag":[],"Tag":[]}}